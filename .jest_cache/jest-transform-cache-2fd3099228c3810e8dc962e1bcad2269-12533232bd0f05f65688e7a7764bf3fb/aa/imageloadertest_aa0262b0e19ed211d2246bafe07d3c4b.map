{"file":"/Users/danilonovais/_danilonov_portfolio/test/unit/image-loader.test.ts","mappings":"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","names":[],"sources":["/Users/danilonovais/_danilonov_portfolio/test/unit/image-loader.test.ts"],"sourcesContent":["import supabaseLoader from '@/lib/supabase/image-loader';\n\ndescribe('supabaseLoader', () => {\n  const originalEnv = process.env;\n\n  beforeEach(() => {\n    jest.resetModules();\n    process.env = {\n      ...originalEnv,\n      NEXT_PUBLIC_SUPABASE_URL: 'https://testproject.supabase.co',\n    };\n  });\n\n  afterAll(() => {\n    process.env = originalEnv;\n  });\n\n  it('returns local paths as-is', () => {\n    const src = '/logo.png';\n    const width = 100;\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe('/logo.png');\n  });\n\n  it('transforms a standard Supabase object URL to a render URL', () => {\n    const src =\n      'https://testproject.supabase.co/storage/v1/object/public/bucket/image.png';\n    const width = 800;\n    const quality = 80;\n\n    const result = supabaseLoader({ src, width, quality });\n    expect(result).toBe(\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png?width=800&quality=80'\n    );\n  });\n\n  it('appends params to an existing render URL', () => {\n    const src =\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png';\n    const width = 500;\n\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe(\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png?width=500&quality=75'\n    );\n  });\n\n  it('handles relative paths if project ID is available via env', () => {\n    process.env.NEXT_PUBLIC_SUPABASE_URL = 'https://myproj.supabase.co';\n    const src = 'bucket/image.png';\n    const width = 300;\n\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe(\n      'https://myproj.supabase.co/storage/v1/render/image/public/bucket/image.png?width=300&quality=75'\n    );\n  });\n\n  it('returns original src for non-Supabase URLs', () => {\n    const src = 'https://example.com/image.png';\n    const width = 300;\n\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe('https://example.com/image.png');\n  });\n\n  it('correctly handles existing query params in render URL', () => {\n    const src =\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png?foo=bar';\n    const width = 100;\n\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe(\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png?foo=bar&width=100&quality=75'\n    );\n  });\n\n  it('correctly handles existing query params when transforming object URL', () => {\n    const src =\n      'https://testproject.supabase.co/storage/v1/object/public/bucket/image.png?v=1';\n    const width = 100;\n\n    const result = supabaseLoader({ src, width });\n    expect(result).toBe(\n      'https://testproject.supabase.co/storage/v1/render/image/public/bucket/image.png?v=1&width=100&quality=75'\n    );\n  });\n});\n"],"version":3}