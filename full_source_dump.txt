// =============================================================================
// Portfolio Project Types - Ghost Era v2.0
// =============================================================================

/**
 * Tipo do projeto define o layout do card
 * - A: Cards grandes, hero-style (6 colunas)
 * - B: Cards menores, grid-style (3 colunas)
 */
export type ProjectType = 'A' | 'B';

/**
 * Categoria de projeto para filtros
 */
export type ProjectCategory =
  | 'branding'
  | 'campanha'
  | 'web'
  | 'motion'
  | 'institucional'
  | 'packaging'
  | 'all';

/**
 * Layout Grid responsivo
 */
export interface ProjectGridLayout {
  /** Colunas no desktop (ex: 'col-span-6') */
  cols: string;
  /** Colunas no mobile */
  colsMobile?: string;
  /** Altura do card (ex: 'h-[400px]') */
  height: string;
  /** Aspect ratio alternativo */
  aspectRatio?: string;
  /** Ordem no grid */
  order?: number;
  /** Sizes used by Next/Image */
  sizes?: string;
}

/**
 * Conteúdo detalhado do modal
 */
export interface ProjectDetail {
  /** Parágrafo de descrição principal */
  description: string;
  /** Bullets ou destaques */
  highlights?: string[];
  /** Créditos/equipe */
  credits?: Array<{ role: string; name: string }>;
  /** Link externo (behance, site, etc) */
  externalUrl?: string;
  /** Galeria de imagens do projeto */
  gallery?: string[];
}

/**
 * Interface principal do Projeto
 */
export interface PortfolioProject {
  /** Identificador único */
  id: string;
  /** Slug para URL */
  slug: string;
  /** Título do projeto */
  title: string;
  /** Subtítulo ou tagline */
  subtitle?: string;
  /** Descrição curta para cards */
  shortDescription?: string;
  /** Cliente */
  client: string;
  /** Categoria principal */
  category: ProjectCategory;
  /** Display de categoria para UI */
  displayCategory: string;
  /** Tags adicionais */
  tags?: string[];
  /** Ano do projeto */
  year: number;
  /** Imagem principal (cover) */
  image: string;
  /** Imagem de hover (opcional) */
  hoverImage?: string;
  /** Vídeo de preview (opcional, para motion) */
  videoPreview?: string;
  /** Tipo de layout: A (grande) ou B (pequeno) */
  type: ProjectType;
  /** Configuração de layout no grid */
  layout: ProjectGridLayout;
  /** Conteúdo detalhado para o modal */
  detail?: ProjectDetail;
  /** Cor de destaque/gradiente do projeto */
  accentColor?: string;
  /** Projeto em destaque? */
  isFeatured?: boolean;
  featuredOnHome?: boolean;
  featuredOnPortfolio?: boolean;
  landingPageSlug?: string | null;
}

/**
 * Estado de filtro do showcase
 */
export interface PortfolioFilter {
  category: ProjectCategory;
  sortBy: 'recent' | 'featured' | 'alphabetical';
}

/**
 * Props para componentes de projeto
 */
export interface ProjectCardProps {
  project: PortfolioProject;
  index: number;
  className?: string;
  onOpen?: (_project: PortfolioProject) => void;
  isAnimating?: boolean;
}

/**
 * Props do Modal
 */
export interface ProjectModalProps {
  project: PortfolioProject | null;
  isOpen: boolean;
  onClose: () => void;
}
/**
 * Framer Motion Type Definitions
 * Centralized types for animation-related code
 */

import type {
  UseScrollOptions,
  MotionValue,
  SpringOptions,
} from 'framer-motion';

/**
 * Re-export commonly used Framer Motion types for convenience
 */
export type ScrollOffset = UseScrollOptions['offset'];

/**
 * Motion value event callback type
 */
export type MotionValueEventCallback<T> = (_latest: T) => void;

/**
 * Scroll narrative configuration for the useScrollNarrative hook
 */
export interface ScrollNarrativeConfig {
  /** Framer Motion scroll offset array, e.g. ['start start', 'end end'] */
  offset?: ScrollOffset;
  /** Spring damping for smooth scroll progress */
  damping?: number;
}

/**
 * Scroll narrative hook return type
 */
export interface ScrollNarrativeResult {
  containerRef: React.RefObject<HTMLDivElement>;
  scrollYProgress: MotionValue<number>;
  smoothProgress: MotionValue<number>;
  transforms: {
    heroOpacity: MotionValue<number>;
    manifestoScale: MotionValue<number>;
    manifestoRadius: MotionValue<number>;
  };
}

/**
 * Spring configuration options for consistent animation timing
 */
export interface GhostSpringConfig extends SpringOptions {
  stiffness?: number;
  damping?: number;
  restDelta?: number;
}
export type DbProject = {
  id: string;
  slug: string;
  title: string;
  client_name: string;
  brand_name: string | null;
  year: number | null;
  project_type: string;
  short_label: string | null;
  description: string | null;
  thumbnail_path: string | null;
  hero_image_path: string | null;
  gallery: Array<{ path: string; caption?: string }> | null;
  featured_on_home: boolean;
  featured_on_portfolio: boolean;
  featured_home_order: number | null;
  featured_portfolio_order: number | null;
  is_published: boolean;
  landing_page_id: string | null;
  created_at: string | null;
  updated_at: string | null;
};

export type DbLandingPage = {
  id: string;
  title: string;
  slug: string;
  cover: string | null;
  content: LandingPageBlock[] | null;
  created_at: string;
};

/** Block structure for landing page content */
export interface LandingPageBlock {
  id: string;
  type: string;
  config: Record<string, unknown>;
}

export type DbTag = {
  id: string;
  slug: string;
  label: string;
  kind: string;
  description: string | null;
  sort_order: number | null;
  created_at: string | null;
};

export type DbAsset = {
  id: string;
  key: string;
  bucket: string;
  file_path: string;
  asset_type: string;
  page: string | null;
  description: string | null;
  is_active: boolean;
  sort_order: number | null;
  href?: string | null;
  created_at: string | null;
  updated_at: string | null;
};
export type BlockType =
  | 'text'
  | 'image'
  | 'video'
  | 'video-autoplay'
  | 'image-text'
  | 'text-image'
  | 'image-image'
  | 'image-video'
  | 'video-text';

export interface TextConfig {
  fontSize?: string; // e.g., 'text-lg', 'text-4xl', or custom values
  fontWeight?: string; // e.g., 'font-light', 'font-bold'
  color?: string; // hex or tailwind class
  textAlign?: 'left' | 'center' | 'right' | 'justify';
}

export interface LandingPageBlockContent {
  text?: string;
  text2?: string;
  textConfig?: TextConfig;
  textConfig2?: TextConfig;
  media?: string;
  media2?: string;
  mediaType?: 'image' | 'video' | 'youtube';
  mediaType2?: 'image' | 'video' | 'youtube';
  autoplay?: boolean;
}

export interface LandingPageBlock {
  id: string;
  type: BlockType;
  content: LandingPageBlockContent;
  // Transient fields for Admin UI
  file?: File | null;
  file2?: File | null;
  previewUrl?: string;
  previewUrl2?: string;
}
declare module '*.module.css' {
  const classes: { readonly [key: string]: string };
  export default classes;
}

declare module '*.module.scss' {
  const classes: { readonly [key: string]: string };
  export default classes;
}

declare module '*.module.sass' {
  const classes: { readonly [key: string]: string };
  export default classes;
}
/**
 * Tipos globais para extensões do Three.js e React Three Fiber
 */
import type { ShaderMaterial, Texture } from 'three';

import type { ShaderPass } from 'three-stdlib';

/**
 * Interface para uniforms do shader AnalogDecay
 */
export interface AnalogDecayUniforms {
  tDiffuse: { value: Texture };
  uTime: { value: number };
  uIntensity: { value: number };
  uGrain: { value: number };
  uScanlines: { value: number };
  uJitter: { value: number };
}

/**
 * Interface para o material AnalogDecay
 */
export interface AnalogDecayShaderMaterial extends ShaderMaterial {
  uniforms: AnalogDecayUniforms;
}

/**
 * Extensão dos ThreeElements para elementos customizados do R3F
 */
declare module '@react-three/fiber' {
  // eslint-disable-next-line no-unused-vars
  interface ThreeElements {
    analogDecayShader: ReactThreeFiber.Object3DNode<
      AnalogDecayShaderMaterial,
      typeof AnalogDecayShaderMaterial
    >;
    shaderPass: ReactThreeFiber.Object3DNode<ShaderPass, typeof ShaderPass>;
    revealShaderMaterial: ReactThreeFiber.Object3DNode<
      ShaderMaterial,
      typeof ShaderMaterial
    >;
    revealMaterial: ReactThreeFiber.Object3DNode<
      ShaderMaterial,
      typeof ShaderMaterial
    > & {
      uGhostPos?: THREE.Vector3;
      uRevealRadius?: number;
      uBaseColor?: THREE.Color;
      uRevealColor?: THREE.Color;
      uOpacity?: number;
      transparent?: boolean;
    };
  }
}

/**
 * Declaração global para variáveis CSS customizadas do Ghost
 */
declare global {
  // eslint-disable-next-line no-unused-vars
  interface CSSProperties {
    '--gx'?: string;
    '--gy'?: string;
    '--ghost-energy'?: string;
    '--ghost-x'?: string;
    '--ghost-y'?: string;
    '--ghost-radius'?: string;
  }
}
declare module '*.less' {
  const content: { [className: string]: string };
  export default content;
}

declare module '*.css' {
  const content: { [className: string]: string };
  export default content;
}

declare module '*.scss' {
  const content: { [className: string]: string };
  export default content;
}

declare module '*.sass' {
  const content: { [className: string]: string };
  export default content;
}
'use client';

import React, {
  createContext,
  useContext,
  useMemo,
  type ReactNode,
} from 'react';
import type { SiteAsset } from '@/lib/supabase/site-assets';
import { validateExternalUrl } from '@/lib/supabase/urls';

type SiteAssetsContextValue = {
  getUrl: (_key: string) => string | undefined;
  getAssetsByPrefix: (_prefix: string) => SiteAsset[];
  getAssetWithValidation: (_key: string) => SiteAsset | undefined;
};

const SiteAssetsContext = createContext<SiteAssetsContextValue | null>(null);

export function SiteAssetsProvider({
  assets,
  children,
}: {
  assets: SiteAsset[];
  children: ReactNode;
}) {
  const assetsMap = useMemo(() => {
    const map: Record<string, SiteAsset> = {};
    assets.forEach((asset) => {
      // Validar href se existir
      if (asset.href) {
        const validatedHref = validateExternalUrl(asset.href);
        map[asset.key] = {
          ...asset,
          href: validatedHref,
        };
      } else {
        map[asset.key] = asset;
      }
    });
    return map;
  }, [assets]);

  const value = useMemo<SiteAssetsContextValue>(() => {
    const entries = Object.values(assetsMap);
    return {
      getUrl: (key: string) => assetsMap[key]?.publicUrl,
      getAssetsByPrefix: (prefix: string) =>
        entries.filter((asset) => asset.key.startsWith(prefix)),
      getAssetWithValidation: (key: string) => {
        const asset = assetsMap[key];
        if (asset?.href) {
          const validatedHref = validateExternalUrl(asset.href);
          return validatedHref ? { ...asset, href: validatedHref } : asset;
        }
        return asset;
      },
    };
  }, [assetsMap]);

  return (
    <SiteAssetsContext.Provider value={value}>
      {children}
    </SiteAssetsContext.Provider>
  );
}

export function useSiteAssetUrl(key: string, fallback?: string) {
  const context = useContext(SiteAssetsContext);
  return context?.getUrl(key) ?? fallback;
}

export function useSiteAssetsByPrefix(prefix: string) {
  const context = useContext(SiteAssetsContext);
  return context?.getAssetsByPrefix(prefix) ?? [];
}

export function useValidatedAsset(key: string) {
  const context = useContext(SiteAssetsContext);
  return context?.getAssetWithValidation(key);
}
'use client';

import { createContext } from 'react';
import type Lenis from 'lenis';

export interface ScrollContextType {
  lenis: Lenis | null;
}

export const ScrollContext = createContext<ScrollContextType>({
  lenis: null,
});
import type { MetadataRoute } from 'next';
import { BRAND } from '@/config/brand';

export const dynamic = 'force-static';

export default function robots(): MetadataRoute.Robots {
  return {
    rules: [
      {
        userAgent: '*',
        allow: '/',
        disallow: '/admin',
      },
    ],
    sitemap: `https://${BRAND.domain}/sitemap.xml`,
  };
}
'use client';

import React, { useState } from 'react';
import { HeroSection } from '@/components/portfolio/HeroSection';
import { ProjectsGallery } from '@/components/portfolio/ProjectsGallery';
import { PortfolioModal } from '@/components/portfolio/PortfolioModal';
import { PortfolioProject } from '@/types/project';
import ClientsBrandsSection from '@/components/home/clients/ClientsBrandsSection';
import ContactSection from '@/components/home/contact/ContactSection';

export default function PortfolioShowcasePage() {
  const [selectedProject, setSelectedProject] =
    useState<PortfolioProject | null>(null);
  const [isModalOpen, setIsModalOpen] = useState(false);

  const handleOpenProject = (project: PortfolioProject) => {
    setSelectedProject(project);
    setIsModalOpen(true);
  };

  const handleCloseModal = () => {
    setIsModalOpen(false);
    // Give time for exit animation before clearing project
    setTimeout(() => setSelectedProject(null), 300);
  };

  return (
    <main className="bg-[#040013] min-h-screen">
      <HeroSection />

      <ProjectsGallery onOpenProject={handleOpenProject} />

      {/* Legacy Sections covering the gallery track if needed */}
      <div className="relative z-10 bg-[#040013]">
        <ClientsBrandsSection />
        <ContactSection />
      </div>

      <PortfolioModal
        isOpen={isModalOpen}
        onClose={handleCloseModal}
        project={selectedProject}
      />
    </main>
  );
}
'use client';

import React, { useState } from 'react';
import Image from 'next/image';
import { motion } from 'framer-motion';

export default function LayoutPlayground() {
  const [opacity, setOpacity] = useState(0.5);
  const [isOverlayVisible, setIsOverlayVisible] = useState(true);
  const [blendMode, setBlendMode] = useState<string>('normal');

  return (
    <div className="relative min-h-screen bg-transparent">
      {/* Control Panel */}
      <div className="fixed bottom-10 left-1/2 z-9999 -translate-x-1/2 flex items-center gap-6 rounded-full bg-black/90 px-8 py-4 backdrop-blur-xl border border-white/10 shadow-2xl">
        <div className="flex flex-col gap-1">
          <label
            htmlFor="opacity-slider"
            className="text-[10px] uppercase tracking-widest text-white/50 font-mono"
          >
            Reference Opacity
          </label>
          <input
            id="opacity-slider"
            type="range"
            min="0"
            max="1"
            step="0.01"
            value={opacity}
            onChange={(e) => setOpacity(parseFloat(e.target.value))}
            className="w-32 accent-[#0057FF]"
            title="Adjust Reference Opacity"
          />
        </div>

        <button
          onClick={() => setIsOverlayVisible(!isOverlayVisible)}
          className={`px-4 py-2 rounded-md text-[10px] font-bold uppercase transition-all tracking-tighter ${isOverlayVisible ? 'bg-[#0057FF] text-white' : 'bg-white/10 text-white'}`}
        >
          {isOverlayVisible ? 'Hide Overlay' : 'Show Overlay'}
        </button>

        <div className="flex items-center gap-2">
          <label
            htmlFor="blend-selector"
            className="text-[10px] uppercase text-white/50 font-mono"
          >
            Blend:
          </label>
          <select
            id="blend-selector"
            value={blendMode}
            onChange={(e) => setBlendMode(e.target.value)}
            className="bg-transparent text-white text-[10px] border-none focus:ring-0 uppercase font-bold px-0 py-0"
            title="Choose Mix Blend Mode"
          >
            <option value="normal">Normal</option>
            <option value="difference">Difference</option>
            <option value="screen">Screen</option>
            <option value="multiply">Multiply</option>
          </select>
        </div>
      </div>

      {/* The Live Implementation (Current Page Content) */}
      <div className="relative z-10 w-full pointer-events-none">
        {/* We use an iframe to render the actual homepage here for comparison */}
        <iframe
          src="/"
          className="w-full min-h-screen border-none h-[500vh]"
          title="Live Implementation"
        />
      </div>

      {/* The Reference Image Overlay */}
      {isOverlayVisible && (
        <motion.div
          className="fixed inset-0 z-50 pointer-events-none"
          animate={{
            opacity,
            mixBlendMode: blendMode as any,
          }}
          transition={{ duration: 0.2 }}
        >
          <div className="relative w-full h-full max-w-[1680px] mx-auto">
            <Image
              src="/referencia/HOME-PORTFOLIO-BLACK---GHOST.jpg"
              alt="Layout Reference"
              fill
              className="object-top object-contain"
              priority
            />
          </div>
        </motion.div>
      )}

      {/* Helper Legend */}
      <div className="fixed top-10 right-10 z-9999 bg-black/80 p-4 rounded-lg border border-white/10 backdrop-blur-md">
        <h4 className="text-[#0057FF] font-bold text-xs uppercase mb-2">
          Playground Tools
        </h4>
        <p className="text-white/60 text-[10px] leading-relaxed max-w-[200px]">
          Use this overlay to find misalignment between the current
          implementation and the absolute reference. Toggle{' '}
          <strong>Difference</strong> blend mode to see exactly where pixels
          don't match.
        </p>
      </div>
    </div>
  );
}
import { NextResponse, type NextRequest } from 'next/server';
import { createServerClient } from '@supabase/ssr';
import { cookies } from 'next/headers';

export async function GET(request: NextRequest) {
  const { searchParams, origin } = new URL(request.url);
  const code = searchParams.get('code');
  const next = searchParams.get('next') ?? '/admin';

  if (code) {
    const cookieStore = await cookies();

    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
    const supabaseKey =
      process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

    if (!supabaseUrl || !supabaseKey) {
      return NextResponse.redirect(
        `${origin}/admin/login?error=missing_config`
      );
    }

    const supabase = createServerClient(supabaseUrl, supabaseKey, {
      cookieOptions: {
        name: '__session',
        sameSite: 'lax',
        secure: true,
      },
      cookies: {
        getAll() {
          return cookieStore.getAll();
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            );
          } catch {
            // Server Component
          }
        },
      },
    });

    const { error } = await supabase.auth.exchangeCodeForSession(code);
    if (!error) {
      return NextResponse.redirect(`${origin}${next}`);
    }
  }

  // Something went wrong, redirect to login with error
  return NextResponse.redirect(
    `${origin}/admin/login?error=auth_callback_failed`
  );
}
import React from 'react';
import type { Metadata } from 'next';
import { AboutHero } from '@/components/sobre/AboutHero';
import AboutOrigin from '@/components/sobre/AboutOrigin';
import { AboutWhatIDo } from '@/components/sobre/AboutWhatIDo';
import AboutMethod from '@/components/sobre/AboutMethod';
import { AboutBeliefs } from '@/components/sobre/AboutBeliefs';
import { AboutClosing } from '@/components/sobre/AboutClosing';
import { SiteClosure } from '@/components/layout/SiteClosure';

export const metadata: Metadata = {
  title: 'Sobre',
  description:
    'Conheça a trajetória, o método e a visão de Danilo Novais por trás do design e desenvolvimento criativo.',
};

export default function AboutPage() {
  return (
    <div className="min-h-screen bg-background text-white">
      {/* Seção 01 — Hero/Manifesto */}
      <AboutHero />
      {/* Seção 02 — Origem Criativa */}
      <AboutOrigin />
      {/* Seção 03 — O Que Eu Faço */}
      <AboutWhatIDo />
      {/* Seção 04 — Como Eu Trabalho */}
      <AboutMethod />
      {/* Seção 05 — O Que Me Move (Beliefs) */}
      <AboutBeliefs />
      {/* Seção 06 — Fechamento/Confirmação */}
      <AboutClosing />
      <SiteClosure />
    </div>
  );
}
import { ImageResponse } from 'next/og';
import { BRAND } from '@/config/brand';

// export const runtime = 'edge'; // Removed to avoid conflict with force-static
export const dynamic = 'force-static'; // <--- ADICIONA ESTA LINHA

// Image metadata
export const alt = 'Danilo Novais | Creative Developer Portfolio';
export const size = {
  width: 1200,
  height: 630,
};
export const contentType = 'image/png';

export default async function Image() {
  return new ImageResponse(
    <div style={styles.container}>
      <div style={styles.logoContainer}>
        {/* Logo Mark Representation */}
        <svg
          width="80"
          height="80"
          viewBox="0 0 40 40"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          style={styles.logoSvg}
        >
          <path
            d="M9 11.2c0-1.2 1-2.2 2.2-2.2h12.2c6.4 0 11.6 5.2 11.6 11.6S29.8 32.2 23.4 32.2H11.2C10 32.2 9 31.2 9 30V11.2Z"
            stroke="white"
            strokeWidth="2"
            strokeOpacity="0.9"
          />
          <path
            d="M14 14l12 12M26 14 14 26"
            stroke="white"
            strokeWidth="1.6"
            strokeOpacity="0.55"
          />
        </svg>
      </div>

      <h1 style={styles.title}>Danilo Novais</h1>
      <p style={styles.subtitle}>Creative Developer & Interactive Designer</p>
    </div>,
    {
      ...size,
    }
  );
}

const styles = {
  container: {
    height: '100%',
    width: '100%',
    display: 'flex',
    flexDirection: 'column',
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: BRAND.colors.background,
    fontFamily: BRAND.assets.fonts.primary,
  },
  logoContainer: {
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    marginBottom: 40,
  },
  logoSvg: {
    marginRight: 0,
  },
  title: {
    fontSize: 64,
    fontWeight: 700,
    background: `linear-gradient(to bottom right, ${BRAND.colors.text} 0%, ${BRAND.colors.textHighlight} 100%)`,
    backgroundClip: 'text',
    color: 'transparent',
    margin: 0,
    marginBottom: 16,
    letterSpacing: '-0.03em',
    textAlign: 'center',
  },
  subtitle: {
    fontSize: 32,
    color: BRAND.colors.textSecondary,
    margin: 0,
    letterSpacing: '-0.01em',
    textAlign: 'center',
  },
} as const;
import { createClient } from '@/lib/supabase/server';
import { notFound } from 'next/navigation';
import ProjectRenderer from '@/components/projects/ProjectRenderer';
import { Metadata } from 'next';

interface Props {
  params: Promise<{ slug: string }>;
}

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { slug } = await params;
  const supabase = await createClient();

  const { data: project } = await supabase
    .from('landing_pages')
    .select('title, cover')
    .eq('slug', slug)
    .single();

  if (!project) return { title: 'Projeto não encontrado' };

  return {
    title: `${project.title} | Danilo Novais`,
    description: `Landing page do projeto ${project.title} por Danilo Novais.`,
    openGraph: {
      title: project.title,
      images: project.cover ? [{ url: project.cover }] : [],
    },
  };
}

export default async function ProjectPage({ params }: Props) {
  const { slug } = await params;
  const supabase = await createClient();

  const { data: project, error } = await supabase
    .from('landing_pages')
    .select('*')
    .eq('slug', slug)
    .single();

  if (error || !project) {
    notFound();
  }

  return (
    <main className="min-h-screen">
      <ProjectRenderer project={project} />
    </main>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

export default function ConfigPage() {
  return (
    <div className="space-y-4">
      <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
        Configurações
      </p>
      <h1 className="text-3xl font-semibold">Configurações básicas</h1>
      <p className="text-slate-300 text-sm">
        Use esta seção para adicionar preferências futuras (ex: usuários admin,
        temas, chaves de API).
      </p>
    </div>
  );
}
'use client';

import LandingPageForm from '@/components/admin/LandingPageForm';

export default function NewLandingPage() {
  return (
    <div className="space-y-8">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Projetos
        </p>
        <h1 className="text-3xl font-semibold">Nova Landing Page</h1>
      </div>

      <LandingPageForm />
    </div>
  );
}
'use client';

import { useEffect, useState, use } from 'react';

import { createClientComponentClient } from '@/lib/supabase/client';
import LandingPageForm from '@/components/admin/LandingPageForm';

interface Props {
  params: Promise<{ id: string }>;
}

export default function EditLandingPage({ params }: Props) {
  const { id } = use(params);
  const supabase = createClientComponentClient();
  const [data, setData] = useState<any>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchData() {
      const { data } = await supabase
        .from('landing_pages')
        .select('*')
        .eq('id', id)
        .single();

      if (data) setData(data);
      setLoading(false);
    }
    fetchData();
  }, [id, supabase]);

  if (loading)
    return <div className="p-10 text-center">Carregando dados...</div>;
  if (!data)
    return <div className="p-10 text-center">Página não encontrada.</div>;

  return (
    <div className="space-y-8">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Projetos
        </p>
        <h1 className="text-3xl font-semibold">Editar Landing Page</h1>
      </div>

      <LandingPageForm initialData={data} />
    </div>
  );
}
'use client';

import { useEffect, useState } from 'react';
import Link from 'next/link';
import { createClientComponentClient } from '@/lib/supabase/client';
import { Plus, Edit, Trash2, ExternalLink } from 'lucide-react';
import { motion, AnimatePresence } from 'framer-motion';

interface LandingPage {
  id: string;
  title: string;
  slug: string;
  created_at: string;
}

export default function LandingPagesListPage() {
  const supabase = createClientComponentClient();
  const [pages, setPages] = useState<LandingPage[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchPages();
  }, []);

  async function fetchPages() {
    try {
      setLoading(true);
      const { data, error } = await supabase
        .from('landing_pages')
        .select('id, title, slug, created_at')
        .order('created_at', { ascending: false });

      if (error) throw error;
      setPages(data || []);
    } catch (err) {
      console.error('Error fetching landing pages:', err);
    } finally {
      setLoading(false);
    }
  }

  async function handleDelete(id: string) {
    if (!confirm('Tem certeza que deseja excluir esta página?')) return;

    try {
      const { error } = await supabase
        .from('landing_pages')
        .delete()
        .eq('id', id);

      if (error) throw error;
      setPages(pages.filter((p) => p.id !== id));
    } catch (err) {
      console.error('Error deleting landing page:', err);
      alert('Erro ao excluir página.');
    }
  }

  return (
    <div className="space-y-8">
      <div className="flex items-center justify-between">
        <div>
          <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
            Gerenciamento
          </p>
          <h1 className="text-3xl font-semibold">Landing Pages de Projetos</h1>
        </div>
        <Link
          href="/admin/landing-pages/new"
          className="flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-blue-700 transition-all"
        >
          <Plus size={18} />
          Nova Página
        </Link>
      </div>

      <div className="overflow-hidden rounded-xl border border-white/10 bg-slate-900/40 backdrop-blur-sm">
        {loading ? (
          <div className="p-12 text-center text-slate-400">Carregando...</div>
        ) : pages.length > 0 ? (
          <table className="min-w-full text-sm text-left">
            <thead>
              <tr className="border-b border-white/10 text-slate-400">
                <th className="px-6 py-4 font-medium uppercase tracking-wider">
                  Título
                </th>
                <th className="px-6 py-4 font-medium uppercase tracking-wider">
                  Slug
                </th>
                <th className="px-6 py-4 font-medium uppercase tracking-wider">
                  Criação
                </th>
                <th className="px-6 py-4 font-medium uppercase tracking-wider text-right">
                  Ações
                </th>
              </tr>
            </thead>
            <tbody className="divide-y divide-white/5">
              <AnimatePresence>
                {pages.map((page) => (
                  <motion.tr
                    key={page.id}
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    className="hover:bg-white/2 transition-colors group"
                  >
                    <td className="px-6 py-4 text-white font-medium">
                      {page.title}
                    </td>
                    <td className="px-6 py-4 text-slate-400 font-mono text-xs">
                      /{page.slug}
                    </td>
                    <td className="px-6 py-4 text-slate-500">
                      {new Date(page.created_at).toLocaleDateString('pt-BR')}
                    </td>
                    <td className="px-6 py-4 text-right">
                      <div className="flex items-center justify-end gap-2">
                        <Link
                          href={`/projects/${page.slug}`}
                          target="_blank"
                          className="p-2 text-slate-400 hover:text-white transition-colors"
                          title="Ver página pública"
                        >
                          <ExternalLink size={18} />
                        </Link>
                        <Link
                          href={`/admin/landing-pages/${page.id}`}
                          className="p-2 text-slate-400 hover:text-blue-400 transition-colors"
                          title="Editar"
                        >
                          <Edit size={18} />
                        </Link>
                        <button
                          onClick={() => handleDelete(page.id)}
                          className="p-2 text-slate-400 hover:text-red-400 transition-colors"
                          title="Excluir"
                        >
                          <Trash2 size={18} />
                        </button>
                      </div>
                    </td>
                  </motion.tr>
                ))}
              </AnimatePresence>
            </tbody>
          </table>
        ) : (
          <div className="p-12 text-center">
            <p className="text-slate-400 mb-4">Nenhuma landing page criada.</p>
            <Link
              href="/admin/landing-pages/new"
              className="text-blue-400 hover:underline text-sm"
            >
              Criar minha primeira página
            </Link>
          </div>
        )}
      </div>
    </div>
  );
}
'use client';

import {
  siteAssetRoleGroups,
  type SiteAssetRole,
} from '@/lib/supabase/asset-roles';

export function PresetButtons() {
  return (
    <div className="rounded-xl border border-white/10 bg-slate-900/60 p-4 space-y-4">
      <h2 className="text-lg font-semibold">Presets rápidos</h2>
      <div className="space-y-4">
        {siteAssetRoleGroups.map((group) => (
          <div key={group.label} className="space-y-2">
            <p className="text-xs font-semibold uppercase tracking-widest text-slate-500">
              {group.label}
            </p>
            <div className="grid gap-2 md:grid-cols-2">
              {group.roles.map((role) => (
                <PresetButton key={role.key} preset={role} />
              ))}
            </div>
          </div>
        ))}
      </div>
      <p className="text-xs text-slate-400">
        Clique para preencher o formulário ao lado com a key, página e tipo
        recomendados.
      </p>
    </div>
  );
}

function PresetButton({ preset }: { preset: SiteAssetRole }) {
  const fillForm = () => {
    if (typeof window === 'undefined') return;
    const keyInput = document.querySelector<HTMLInputElement>(
      'form input[name="asset-key"]'
    );
    const pageSelect = document.querySelector<HTMLSelectElement>(
      'form select[name="asset-page"]'
    );
    const typeSelect = document.querySelector<HTMLSelectElement>(
      'form select[name="asset-type"]'
    );
    const subPathInput = document.querySelector<HTMLInputElement>(
      'form input[name="asset-subpath"]'
    );
    if (keyInput) keyInput.value = preset.key;
    if (pageSelect) pageSelect.value = preset.page;
    if (typeSelect) typeSelect.value = preset.asset_type;
    if (subPathInput) subPathInput.value = preset.subPath ?? '';
    keyInput?.dispatchEvent(new Event('input', { bubbles: true }));
    pageSelect?.dispatchEvent(new Event('change', { bubbles: true }));
    typeSelect?.dispatchEvent(new Event('change', { bubbles: true }));
    subPathInput?.dispatchEvent(new Event('input', { bubbles: true }));
  };

  return (
    <button
      type="button"
      onClick={fillForm}
      className="flex w-full flex-col items-start rounded-md border border-white/10 bg-slate-900/80 px-3 py-2 text-left text-sm text-white transition hover:border-blue-400 hover:bg-blue-500/10"
    >
      <div className="font-semibold">{preset.label}</div>
      <div className="text-[11px] text-slate-400">{preset.key}</div>
      <div className="text-[11px] text-slate-500">
        {preset.page} • {preset.asset_type}
      </div>
      {preset.description && (
        <div className="text-[11px] text-slate-500">{preset.description}</div>
      )}
    </button>
  );
}
'use server';

import type { SiteAssetRole } from '@/lib/supabase/asset-roles';
import {
  buildAssetFilePath,
  getFileExtension,
} from '@/lib/supabase/asset-paths';
import { normalizeStoragePath } from '@/lib/supabase/urls';
import { createClient } from '@/lib/supabase/server';
import { revalidatePath } from 'next/cache';

type AssetPayload = {
  key: string;
  page: string;
  asset_type: string;
  description?: string | null;
  sort_order?: number | null;
  file_path?: string | null;
  bucket?: string;
};

export async function upsertAsset(payload: AssetPayload) {
  const supabase = await createClient();
  const normalizedPath = payload.file_path
    ? normalizeStoragePath(payload.file_path, payload.bucket ?? 'site-assets')
    : null;
  const { error } = await supabase.from('site_assets').upsert(
    {
      ...payload,
      bucket: payload.bucket ?? 'site-assets',
      is_active: true,
      file_path: normalizedPath,
    },
    { onConflict: 'key' }
  );
  if (error) throw error;
  refreshAssetRoutes();
}

type AssignAssetRolePayload = {
  assetId: string;
  role: SiteAssetRole;
};

export async function assignAssetRole(payload: AssignAssetRolePayload) {
  const supabase = await createClient();
  const { data: existing, error: fetchError } = await supabase
    .from('site_assets')
    .select('bucket,file_path')
    .eq('id', payload.assetId)
    .single();

  if (fetchError || !existing) {
    throw fetchError ?? new Error('Asset não encontrado.');
  }

  const currentPath = normalizeStoragePath(existing.file_path, existing.bucket);
  const extension = getFileExtension(currentPath) || 'bin';
  const targetPath = buildAssetFilePath({
    page: payload.role.page,
    key: payload.role.key,
    subPath: payload.role.subPath,
    extension,
  });

  let file_path = currentPath;

  if (file_path && file_path !== targetPath) {
    const { error: moveError } = await supabase.storage
      .from(existing.bucket)
      .move(file_path, targetPath);
    if (moveError) throw moveError;
    file_path = targetPath;
  }

  const { error: updateError } = await supabase
    .from('site_assets')
    .update({
      key: payload.role.key,
      page: payload.role.page,
      asset_type: payload.role.asset_type,
      description: payload.role.description,
      sort_order: payload.role.sort_order ?? null,
      file_path,
    })
    .eq('id', payload.assetId);

  if (updateError) throw updateError;
  refreshAssetRoutes();
}

export async function removeAsset(payload: {
  id: string;
  bucket: string;
  file_path?: string | null;
}) {
  const supabase = await createClient();
  if (payload.file_path) {
    const normalizedPath = normalizeStoragePath(
      payload.file_path,
      payload.bucket
    );
    if (normalizedPath) {
      const { error: storageError } = await supabase.storage
        .from(payload.bucket)
        .remove([normalizedPath]);
      if (storageError) throw storageError;
    }
  }
  const { error } = await supabase
    .from('site_assets')
    .delete()
    .eq('id', payload.id);
  if (error) throw error;
  refreshAssetRoutes();
}

function refreshAssetRoutes() {
  revalidatePath('/');
  revalidatePath('/about');
  revalidatePath('/portfolio');
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import { createClient } from '@/lib/supabase/server';
import { AssetForm } from '@/components/admin/AssetForm';
import { AssetGuide } from '@/components/admin/AssetGuide';
import { PresetButtons } from './preset-buttons';
import { normalizeAssetList } from '@/lib/supabase/site-asset-utils';
import { AssetGallery } from '@/components/admin/AssetGallery';

export default async function MidiaPage() {
  const supabase = await createClient();
  const { data: assets } = await supabase
    .from('site_assets')
    .select('*')
    .order('page', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  const normalizedAssets = normalizeAssetList(assets ?? [], {
    onlyActive: false,
  }); // Mostrar todos para permitir edição
  const validAssets = normalizedAssets.filter((asset) => {
    // Filtrar assets com chaves inválidas
    return !(
      asset.key.startsWith('updated_at:') || asset.key.startsWith('key:')
    );
  });
  const activeCount = validAssets.filter((asset) => asset.is_active).length;

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between gap-3">
        <div>
          <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
            Mídia
          </p>
          <h1 className="text-3xl font-semibold">Assets do site</h1>
          <p className="text-sm text-slate-400">
            {activeCount} ativos de {normalizedAssets.length} registros válidos
          </p>
        </div>
      </div>

      <div className="grid gap-6 lg:grid-cols-[2fr_1fr]">
        <div className="rounded-xl border border-white/10 bg-slate-900/60 p-4">
          <h2 className="text-lg font-semibold mb-3">
            Adicionar/atualizar asset
          </h2>
          <AssetForm />
        </div>
        <div className="flex flex-col gap-4">
          <PresetButtons />
          <AssetGuide />
        </div>
      </div>

      <AssetGallery assets={validAssets} />
    </div>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import { createClient } from '@/lib/supabase/server';
import { TagForm } from '@/components/admin/TagForm';

const KIND_LABELS: Record<string, string> = {
  category: 'Categoria',
  discipline: 'Disciplina',
  industry: 'Indústria',
};

export default async function TagsPage() {
  const supabase = await createClient();
  const { data: tags } = await supabase
    .from('portfolio_tags')
    .select('*')
    .order('kind', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  const tagList = tags ?? [];
  type TagRow = NonNullable<(typeof tagList)[number]>;
  const grouped = tagList.reduce<Record<string, TagRow[]>>((acc, tag) => {
    const group = acc[tag.kind] ?? [];
    group.push(tag);
    acc[tag.kind] = group;
    return acc;
  }, {});

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between gap-3">
        <div>
          <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
            Tags
          </p>
          <h1 className="text-3xl font-semibold">Categorias e filtros</h1>
        </div>
      </div>

      <div className="grid gap-6 md:grid-cols-[2fr_1fr]">
        <div className="space-y-6">
          {Object.entries(grouped).map(([kind, groupTags]) => (
            <div
              key={kind}
              className="rounded-xl border border-white/10 bg-slate-900/60 px-4 py-5"
            >
              <div className="mb-4 flex items-center justify-between">
                <div>
                  <p className="text-xs uppercase tracking-[0.4em] text-slate-400">
                    {kind.toUpperCase()}
                  </p>
                  <h2 className="text-lg font-semibold text-white">
                    {KIND_LABELS[kind] ?? kind}
                  </h2>
                </div>
                <span className="text-xs text-slate-400">
                  {groupTags.length} tag{groupTags.length === 1 ? '' : 's'}
                </span>
              </div>
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-400">
                    <th className="px-3 py-2">Tag</th>
                    <th className="px-3 py-2">Slug</th>
                    <th className="px-3 py-2">Ordem</th>
                  </tr>
                </thead>
                <tbody>
                  {groupTags.map((tag) => (
                    <tr key={tag.id} className="border-t border-white/5">
                      <td className="px-3 py-2 font-medium text-white">
                        {tag.label}
                      </td>
                      <td className="px-3 py-2 text-slate-300">{tag.slug}</td>
                      <td className="px-3 py-2 text-slate-300">
                        {tag.sort_order ?? '—'}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          ))}
          {!tags?.length && (
            <div className="rounded-xl border border-white/10 bg-slate-900/60 px-4 py-6 text-center text-slate-400">
              Nenhuma tag cadastrada.
            </div>
          )}
        </div>

        <div className="rounded-xl border border-white/10 bg-slate-900/60 p-4">
          <h2 className="text-lg font-semibold mb-3">Nova tag</h2>
          <TagForm />
        </div>
      </div>
    </div>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import type { Metadata } from 'next';
import type { ReactNode } from 'react';
import { isRedirectError } from 'next/dist/client/components/redirect-error';
import { AdminShell } from '@/components/admin/AdminShell';
import { AdminErrorDisplay } from '@/components/admin/AdminErrorDisplay';
import { redirect } from 'next/navigation';
import { createClient } from '@/lib/supabase/server';

export const metadata: Metadata = {
  robots: {
    index: false,
    follow: false,
    nocache: true,
    googleBot: {
      index: false,
      follow: false,
    },
  },
};

export default async function ProtectedLayout({
  children,
}: {
  children: ReactNode;
}) {
  try {
    const supabase = await createClient();
    const {
      data: { user },
      error,
    } = await supabase.auth.getUser();

    if (error) {
      console.error('[Admin Layout] auth.getUser error:', error.message);
    }

    if (!user) {
      // O middleware já redireciona para /admin/login se não houver usuário.
      // Adicionamos um redirecionamento explícito aqui como safeguard.
      redirect('/admin/login');
    }

    return (
      <AdminShell userEmail={user.email ?? undefined}>{children}</AdminShell>
    );
  } catch (error) {
    if (isRedirectError(error)) {
      throw error;
    }

    console.error(
      '[Admin Layout] Critical failure:',
      error instanceof Error ? error.message : error
    );

    const isMissingEnv =
      error instanceof Error &&
      error.message.includes('Missing Supabase server client credentials');

    return (
      <AdminErrorDisplay
        message={error instanceof Error ? error.message : 'Falha desconhecida'}
        isMissingEnv={isMissingEnv}
      />
    );
  }
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import Link from 'next/link';
import { createClient } from '@/lib/supabase/server';
import { ADMIN_NAVIGATION } from '@/config/admin-navigation';

export default async function AdminDashboard() {
  const supabase = await createClient();

  const [
    { count: projectsCount },
    { count: tagsCount },
    { data: featuredHome },
    { data: featuredPortfolio },
  ] = await Promise.all([
    supabase
      .from('portfolio_projects')
      .select('id', { count: 'exact', head: true }),
    supabase
      .from('portfolio_tags')
      .select('id', { count: 'exact', head: true }),
    supabase
      .from('portfolio_projects')
      .select('id')
      .eq('featured_on_home', true)
      .order('featured_home_order', { ascending: true }),
    supabase
      .from('portfolio_projects')
      .select('id')
      .eq('featured_on_portfolio', true)
      .order('featured_portfolio_order', { ascending: true }),
  ]);

  return (
    <div className="space-y-6">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Dashboard
        </p>
        <h1 className="text-3xl font-semibold">Visão geral</h1>
      </div>

      <div className="grid gap-4 md:grid-cols-4">
        <StatCard
          title="Projetos"
          value={projectsCount ?? 0}
          href={ADMIN_NAVIGATION.trabalhos.index}
        />
        <StatCard
          title="Tags"
          value={tagsCount ?? 0}
          href={ADMIN_NAVIGATION.tags}
        />
        <StatCard title="Destaques Home" value={featuredHome?.length ?? 0} />
        <StatCard
          title="Destaques Portfólio"
          value={featuredPortfolio?.length ?? 0}
        />
      </div>
    </div>
  );
}

function StatCard({
  title,
  value,
  href,
}: {
  title: string;
  value: number;
  href?: string;
}) {
  const CardContent = () => (
    <>
      <p className="text-sm text-slate-400">{title}</p>
      <p className="text-3xl font-semibold mt-2">{value}</p>
    </>
  );

  if (href) {
    return (
      <Link
        href={href}
        className="rounded-xl border border-white/10 bg-slate-900/60 p-4 hover:bg-slate-800/60 transition-colors"
      >
        <CardContent />
      </Link>
    );
  }

  return (
    <div className="rounded-xl border border-white/10 bg-slate-900/60 p-4">
      <CardContent />
    </div>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import { createClient } from '@/lib/supabase/server';
import { ProjectForm } from '@/components/admin/ProjectForm';

export default async function NewProjectPage() {
  const supabase = await createClient();
  const [{ data: tags }, { data: landingPages }] = await Promise.all([
    supabase
      .from('portfolio_tags')
      .select('*')
      .order('sort_order', { ascending: true, nullsFirst: false }),
    supabase
      .from('landing_pages')
      .select('id, title, slug')
      .order('title', { ascending: true }),
  ]);

  return (
    <div className="space-y-6">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Trabalhos
        </p>
        <h1 className="text-3xl font-semibold">Novo projeto</h1>
      </div>
      <ProjectForm tags={tags ?? []} landingPages={landingPages ?? []} />
    </div>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import { notFound } from 'next/navigation';
import { createClient } from '@/lib/supabase/server';
import { ProjectForm } from '@/components/admin/ProjectForm';

type Props = {
  params: Promise<{ id: string }>;
};

export default async function EditProjectPage(props: Props) {
  const params = await props.params;
  const { id } = params;
  const supabase = await createClient();

  const [
    { data: project, error: projectError },
    { data: tags },
    { data: landingPages },
  ] = await Promise.all([
    supabase
      .from('portfolio_projects')
      .select('*, project_tags:portfolio_project_tags(tag_id)')
      .eq('id', id)
      .single(),
    supabase
      .from('portfolio_tags')
      .select('*')
      .order('sort_order', { ascending: true, nullsFirst: false }),
    supabase
      .from('landing_pages')
      .select('id, title, slug')
      .order('title', { ascending: true }),
  ]);

  if (projectError || !project) {
    notFound();
  }

  const selectedTagIds =
    project.project_tags
      ?.map((tag: { tag_id: string }) => tag.tag_id)
      .filter(Boolean) ?? [];

  return (
    <div className="space-y-6">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Trabalhos
        </p>
        <h1 className="text-3xl font-semibold">Editar projeto</h1>
      </div>
      <ProjectForm
        project={project}
        tags={tags ?? []}
        landingPages={landingPages ?? []}
        selectedTagIds={selectedTagIds}
      />
    </div>
  );
}
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
export const fetchCache = 'force-no-store';

import Link from 'next/link';
import Image from 'next/image'; // Added import for next/image
import { createClient } from '@/lib/supabase/server';
import { togglePublish } from '@/lib/supabase/queries/projects';
import { ADMIN_NAVIGATION } from '@/config/admin-navigation';

type Props = {
  searchParams: Promise<{
    tag?: string;
    year?: string;
    type?: string;
    status?: 'published' | 'draft';
    search?: string;
  }>;
};

export default async function TrabalhosPage(props: Props) {
  const searchParams = await props.searchParams;

  const supabase = await createClient();

  const resolvedSearchParams = searchParams || {};

  // filtros básicos
  const tagFilter = resolvedSearchParams.tag;
  const yearFilter = resolvedSearchParams.year
    ? Number(resolvedSearchParams.year)
    : undefined;
  const typeFilter = resolvedSearchParams.type;
  const statusFilter = resolvedSearchParams.status;
  const search = resolvedSearchParams.search;

  let query = supabase
    .from('portfolio_projects')
    .select(
      'id, title, client_name, year, featured_on_home, featured_home_order, featured_on_portfolio, featured_portfolio_order, is_published, thumbnail_path, project_type, slug, tags:portfolio_project_tags(tag:portfolio_tags(label, slug)), landing_page:landing_pages(slug)'
    )
    .order('updated_at', { ascending: false });

  if (tagFilter) query = query.eq('tags.tag.slug', tagFilter);
  if (yearFilter) query = query.eq('year', yearFilter);
  if (typeFilter) query = query.eq('project_type', typeFilter);
  if (statusFilter === 'published') query = query.eq('is_published', true);
  if (statusFilter === 'draft') query = query.eq('is_published', false);
  if (search)
    query = query.or(`title.ilike.%${search}%,client_name.ilike.%${search}%`);

  const [{ data: projects }, { data: tags }] = await Promise.all([
    query,
    supabase
      .from('portfolio_tags')
      .select('id, label, slug')
      .order('sort_order', { ascending: true, nullsFirst: false }),
  ]);

  const uniqueYears = Array.from(
    new Set((projects ?? []).map((p) => p.year).filter(Boolean))
  ).sort((a, b) => (b ?? 0) - (a ?? 0));
  const uniqueTypes = Array.from(
    new Set((projects ?? []).map((p) => p.project_type).filter(Boolean))
  );

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between gap-3">
        <div>
          <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
            Trabalhos
          </p>
          <h1 className="text-3xl font-semibold">Portfólio</h1>
        </div>
        <Link
          href={ADMIN_NAVIGATION.trabalhos.new}
          className="rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-blue-600"
        >
          Novo trabalho
        </Link>
      </div>

      <Filters
        tags={tags ?? []}
        years={uniqueYears as number[]}
        types={uniqueTypes as string[]}
        current={{
          tag: tagFilter,
          year: yearFilter,
          type: typeFilter,
          status: statusFilter,
          search,
        }}
      />

      <div className="overflow-x-auto rounded-xl border border-white/10 bg-slate-900/60">
        <table className="min-w-full text-sm">
          <thead>
            <tr className="text-left text-slate-400">
              <th className="px-4 py-3">Título</th>
              <th className="px-4 py-3">Cliente</th>
              <th className="px-4 py-3">Ano</th>
              <th className="px-4 py-3">Tipo</th>
              <th className="px-4 py-3">Tags</th>
              <th className="px-4 py-3">Flags</th>
              <th className="px-4 py-3">Destaques</th>
              <th className="px-4 py-3">Status</th>
              <th className="px-4 py-3 text-right">Ações</th>
            </tr>
          </thead>
          <tbody>
            {projects?.map((project) => (
              <tr key={project.id} className="border-t border-white/5">
                <td className="px-4 py-3 font-medium text-white">
                  <div className="flex items-center gap-3">
                    {project.thumbnail_path && (
                      <Image
                        src={`${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/portfolio-media/${project.thumbnail_path}`}
                        alt={project.title}
                        width={64} // Assuming width of 16 * 4 = 64px at 1x scale
                        height={40} // Assuming height of 10 * 4 = 40px at 1x scale
                        className="h-10 w-16 rounded object-cover border border-white/10"
                      />
                    )}
                    <span>{project.title}</span>
                  </div>
                </td>
                <td className="px-4 py-3 text-slate-300">
                  {project.client_name}
                </td>
                <td className="px-4 py-3 text-slate-300">
                  {project.year ?? '—'}
                </td>
                <td className="px-4 py-3 text-slate-300">
                  {project.project_type}
                </td>
                <td className="px-4 py-3 text-slate-300">
                  <div className="flex flex-wrap gap-1 text-[11px]">
                    {project.tags?.map(
                      (t: {
                        tag:
                          | { label: string; slug: string }
                          | Array<{ label: string; slug: string }>;
                      }) => {
                        const tag = Array.isArray(t.tag) ? t.tag[0] : t.tag;
                        if (!tag) return null;
                        return (
                          <span
                            key={tag.slug}
                            className="px-2 py-1 rounded bg-white/10"
                          >
                            {tag.label}
                          </span>
                        );
                      }
                    )}
                  </div>
                </td>
                <td className="px-4 py-3 text-slate-300">
                  <div className="flex gap-2 text-xs">
                    {project.featured_on_home && (
                      <span className="px-2 py-1 rounded bg-white/10">
                        Home
                      </span>
                    )}
                    {project.featured_on_portfolio && (
                      <span className="px-2 py-1 rounded bg-white/10">
                        Portfólio
                      </span>
                    )}
                  </div>
                </td>
                <td className="px-4 py-3 text-slate-300">
                  <div className="flex flex-col gap-1 text-xs">
                    <div className="flex items-center gap-2">
                      <span className="text-slate-400">Home:</span>
                      {project.featured_on_home ? (
                        <span className="rounded bg-blue-500/15 px-2 py-1 text-blue-100">
                          #{project.featured_home_order ?? '—'}
                        </span>
                      ) : (
                        <span className="text-slate-500">—</span>
                      )}
                    </div>
                    <div className="flex items-center gap-2">
                      <span className="text-slate-400">Portfólio:</span>
                      {project.featured_on_portfolio ? (
                        <span className="rounded bg-emerald-500/15 px-2 py-1 text-emerald-100">
                          #{project.featured_portfolio_order ?? '—'}
                        </span>
                      ) : (
                        <span className="text-slate-500">—</span>
                      )}
                    </div>
                  </div>
                </td>
                <td className="px-4 py-3 text-slate-300">
                  <form action={togglePublish}>
                    <input type="hidden" name="id" value={project.id} />
                    <input
                      type="hidden"
                      name="nextStatus"
                      value={project.is_published ? 'false' : 'true'}
                    />
                    <button
                      type="submit"
                      className={`rounded px-2 py-1 text-xs font-semibold ${
                        project.is_published
                          ? 'bg-green-500/20 text-green-300 border border-green-500/30'
                          : 'bg-slate-700 text-slate-200 border border-white/10'
                      }`}
                    >
                      {project.is_published ? 'Publicado' : 'Rascunho'}
                    </button>
                  </form>
                </td>
                <td className="px-4 py-3 text-right">
                  <Link
                    href={ADMIN_NAVIGATION.trabalhos.detail(project.id)}
                    className="text-blue-300 hover:text-blue-200 text-sm"
                  >
                    Editar
                  </Link>
                </td>
              </tr>
            ))}
            {!projects?.length && (
              <tr>
                <td
                  className="px-4 py-6 text-center text-slate-400"
                  colSpan={9}
                >
                  Nenhum projeto encontrado.
                </td>
              </tr>
            )}
          </tbody>
        </table>
      </div>
    </div>
  );
}

function Filters({
  tags,
  years,
  types,
  current,
}: {
  tags: Array<{ id: string; label: string; slug: string }>;
  years: number[];
  types: string[];
  current: {
    tag?: string;
    year?: number;
    type?: string;
    status?: string;
    search?: string;
  };
}) {
  return (
    <form className="grid gap-3 md:grid-cols-5" method="get">
      <input
        name="search"
        placeholder="Buscar por título ou cliente"
        defaultValue={current.search}
        className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm md:col-span-2"
      />
      <select
        name="tag"
        title="Filtrar por Tag"
        defaultValue={current.tag || ''}
        className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
      >
        <option value="">Todas as tags</option>
        {tags.map((tag) => (
          <option key={tag.id} value={tag.slug}>
            {tag.label}
          </option>
        ))}
      </select>
      <select
        name="year"
        title="Filtrar por Ano"
        defaultValue={current.year || ''}
        className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
      >
        <option value="">Todos os anos</option>
        {years.map((year) => (
          <option key={year} value={year}>
            {year}
          </option>
        ))}
      </select>
      <select
        name="type"
        title="Filtrar por Tipo"
        defaultValue={current.type || ''}
        className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
      >
        <option value="">Todos os tipos</option>
        {types.map((type) => (
          <option key={type} value={type}>
            {type}
          </option>
        ))}
      </select>
      <select
        name="status"
        title="Filtrar por Status"
        defaultValue={current.status || ''}
        className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
      >
        <option value="">Todos</option>
        <option value="published">Publicado</option>
        <option value="draft">Rascunho</option>
      </select>
      <div className="flex gap-3 md:col-span-5">
        <button
          type="submit"
          className="rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-blue-600"
        >
          Filtrar
        </button>
        <Link
          href={ADMIN_NAVIGATION.trabalhos.index}
          className="rounded-md border border-white/10 px-4 py-2 text-sm font-semibold text-white hover:bg-white/10"
        >
          Limpar
        </Link>
      </div>
    </form>
  );
}
import type { Metadata } from 'next';
import type { ReactNode } from 'react';
import Link from 'next/link';

export const metadata: Metadata = {
  robots: {
    index: false,
    follow: false,
    nocache: true,
    googleBot: {
      index: false,
      follow: false,
    },
  },
};

export default function AuthLayout({ children }: { children: ReactNode }) {
  return (
    <div className="min-h-screen bg-slate-950 text-white flex items-center justify-center px-4">
      <div className="w-full max-w-md rounded-2xl border border-white/10 bg-slate-900/60 p-8 shadow-2xl">
        <div className="mb-6">
          <Link
            href="/"
            className="text-sm text-slate-400 hover:text-white transition-colors"
          >
            ← Voltar ao site
          </Link>
        </div>
        {children}
      </div>
    </div>
  );
}
// Client component for login
'use client';

import { Suspense } from 'react';
import LoginForm from '@/components/admin/LoginForm';

export default function LoginPage() {
  return (
    <Suspense
      fallback={
        <div className="space-y-6">
          <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
            Admin
          </p>
          <h1 className="text-2xl font-semibold mt-2">Carregando...</h1>
        </div>
      }
    >
      <LoginForm />
    </Suspense>
  );
}
import { createClient } from '@/lib/supabase/server';
import { Suspense } from 'react';

async function InstrumentsData() {
  const supabase = await createClient();
  const { data: instruments } = await supabase.from('instruments').select();

  return <pre>{JSON.stringify(instruments, null, 2)}</pre>;
}

export default function Instruments() {
  return (
    <Suspense fallback={<div>Loading instruments...</div>}>
      <InstrumentsData />
    </Suspense>
  );
}
import type { MetadataRoute } from 'next';
import { HOME_CONTENT } from '@/config/content';
import { BRAND } from '@/config/brand';
import { createStaticClient } from '@/lib/supabase/static';
import { listProjects } from '@/lib/supabase/queries/projects';

export const dynamic = 'force-static';

export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  const baseUrl = `https://${BRAND.domain}`;
  let projectUrls: MetadataRoute.Sitemap = [];

  try {
    const supabase = createStaticClient();
    const dbProjects = await listProjects({}, supabase);

    projectUrls = dbProjects.map((project) => ({
      url: `${baseUrl}/portfolio/${project.slug}`,
      lastModified: new Date(project.updated_at || new Date()),
      changeFrequency: 'monthly',
      priority: 0.7,
    }));
  } catch (error) {
    console.warn(
      'Sitemap: Error fetching projects from Supabase, using fallback.',
      error
    );

    projectUrls = HOME_CONTENT.featuredProjects.map((project) => ({
      url: `${baseUrl}/portfolio/${project.slug}`,
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.7,
    }));
  }

  return [
    {
      url: baseUrl,
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    {
      url: `${baseUrl}/portfolio`,
      lastModified: new Date(),
      changeFrequency: 'weekly',
      priority: 0.9,
    },
    {
      url: `${baseUrl}/sobre`,
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.8,
    },
    ...projectUrls,
  ];
}
import { createClient } from '@/utils/supabase/server';
import { cookies } from 'next/headers';

export default async function Page() {
  const cookieStore = await cookies();
  const supabase = await createClient(cookieStore);

  const { data: todos, error } = await supabase.from('todos').select('*');

  if (error) {
    throw error;
  }

  return (
    <ul>
      {todos?.map((todo, index) => (
        <li key={(todo as { id?: string })?.id ?? index}>
          {JSON.stringify(todo)}
        </li>
      ))}
    </ul>
  );
}
import type { Metadata, Viewport } from 'next';
import '@/lib/polyfills';
import { siteMetadata, siteViewport } from '@/config/metadata';
import JsonLd from '@/components/ui/JsonLd';
import './globals.css'; // Fonts and styles are loaded here
import type { CSSProperties } from 'react';
import { BRAND } from '@/config/brand';
import AssetLoaderWrapper from '@/components/layout/AssetLoaderWrapper';
import SmoothScroll from '@/components/layout/SmoothScroll';

export const metadata: Metadata = siteMetadata;
export const viewport: Viewport = siteViewport;

// Define a function to safely get environment variables
function getSupabaseBaseUrl(): string {
  return process.env.NEXT_PUBLIC_SUPABASE_URL?.replace(/\/$/, '') ?? '';
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const cssVars: Record<string, string> = {};
  const setVar = (name: string, value?: string) => {
    if (value) cssVars[name] = value;
  };

  const supabaseBaseUrl = getSupabaseBaseUrl();
  setVar('--supabase-url', supabaseBaseUrl);

  // Use default values from BRAND config for initial render
  setVar('--logo-light-url', BRAND.assets.logos.logoLight);
  setVar('--logo-dark-url', BRAND.assets.logos.logoDark);
  setVar('--favicon-light-url', BRAND.assets.logos.favicon);
  setVar('--favicon-dark-url', BRAND.assets.logos.favicon);

  const inlineStyle = cssVars as CSSProperties;
  const jsonLdLogoUrl = BRAND.assets.logos.logoLight;

  return (
    <html lang="pt-BR" data-scroll-behavior="smooth" suppressHydrationWarning>
      <head>
        <JsonLd logoUrl={jsonLdLogoUrl} />
      </head>
      <body
        className="antialiased bg-background text-text pb-0 lg:pb-[64px] overflow-x-hidden"
        style={inlineStyle}
      >
        <a
          href="#main-content"
          className="sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-50 focus:bg-white focus:text-black focus:px-4 focus:py-2 focus:rounded-md"
        >
          Pular para o conteúdo
        </a>
        <SmoothScroll>
          <AssetLoaderWrapper>{children}</AssetLoaderWrapper>
        </SmoothScroll>
      </body>
    </html>
  );
}
'use client';

import { useCallback, useState } from 'react';
import type { PortfolioProject } from '@/types/project';
import PortfolioHeroNew from '@/components/portfolio/PortfolioHeroNew';
import PortfolioShowcaseSection from '@/components/portfolio/PortfolioShowcaseSection';
import PortfolioModalNew from '@/components/portfolio/PortfolioModalNew';
import { SiteClosure } from '@/components/layout/SiteClosure';
import type { FC } from 'react';

type ShowcaseProps = {
  projects: PortfolioProject[];
  onProjectSelect: (_project: PortfolioProject) => void;
};

// Workaround: ensure TS understands the imported symbol is a React component with props
const Showcase = PortfolioShowcaseSection as unknown as FC<ShowcaseProps>;

type PortfolioClientProps = {
  projects: PortfolioProject[];
};

export default function PortfolioClient({ projects }: PortfolioClientProps) {
  const [selectedProject, setSelectedProject] = useState<PortfolioProject | null>(null);
  const [isModalOpen, setIsModalOpen] = useState(false);

  // Handler para abrir o projeto
  const handleOpenProject = useCallback((project: PortfolioProject) => {
    setSelectedProject(project);
    setIsModalOpen(true);
  }, []);

  // Handler para fechar o modal
  const handleCloseModal = useCallback(() => {
    setIsModalOpen(false);
    // Limpa o projeto após a animação de saída (400ms matching transition)
    setTimeout(() => {
      setSelectedProject(null);
    }, 400);
  }, []);

  return (
    <div className="min-h-screen bg-background text-text">
      {/* Hero com video loop */}
      <PortfolioHeroNew />

      {/* Nova Seção de Cards com Animações de Overlay */}
      <Showcase projects={projects} onProjectSelect={handleOpenProject} />

      {/* Modal de Detalhes (Ghost) */}
      <PortfolioModalNew
        project={selectedProject}
        isOpen={isModalOpen}
        onClose={handleCloseModal}
      />

      {/* Global Closure (Footer Area) */}
      <SiteClosure />
    </div>
  );
}
import type { Metadata } from 'next';
import PortfolioClient from './PortfolioClient';
import { listProjects } from '@/lib/supabase/queries/projects';
import { mapDbProjectToPortfolioProject } from '@/lib/portfolio/project-mappers';
import { createStaticClient } from '@/lib/supabase/static';
import { HOME_CONTENT } from '@/config/content';
import type { PortfolioProject, ProjectCategory } from '@/types/project';

export const revalidate = 60;

export const metadata: Metadata = {
  title: 'Portfólio',
  description:
    'Explore uma seleção curada de projetos de Branding, Motion Design e Creative Development.',
};

const FALLBACK_CATEGORY_MAP: Record<string, ProjectCategory> = {
  'branding & campanha': 'branding',
  branding: 'branding',
  campanha: 'campanha',
  'web & motion': 'web',
  'web & digital': 'web',
  'motion & video': 'motion',
  'video & motion': 'motion',
  'motion': 'motion',
  'videos & motions': 'motion',
};

function mapFallbackCategory(label?: string): ProjectCategory {
  if (!label) return 'branding';
  const normalized = label.trim().toLowerCase();
  return FALLBACK_CATEGORY_MAP[normalized] ?? 'branding';
}

function buildFallbackProjects(): PortfolioProject[] {
  return (HOME_CONTENT.featuredProjects ?? []).map((project, index) => {
    const layout =
      (project.layout as {
        h?: string;
        cols?: string;
        sizes?: string;
        aspect?: string;
        aspectRatio?: string;
      }) ?? {};
    const category = mapFallbackCategory(project.category);

    return {
      id: `fallback-${project.id ?? index}`,
      slug: project.slug ?? `fallback-${index}`,
      title: project.title ?? 'Projeto de portfólio',
      subtitle: project.category,
      client: project.client ?? 'Cliente confidencial',
      category,
      displayCategory: project.category ?? 'Projeto',
      tags: project.tags ?? [],
      year:
        typeof project.year === 'number'
          ? project.year
          : Number(project.year) || new Date().getFullYear(),
      image: project.img || '',
      type: index < 4 ? 'A' : 'B',
      layout: {
        cols: layout.cols ?? 'md:col-span-4',
        height: layout.h ?? 'min-h-[320px]',
        aspectRatio: layout.aspect ?? layout.aspectRatio,
        sizes: layout.sizes,
      },
      detail: {
        description: project.title ?? 'Projeto de portfólio',
        highlights: project.tags,
      },
      accentColor:
        category === 'branding'
          ? '#0057ff'
          : category === 'campanha'
            ? '#ff3366'
            : undefined,
      featuredOnPortfolio: true,
    };
  });
}

export default async function PortfolioPage() {
  let projects: PortfolioProject[] = [];

  try {
    const fallbackProjects = buildFallbackProjects();
    const hasSupabaseEnv =
      Boolean(process.env.NEXT_PUBLIC_SUPABASE_URL) &&
      Boolean(
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ??
          process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY
      );

    if (hasSupabaseEnv) {
      const supabase = createStaticClient();
      
      const dbProjects = await listProjects({}, supabase);
      projects = dbProjects.map((project, index) =>
        mapDbProjectToPortfolioProject(project, index)
      );

      // If the database is empty (common in local dev/CI), fall back to curated static projects
      if (projects.length === 0) {
        console.warn('[Portfolio] No projects returned from Supabase, using fallback projects.');
        projects = fallbackProjects;
      }
    } else {
      console.warn('[Portfolio] Supabase env vars missing, using fallback projects.');
      projects = fallbackProjects;
    }
  } catch (error) {
    console.error('[Portfolio] Error occurred:', error instanceof Error ? error.message : error);
    projects = buildFallbackProjects();
  }

  return <PortfolioClient projects={projects} />;
}
import { notFound } from 'next/navigation';
import Image from 'next/image';
import { HOME_CONTENT } from '@/config/content';
import { ArrowLeft } from 'lucide-react';
import Link from 'next/link';
import { SiteClosure } from '@/components/layout/SiteClosure';
import { siteMetadata } from '@/config/metadata';
import type { Metadata } from 'next';
import { createStaticClient } from '@/lib/supabase/static';
import { listProjects } from '@/lib/supabase/queries/projects';
import {
  mapDbProjectToPortfolioProject,
  mapStaticProjectToPortfolioProject,
} from '@/lib/portfolio/project-mappers';
import type { PortfolioProject } from '@/types/project';
import { isVideo } from '@/utils/utils';

async function getProject(slug: string): Promise<PortfolioProject | undefined> {
  // Try database first
  try {
    const supabase = createStaticClient();
    const dbProjects = await listProjects({}, supabase);
    const dbProject = dbProjects.find((p) => p.slug === slug);

    if (dbProject) {
      // Find its index for layout mapping
      const index = dbProjects.findIndex((p) => p.slug === slug);
      return mapDbProjectToPortfolioProject(dbProject, index);
    }
  } catch (error) {
    console.warn(`Error fetching project ${slug} from DB:`, error);
  }



  // Fallback to static content
  const staticProject = HOME_CONTENT.featuredProjects.find(
    (p) => p.slug === slug
  );
  if (staticProject) {
    const index = HOME_CONTENT.featuredProjects.findIndex(
      (p) => p.slug === slug
    );
    return mapStaticProjectToPortfolioProject(staticProject, index);
  }

  return undefined;
}

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { slug } = await params;
  const project = await getProject(slug);

  if (!project) return siteMetadata;

  return {
    title: project.title,
    description: `Case study: ${project.title} for ${project.client}. Category: ${project.displayCategory}.`,
    openGraph: {
      title: project.title,
      description: `Case study: ${project.title} for ${project.client}. Category: ${project.displayCategory}.`,
      images: [project.image || ''],
    },
  };
}

export async function generateStaticParams() {
  const hasSupabaseEnv =
    Boolean(process.env.NEXT_PUBLIC_SUPABASE_URL) &&
    Boolean(process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);

  const staticSlugs = HOME_CONTENT.featuredProjects.map((p) => ({
    slug: p.slug,
  }));

  if (hasSupabaseEnv) {
    try {
      const supabase = createStaticClient();
      const dbProjects = await listProjects({}, supabase);
      const dbSlugs = dbProjects.map((p) => ({ slug: p.slug }));

      const allSlugs = [...dbSlugs, ...staticSlugs];
      const uniqueSlugs = Array.from(new Set(allSlugs.map((s) => s.slug))).map(
        (slug) => ({ slug })
      );
      return uniqueSlugs;
    } catch (error) {
      console.error('Error fetching projects for static params:', error);
    }
  }

  return staticSlugs;
}

type Props = {
  params: Promise<{ slug: string }>;
};

export default async function ProjectPage({ params }: Props) {
  const { slug } = await params;
  const project = await getProject(slug);

  if (!project) {
    notFound();
  }

  return (
    <div className="min-h-screen bg-background text-foreground selection:bg-primary selection:text-white">
      <nav className="fixed top-0 left-0 w-full z-50 px-6 py-6 md:px-12 md:py-8 mix-blend-difference">
        <Link
          href="/portfolio"
          className="inline-flex items-center gap-2 text-sm font-medium uppercase tracking-widest hover:text-primary transition-colors"
        >
          <ArrowLeft className="w-4 h-4" />
          Back to Portfolio
        </Link>
      </nav>

      <section className="relative pt-32 pb-16 px-6 md:px-12 max-w-[1800px] mx-auto">
        <div className="flex flex-col gap-6 mb-12 md:mb-20">
          <div className="flex flex-col md:flex-row md:items-end md:justify-between gap-6">
            <h1 className="text-4xl md:text-6xl lg:text-7xl font-bold font-display tracking-tight leading-[0.9]">
              {project.title}
            </h1>
            <div className="flex flex-col gap-1 text-right md:text-right">
              <span className="text-xs font-bold tracking-widest uppercase text-text-muted">
                Client
              </span>
              <span className="text-lg md:text-xl font-medium">
                {project.client}
              </span>
            </div>
          </div>

          <div className="flex gap-4 md:gap-8 border-t border-white/10 pt-6 mt-6">
            <div>
              <span className="block text-xs font-bold tracking-widest uppercase text-text-muted mb-1">
                Category
              </span>
              <span className="text-base uppercase tracking-wide">
                {project.displayCategory}
              </span>
            </div>
            <div>
              <span className="block text-xs font-bold tracking-widest uppercase text-text-muted mb-1">
                Year
              </span>
              <span className="text-base uppercase tracking-wide">
                {project.year}
              </span>
            </div>
          </div>
        </div>

        <div className="relative w-full aspect-video md:aspect-[2.4/1] rounded-2xl md:rounded-4xl overflow-hidden bg-muted shadow-2xl">
          {isVideo(project.image) ? (
            <video
              src={project.image}
              autoPlay
              muted
              loop
              playsInline
              className="absolute inset-0 w-full h-full object-cover"
            />
          ) : (
            <Image
              src={project.image}
              alt={project.title}
              fill
              className="object-cover"
              priority
              sizes="(max-width: 768px) 100vw, 90vw"
            />
          )}
        </div>
      </section>

      <section className="px-6 md:px-12 pb-32 max-w-4xl mx-auto">
        <div className="prose prose-invert prose-lg md:prose-xl mx-auto">
          <h2 className="text-2xl md:text-3xl font-bold mb-6">
            About the Project
          </h2>
          <p className="text-muted-foreground leading-relaxed">
            This is a showcase page for <strong>{project.title}</strong>.
            Detailed case study content, process documentation, and final
            deliverables would typically appear here.
          </p>
          <p className="text-muted-foreground leading-relaxed mt-4">
            The project focuses on {project.displayCategory} solutions for{' '}
            {project.client}, delivered in {project.year}.
          </p>
        </div>
      </section>

      <SiteClosure />
    </div>
  );
}
import FloatingCards from '@/components/ui/FloatingCards';
import { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'Floating Cards Prototype | Danilo Novais',
  description: 'Interactive 3D floating cards grid using GSAP and Next.js.',
};

export default function FloatingCardsPage() {
  return (
    <main className="min-h-screen bg-[#0f0f23]">
      {/* Header Spacer */}
      <div className="h-32 w-full" />

      <div className="container mx-auto px-6 py-12 text-center">
        <h1 className="text-display-hero mb-4 text-white">
          Visual Experiments
        </h1>
        <p className="text-h3 text-gray-400">
          GSAP + ScrollTrigger + 3D Physics
        </p>
      </div>

      <FloatingCards />

      {/* Footer Spacer */}
      <div className="h-64 w-full bg-linear-to-t from-black to-transparent" />
    </main>
  );
}
import { createClient } from '@supabase/supabase-js';
import { NextResponse } from 'next/server';
import { normalizeAssetList } from '@/lib/supabase/site-asset-utils';
import type { DbAsset } from '@/types/admin';

export const dynamic = 'force-static';
export const revalidate = 3600; // Revalidate every hour

export async function GET() {
  const supabaseUrl =
    process.env.NEXT_PUBLIC_SUPABASE_URL ?? process.env.SUPABASE_URL;
  const supabaseKey =
    process.env.SUPABASE_SERVICE_ROLE_KEY ?? process.env.SUPABASE_SERVICE_KEY;

  if (!supabaseUrl || !supabaseKey) {
    return NextResponse.json(
      { error: 'Missing Supabase credentials' },
      { status: 500 }
    );
  }

  const supabase = createClient(supabaseUrl, supabaseKey, {
    auth: { persistSession: false },
  });

  const { data, error } = await supabase
    .from('site_assets')
    .select('*')
    .order('page', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  if (error) {
    console.error('Supabase error:', error);
    return NextResponse.json({ error: error.message }, { status: 500 });
  }

  const assets = normalizeAssetList((data ?? []) as DbAsset[], {
    onlyActive: true,
  });

  return NextResponse.json(assets, { status: 200 });
}
import type { Metadata } from 'next';

import { SiteClosure } from '@/components/layout/SiteClosure';
import FeaturedProjectsSection from '@/components/home/featured-projects/FeaturedProjectsSection';
import HomeHero from '@/components/home/hero/HomeHero';
import PortfolioShowcase from '@/components/home/portfolio-showcase/PortfolioShowcase';
import { VideoManifesto } from '@/components/home/hero/VideoManifesto';
import { BRAND } from '@/config/brand';
import { listProjects } from '@/lib/supabase/queries/projects';
import { mapDbProjectToPortfolioProject } from '@/lib/portfolio/project-mappers';
import { createStaticClient } from '@/lib/supabase/static';
import type { PortfolioProject } from '@/types/project';
// Removed unused AntigravityDebugger import

export const metadata: Metadata = {
  title: 'Danilo Novais | Creative Developer',
  description:
    'Você não vê o design. Mas ele vê você. Portfólio de Danilo Novais - Creative Developer especializado em WebGL, R3F, Next.js e experiências digitais interativas.',
  keywords: [
    'Danilo Novais',
    'Creative Developer',
    'WebGL',
    'R3F',
    'React Three Fiber',
    'Next.js',
    'Creative Development',
    'Brazil',
    'Portfolio',
    'Interactive Design',
  ],
};

export default async function HomePage() {
  let featuredProjects: PortfolioProject[] = [];
  try {
    const supabase = createStaticClient();
    const dbProjects = await listProjects({ featuredOnHome: true }, supabase);
    featuredProjects = dbProjects.map((project, index) =>
      mapDbProjectToPortfolioProject(project, index)
    );
  } catch (error) {
    console.error('Error fetching projects:', error);
    // Fallback ou array vazio para evitar crash
  }

  return (
    <>
      <HomeHero />
      <VideoManifesto src={BRAND.assets.video.manifesto} />
      <PortfolioShowcase />
      <FeaturedProjectsSection projects={featuredProjects} />
      <SiteClosure />
    </>
  );
}
@import 'tailwindcss';
@import '../styles/globals.css';

/* Force rebuild */
'use client';

import { useEffect } from 'react';
import Link from 'next/link';

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    console.error('Global error:', error);
  }, [error]);

  return (
    <html>
      <body className="bg-background text-foreground">
        <div className="flex min-h-screen flex-col items-center justify-center p-4">
          <h2 className="mb-4 text-2xl font-bold text-destructive">
            Ops! Algo deu errado.
          </h2>
          <p className="mb-4 text-muted-foreground">
            {error.message || 'Ocorreu um erro na aplicação.'}
          </p>

          <div className="flex gap-4">
            <button
              onClick={() => reset()}
              className="rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600"
            >
              Tentar novamente
            </button>

            {/* Use Link instead of <a> tag */}
            <Link
              href="/"
              className="rounded bg-secondary px-4 py-2 text-white hover:bg-secondary/80"
            >
              Voltar para Home
            </Link>
          </div>
        </div>
      </body>
    </html>
  );
}
'use client';

import React from 'react';
import Link from 'next/link';

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset?: () => void;
}) {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center bg-[#070714] text-white">
      <div className="max-w-xl text-center space-y-4 px-4">
        <p className="font-mono text-sm text-[#94a3b8]">
          Something unexpected happened.
        </p>
        <h1 className="text-4xl font-bold">We hit an error.</h1>
        <p className="text-base leading-relaxed text-[#cbd5f5]">
          {error.message}
        </p>
        <div className="flex flex-wrap justify-center gap-3">
          <Link
            href="/"
            className="rounded-full bg-white px-6 py-3 text-sm font-semibold text-[#070714] transition hover:bg-blue-200"
          >
            Go back home
          </Link>
          {reset && (
            <button
              type="button"
              onClick={reset}
              className="rounded-full border border-white/50 px-6 py-3 text-sm font-semibold text-white transition hover:border-white"
            >
              Try again
            </button>
          )}
        </div>
      </div>
    </main>
  );
}
'use client';

import { useEffect, useRef } from 'react';

export default function NotFound() {
  const iframeRef = useRef<HTMLIFrameElement>(null);

  useEffect(() => {
    if (iframeRef.current) {
      iframeRef.current.src = '/404.html';
    }
  }, []);

  return (
    <div style={{ width: '100%', height: '100vh', overflow: 'hidden' }}>
      <iframe
        ref={iframeRef}
        style={{
          width: '100%',
          height: '100%',
          border: 'none',
        }}
        title="404 Not Found"
      />
    </div>
  );
}
'use client';

import { motion } from 'framer-motion';
import { usePathname } from 'next/navigation';
import { useEffect } from 'react';
import { GHOST_EASE } from '@/config/motion';

/**
 * Ghost Era Page Template
 * Handles entry transitions for all pages.
 * Rules:
 * - Fade in (opacity 0 -> 1)
 * - Horizontal/Vertical Blur (12px -> 0px)
 * - Subtle slide up (y: 20 -> 0)
 * - Easing: cubic-bezier(0.22, 1, 0.36, 1)
 */
export default function Template({ children }: { children: React.ReactNode }) {
  const pathname = usePathname();

  useEffect(() => {
    // Reset scroll to top on path change (Lenis handles smooth, but we make sure)
    window.scrollTo(0, 0);
  }, [pathname]);

  return (
    <motion.div
      key={pathname}
      initial={{ opacity: 0, y: 15 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{
        duration: 0.95, // Mantido próximo do padrão para transições de página
        ease: GHOST_EASE,
      }}
      className="w-full flex-col flex grow"
    >
      {children}
    </motion.div>
  );
}
export type SiteAssetDefinition = {
  key: string;
  label: string;
  description?: string;
  page: string;
  category: 'logo' | 'font' | 'video' | 'image' | 'client' | 'misc';
};

export const SITE_ASSET_KEYS = {
  logos: {
    headerLight: 'global.logo_header_light',
    headerDark: 'global.logo_header_dark',
    faviconLight: 'global.favicon_light',
    faviconDark: 'global.favicon_dark',
  },
  fonts: {
    display: 'global.font_display',
    h1: 'global.font_h1',
    h2: 'global.font_h2',
    h3: 'global.font_h3',
    body: 'global.font_body',
    light: 'global.font_light',
  },
  heroVideos: {
    homeManifesto: 'home.manifesto_video',
    aboutDesktop: 'about.hero.about.hero.desktop_video.mp4',
    aboutMobile: 'about.hero.about.hero.mobile_video.mp4',
    portfolioDesktop: 'portfolio.hero_desktop_video',
    portfolioMobile: 'portfolio.hero_mobile_video',
    method: 'about.method_video',
  },
  about: {
    originImages: [
      'about.origin_image.1',
      'about.origin_image.2',
      'about.origin_image.3',
      'about.origin_image.4',
    ],
    methodDesktop: 'about.method_video',
    methodMobile: 'about.method_video',
    beliefs: {
      ghostModel: 'about.beliefs.ghost-transformed.glb',
      skillsVideo: 'about.beliefs.VIDEO-SKILLS-FINAL_compressed.mp4',
      skillsVideoMobile: 'about.beliefs.VIDEO-SKILLS-MOBILE-FINAL.mp4',
    },
  },
  projects: {
    campaign: {
      cover: 'projects.campaign.cover.webp',
      hero: 'projects.campaign.hero.webp',
      thumb: 'projects.campaign.thumb.webp',
    },
    keyVision: {
      cover: 'projects.key-visual.cover.webp',
      hero: 'projects.key_vision.hero.webp',
      thumb: 'projects.key_vision.thumb.webp',
    },
    brandVideo: {
      hero: 'projects.brand_video.hero.png',
      thumb: 'projects.brand_video.thumb.mp4',
    },
    advertisingVideo: {
      hero: 'projects.advertising_video.hero.png',
      thumb: 'projects.advertising_video.thumb.png',
    },
    creativeDirection: {
      hero: 'projects.creative-direction.hero.webp',
      thumb: 'projects.creative-direction.thumb.webp',
    },
  },
  portfolio: {
    heroDesktop: 'portfolio.hero_video.desktop',
    heroMobile: 'portfolio.hero_video.mobile',
  },
  clients: {
    strips: Array.from({ length: 12 }, (_, i) => `clients.strip.${i + 1}`),
  },
} as const;

const fontDefinitions: SiteAssetDefinition[] = Object.entries(
  SITE_ASSET_KEYS.fonts
).map(([name, key]) => ({
  key,
  label: `Fonte ${name}`,
  page: 'global',
  category: 'font',
}));

const originImages: SiteAssetDefinition[] =
  SITE_ASSET_KEYS.about.originImages.map((key, index) => ({
    key,
    label: `Origem imagem ${index + 1}`,
    page: 'about',
    category: 'image',
  }));

const clientLogos: SiteAssetDefinition[] = SITE_ASSET_KEYS.clients.strips.map(
  (key, index) => ({
    key,
    label: `Logo cliente ${index + 1}`,
    page: 'clients',
    category: 'client',
  })
);

export const SITE_ASSET_DEFINITIONS: SiteAssetDefinition[] = [
  {
    key: SITE_ASSET_KEYS.logos.headerLight,
    label: 'Logo header claro',
    page: 'global',
    category: 'logo',
  },
  {
    key: SITE_ASSET_KEYS.logos.headerDark,
    label: 'Logo header escuro',
    page: 'global',
    category: 'logo',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconLight,
    label: 'Favicon claro',
    page: 'global',
    category: 'logo',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconDark,
    label: 'Favicon escuro',
    page: 'global',
    category: 'logo',
  },
  ...fontDefinitions,
  {
    key: SITE_ASSET_KEYS.heroVideos.homeManifesto,
    label: 'Vídeo manifesto',
    page: 'home',
    category: 'video',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutDesktop,
    label: 'Vídeo hero Sobre (desktop)',
    page: 'about',
    category: 'video',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutMobile,
    label: 'Vídeo hero Sobre (mobile)',
    page: 'about',
    category: 'video',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.method,
    label: 'Vídeo método',
    page: 'about',
    category: 'video',
  },
  ...originImages,
  {
    key: SITE_ASSET_KEYS.portfolio.heroDesktop,
    label: 'Vídeo hero Portfólio (desktop)',
    page: 'portfolio',
    category: 'video',
  },
  {
    key: SITE_ASSET_KEYS.portfolio.heroMobile,
    label: 'Vídeo hero Portfólio (mobile)',
    page: 'portfolio',
    category: 'video',
  },
  ...clientLogos,
];
{
  "bluePrimary": "#0048ff",
  "blueAccent": "#4fe6ff",
  "background": "#040013",
  "text": "#fcffff",
  "textSecondary": "#a1a3a3",
  "surface": "#0b0d3a",
  "error": "#ff3366",
  "fontDisplay": "clamp(2.5rem, 5vw + 1rem, 5.5rem)",
  "fontH1": "clamp(2rem, 4vw + 1rem, 3.5rem)",
  "fontBody": "clamp(1rem, 0.5vw + 0.8rem, 1.125rem)",
  "easing": "cubic-bezier(0.22, 1, 0.36, 1)"
}
// O projeto principal é o aymuvxysygrwoicsjgxj; usamos como fallback seguro
// para evitar perda de links quando as envs não estão presentes (ex.: build local).
const SUPABASE_PROJECT_URL =
  process.env.NEXT_PUBLIC_SUPABASE_URL ??
  process.env.SUPABASE_URL ??
  'https://umkmwbkwvulxtdodzmzf.supabase.co';

export const SUPABASE_STORAGE_URL = `${SUPABASE_PROJECT_URL.replace(
  /\/$/,
  ''
)}/storage/v1/object/public`;

const asset = (path: string) =>
  `${SUPABASE_STORAGE_URL}/${path.replace(/^\/+/, '')}`;

export const BRAND = {
  name: 'Danilo Novais',
  domain: 'portfoliodanilo.com',

  // Paleta de Cores (Design System 2.1)
  colors: {
    bluePrimary: '#0048ff', // CTAs, links, interativos
    blueAccent: '#4fe6ff', // Destaques secundários, brilhos
    purpleDetails: '#8705f2', // Pequenos detalhes
    pinkDetails: '#f501d3', // Ênfases pontuais

    background: '#040013', // Fundo escuro principal
    backgroundLight: '#f0f0f0', // Seções claras

    text: '#fcffff', // Texto principal (dark mode)
    textInverse: '#0e0e0e', // Texto em fundos claros
    textEmphasis: '#2E85F2', // Palavras destacadas
    textHighlight: '#4fe6ff', // Destaques curtos
    textSecondary: '#a1a3a3', // Infos secundárias

    neutral: '#0b0d3a', // Gradientes sutis
    neutralLight: '#F5F5F5', // Fundos secundários
    contactForeground: '#fcffff', // Texto e ícones da seção Contato
  },

  // Assets Globais (2.6 Global Assets)
  assets: {
    logos: {
      favicon: asset('site-assets/global/logos/global.favicon_dark.svg'),
      faviconLight: asset('site-assets/global/logos/global.favicon_light.svg'),
      logoLight: asset('site-assets/global/logos/global.logo_header_light.svg'),
      logoDark: asset('site-assets/global/logos/global.logo_header_dark.svg'),
    },
    video: {
      manifesto: asset('site-assets/home/home.manifesto_video.mp4'),
    },
    fonts: {
      primary: 'TT Norms Pro',
      mono: 'PPSupplyMono',
    },
  },
  video: {
    manifesto: asset('site-assets/home/home.manifesto_video.mp4'),
  },

  // Leis de Layout (Absolute Laws)
  layout: {
    mobile: {
      stacking: 'vertical', // Todas as sessões com cards devem empilhar um abaixo do outro
      alignment: 'center',
    },
  },
};
export const SOCIALS = {
  instagram: 'https://instagram.com/danilo_novais',
  facebook: 'https://facebook.com/danilonovaisvilela',
  linkedin: 'https://linkedin.com/in/danilonovais',
  twitter: 'https://twitter.com/danilo_novais',
  emailPrimary: 'mailto:danilo@portfoliodanilo.com',
  emailSecondary: 'mailto:dannovaisv@gmail.com',
  phone: '+55 11 98396-6838',
};

export const NAVIGATION = {
  header: [
    { label: 'home', href: '/' }, // ou #hero se estiver na home
    { label: 'sobre', href: '/sobre' },
    { label: 'portfólio', href: '/portfolio' },
    { label: 'contato', href: '#contact' }, // Always anchor
  ],
  footer: {
    copyright: '© 2025 Danilo Novais Vilela — todos os direitos reservados',
    links: [
      { label: 'home', href: '#hero' },
      { label: 'sobre', href: '/sobre' },
      { label: 'portfólio', href: '/portfolio' },
      { label: 'contato', href: '#contact' },
    ],
  },
};

export const CONTACT_FORM = {
  action: 'https://formsubmit.co/danilo@portfoliodanilo.com',
};
import type { Variants, Transition, SpringOptions } from 'framer-motion';

// =============================================================================
// MOTION TOKENS - Ghost Era Design System
// SINGLE SOURCE OF TRUTH for all animations
// =============================================================================

/** Ghost Easing Curve - A fluid, ethereal timing function */
type EasingTuple = [number, number, number, number];

export const GHOST_EASE: EasingTuple = [0.22, 1, 0.36, 1];
export const GHOST_EASE_SOFT: EasingTuple = [0.25, 1, 0.5, 1];
export const GHOST_EASE_HEAVY: EasingTuple = [0.43, 0.13, 0.23, 0.96];

export const MOTION_TOKENS = {
  // ─────────────────────────────────────────────────────────────────────────
  // DURATIONS
  // ─────────────────────────────────────────────────────────────────────────
  duration: {
    /** Atmospheric, slow reveals - 1.2s */
    slow: 1.2,
    /** Standard transitions - 0.8s */
    normal: 0.8,
    /** Quick interactions - 0.4s */
    fast: 0.4,
    /** Micro-interactions - 0.2s */
    instant: 0.2,
    /** Modal/overlay animations - 0.5s */
    modal: 0.5,
  },

  // ─────────────────────────────────────────────────────────────────────────
  // EASING CURVES
  // ─────────────────────────────────────────────────────────────────────────
  easing: {
    /** Base smooth curve - use for most animations */
    base: GHOST_EASE,
    /** Extra soft for atmospheric/ghostly effects */
    ghost: GHOST_EASE_SOFT,
    /** Heavier curve for large movements */
    heavy: GHOST_EASE_HEAVY,
    /** Linear for opacity-only transitions */
    linear: 'linear' as const,
  },

  // ─────────────────────────────────────────────────────────────────────────
  // STAGGER DELAYS
  // ─────────────────────────────────────────────────────────────────────────
  stagger: {
    /** Rapid fire - 0.05s */
    tight: 0.05,
    /** Standard stagger - 0.1s */
    normal: 0.1,
    /** Ghost-like slow reveal - 0.18s */
    relaxed: 0.18,
    /** Very slow, dramatic - 0.25s */
    dramatic: 0.25,
  },

  // ─────────────────────────────────────────────────────────────────────────
  // VIEWPORT REVEAL SETTINGS
  // ─────────────────────────────────────────────────────────────────────────
  reveal: {
    threshold: 0.1,
    margin: '-50px',
  },

  // ─────────────────────────────────────────────────────────────────────────
  // SPRING PHYSICS (Ghost-style: fluid, not bouncy)
  // ─────────────────────────────────────────────────────────────────────────
  spring: {
    /** Ultra-soft spring for parallax and scroll-linked animations */
    ghost: {
      stiffness: 50,
      damping: 20,
      restDelta: 0.001,
    } satisfies SpringOptions,
    /** Slightly more responsive spring */
    responsive: {
      stiffness: 100,
      damping: 25,
      restDelta: 0.001,
    } satisfies SpringOptions,
    /** Snappy but not bouncy - for buttons/interactive elements */
    snappy: {
      stiffness: 200,
      damping: 30,
      restDelta: 0.001,
    } satisfies SpringOptions,
  },

  // ─────────────────────────────────────────────────────────────────────────
  // Y-OFFSET LIMITS (Ghost Design: max 18px for subtle movements)
  // ─────────────────────────────────────────────────────────────────────────
  offset: {
    /** Minimal shift - 8px */
    subtle: 8,
    /** Standard entrance - 18px (max for Ghost) */
    standard: 18,
    /** Larger movements for special cases - 30px */
    large: 30,
    /** Hero/dramatic entrances - 40px (use sparingly) */
    dramatic: 40,
  },
} as const;

// =============================================================================
// REUSABLE VARIANTS
// =============================================================================

/**
 * Ghost Fade - Standard fade with blur
 * Use for: Text, titles, sections
 */
export const ghostFade: Variants = {
  hidden: {
    opacity: 0,
    filter: 'blur(10px)',
  },
  visible: {
    opacity: 1,
    filter: 'blur(0px)',
    transition: {
      duration: MOTION_TOKENS.duration.normal,
      ease: GHOST_EASE,
    },
  },
};

/**
 * Rise Soft - Subtle Y movement + fade + blur
 * Use for: Cards, list items, content blocks
 */
export const riseSoft: Variants = {
  hidden: {
    opacity: 0,
    y: MOTION_TOKENS.offset.standard,
    filter: 'blur(6px)',
  },
  visible: {
    opacity: 1,
    y: 0,
    filter: 'blur(0px)',
    transition: {
      duration: MOTION_TOKENS.duration.normal,
      ease: GHOST_EASE,
    },
  },
};

/**
 * Image Float - For media elements (max opacity 0.85)
 * Use for: Background images, decorative media
 */
export const imageFloat: Variants = {
  hidden: {
    opacity: 0,
    y: 20,
  },
  visible: {
    opacity: 0.85,
    y: 0,
    transition: {
      duration: MOTION_TOKENS.duration.slow,
      ease: GHOST_EASE,
    },
  },
};

/**
 * Stagger Container - Parent for staggered children
 * Use for: Lists, grids, card groups
 */
export const staggerContainer = (
  staggerDelay: number = MOTION_TOKENS.stagger.relaxed as number
): Variants => ({
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: staggerDelay,
      delayChildren: 0.2,
    },
  },
});

/**
 * Modal variants - Coordinated backdrop + content animations
 */
export const modalVariants = {
  backdrop: {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: { duration: MOTION_TOKENS.duration.fast, ease: 'easeOut' },
    },
    exit: {
      opacity: 0,
      transition: { duration: MOTION_TOKENS.duration.instant },
    },
  } satisfies Variants,

  content: {
    hidden: {
      opacity: 0,
      y: MOTION_TOKENS.offset.large,
    },
    visible: {
      opacity: 1,
      y: 0,
      transition: {
        duration: MOTION_TOKENS.duration.modal,
        ease: GHOST_EASE,
        delay: 0.1,
      },
    },
    exit: {
      opacity: 0,
      y: MOTION_TOKENS.offset.standard,
      transition: {
        duration: MOTION_TOKENS.duration.fast,
        ease: GHOST_EASE,
      },
    },
  } satisfies Variants,
};

// =============================================================================
// TRANSITION HELPERS
// =============================================================================

/**
 * Create a ghost-style transition
 */
export const ghostTransition = (
  delay: number = 0,
  dur: number = MOTION_TOKENS.duration.normal as number
): Transition => ({
  duration: dur,
  delay,
  ease: GHOST_EASE,
});

/**
 * Create a spring transition with ghost physics
 */
export const ghostSpringTransition = (
  springType: keyof typeof MOTION_TOKENS.spring = 'ghost'
): Transition => ({
  type: 'spring',
  ...MOTION_TOKENS.spring[springType],
});

/**
 * Viewport animation props (for whileInView)
 */
export const viewportConfig = {
  once: true,
  margin: MOTION_TOKENS.reveal.margin,
  amount: MOTION_TOKENS.reveal.threshold,
};

// =============================================================================
// REDUCED MOTION HELPER
// =============================================================================

/**
 * Returns empty animation props if user prefers reduced motion
 */
export const getMotionProps = <T extends object>(
  props: T,
  prefersReducedMotion: boolean | null
): T | Record<string, never> => {
  if (prefersReducedMotion) return {};
  return props;
};
import { buildSupabaseStorageUrl } from '@/lib/supabase/urls';

const siteAsset = (path: string) =>
  buildSupabaseStorageUrl('site-assets', path);

const projectMedia = (path: string) =>
  buildSupabaseStorageUrl('portfolio-media', path);

const projectVideo = (path: string) =>
  buildSupabaseStorageUrl('project-videos', path);

export const HOME_CONTENT = {
  hero: {
    tag: '[BRAND AWARENESS]',
    // Otimizado: Array permite animação escalonada (stagger) linha a linha
    title: ['Você não vê o design.'],
    subtitle: 'Mas ele vê você.',
    cta: 'step inside',
  },

  showcase: {
    title: 'portfólio showcase',
    floatingLabel: '[what we love working on]',
    cta: {
      label: 'let’s build something great →',
      href: '/#contact',
    },
    ctas: [
      { label: 'Fale Comigo', href: '#contact', variant: 'primary' },
      {
        label: 'Download CV',
        href: '/cv-danilo-novais.pdf',
        variant: 'secondary',
        download: true,
        external: true,
      },
    ],
    categories: [
      {
        id: 'brand-campaigns',
        label: 'Brand & Campaigns',
        titleDesktop: 'Brand & Campaigns',
        // Otimizado: Quebra forçada para evitar viúva em mobile pequeno
        titleMobile: 'Brand &\nCampaigns',
        align: 'end',
        thumb: siteAsset('home/showcase/Branding-Project.webp'),
      },
      {
        id: 'videos-motions',
        label: 'Videos & Motion', // Corrigido: Motion (singular)
        titleDesktop: 'Videos & Motion',
        titleMobile: 'Videos &\nMotion',
        align: 'center',
        thumb: siteAsset('home/showcase/Key-Visual.webp'),
      },
      {
        id: 'websites-webcampaigns-tech',
        label: 'Web Campaigns, Websites & Tech',
        // Otimizado: Balanceamento visual para desktop
        titleDesktop: 'Web Campaigns,\nWebsites & Tech',
        // Otimizado: Quebra estratégica para mobile (3 linhas equilibradas)
        titleMobile: 'Web Campaigns,\nWebsites & Tech',
        align: 'start',
        thumb: siteAsset('home/showcase/webdesigner-2.gif'),
      },
    ],
  },

  featuredProjects: [
    {
      id: 1,
      slug: 'magic-radio-branding',
      title: 'Magic — devolvendo a magia ao rádio',
      category: 'branding & campanha',
      client: 'Magic',
      year: 2023,
      tags: ['Branding', 'Campaign'],
      img: projectMedia('projects/creative-direction/hero.webp'),
      layout: {
        // Otimizado: 'min-h' previne overflow de texto, 'aspect' mantém proporção visual
        h: 'min-h-[400px] md:h-[500px] aspect-[4/5] md:aspect-auto',
        cols: 'md:col-span-5',
        sizes: '(max-width: 1024px) 100vw, 42vw',
      },
    },
    {
      id: 2,
      slug: 'branding-project-01',
      title: 'Uma marca ousada e consistente',
      category: 'Branding',
      client: 'Cliente confidencial',
      year: 2022,
      tags: ['Strategy', 'Identity'],
      img: projectMedia('projects/campaign/hero.webp'),
      layout: {
        h: 'min-h-[400px] md:h-[500px] aspect-[4/5] md:aspect-auto',
        cols: 'md:col-span-7',
        sizes: '(max-width: 1024px) 100vw, 58vw',
      },
    },
    {
      id: 3,
      slug: 'key-visual-campaign',
      title: 'Key visual para campanha sazonal',
      category: 'Campanha',
      client: 'Cliente confidencial',
      year: 2021,
      tags: ['Art Direction'],
      img: projectMedia('projects/key-vision/gallery/converted-5-webp.webp'),
      layout: {
        // Otimizado: Altura maior para destaque full-width
        h: 'min-h-[400px] md:h-[600px]',
        cols: 'md:col-span-12',
        sizes: '100vw',
      },
    },
    {
      id: 4,
      slug: 'webdesigner-motion',
      title: 'Experiência web em movimento',
      category: 'Web & Motion',
      client: 'Cliente confidencial',
      year: 2023,
      tags: ['UX/UI', 'Animation'],
      img: projectMedia('projects/key_vision/hero.webp'),
      layout: {
        h: 'min-h-[400px] md:h-[400px] aspect-video md:aspect-auto',
        cols: 'md:col-span-8',
        sizes: '(max-width: 1024px) 100vw, 66vw',
      },
    },
  ],

  clients: {
    title: 'marcas com as quais já trabalhei',
    logos: Array.from({ length: 12 }, (_, i) => ({
      id: i + 1,
      src: siteAsset(`clients/clients.strip.${i + 1}.svg`),
      alt: `Logo do cliente ${i + 1}`, // Otimizado: Português para consistência
    })),
  },

  contact: {
    title: 'contato',
    subtitle: 'Tem uma pergunta ou quer trabalhar junto?',
  },
};

export const TAG_CATALOG = [
  {
    category: {
      label: 'Videos & Motions',
      slug: 'videos-motions',
      type: 'category',
    },
    tags: [
      { label: 'Vídeo', slug: 'video', type: 'tag' },
      { label: 'Vídeo Institucional', slug: 'brand-video', type: 'tag' },
      { label: 'Vídeo para Redes Sociais', slug: 'social-video', type: 'tag' },
      { label: 'Filme Publicitário', slug: 'advertising-video', type: 'tag' },
      { label: 'Edição de Vídeo', slug: 'video-editing', type: 'tag' },
      { label: 'Motion Design', slug: 'motion-design', type: 'tag' },
      { label: 'Animação', slug: 'animation', type: 'tag' },
      { label: 'Animação 2D', slug: '2d-animation', type: 'tag' },
      { label: 'Tipografia Cinética', slug: 'kinetic-typography', type: 'tag' },
      {
        label: 'Transições Animadas',
        slug: 'animated-transitions',
        type: 'tag',
      },
      { label: 'Microinterações', slug: 'micro-interactions', type: 'tag' },
      { label: 'Narrativa Visual', slug: 'visual-storytelling', type: 'tag' },
      { label: 'Roteiro', slug: 'script', type: 'tag' },
      { label: 'Conceito de Vídeo', slug: 'video-concept', type: 'tag' },
      { label: 'Design de Som', slug: 'sound-design', type: 'tag' },
    ],
  },
];

// CORREÇÃO APLICADA: Espaço adicionado entre 'export' e 'const'
export const ABOUT_CONTENT = {
  hero: {
    title: {
      text: 'Sou ',
      highlight: 'Danilo Novais. ',
    },
    manifesto: [
      {
        text: 'Você ',
        highlight: 'não vê tudo ',
        textEnd: 'o que eu faço.',
      },
      { text: 'Mas sente ' },
      { text: 'quando ', highlight: 'funciona.' },
    ],
    description: [
      'Crio designs que observam,\n',
      'entendem e guiam experiências com intenção,\n',
      'estratégia e tecnologia,\n na medida exata.',
    ],
    videos: {
      desktop: siteAsset('about/hero/about.hero.desktop_video.mp4'),
      mobile: siteAsset('about/hero/about.hero.mobile_video.mp4'),
    },
  },
  beliefsIntro: [
    { text: 'Acredito no ' },
    { text: 'design que muda o dia', highlight: true },
    { text: ' de alguém.', newLine: true }, // newLine mantido para controle visual
    { text: 'Não pelo choque, ' },
    { text: 'mas pela conexão.', highlight: true },
  ],
  intro: {
    origin:
      'Goiânia, 2012. O início foi em agências, mas a inquietude era maior.',
  },
  origin: {
    title: 'Origem',
    blocks: [
      {
        type: 'block',
        id: '1',
        title: 'O QUE PERMANECE',
        text: 'Desde cedo, sempre prestei atenção no que ficava — não só no que aparecia. Enquanto muitos olhavam para o brilho imediato, eu era atraído pelos vestígios, pelos detalhes que sobreviviam ao tempo. A essência das coisas sempre falou mais alto do que a superfície.',
        description: '',
        src: siteAsset('about/origin/about.origin_image.1.webp'),
        alt: 'Observando os detalhes',
        align: 'right',
      },
      {
        type: 'block',
        id: '2',
        title: 'DO TRAÇO À INTENÇÃO',
        text: 'Rabiscos viraram ideias. Ideias viraram projetos. E os projetos começaram a deixar rastros. Meu processo criativo nasceu do improviso, do lápis na margem do caderno. Aos poucos, aquilo que era instinto virou direção. Com cada tentativa, aprendi a dar forma ao invisível — até que os conceitos começaram a falar por si.',
        description: '',
        src: siteAsset('about/origin/about.origin_image.2.webp'),
        alt: 'Processo criativo',
        align: 'left',
      },
      {
        type: 'block',
        id: '3',
        title: 'A DESCOBERTA DO INVISÍVEL',
        text: 'Foi ali que entendi: design não é enfeite. É ferramenta invisível de transformação. Por trás de cada escolha visual, existe intenção. Descobri que o design verdadeiro não grita — ele conduz. Ele está presente nos detalhes que ninguém percebe, mas que todos sentem. Transformar sem que se perceba a transformação: isso é potência.',
        description: '',
        src: siteAsset('about/origin/about.origin_image.3.webp'),
        alt: 'Design invisível',
        align: 'right',
      },
      {
        type: 'block',
        id: '4',
        title: 'EXPANSÃO COM PROPÓSITO',
        text: 'Estudei Comunicação, mergulhei no design, no branding e hoje uso inteligência artificial para expandir o alcance sem perder a essência humana da criação. Minha trajetória uniu intuição com método, arte com estratégia. O futuro pede novas ferramentas — e eu as abracei. Mas nunca deixei que a tecnologia apagasse o que me move: a sensibilidade, o olhar atento, a busca pelo significado.',
        description: '',
        src: siteAsset('about/origin/about.origin_image.4.webp'),
        alt: 'Expansão e tecnologia',
        align: 'left',
      },
    ],
  },
  whatIDo: {
    title: ['Do insight ao impacto.', 'Mesmo quando você não percebe.'],
    cards: [
      { id: '1', text: 'Direção criativa que organiza o caos' },
      { id: '2', text: 'Design estratégico que guia decisões' },
      { id: '3', text: 'Identidades que permanecem na memória' },
      { id: '4', text: 'Campanhas multicanais com lógica e emoção' },
      { id: '5', text: 'Branding que não grita, mas marca' },
      {
        id: '6',
        text: 'Inteligência Artificial aplicada à criação',
      },
      { id: '7', text: 'Liderança Criativa com visão e método' },
    ],
    marquee: [
      'DIREÇÃO CRIATIVA',
      'DESIGN ESTRATÉGICO',
      'IDENTIDADES',
      'CAMPANHAS',
      'BRANDING',
      'INTELIGÊNCIA ARTIFICIAL',
      'LIDERANÇA CRIATIVA',
    ],
  },
  method: {
    title: ['Criatividade com método.', 'Impacto sem ruído.'],
    videos: {
      desktop: siteAsset('about/method/about.method.desktop_video.mp4'),
      mobile: siteAsset('about/method/about.method.mobile_video.mp4'),
    },
    intro: [
      'Antes da estética, existe intenção.',
      'Antes do layout, existe lógica.',
      'Antes do impacto, existe silêncio.',
    ],
    steps: [
      { id: '01', text: 'Briefings bem construídos para decisões claras' },
      { id: '02', text: 'Estratégia como base de qualquer criação' },
      { id: '03', text: 'Design com propósito, não só beleza' },
      { id: '04', text: 'Revisões inteligentes, sem ruído desnecessário' },
      { id: '05', text: 'IA e automações para escalar com qualidade' },
      {
        id: '06',
        text: 'Métricas criativas: engajamento, retenção e resultado',
      },
    ],
  },
  beliefs: [
    { text: 'Um vídeo que respira.', highlight: 'respira' },
    { text: 'Uma marca que se reconhece.', highlight: 'reconhece' },
    { text: 'Um detalhe que fica.', highlight: 'fica' },
    { text: 'Crio para gerar presença.', highlight: 'Crio' },
    { text: 'Mesmo quando não estou ali.', highlight: 'Mesmo' },
    { text: 'Mesmo quando ninguém percebe o esforço.', highlight: 'Mesmo' },
  ],
  closing: {
    title: 'Hoje sou Diretor de Criação, com mais de 10 anos de estrada.',
    text: [
      'Já liderei marcas, agências, eventos e criei experiências para todos os canais.',
      'Agora, quero criar algo que permaneça — com você.',
    ],
    ghostText: {
      prefix: 'ISSO É',
      main: 'GHOST DESIGN',
    },
    ctas: [
      { label: 'Fale Comigo', href: '#contact', variant: 'primary' },
      {
        label: 'Download CV',
        href: '/cv-danilo-novais.pdf',
        variant: 'secondary',
        download: true,
        external: true,
      },
    ],
  },
};

export const PORTFOLIO_CONTENT = {
  hero: {
    video: {
      desktop: projectVideo('video-heroPort.mp4'),
      mobile: projectVideo('video-heroPort-mobile.mp4'),
    },
  },
};
export const ADMIN_NAVIGATION = {
  dashboard: '/admin',
  trabalhos: {
    index: '/admin/trabalhos',
    new: '/admin/trabalhos/new',
    detail: (id: string) => `/admin/trabalhos/${id}`,
  },
  tags: '/admin/tags',
  midia: '/admin/midia',
  'landing-pages': '/admin/landing-pages',
  config: '/admin/config',
} as const;
import { getAssetUrl } from '@/utils/utils';

export const ABOUT_ORIGIN_SECTIONS = [
  {
    id: 'permanence',
    title: 'O QUE PERMANECE',
    text: `Desde cedo, sempre prestei atenção no que ficava —
não só no que aparecia.

Enquanto muitos olhavam para o brilho imediato,eu era atraído pelos vestígios, pelos detalhes que sobreviviam ao tempo.
A essência das coisas sempre falou mais alto do que a superfície.`,
    img: getAssetUrl('sobre_page/sobre-1.webp'),
    alt: 'O que permanece - essência que sobrevive ao tempo',
    textAlign: 'right' as const,
  },
  {
    id: 'intention',
    title: 'DO TRAÇO À INTENÇÃO',
    text: `Rabiscos viraram ideias.
Ideias viraram projetos.
E os projetos começaram a deixar rastros.

Meu processo criativo nasceu do improviso, do lápis na margem do caderno.
Aos poucos, aquilo que era instinto virou direção.
Com cada tentativa, aprendi a dar forma ao invisível —
até que os conceitos começaram a falar por si.`,
    img: getAssetUrl('sobre_page/sobre-2.webp'),
    alt: 'Do traço à intenção - processo criativo',
    textAlign: 'right' as const,
  },
  {
    id: 'invisible',
    title: 'A DESCOBERTA DO INVISÍVEL',
    text: `Foi ali que entendi:
design não é enfeite.
É ferramenta invisível de transformação.

Por trás de cada escolha visual, existe intenção.
Descobri que o design verdadeiro não grita — ele conduz.
Ele está presente nos detalhes que ninguém percebe,
mas que todos sentem.
Transformar sem que se perceba a transformação: isso é potência.`,
    img: getAssetUrl('sobre_page/sobre-3.webp'),
    alt: 'A descoberta do invisível - design como ferramenta de transformação',
    textAlign: 'right' as const,
  },
  {
    id: 'expansion',
    title: 'EXPANSÃO COM PROPÓSITO',
    text: `Estudei Comunicação, mergulhei no design, no branding
e hoje uso inteligência artificial para expandir o alcance
sem perder a essência humana da criação.

Minha trajetória uniu intuição com método, arte com estratégia.
O futuro pede novas ferramentas — e eu as abracei.
Mas nunca deixei que a tecnologia apagasse o que me move:
a sensibilidade, o olhar atento, a busca pelo significado.`,
    img: getAssetUrl('sobre_page/sobre-4.webp'),
    alt: 'Expansão com propósito - união de intuição e método',
    textAlign: 'right' as const,
  },
];
{
  "project_rules": "v2.1",
  "strict_mode": true
}
// src/config/about-motion.ts
// Ghost Design Motion Tokens - Fonte da verdade para animações da página Sobre

/**
 * Ghost Easing - A curva de animação principal do sistema
 * Suave, etérea, sem bounce ou elastic
 */
const GHOST_EASE: [number, number, number, number] = [0.22, 1, 0.36, 1];

/**
 * Tokens de Motion para a página Sobre
 * REGRAS ABSOLUTAS:
 * - ❌ Scale proibido
 * - ❌ Bounce proibido
 * - ❌ Rotate proibido
 * - ✅ Opacity + Blur permitidos
 * - ✅ TranslateY máx 18px permitido
 */
export const motionTokens = {
  /**
   * FadeGhost - Entrada padrão com blur
   * Uso: Textos, títulos, seções
   */
  fadeGhost: {
    hidden: { opacity: 0, filter: 'blur(10px)' },
    visible: {
      opacity: 1,
      filter: 'blur(0px)',
      transition: { duration: 0.9, ease: GHOST_EASE },
    },
  },

  /**
   * RiseSoft - Entrada com leve rise (18px máx)
   * Uso: Cards, itens de lista
   */
  riseSoft: {
    hidden: { opacity: 0, y: 18, filter: 'blur(6px)' },
    visible: {
      opacity: 1,
      y: 0,
      filter: 'blur(0px)',
      transition: { duration: 0.9, ease: GHOST_EASE },
    },
  },

  /**
   * ImageFloat - Entrada lateral para imagens
   * Nota: Imagens NUNCA chegam a 100% opacity (máx 0.85)
   */
  imageFloat: {
    hidden: { opacity: 0, x: 12 },
    visible: {
      opacity: 0.85,
      x: 0,
      transition: { duration: 1.2, ease: GHOST_EASE },
    },
  },

  /**
   * TimeBased - Para textos que aparecem por tempo, não scroll
   * Uso: Seção Beliefs/Manifesto
   */
  timeBased: {
    hidden: { opacity: 0, filter: 'blur(8px)', y: 18 },
    visible: {
      opacity: 1,
      filter: 'blur(0px)',
      y: 0,
      transition: { duration: 0.8, ease: GHOST_EASE },
    },
    exit: {
      opacity: 0,
      filter: 'blur(8px)',
      y: -18,
      transition: { duration: 0.6, ease: GHOST_EASE },
    },
  },
};

/**
 * Delays padrão do sistema
 */
export const motionDelays = {
  none: 0,
  short: 0.2,
  base: 0.4,
  long: 1.0,
  stagger: 0.18,
};

/**
 * Durações padrão do sistema
 */
export const motionDurations = {
  fast: 0.6,
  base: 0.9,
  slow: 1.4,
};

/**
 * Configurações de Spring (Física)
 */
export const motionSprings = {
  ghost: {
    stiffness: 50,
    damping: 20,
    restDelta: 0.001,
  },
};

export { GHOST_EASE };
import type { Metadata, Viewport } from 'next';
import { BRAND } from '@/config/brand';

/**
 * Global SEO Metadata
 * This file exports metadata for the entire site.
 * Import in layout.tsx or page.tsx as needed.
 */

export const siteMetadata: Metadata = {
  metadataBase: new URL(`https://${BRAND.domain}`),

  title: {
    default: `${BRAND.name} | Creative Developer`,
    template: `%s | ${BRAND.name}`,
  },

  description:
    'Portfólio de Danilo Novais - Creative Developer especializado em design digital, branding e motion design. Você não vê o design. Mas ele vê você.',

  keywords: [
    'Creative Developer',
    'Creative Development',
    'Creative technologist',
    'Design System',
    'User Experience',
    'WebGL',
    'WebGL Developer',
    'Three.js',
    'React Three Fiber',
    'R3F',
    'GLSL Shaders',
    'GSAP Animation',
    'Framer Motion',
    'Next.js',
    'React',
    'TypeScript',
    'Branding',
    'Motion Design',
    'São Paulo',
    'Brazil',
    'Portfolio',
    'Interactive Design',
    'Front-end Engineering',
  ],

  authors: [{ name: BRAND.name, url: `https://${BRAND.domain}` }],
  creator: BRAND.name,
  publisher: BRAND.name,

  openGraph: {
    type: 'website',
    locale: 'pt_BR',
    url: `https://${BRAND.domain}`,
    siteName: BRAND.name,
    title: `${BRAND.name} | Creative Developer`,
    description:
      'Você não vê o design. Mas ele vê você. Portfólio de projetos criativos.',
    images: [
      {
        url: '/opengraph-image',
        width: 1200,
        height: 630,
        alt: `${BRAND.name} - Creative Developer`,
      },
    ],
  },

  twitter: {
    card: 'summary_large_image',
    title: `${BRAND.name} | Creative Developer`,
    description: 'Você não vê o design. Mas ele vê você.',
    images: ['/opengraph-image'],
    creator: '@_novais',
  },

  robots: {
    index: true,
    follow: true,
    googleBot: {
      index: true,
      follow: true,
      'max-video-preview': -1,
      'max-image-preview': 'large',
      'max-snippet': -1,
    },
  },

  icons: {
    icon: BRAND.assets.logos.favicon,
    shortcut: BRAND.assets.logos.favicon,
    apple: BRAND.assets.logos.favicon,
  },

  manifest: '/manifest.json',

  alternates: {
    canonical: `https://${BRAND.domain}`,
  },
};

export const siteViewport: Viewport = {
  width: 'device-width',
  initialScale: 1,
  maximumScale: 5,
  themeColor: [
    { media: '(prefers-color-scheme: light)', color: BRAND.colors.background },
    { media: '(prefers-color-scheme: dark)', color: BRAND.colors.background },
  ],
};
export const TIMELINE = {
  HERO: {
    START: 0,
    FADE_OUT_START: 0,
    FADE_OUT_END: 0.15, // Hero Copy + Ghost fade out faster
  },
  MANIFESTO: {
    // When the thumb starts transitioning from sticky/corner
    ENTRY_START: 0.05,

    // When it reaches full screen / full focus (earlier = longer fullscreen time)
    FULL_FOCUS_START: 0.3,

    // Video stays fullscreen from 0.3 to 0.8 (~50% of scroll = ~2s at normal speed)
    // When it starts exiting
    EXIT_START: 0.85,

    // Visual Transforms (Parallax/Scale)
    SCALE_START: 0.05, // Start scaling almost immediately
    SCALE_END: 0.35, // Reach fullscreen by 35%
  },
  GLOBAL: {
    SCROLL_END: 1,
  },
} as const;
// src/config/ghostConfig.ts

// Paleta de cores fluorescentes
export const FLUORESCENT_COLORS = {
  cyan: '#00ffff',
  lime: '#00ff00',
  magenta: '#ff00ff',
  yellow: '#ffff00',
  orange: '#ff4500',
  pink: '#ff1493',
  purple: '#9400d3',
  blue: '#0080ff', // Corrigido para coincidir com a referência do CodePen
  green: '#00ff80',
  red: '#ff0040',
  teal: '#00ffaa',
  violet: '#8a2be2',
} as const;

// Tipo para as chaves da paleta
export type FluorescentColorName = keyof typeof FLUORESCENT_COLORS;

// Paleta Extendida (cores personalizadas para o Ghost)
export const EXTENDED_FLUORESCENT_COLORS = {
  ...FLUORESCENT_COLORS,
  // Cores personalizadas do Ghost
  deepSpace: '#0f2027',
  neonCyan: '#50e3c2',
  violetGlow: '#8a2be2',
  midnightBlue: '#040013',
  electricBlue: '#0080ff',
  voidSky: '#020112',
  ghostBlue: '#0048ff',
  darkVoid: '#01010f',
  fogBlue: '#051f51',
} as const;

// Tipo para cores extendidas
export type ExtendedColorName = keyof typeof EXTENDED_FLUORESCENT_COLORS;

// Função para resolver nomes de cores para valores hex
export function resolveFluorescentColor(color: FluorescentColorName): string {
  return FLUORESCENT_COLORS[color];
}

// Função para resolver cores do config (suporta nomes personalizados)
export function resolveConfigColor(colorName: string): string {
  if (!colorName || typeof colorName !== 'string') {
    console.warn('resolveConfigColor received invalid color:', colorName);
    return '#00ffff'; // Safe fallback
  }

  // Tenta a paleta extendida primeiro
  const extendedColor =
    EXTENDED_FLUORESCENT_COLORS[colorName as ExtendedColorName];
  if (extendedColor !== undefined) {
    return extendedColor;
  }
  // Retorna o próprio valor se já for hex
  if (colorName.startsWith('#') || colorName.startsWith('0x')) {
    return colorName;
  }
  // Fallback para cyan se não encontrar
  console.warn(`[ghostConfig] Cor não encontrada: ${colorName}, usando cyan`);
  return FLUORESCENT_COLORS.cyan;
}

// Interface para a configuração do Ghost
export interface GhostConfig {
  // Fundo e névoa
  backgroundColor: string;
  fogColor: string;
  fogNear: number;
  fogFar: number;

  // Câmera e renderização
  cameraDistance: number;
  cameraFov: number;
  rendererDPR: [number, number];

  // Aparência do Ghost
  ghostScale: number;
  bodyColor: string;
  glowColor: string;
  eyeGlowColor: string;
  ghostOpacity: number;
  emissiveIntensity: number;
  pulseSpeed: number;
  pulseIntensity: number;
  floatSpeed: number;

  // Comportamento do Ghost
  followSpeed: number;
  movementThreshold: number;

  // Iluminação
  rimLightIntensity: number;
  ambientLightColor: string;
  ambientLightIntensity: number;

  // Véu Atmosférico (Revelação)
  veilColor: string;
  veilEmissive: string;
  veilEmissiveIntensity: number;
  veilOpacity: number;
  veilPulseAmount: number;
  veilBackgroundColor: string;
  veilBackgroundOpacity: number;

  // Fireflies
  fireflyCount: number;
  fireflySpeed: number;
  fireflyBaseRadius: number;
  fireflyRadiusVariance: number;
  fireflyScaleBase: number;
  fireflyScaleVariance: number;
  fireflyFloatFrequency: number;
  fireflyFloatAmplitude: number;
  fireflyWobbleFrequency: number;
  fireflyWobbleIntensity: number;
  fireflyPulseBase: number;
  fireflyPulseVariance: number;
  fireflyPulseFrequency: number;
  fireflyOpacity: number;
  fireflyGlowIntensity: number;

  // Partículas
  particleCount: number;
  particleColor: string;
  particleSpeedFactor: number;
  particleRadius: number;
  particleGlowOffset: number;
  particleGlowSpeed: number;
  particleGlowStrength: number;
  particleOpacity: number;
  particleDecayRate: number;
  createParticlesOnlyWhenMoving: boolean;
  particleCreationRate: number;

  // Olhos
  eyeGlowIntensity: number;
  eyeGlowResponse: number;
  eyeGlowDecay: number;

  // Efeitos de Pós-Processamento (Analog Decay)
  analogGrain: number;
  analogBleeding: number;
  analogScanlines: number;
  analogVignette: number;
  analogIntensity: number;
  analogJitter: number;
  analogVSync: number;
  limboMode: boolean;

  // Parâmetros do Véu Atmosférico
  revealRadius: number;
  fadeStrength: number;
  baseOpacity: number;
  revealOpacity: number;
}

// Configuração centralizada do Ghost (valores alinhados com o CodePen)
export const GHOST_CONFIG: GhostConfig = {
  // Fundo e névoa
  backgroundColor: '#01010f',
  fogColor: '#051f51',
  fogNear: 1.6,
  fogFar: 2.8,

  // Câmera e renderização
  cameraDistance: 15,
  cameraFov: 75,
  rendererDPR: [1, 2],

  // Aparência do Ghost (MATCHED to CodePen Reference)
  ghostScale: 0.4, // FIXED: was 1.2
  bodyColor: 'ghostBlue', // 0x0f2027
  glowColor: 'blue', // "blue"
  eyeGlowColor: 'purple', // FIXED: CodePen uses 'blue' (0x0080ff)

  ghostOpacity: 0.88,
  emissiveIntensity: 8.5, // FIXED: was 5.8
  pulseSpeed: 1.6,
  pulseIntensity: 0.6,
  floatSpeed: 1.6, // FIXED: was 1.6

  // Comportamento do Ghost
  followSpeed: 0.05, // FIXED: was 0.05
  movementThreshold: 0.07,

  // Iluminação
  rimLightIntensity: 1.8,
  ambientLightColor: 'cyan',
  ambientLightIntensity: 0.08,

  // Véu Atmosférico (Revelação)
  veilColor: 'ghostBlue',
  veilEmissive: 'blue',
  veilEmissiveIntensity: 3.6,
  veilOpacity: 3.9,
  veilPulseAmount: 1.6,
  veilBackgroundColor: 'blue',
  veilBackgroundOpacity: 0.95,

  // Fireflies (Matched to CodePen)
  fireflyCount: 20, // CodePen cria 20 fireflies em createFireflies loop
  fireflySpeed: 0.09,
  fireflyBaseRadius: 0.02,
  fireflyRadiusVariance: 0.06,
  fireflyScaleBase: 1,
  fireflyScaleVariance: 0.5,
  fireflyFloatFrequency: 1,
  fireflyFloatAmplitude: 0.05,
  fireflyWobbleFrequency: 0.5,
  fireflyWobbleIntensity: 0.09,
  fireflyPulseBase: 0.9,
  fireflyPulseVariance: 0.4,
  fireflyPulseFrequency: 2,
  fireflyOpacity: 0.9,
  fireflyGlowIntensity: 4.3,

  // Partículas (Matched to CodePen)
  particleCount: 650,
  particleColor: 'violet',
  particleSpeedFactor: 0.012,
  particleRadius: 3.5,
  particleGlowOffset: 0.6,
  particleGlowSpeed: 0.003,
  particleGlowStrength: 0.9,
  particleOpacity: 0.9,
  particleDecayRate: 0.005,
  createParticlesOnlyWhenMoving: true,
  particleCreationRate: 5,

  // Olhos (Matched to CodePen)
  eyeGlowIntensity: 9.5,
  eyeGlowResponse: 0.31,
  eyeGlowDecay: 0.95,

  // Efeitos de Pós-Processamento (Matched to CodePen)
  analogGrain: 2.4,
  analogBleeding: 1.5,
  analogScanlines: 0.7,
  analogVignette: 0.9,
  analogIntensity: 0.9,
  analogJitter: 0.5,
  analogVSync: 0.7,
  limboMode: false,

  // Parâmetros do Véu Atmosférico (MATCHED to CodePen Reference)
  revealRadius: 17, // Increased for better text readability
  fadeStrength: 0.7,
  baseOpacity: 0.08, // Darker background to create reveal contrast
  revealOpacity: -0.2, // Fully transparent reveal
};

// Helper para converter cor do config para formato numérico (Three.js)
export function getConfigColorHex(colorName: string): number {
  const hex = resolveConfigColor(colorName);
  return parseInt(hex.replace('#', ''), 16);
}
export const lerp = (start: number, end: number, t: number) =>
  start * (1 - t) + end * t;
export const clamp = (val: number, min: number, max: number) =>
  Math.min(Math.max(val, min), max);
import type React from 'react';
import { SUPABASE_STORAGE_URL } from '@/config/brand';

export const ASSET_PLACEHOLDER =
  'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';

function normalizePath(path: string) {
  return path
    .replace(/^https?:\/\/[^/]+\/storage\/v1\/object\/public\//, '')
    .replace(/^\/?storage\/v1\/object\/public\//, '')
    .replace(/^\/+/, '');
}

export function getAssetUrl(path?: string | null): string {
  if (!path) return ASSET_PLACEHOLDER;
  const trimmed = path.trim();
  if (!trimmed) return ASSET_PLACEHOLDER;
  if (/^https?:\/\//.test(trimmed)) return trimmed;

  const normalized = normalizePath(trimmed);
  if (!normalized) return ASSET_PLACEHOLDER;

  return `${SUPABASE_STORAGE_URL}/${normalized}`;
}

export function applyImageFallback(
  event: React.SyntheticEvent<HTMLImageElement, Event>
) {
  const target = event.currentTarget;
  if (target.dataset.fallbackApplied) return;
  target.dataset.fallbackApplied = 'true';
  target.src = ASSET_PLACEHOLDER;
}

export const getGhostAssetUrl = (path?: string | null): string => {
  if (!path) return '/assets/placeholder.webp';

  try {
    // Verifica se é uma URL válida
    if (path.startsWith('http://') || path.startsWith('https://')) {
      return path;
    }

    // Usa a função getAssetUrl existente
    return getAssetUrl(path);
  } catch (error) {
    console.error('Erro ao obter URL do asset:', error);
    return ASSET_PLACEHOLDER;
  }
};

// Função para aplicar lazy loading em imagens
export const applyLazyLoading = (img: HTMLImageElement) => {
  img.loading = 'lazy';
  img.decoding = 'async';
};

// Função para verificar se um caminho de arquivo ou URL é um vídeo
export const isVideo = (path?: string | null): boolean => {
  if (!path) return false;
  const videoExtensions = ['.mp4', '.webm', '.ogg', '.mov', '.m4v'];
  return videoExtensions.some((ext) => path.toLowerCase().endsWith(ext));
};
import { createServerClient } from '@supabase/ssr';
import { type NextRequest, NextResponse } from 'next/server';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey =
  process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

export const createClient = (request: NextRequest) => {
  if (!supabaseUrl || !supabaseKey) {
    throw new Error('Missing Supabase middleware credentials');
  }

  let supabaseResponse = NextResponse.next({
    request: {
      headers: request.headers,
    },
  });

  const supabase = createServerClient(supabaseUrl, supabaseKey, {
    cookies: {
      getAll() {
        return request.cookies.getAll();
      },
      setAll(cookiesToSet) {
        cookiesToSet.forEach(({ name, value }) =>
          request.cookies.set(name, value)
        );
        supabaseResponse = NextResponse.next({
          request,
        });
        cookiesToSet.forEach(({ name, value, options }) =>
          supabaseResponse.cookies.set(name, value, options)
        );
      },
    },
  });

  return { supabase, supabaseResponse };
};
import { createBrowserClient } from '@supabase/ssr';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey =
  process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

export const createClient = () => {
  if (!supabaseUrl || !supabaseKey) {
    throw new Error('Missing Supabase browser credentials');
  }

  return createBrowserClient(supabaseUrl, supabaseKey);
};
import { createServerClient } from '@supabase/ssr';
import { cookies } from 'next/headers';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey =
  process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

type CookieStore = Awaited<ReturnType<typeof cookies>>;

export const createClient = async (cookieStore?: CookieStore) => {
  if (!supabaseUrl || !supabaseKey) {
    throw new Error('Missing Supabase server credentials');
  }

  const store = cookieStore ?? (await cookies());

  return createServerClient(supabaseUrl, supabaseKey, {
    cookies: {
      getAll() {
        return store.getAll();
      },
      setAll(cookiesToSet) {
        try {
          cookiesToSet.forEach(({ name, value, options }) =>
            store.set(name, value, options)
          );
        } catch {
          // Server Components cannot mutate cookies; middleware should handle refresh.
        }
      },
    },
  });
};
import { z } from 'zod';

export const postSchema = z.object({
  title: z.string().min(1, 'Title is required'),
  slug: z
    .string()
    .min(1, 'Slug is required')
    .regex(/^[a-z0-9-]+$/, 'Slug must be lowercase, numbers, and hyphens'),
  content: z.any().optional(), // JSON content from TipTap/EditorJS
  cover_image: z.string().optional(),
  published: z.boolean().default(false),
  seo_title: z.string().optional(),
  seo_description: z.string().optional(),
});

// Form input values (pre-parse)
export type PostFormData = z.input<typeof postSchema>;
// Parsed payload with defaults applied
export type PostFormPayload = z.output<typeof postSchema>;
/* GSAP & 3D Transitions */
.floating-cards-container {
  perspective: 1000px;
}

.card-3d-wrapper {
  transform-style: preserve-3d;
  will-change: transform;
}

.card-glass {
  background: rgba(255, 255, 255, 0.05);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
}

.purple-glow-text {
  text-shadow: 0 0 10px rgba(147, 51, 234, 0.6);
}

@media (prefers-reduced-motion: reduce) {
  .card-3d-wrapper {
    animation: none !important;
    transform: none !important;
  }
}
/* TT Norms Pro - Primary Font */
@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Thin.woff2') format('woff2');
  font-weight: 100;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Light.woff2') format('woff2');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Medium.woff2') format('woff2');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'TT Norms Pro';
  src: url('/fonts/TT%20Norms%20Pro%20Black.woff2') format('woff2');
  font-weight: 900;
  font-style: normal;
  font-display: swap;
}

/* PPSupplyMono - Tag/Micro Font */
@font-face {
  font-family: 'PPSupplyMono';
  src: url('https://assets.codepen.io/7558/PPSupplyMono-Variable.woff2')
    format('woff2');
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

/* CustomLight - From about-origin.css */
@font-face {
  font-family: 'CustomLight';
  src: url('https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/global/fonts/global.font_light.woff2')
    format('woff2');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}
@import './fonts.css';

:root {
  /* Tipografia Fluida (Mobile -> Desktop) */
  /* Valores exatos do Design System 2.2 */
  --font-display: clamp(2.5rem, 5vw, 4.5rem);
  /* 40px -> 72px */
  --font-h1: clamp(2rem, 4vw, 3.5rem);
  /* 32px -> 56px */
  --font-h2: clamp(1.5rem, 3vw, 2.5rem);
  /* 24px -> 40px */
  --font-h3: clamp(1.25rem, 2vw, 1.75rem);
  /* 20px -> 28px */
  --font-body: clamp(1rem, 1.2vw, 1.125rem);
  /* 16px -> 18px */

  --font-small: 0.875rem;
  /* 14px */
  --font-micro: 0.75rem;
  /* 12px */

  /* Espaçamento Global */
  --container-padding: clamp(24px, 5vw, 96px);

  /* Ghost Cards */
  --ghost-card-height-desktop: 480px;
}

body {
  font-family: 'TT Norms Pro', ui-sans-serif, system-ui, sans-serif;
  background-color: #040013;
  /* BRAND.colors.background */
  color: #fcffff;
  /* BRAND.colors.text */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  /* Mobile-First: Safe area padding for notch/dynamic island */
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);

  /* Prevent horizontal overflow on mobile */
  overflow-x: hidden;

  /* Optimize text rendering */
  text-rendering: optimizeLegibility;
}

/* Utilitários de Tipografia baseados nos Tokens */
.text-display {
  font-size: var(--font-display);
  font-weight: 900;
  /* Black */
  line-height: 1.1;
}

.text-h1 {
  font-size: var(--font-h1);
  font-weight: 700;
  /* Bold */
  line-height: 1.1;
}

.text-h2 {
  font-size: var(--font-h2);
  font-weight: 700;
  /* Bold */
  line-height: 1.15;
}

.text-h3 {
  font-size: var(--font-h3);
  font-weight: 500;
  /* Medium */
  line-height: 1.2;
}

.text-body {
  font-size: var(--font-body);
  font-weight: 400;
  /* Regular */
  line-height: 1.5;
}

.text-micro {
  font-family: 'PPSupplyMono', monospace;
  font-size: var(--font-micro);
  line-height: 1.4;
}

/* Card sizing helpers — same height on desktop, 5x4 on mobile */
.card-shell {
  position: relative;
  display: flex;
  flex-direction: column;
  width: 100%;
  height: auto;
  aspect-ratio: 5 / 4;
  min-height: 0;
}

@media (min-width: 768px) {
  .card-shell {
    aspect-ratio: unset;
    min-height: var(--ghost-card-height-desktop);
    height: var(--ghost-card-height-desktop);
  }
}

.card-media {
  position: relative;
  flex: 1 1 auto;
  width: 100%;
  min-height: 0;
}

/* Layout & Grid System (Strict Standard) */
.std-grid {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  padding-left: 1.5rem;
  /* Mobile: 24px */
  padding-right: 1.5rem;
}

@media (min-width: 768px) {
  .std-grid {
    padding-left: 3rem;
    /* Tablet: 48px */
    padding-right: 3rem;
  }
}

@media (min-width: 1024px) {
  .std-grid {
    padding-left: 6rem;
    /* Desktop: 96px */
    padding-right: 6rem;
    max-width: 1680px;
    /* Max-width constraint */
  }
}

/* Lenis styles from about-origin.css */
html.lenis {
  height: auto;
}

.lenis.lenis-smooth {
  scroll-behavior: auto;
}

.lenis.lenis-smooth [data-lenis-prevent] {
  overscroll-behavior: contain;
}

.lenis.lenis-stopped {
  overflow: hidden;
}

/* ========================================================================
   Admin pages: keep native scrolling (no Lenis)
   ======================================================================== */
html.admin-page {
  scroll-behavior: auto !important;
}

html.admin-page,
html.admin-page body {
  overflow-y: auto !important;
  height: auto;
}

.img-wrapper {
  clip-path: inset(0% 0% 0% 0%);
  will-change: clip-path;
}

/* ========================================================================
   Mobile-First Utilities
   ======================================================================== */

/* Touch Target - Minimum 48px for accessibility (WCAG 2.5.5) */
.touch-target {
  min-width: 48px;
  min-height: 48px;
}

/* Safe Area Padding - For notch/dynamic island devices */
.safe-area-bottom {
  padding-bottom: max(16px, env(safe-area-inset-bottom, 16px));
}

.footer-safe-area {
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.safe-area-top {
  padding-top: max(16px, env(safe-area-inset-top, 16px));
}

.safe-area-x {
  padding-left: max(16px, env(safe-area-inset-left, 16px));
  padding-right: max(16px, env(safe-area-inset-right, 16px));
}

/* Touch Feedback - Visual response for mobile tap */
.touch-feedback {
  transition:
    transform 150ms ease,
    opacity 150ms ease;
}

.touch-feedback:active {
  transform: scale(0.97);
  opacity: 0.9;
}

/* Scroll Snap for mobile carousels */
.scroll-snap-x {
  scroll-snap-type: x mandatory;
  overflow-x: auto;
}

/* Hide scrollbar cross-browser */
.scroll-snap-x::-webkit-scrollbar {
  display: none;
}

.scroll-snap-x {
  -ms-overflow-style: none;
}

.scroll-snap-item {
  scroll-snap-align: start;
  scroll-snap-stop: always;
}

/* Mobile-optimized text sizes */
.text-mobile-hero {
  font-size: clamp(2.5rem, 10vw, 6rem);
  line-height: 0.95;
  letter-spacing: -0.03em;
}

.text-mobile-title {
  font-size: clamp(1.5rem, 6vw, 3rem);
  line-height: 1.1;
}

.text-mobile-body {
  font-size: clamp(0.875rem, 3.5vw, 1.125rem);
  line-height: 1.6;
}
/**
 * @deprecated Use `AntigravityCTA` instead for consistent CTA styling across the app.
 * This component is kept for backward compatibility but should not be used for new implementations.
 * The AntigravityCTA follows the "Compound Fusion" design pattern.
 */
'use client';

import { useId } from 'react';
import { useReducedMotion } from 'framer-motion';
import { ArrowRight } from 'lucide-react';
import Link from 'next/link';

interface CTAButtonProps {
  href?: string;
  onClick?: () => void;
  type?: 'button' | 'submit' | 'reset';
  disabled?: boolean;
  children: React.ReactNode;
  // Adicionado 'ghost' à tipagem
  variant?: 'primary' | 'secondary' | 'accent' | 'ghost';
  className?: string;
  id?: string;
}

export const CTAButton: React.FC<CTAButtonProps> = ({
  href,
  onClick,
  type = 'button',
  disabled = false,
  children,
  variant = 'primary',
  className = '',
  id,
}) => {
  const prefersReducedMotion = useReducedMotion();
  const generatedId = useId();
  const uniqueId = id || `cta-btn-${generatedId.replace(/:/g, '')}`;

  const variants = {
    primary: {
      bg: 'bg-ghost-blue shadow-[0_0_30px_-5px_rgba(0,87,255,0.6)]',
      text: 'text-white',
      iconBg: 'bg-ghost-blue shadow-[0_0_30px_-5px_rgba(0,87,255,0.6)]',
    },
    secondary: {
      bg: 'bg-transparent border-2 border-ghost-blue shadow-[0_0_20px_-5px_rgba(0,87,255,0.2)]',
      text: 'text-ghost-blue',
      iconBg: 'bg-ghost-blue shadow-[0_0_20px_-5px_rgba(0,87,255,0.2)]',
    },
    accent: {
      bg: 'bg-ghost-green shadow-[0_0_30px_-5px_rgba(79,230,255,0.5)]',
      text: 'text-secondary',
      iconBg: 'bg-ghost-blue',
    },
    // Nova variante Ghost (Minimalista/Transparente)
    ghost: {
      bg: 'bg-transparent hover:bg-white/5 border border-white/10 backdrop-blur-sm shadow-lg',
      text: 'text-white/90 hover:text-white',
      iconBg: 'bg-white/10 text-white',
    },
  };

  // Fallback de segurança: se variant não existir, usa primary
  const v = variants[variant] || variants.primary;

  const buttonContent = (
    <>
      <span
        className={`inline-flex items-center px-8 md:px-10 py-3 md:py-4 ${v.bg} ${v.text} font-medium uppercase tracking-wide text-sm md:text-base rounded-full whitespace-nowrap transition-all duration-300`}
      >
        {children}
      </span>

      <span
        className={`flex items-center justify-center w-12 h-12 md:w-14 md:h-14 ${v.iconBg} text-white rounded-full -ml-4 md:-ml-5 z-10 transition-all duration-300`}
      >
        <ArrowRight
          className={`w-4 h-4 md:w-5 md:h-5 -rotate-45 ${
            prefersReducedMotion
              ? ''
              : 'transition-transform duration-300 group-hover:rotate-0'
          }`}
        />
      </span>
    </>
  );

  const baseClasses = `
    inline-flex items-center group relative
    ${prefersReducedMotion ? '' : 'hover:-translate-y-px transition ease-out duration-200'}
    ${disabled ? 'opacity-50 pointer-events-none' : ''}
    focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ghost-green focus-visible:ring-offset-4 focus-visible:ring-offset-transparent
    ${className}
  `;

  if (href) {
    const isInternal = href.startsWith('/') || href.startsWith('#');
    const linkProps = {
      id: uniqueId,
      className: baseClasses,
      href,
      ...(isInternal ? {} : { target: '_blank', rel: 'noopener noreferrer' }),
    };

    if (isInternal) {
      return (
        <Link {...linkProps} role="button">
          {buttonContent}
        </Link>
      );
    }

    return (
      <a {...linkProps} role="button">
        {buttonContent}
      </a>
    );
  }

  const buttonProps: React.ButtonHTMLAttributes<HTMLButtonElement> = {
    id: uniqueId,
    className: baseClasses,
    type,
    onClick,
    disabled,
  };

  return <button {...buttonProps}>{buttonContent}</button>;
};

export default CTAButton;
import { BRAND } from '@/config/brand';

type JsonLdProps = {
  logoUrl?: string;
};

export default function JsonLd({ logoUrl }: JsonLdProps) {
  const personSchema = {
    '@type': 'Person',
    name: BRAND.name,
    url: `https://${BRAND.domain}`,
    image: logoUrl ?? BRAND.assets.logos.logoLight,
    jobTitle: 'Creative Developer & Designer',
    sameAs: [
      'https://github.com/danilonovaisv',
      'https://linkedin.com/in/danilonovaisv',
      'https://instagram.com/_novais',
    ],
    description:
      'Creative Developer especializado em WebGL, R3F, Next.js e experiências digitais interativas.',
    knowsAbout: [
      'WebGL',
      'React Three Fiber',
      'Three.js',
      'Next.js',
      'TypeScript',
      'Motion Design',
      'Branding',
      'Creative Development',
      'Interactive Design',
    ],
  };

  const websiteSchema = {
    '@type': 'WebSite',
    name: `${BRAND.name} | Portfolio`,
    url: `https://${BRAND.domain}`,
    description: 'Você não vê o design. Mas ele vê você.',
    inLanguage: 'pt-BR',
  };

  const portfolioSchema = {
    '@type': 'CollectionPage',
    name: 'Portfolio - Danilo Novais',
    description:
      'Seleção curada de projetos de Branding, Motion Design e Creative Development.',
    url: `https://${BRAND.domain}/portfolio`,
    isPartOf: {
      '@type': 'WebSite',
      url: `https://${BRAND.domain}`,
    },
  };

  return (
    <script
      type="application/ld+json"
      dangerouslySetInnerHTML={{
        __html: JSON.stringify({
          '@context': 'https://schema.org',
          '@graph': [personSchema, websiteSchema, portfolioSchema],
        }),
      }}
    />
  );
}
'use client';

import * as React from 'react';
import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog';

import { cn } from '@/lib/utils';
import { buttonVariants } from '@/components/ui/button';

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
AlertDialogHeader.displayName = 'AlertDialogHeader';

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
AlertDialogFooter.displayName = 'AlertDialogFooter';

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold', className)}
    {...props}
  />
));
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
));
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: 'outline' }),
      'mt-2 sm:mt-0',
      className
    )}
    {...props}
  />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};
'use client';

import * as React from 'react';
import * as TabsPrimitive from '@radix-ui/react-tabs';

import { cn } from '@/lib/utils';

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      'inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground',
      className
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      'inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm',
      className
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
      className
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };
import * as React from 'react';

import { cn } from '@/lib/utils';

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'rounded-lg border bg-card text-card-foreground shadow-sm',
      className
    )}
    {...props}
  />
));
Card.displayName = 'Card';

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex flex-col space-y-1.5 p-6', className)}
    {...props}
  />
));
CardHeader.displayName = 'CardHeader';

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'text-2xl font-semibold leading-none tracking-tight',
      className
    )}
    {...props}
  />
));
CardTitle.displayName = 'CardTitle';

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
CardDescription.displayName = 'CardDescription';

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />
));
CardContent.displayName = 'CardContent';

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex items-center p-6 pt-0', className)}
    {...props}
  />
));
CardFooter.displayName = 'CardFooter';

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardDescription,
  CardContent,
};
'use client';

import * as React from 'react';
import * as SliderPrimitive from '@radix-ui/react-slider';

import { cn } from '@/lib/utils';

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex w-full touch-none select-none items-center',
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
));
Slider.displayName = SliderPrimitive.Root.displayName;

export { Slider };
'use client';

import { useEffect, useRef } from 'react';
import { motion, useMotionValue } from 'framer-motion';

export interface CustomCursorProps {
  color?: string;
  size?: number;
}

export default function CustomCursor({
  color = '#0048ff',
  size = 20,
}: CustomCursorProps) {
  const cursorRef = useRef<HTMLDivElement>(null);
  const mouseX = useMotionValue(0);
  const mouseY = useMotionValue(0);

  useEffect(() => {
    const handleMouseMove = (e: MouseEvent) => {
      mouseX.set(e.clientX);
      mouseY.set(e.clientY);
    };

    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, [mouseX, mouseY]);

  return (
    <motion.div
      ref={cursorRef}
      style={{
        position: 'fixed',
        left: 0,
        top: 0,
        width: size,
        height: size,
        backgroundColor: color,
        borderRadius: '50%',
        pointerEvents: 'none',
        zIndex: 9999,
        x: mouseX,
        y: mouseY,
        translateX: '-50%',
        translateY: '-50%',
      }}
      aria-hidden="true"
    />
  );
}
'use client';

import * as React from 'react';
import * as PopoverPrimitive from '@radix-ui/react-popover';

import { cn } from '@/lib/utils';

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        'z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };
'use client';

import type { SVGProps } from 'react';

export function ArrowIcon(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      viewBox="0 0 16 16"
      aria-hidden="true"
      fill="none"
      stroke="currentColor"
      strokeWidth={1.5}
      {...props}
    >
      <path d="M3 13L13 3M6 3H13V10" />
    </svg>
  );
}
'use client';

import * as React from 'react';
import * as ProgressPrimitive from '@radix-ui/react-progress';

import { cn } from '@/lib/utils';

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      'relative h-4 w-full overflow-hidden rounded-full bg-secondary',
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
));
Progress.displayName = ProgressPrimitive.Root.displayName;

export { Progress };
'use client';

import { useToast } from '@/hooks/use-toast';
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from '@/components/ui/toast';

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        );
      })}
      <ToastViewport />
    </ToastProvider>
  );
}
'use client';

import * as React from 'react';
import * as RechartsPrimitive from 'recharts';

import { cn } from '@/lib/utils';

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: '', dark: '.dark' } as const;

export type ChartConfigEntry = {
  label?: React.ReactNode;
  icon?: React.ComponentType;
} & (
  | { color?: string; theme?: never }
  | { color?: never; theme: Record<keyof typeof THEMES, string> }
);

export type ChartConfig = Record<string, ChartConfigEntry>;

type ChartContextProps = {
  config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

const sanitizeConfigKey = (key: string) => {
  const sanitized = key.replace(/[^a-zA-Z0-9_-]/g, '-');
  return sanitized || 'default';
};

const getConfigClassName = (key: string, prefix: string) =>
  `${prefix}-${sanitizeConfigKey(key)}`;

function useChart() {
  const context = React.useContext(ChartContext);

  if (!context) {
    throw new Error('useChart must be used within a <ChartContainer />');
  }

  return context;
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    config: ChartConfig;
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >['children'];
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId();
  const chartId = `chart-${id || uniqueId.replace(/:/g, '')}`;

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  );
});
ChartContainer.displayName = 'Chart';

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([, config]) => config.theme || config.color
  );

  if (!colorConfig.length) {
    return null;
  }

  const themeStyles = Object.entries(THEMES)
    .map(([theme, prefix]) => {
      const declarations = colorConfig
        .map(([key, itemConfig]) => {
          const safeKey = sanitizeConfigKey(key);
          const color =
            itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
            itemConfig.color;

          return color ? `  --color-${safeKey}: ${color};` : null;
        })
        .filter(Boolean)
        .join('\n');

      if (!declarations) {
        return null;
      }

      return `
${prefix} [data-chart=${id}] {
${declarations}
}

`;
    })
    .filter(Boolean)
    .join('');

  const indicatorStyles = colorConfig
    .map(([key]) => {
      const safeKey = sanitizeConfigKey(key);
      return `
[data-chart=${id}] .chart-tooltip-indicator-${safeKey} {
  background-color: var(--color-${safeKey});
  border-color: var(--color-${safeKey});
}

[data-chart=${id}] .chart-legend-color-${safeKey} {
  background-color: var(--color-${safeKey});
}

`;
    })
    .join('');

  const styleContent = [themeStyles, indicatorStyles]
    .filter(Boolean)
    .join('\n');

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: styleContent,
      }}
    />
  );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

const ChartTooltipContent = React.forwardRef<HTMLDivElement, any>(
  (
    {
      active,
      payload,
      className,
      indicator = 'dot',
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart();

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null;
      }

      const [item] = payload;
      const key = `${labelKey || item.dataKey || item.name || 'value'}`;
      const { config: payloadConfigEntry } = getPayloadConfigFromPayload(
        config,
        item,
        key
      );
      const value =
        !labelKey && typeof label === 'string'
          ? config[label as keyof typeof config]?.label || label
          : payloadConfigEntry?.label;

      if (labelFormatter) {
        return (
          <div className={cn('font-medium', labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        );
      }

      if (!value) {
        return null;
      }

      return <div className={cn('font-medium', labelClassName)}>{value}</div>;
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ]);

    if (!active || !payload?.length) {
      return null;
    }

    const nestLabel = payload.length === 1 && indicator !== 'dot';

    return (
      <div
        ref={ref}
        className={cn(
          'grid min-w-32 items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl',
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item: any, index: number) => {
            const key = `${nameKey || item.name || item.dataKey || 'value'}`;
            const { config: payloadConfigEntry, key: payloadConfigKey } =
              getPayloadConfigFromPayload(config, item, key);
            const indicatorClassKey = payloadConfigKey || key;
            const hasPayloadColor = Boolean(
              payloadConfigEntry?.color || payloadConfigEntry?.theme
            );

            return (
              <div
                key={item.dataKey}
                className={cn(
                  'flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground',
                  indicator === 'dot' && 'items-center'
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {payloadConfigEntry?.icon ? (
                      <payloadConfigEntry.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            'shrink-0 rounded-[2px] border',
                            indicator === 'dot' && 'h-2.5 w-2.5',
                            indicator === 'line' && 'h-2.5 w-1',
                            indicator === 'dashed' &&
                              'w-0 border-[1.5px] border-dashed bg-transparent',
                            nestLabel && indicator === 'dashed' && 'my-0.5',
                            hasPayloadColor &&
                              getConfigClassName(
                                indicatorClassKey,
                                'chart-tooltip-indicator'
                              )
                          )}
                        />
                      )
                    )}
                    <div
                      className={cn(
                        'flex flex-1 justify-between leading-none',
                        nestLabel ? 'items-end' : 'items-center'
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {payloadConfigEntry?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            );
          })}
        </div>
      </div>
    );
  }
);
ChartTooltipContent.displayName = 'ChartTooltip';

const ChartLegend = RechartsPrimitive.Legend;

const ChartLegendContent = React.forwardRef<HTMLDivElement, any>(
  (
    { className, hideIcon = false, payload, verticalAlign = 'bottom', nameKey },
    ref
  ) => {
    const { config } = useChart();

    if (!payload?.length) {
      return null;
    }

    return (
      <div
        ref={ref}
        className={cn(
          'flex items-center justify-center gap-4',
          verticalAlign === 'top' ? 'pb-3' : 'pt-3',
          className
        )}
      >
        {payload.map((item: any) => {
          const key = `${nameKey || item.dataKey || 'value'}`;
          const { config: payloadConfigEntry, key: payloadConfigKey } =
            getPayloadConfigFromPayload(config, item, key);
          const legendClassKey = payloadConfigKey || key;
          const hasPayloadColor = Boolean(
            payloadConfigEntry?.color || payloadConfigEntry?.theme
          );

          return (
            <div
              key={item.value}
              className={cn(
                'flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground'
              )}
            >
              {payloadConfigEntry?.icon && !hideIcon ? (
                <payloadConfigEntry.icon />
              ) : (
                <div
                  className={cn(
                    'h-2 w-2 shrink-0 rounded-[2px]',
                    hasPayloadColor
                      ? getConfigClassName(legendClassKey, 'chart-legend-color')
                      : 'bg-muted-foreground/50'
                  )}
                />
              )}
              {payloadConfigEntry?.label}
            </div>
          );
        })}
      </div>
    );
  }
);
ChartLegendContent.displayName = 'ChartLegend';

type PayloadConfigResult = {
  config?: ChartConfigEntry;
  key: string;
};

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
): PayloadConfigResult {
  if (typeof payload !== 'object' || payload === null) {
    return { config: undefined, key };
  }

  const payloadPayload =
    'payload' in payload &&
    typeof payload.payload === 'object' &&
    payload.payload !== null
      ? payload.payload
      : undefined;

  let configLabelKey: string = key;

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === 'string'
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string;
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === 'string'
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string;
  }

  const configEntry =
    configLabelKey in config
      ? config[configLabelKey]
      : config[key as keyof typeof config];

  return { config: configEntry, key: configLabelKey };
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
};
'use client';

import * as React from 'react';
import * as SheetPrimitive from '@radix-ui/react-dialog';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  }
);

interface SheetContentProps
  extends
    React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = 'right', className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
));
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
SheetHeader.displayName = 'SheetHeader';

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
SheetFooter.displayName = 'SheetFooter';

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold text-foreground', className)}
    {...props}
  />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
};
'use client';

import * as React from 'react';
import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area';

import { cn } from '@/lib/utils';

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn('relative overflow-hidden', className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = 'vertical', ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      'flex touch-none select-none transition-colors',
      orientation === 'vertical' &&
        'h-full w-2.5 border-l border-l-transparent p-px',
      orientation === 'horizontal' &&
        'h-2.5 flex-col border-t border-t-transparent p-px',
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };
'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const labelVariants = cva(
  'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'
);

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };
'use client';

import * as React from 'react';
import * as AccordionPrimitive from '@radix-ui/react-accordion';
import { ChevronDown } from 'lucide-react';

import { cn } from '@/lib/utils';

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn('border-b', className)}
    {...props}
  />
));
AccordionItem.displayName = 'AccordionItem';

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        'flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180',
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn('pb-4 pt-0', className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };
'use client';

import * as React from 'react';
import * as TooltipPrimitive from '@radix-ui/react-tooltip';

import { cn } from '@/lib/utils';

const TooltipProvider = TooltipPrimitive.Provider;

const Tooltip = TooltipPrimitive.Root;

const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      'z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };
'use client';

import type { ReactNode } from 'react';

type Variant = 'solid' | 'outline';

interface PrimaryButtonProps {
  href: string;
  children: ReactNode;
  variant?: Variant;
}

export function PrimaryButton({
  href,
  children,
  variant = 'solid',
}: PrimaryButtonProps) {
  const baseClasses =
    'inline-flex items-center justify-center rounded-full px-6 py-3 text-sm font-medium uppercase tracking-[0.22em] transition-colors duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2';

  const variantClasses =
    variant === 'solid'
      ? 'bg-primary text-white hover:bg-primary-hover focus-visible:ring-primary focus-visible:ring-offset-background'
      : 'border border-primary text-primary hover:bg-primary hover:text-white focus-visible:ring-primary focus-visible:ring-offset-background';

  return (
    <a href={href} className={`${baseClasses} ${variantClasses}`}>
      {children}
    </a>
  );
}
import * as React from 'react';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const alertVariants = cva(
  'relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground',
  {
    variants: {
      variant: {
        default: 'bg-background text-foreground',
        destructive:
          'border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
));
Alert.displayName = 'Alert';

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn('mb-1 font-medium leading-none tracking-tight', className)}
    {...props}
  />
));
AlertTitle.displayName = 'AlertTitle';

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('text-sm [&_p]:leading-relaxed', className)}
    {...props}
  />
));
AlertDescription.displayName = 'AlertDescription';

export { Alert, AlertTitle, AlertDescription };
/**
 * @deprecated Use `AntigravityCTA` instead for consistent CTA styling across the app.
 * This component is kept for backward compatibility but should not be used for new implementations.
 */
'use client';

import React, { useEffect } from 'react';
import { motion, useMotionValue, useTransform } from 'framer-motion';
import Link from 'next/link';
import { ArrowIcon } from './ArrowIcon';

interface CompoundPillCTAProps {
  href: string;
  label: string;
}

export const CompoundPillCTA = ({ href, label }: CompoundPillCTAProps) => {
  // Idle orbital animation for the arrow
  const time = useMotionValue(0);
  useEffect(() => {
    let frame: number;
    const animate = (t: number) => {
      time.set(t / 1000);
      frame = requestAnimationFrame(animate);
    };
    frame = requestAnimationFrame(animate);
    return () => cancelAnimationFrame(frame);
  }, [time]);

  // Orbital motion (very subtle idle)
  const radius = 2;
  const speed = 2.5;
  const orbitX = useTransform(time, (t) => Math.cos(t * speed) * radius);
  const orbitY = useTransform(time, (t) => Math.sin(t * speed) * radius);

  return (
    <div className="relative flex items-center justify-center py-12">
      <Link
        href={href}
        className="group flex items-center gap-[5px] transition-transform duration-200 ease-out hover:-translate-y-px"
      >
        {/* Pill Label */}
        <div className="relative z-10 flex h-[58px] items-center justify-center rounded-full bg-bluePrimary px-10 transition-all duration-200 ease-out group-hover:bg-blueAccent shadow-[0_15px_45px_var(--color-bluePrimary-faint)]">
          <span className="text-base font-bold lowercase tracking-tight text-white transition-colors duration-200 ease-out group-hover:text-background">
            {label}
          </span>
        </div>

        {/* Arrow Circle */}
        <motion.div
          style={{ x: orbitX, y: orbitY }}
          className="flex h-[46px] w-[46px] items-center justify-center rounded-full bg-bluePrimary text-white transition-all duration-200 ease-out group-hover:bg-blueAccent group-hover:text-background group-hover:scale-105 shadow-[0_10px_30px_rgba(0,0,0,0.1)]"
        >
          <ArrowIcon className="h-6 w-6" />
        </motion.div>
      </Link>
    </div>
  );
};
'use client';

import * as React from 'react';
import * as SwitchPrimitives from '@radix-ui/react-switch';

import { cn } from '@/lib/utils';

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      'peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input',
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        'pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0'
      )}
    />
  </SwitchPrimitives.Root>
));
Switch.displayName = SwitchPrimitives.Root.displayName;

export { Switch };
'use client';

import * as React from 'react';
import { ChevronLeft, ChevronRight } from 'lucide-react';
import { DayPicker } from 'react-day-picker';

import { cn } from '@/lib/utils';
import { buttonVariants } from '@/components/ui/button';

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn('p-3', className)}
      classNames={{
        months: 'flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0',
        month: 'space-y-4',
        caption: 'flex justify-center pt-1 relative items-center',
        caption_label: 'text-sm font-medium',
        nav: 'space-x-1 flex items-center',
        nav_button: cn(
          buttonVariants({ variant: 'outline' }),
          'h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100'
        ),
        nav_button_previous: 'absolute left-1',
        nav_button_next: 'absolute right-1',
        table: 'w-full border-collapse space-y-1',
        head_row: 'flex',
        head_cell:
          'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
        row: 'flex w-full mt-2',
        cell: 'h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
        day: cn(
          buttonVariants({ variant: 'ghost' }),
          'h-9 w-9 p-0 font-normal aria-selected:opacity-100'
        ),
        day_range_end: 'day-range-end',
        day_selected:
          'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
        day_today: 'bg-accent text-accent-foreground',
        day_outside:
          'day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground',
        day_disabled: 'text-muted-foreground opacity-50',
        day_range_middle:
          'aria-selected:bg-accent aria-selected:text-accent-foreground',
        day_hidden: 'invisible',
        ...classNames,
      }}
      components={
        {
          IconLeft: (props: any) => {
            const { className, ...rest } = props;
            return (
              <ChevronLeft className={cn('h-4 w-4', className)} {...rest} />
            );
          },
          IconRight: (props: any) => {
            const { className, ...rest } = props;
            return (
              <ChevronRight className={cn('h-4 w-4', className)} {...rest} />
            );
          },
        } as any
      }
      {...props}
    />
  );
}
Calendar.displayName = 'Calendar';

export { Calendar };
'use client';

import * as React from 'react';
import * as RadioGroupPrimitive from '@radix-ui/react-radio-group';
import { Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn('grid gap-2', className)}
      {...props}
      ref={ref}
    />
  );
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        'aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };
import React, { useEffect } from 'react';
import gsap from 'gsap';

export default function MyComponent(): React.ReactElement {
  useEffect(() => {
    const animation = gsap.fromTo(
      '.my-element',
      { opacity: 0 },
      { opacity: 1, duration: 1 }
    );

    return () => {
      if (animation && typeof (animation as any).kill === 'function') {
        (animation as any).kill();
      }
    };
  }, []);

  return <div className="my-element">Hello World</div>;
}
'use client';

import { useRef } from 'react';
import Image from 'next/image';
import gsap from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';
import { useGSAP } from '@gsap/react';
import { floatingCardsData } from '@/data/cards.data';
import '@/styles/floating-cards.css';

gsap.registerPlugin(ScrollTrigger);

export default function FloatingCards() {
  const containerRef = useRef<HTMLDivElement>(null);
  const gridRef = useRef<HTMLDivElement>(null);

  useGSAP(
    () => {
      const cards = gsap.utils.toArray('.card-item');

      // 1. Initial Infinite Float Loop
      cards.forEach((card) => {
        const element = card as HTMLElement;
        gsap.to(element, {
          y: '-=20',
          rotationX: 'random(-5, 5)',
          rotationY: 'random(-5, 5)',
          duration: 'random(2, 4)',
          repeat: -1,
          yoyo: true,
          ease: 'sine.inOut',
        });
      });

      // 2. Scroll Parallax (Desacoplado)
      ScrollTrigger.create({
        trigger: gridRef.current,
        start: 'top bottom',
        end: 'bottom top',
        scrub: 1.5,
        onUpdate: (self) => {
          gsap.to(cards, {
            yPercent: (i) => -self.progress * (20 + i * 10),
            ease: 'none',
            overwrite: 'auto',
          });
        },
      });

      // Fade in background on scroll
      gsap.to(containerRef.current, {
        background: '#1a1a3a',
        scrollTrigger: {
          trigger: containerRef.current,
          start: 'top center',
          end: 'bottom center',
          scrub: true,
        },
      });
    },
    { scope: containerRef }
  );

  const handleMouseEnter = (e: React.MouseEvent<HTMLDivElement>) => {
    gsap.to(e.currentTarget, {
      scale: 1.05,
      rotateY: 10,
      rotateX: -5,
      boxShadow: '0 25px 50px rgba(147, 51, 234, 0.4)',
      duration: 0.4,
      ease: 'power2.out',
    });
  };

  const handleMouseLeave = (e: React.MouseEvent<HTMLDivElement>) => {
    gsap.to(e.currentTarget, {
      scale: 1,
      rotateY: 0,
      rotateX: 0,
      boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.37)',
      duration: 0.4,
      ease: 'power2.out',
    });
  };

  return (
    <section
      ref={containerRef}
      className="floating-cards-container relative min-h-screen w-full overflow-hidden bg-[#0f0f23] py-24 px-6 md:px-12"
    >
      <div
        ref={gridRef}
        className="mx-auto grid max-w-[1400px] grid-cols-1 gap-12 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"
      >
        {floatingCardsData.map((card) => (
          <div
            key={card.id}
            className="card-item card-3d-wrapper"
            onMouseEnter={handleMouseEnter}
            onMouseLeave={handleMouseLeave}
            tabIndex={0}
            role="article"
            aria-label={card.title}
          >
            <div className="card-glass relative flex h-[320px] w-full flex-col overflow-hidden rounded-[24px] p-6 transition-colors hover:bg-white/10 group">
              <div className="relative mb-4 h-40 w-full overflow-hidden rounded-[16px]">
                <Image
                  src={card.img}
                  alt={card.title}
                  fill
                  className="object-cover transition-transform duration-700 group-hover:scale-110"
                  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 25vw"
                />
              </div>

              <h3 className="purple-glow-text mb-2 text-xl font-bold text-white transition-colors group-hover:text-[#4fe6ff]">
                {card.title}
              </h3>
              <p className="text-sm leading-relaxed text-gray-300">
                {card.desc}
              </p>

              <div className="absolute top-4 right-4 h-2 w-2 rounded-full bg-[#8705f2] animate-pulse" />
            </div>
          </div>
        ))}
      </div>
    </section>
  );
}
'use client';

import * as React from 'react';
import * as AvatarPrimitive from '@radix-ui/react-avatar';

import { cn } from '@/lib/utils';

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full',
      className
    )}
    {...props}
  />
));
Avatar.displayName = AvatarPrimitive.Root.displayName;

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn('aspect-square h-full w-full', className)}
    {...props}
  />
));
AvatarImage.displayName = AvatarPrimitive.Image.displayName;

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      'flex h-full w-full items-center justify-center rounded-full bg-muted',
      className
    )}
    {...props}
  />
));
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;

export { Avatar, AvatarImage, AvatarFallback };
'use client';

import * as React from 'react';
import * as MenubarPrimitive from '@radix-ui/react-menubar';
import { Check, ChevronRight, Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

function MenubarMenu({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {
  return <MenubarPrimitive.Menu {...props} />;
}

function MenubarGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Group>) {
  return <MenubarPrimitive.Group {...props} />;
}

function MenubarPortal({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {
  return <MenubarPrimitive.Portal {...props} />;
}

function MenubarRadioGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {
  return <MenubarPrimitive.RadioGroup {...props} />;
}

function MenubarSub({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {
  return <MenubarPrimitive.Sub data-slot="menubar-sub" {...props} />;
}

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn(
      'flex h-10 items-center space-x-1 rounded-md border bg-background p-1',
      className
    )}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      className
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      inset && 'pl-8',
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(
  (
    { className, align = 'start', alignOffset = -4, sideOffset = 8, ...props },
    ref
  ) => (
    <MenubarPrimitive.Portal>
      <MenubarPrimitive.Content
        ref={ref}
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          'z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
          className
        )}
        {...props}
      />
    </MenubarPrimitive.Portal>
  )
);
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className
      )}
      {...props}
    />
  );
};
MenubarShortcut.displayname = 'MenubarShortcut';

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};
'use client';
import { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'motion/react';

import { BRAND } from '@/config/brand';

const hexToRgba = (hex: string, alpha = 1) => {
  const cleaned = hex.replace('#', '');
  const longHex =
    cleaned.length === 3
      ? cleaned.replace(/./g, (char) => char + char)
      : cleaned;
  const numeric = parseInt(longHex, 16);
  const r = (numeric >> 16) & 255;
  const g = (numeric >> 8) & 255;
  const b = numeric & 255;
  return `rgba(${r}, ${g}, ${b}, ${alpha})`;
};

const primaryShadowColor = hexToRgba(BRAND.colors.bluePrimary, 0.45);
const accentShadowColor = hexToRgba(BRAND.colors.blueAccent, 0.6);

type Props = {
  /** Controlado: some quando `ready === true` */
  ready?: boolean;
  /** Compatibilidade: encerra sozinho e chama callback */
  onComplete?: () => void;
  /** Duração usada com `onComplete` (ms) */
  durationMs?: number;
  label?: string;
  className?: string;
};

export function Preloader({
  ready,
  onComplete,
  durationMs = 2000,
  label = 'Summoning spirits',
  className,
}: Props) {
  const [show, setShow] = useState(true);

  // Detecção de movimento reduzido
  const [reduced, setReduced] = useState(false);
  useEffect(() => {
    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
    setReduced(mq.matches);
    const handler = (e: MediaQueryListEvent) => setReduced(e.matches);
    mq.addEventListener('change', handler);
    return () => mq.removeEventListener('change', handler);
  }, []);

  useEffect(() => {
    // Modo A: controlado por 'ready'
    if (typeof ready === 'boolean') {
      if (!ready) return;
      const t = setTimeout(() => setShow(false), reduced ? 200 : 800);
      return () => clearTimeout(t);
    }
    // Modo B: compatibilidade com onComplete
    if (onComplete) {
      const t = setTimeout(() => {
        setShow(false);
        try {
          onComplete();
        } catch {}
      }, durationMs);
      return () => clearTimeout(t);
    }
  }, [ready, onComplete, durationMs, reduced]);

  return (
    <AnimatePresence>
      {show && (
        <motion.div
          className={
            'fixed inset-0 z-50 grid place-items-center bg-linear-to-b from-background to-neutral ' +
            (className ?? '')
          }
          initial={{ opacity: 1, filter: 'blur(0px)', scale: 1 }}
          exit={{ opacity: 0, filter: 'blur(20px)', scale: 1.05 }}
          transition={{
            duration: reduced ? 0.3 : 1,
            ease: [0.22, 1, 0.36, 1],
          }}
          role="status"
          aria-live="polite"
        >
          <div className="text-center text-text select-none">
            {/* Ghost Flutuante */}
            <motion.div
              className="mx-auto mb-10 h-24 w-24"
              animate={
                reduced
                  ? {}
                  : {
                      y: [0, -12, 0],
                      opacity: [0.95, 1, 0.95],
                      filter: [
                        `drop-shadow(0 0 15px ${primaryShadowColor})`,
                        `drop-shadow(0 0 25px ${accentShadowColor})`,
                        `drop-shadow(0 0 15px ${primaryShadowColor})`,
                      ],
                    }
              }
              transition={{
                duration: 2.2,
                repeat: Infinity,
                ease: 'easeInOut',
              }}
            >
              <Ghost />
            </motion.div>

            {/* Texto Pulsante */}
            <motion.p
              className="text-[14px] font-mono font-medium uppercase tracking-[0.35em] text-textSecondary mb-8"
              animate={reduced ? {} : { opacity: [0.7, 1, 0.7] }}
              transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
            >
              {label.toUpperCase()}
            </motion.p>

            {/* Barra de Progresso Gradient */}
            <div className="mx-auto w-40 h-px bg-text/20 rounded-full overflow-hidden">
              <motion.div
                className="h-full"
                style={{
                  background: `linear-gradient(90deg, ${BRAND.colors.bluePrimary} 0%, ${BRAND.colors.blueAccent} 100%)`,
                  boxShadow: `0 0 12px ${primaryShadowColor}`,
                }}
                initial={{ width: '0%' }}
                animate={{ width: '100%' }}
                transition={{
                  duration: durationMs / 1000,
                  ease: 'easeInOut',
                }}
              />
            </div>
          </div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}

function Ghost() {
  return (
    <svg viewBox="0 0 512 512" className="w-full h-full">
      <path
        d="m508.374 432.802s-46.6-39.038-79.495-275.781c-8.833-87.68-82.856-156.139-172.879-156.139-90.015 0-164.046 68.458-172.879 156.138-32.895 236.743-79.495 275.782-79.495 275.782-15.107 25.181 20.733 28.178 38.699 27.94 35.254-.478 35.254 40.294 70.516 40.294 35.254 0 35.254-35.261 70.508-35.261s37.396 45.343 72.65 45.343 37.389-45.343 72.651-45.343c35.254 0 35.254 35.261 70.508 35.261s35.27-40.772 70.524-40.294c17.959.238 53.798-2.76 38.692-27.94z"
        fill={BRAND.colors.text}
        opacity="0.95"
      />
      <circle cx="208" cy="225" r="22" fill={BRAND.colors.neutral} />
      <circle cx="297" cy="225" r="22" fill={BRAND.colors.neutral} />
    </svg>
  );
}
'use client';

import * as React from 'react';
import * as DialogPrimitive from '@radix-ui/react-dialog';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      'fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-1.5 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
DialogHeader.displayName = 'DialogHeader';

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
DialogFooter.displayName = 'DialogFooter';

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      'text-lg font-semibold leading-none tracking-tight',
      className
    )}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};
import * as React from 'react';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const badgeVariants = cva(
  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',
  {
    variants: {
      variant: {
        default:
          'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',
        secondary:
          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',
        destructive:
          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',
        outline: 'text-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

export interface BadgeProps
  extends
    React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  );
}

export { Badge, badgeVariants };
'use client';

import * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { VariantProps, cva } from 'class-variance-authority';
import { PanelLeft } from 'lucide-react';

import { useIsMobile } from '@/hooks/use-mobile';
import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Separator } from '@/components/ui/separator';
import { Sheet, SheetContent } from '@/components/ui/sheet';
import { Skeleton } from '@/components/ui/skeleton';
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '@/components/ui/tooltip';

const SIDEBAR_COOKIE_NAME = 'sidebar_state';
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_KEYBOARD_SHORTCUT = 'b';

type SidebarContext = {
  state: 'expanded' | 'collapsed';
  open: boolean;
  setOpen: (_open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (_open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error('useSidebar must be used within a SidebarProvider.');
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (_open: boolean) => void;
  }
>(
  (
    {
      defaultOpen = true,
      open: openProp,
      onOpenChange: setOpenProp,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const isMobile = useIsMobile();
    const [openMobile, setOpenMobile] = React.useState(false);

    // This is the internal state of the sidebar.
    // We use openProp and setOpenProp for control from outside the component.
    const [_open, _setOpen] = React.useState(defaultOpen);
    const open = openProp ?? _open;
    const setOpen = React.useCallback(
      (value: boolean | ((_value: boolean) => boolean)) => {
        const openState = typeof value === 'function' ? value(open) : value;
        if (setOpenProp) {
          setOpenProp(openState);
        } else {
          _setOpen(openState);
        }

        // This sets the cookie to keep the sidebar state.
        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
      },
      [setOpenProp, open]
    );

    // Helper to toggle the sidebar.
    const toggleSidebar = React.useCallback(() => {
      return isMobile
        ? setOpenMobile((open) => !open)
        : setOpen((open) => !open);
    }, [isMobile, setOpen, setOpenMobile]);

    // Adds a keyboard shortcut to toggle the sidebar.
    React.useEffect(() => {
      const handleKeyDown = (event: KeyboardEvent) => {
        if (
          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
          (event.metaKey || event.ctrlKey)
        ) {
          event.preventDefault();
          toggleSidebar();
        }
      };

      window.addEventListener('keydown', handleKeyDown);
      return () => window.removeEventListener('keydown', handleKeyDown);
    }, [toggleSidebar]);

    // We add a state so that we can do data-state="expanded" or "collapsed".
    // This makes it easier to style the sidebar with Tailwind classes.
    const state = open ? 'expanded' : 'collapsed';

    const contextValue = React.useMemo<SidebarContext>(
      () => ({
        state,
        open,
        setOpen,
        isMobile,
        openMobile,
        setOpenMobile,
        toggleSidebar,
      }),
      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
    );

    return (
      <SidebarContext.Provider value={contextValue}>
        <TooltipProvider delayDuration={0}>
          <div
            className={cn(
              'sidebar-provider group/sidebar-wrapper flex min-h-svh w-full has-data-[variant=inset]:bg-sidebar',
              className
            )}
            ref={ref}
            {...props}
          >
            {children}
          </div>
        </TooltipProvider>
      </SidebarContext.Provider>
    );
  }
);
SidebarProvider.displayName = 'SidebarProvider';

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    side?: 'left' | 'right';
    variant?: 'sidebar' | 'floating' | 'inset';
    collapsible?: 'offcanvas' | 'icon' | 'none';
  }
>(
  (
    {
      side = 'left',
      variant = 'sidebar',
      collapsible = 'offcanvas',
      className,
      children,
      ...props
    },
    ref
  ) => {
    const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

    if (collapsible === 'none') {
      return (
        <div
          className={cn(
            'flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground',
            className
          )}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      );
    }

    if (isMobile) {
      return (
        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
          <SheetContent
            data-sidebar="sidebar"
            data-mobile="true"
            className="sidebar-mobile-sheet w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
            side={side}
          >
            <div className="flex h-full w-full flex-col">{children}</div>
          </SheetContent>
        </Sheet>
      );
    }

    return (
      <div
        ref={ref}
        className="group peer hidden md:block text-sidebar-foreground"
        data-state={state}
        data-collapsible={state === 'collapsed' ? collapsible : ''}
        data-variant={variant}
        data-side={side}
      >
        {/* This is what handles the sidebar gap on desktop */}
        <div
          className={cn(
            'duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear',
            'group-data-[collapsible=offcanvas]:w-0',
            'group-data-[side=right]:rotate-180',
            variant === 'floating' || variant === 'inset'
              ? 'group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]'
              : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon]'
          )}
        />
        <div
          className={cn(
            'duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex',
            side === 'left'
              ? 'left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]'
              : 'right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]',
            // Adjust the padding for floating and inset variants.
            variant === 'floating' || variant === 'inset'
              ? 'p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]'
              : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l',
            className
          )}
          {...props}
        >
          <div
            data-sidebar="sidebar"
            className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
          >
            {children}
          </div>
        </div>
      </div>
    );
  }
);
Sidebar.displayName = 'Sidebar';

const SidebarTrigger = React.forwardRef<
  React.ElementRef<typeof Button>,
  React.ComponentProps<typeof Button>
>(({ className, onClick, ...props }, ref) => {
  const { toggleSidebar } = useSidebar();

  return (
    <Button
      ref={ref}
      data-sidebar="trigger"
      variant="ghost"
      size="icon"
      className={cn('h-7 w-7', className)}
      onClick={(event) => {
        onClick?.(event);
        toggleSidebar();
      }}
      {...props}
    >
      <PanelLeft />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  );
});
SidebarTrigger.displayName = 'SidebarTrigger';

const SidebarRail = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'>
>(({ className, ...props }, ref) => {
  const { toggleSidebar } = useSidebar();

  return (
    <button
      ref={ref}
      data-sidebar="rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        'absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex',
        'in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize',
        'in-data-[side=left][data-state=collapsed]:cursor-e-resize in-data-[side=right][data-state=collapsed]:cursor-w-resize',
        'group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar',
        '[[data-side=left][data-collapsible=offcanvas]_&]:-right-2',
        '[[data-side=right][data-collapsible=offcanvas]_&]:-left-2',
        className
      )}
      {...props}
    />
  );
});
SidebarRail.displayName = 'SidebarRail';

const SidebarInset = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'main'>
>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        'relative flex min-h-svh flex-1 flex-col bg-background',
        'peer-data-[variant=inset]:min-h-[calc(100svh-(--spacing(4)))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow',
        className
      )}
      {...props}
    />
  );
});
SidebarInset.displayName = 'SidebarInset';

const SidebarInput = React.forwardRef<
  React.ElementRef<typeof Input>,
  React.ComponentProps<typeof Input>
>(({ className, ...props }, ref) => {
  return (
    <Input
      ref={ref}
      data-sidebar="input"
      className={cn(
        'h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring',
        className
      )}
      {...props}
    />
  );
});
SidebarInput.displayName = 'SidebarInput';

const SidebarHeader = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="header"
      className={cn('flex flex-col gap-2 p-2', className)}
      {...props}
    />
  );
});
SidebarHeader.displayName = 'SidebarHeader';

const SidebarFooter = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="footer"
      className={cn('flex flex-col gap-2 p-2', className)}
      {...props}
    />
  );
});
SidebarFooter.displayName = 'SidebarFooter';

const SidebarSeparator = React.forwardRef<
  React.ElementRef<typeof Separator>,
  React.ComponentProps<typeof Separator>
>(({ className, ...props }, ref) => {
  return (
    <Separator
      ref={ref}
      data-sidebar="separator"
      className={cn('mx-2 w-auto bg-sidebar-border', className)}
      {...props}
    />
  );
});
SidebarSeparator.displayName = 'SidebarSeparator';

const SidebarContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn(
        'flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden',
        className
      )}
      {...props}
    />
  );
});
SidebarContent.displayName = 'SidebarContent';

const SidebarGroup = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="group"
      className={cn('relative flex w-full min-w-0 flex-col p-2', className)}
      {...props}
    />
  );
});
SidebarGroup.displayName = 'SidebarGroup';

const SidebarGroupLabel = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'div';

  return (
    <Comp
      ref={ref}
      data-sidebar="group-label"
      className={cn(
        'duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
        'group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0',
        className
      )}
      {...props}
    />
  );
});
SidebarGroupLabel.displayName = 'SidebarGroupLabel';

const SidebarGroupAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'button';

  return (
    <Comp
      ref={ref}
      data-sidebar="group-action"
      className={cn(
        'absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
        // Increases the hit area of the button on mobile.
        'after:absolute after:-inset-2 after:md:hidden',
        'group-data-[collapsible=icon]:hidden',
        className
      )}
      {...props}
    />
  );
});
SidebarGroupAction.displayName = 'SidebarGroupAction';

const SidebarGroupContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="group-content"
    className={cn('w-full text-sm', className)}
    {...props}
  />
));
SidebarGroupContent.displayName = 'SidebarGroupContent';

const SidebarMenu = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<'ul'>
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu"
    className={cn('flex w-full min-w-0 flex-col gap-1', className)}
    {...props}
  />
));
SidebarMenu.displayName = 'SidebarMenu';

const SidebarMenuItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<'li'>
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    data-sidebar="menu-item"
    className={cn('group/menu-item relative', className)}
    {...props}
  />
));
SidebarMenuItem.displayName = 'SidebarMenuItem';

const sidebarMenuButtonVariants = cva(
  'peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'hover:bg-sidebar-accent hover:text-sidebar-accent-foreground',
        outline:
          'bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]',
      },
      size: {
        default: 'h-8 text-sm',
        sm: 'h-7 text-xs',
        lg: 'h-12 text-sm group-data-[collapsible=icon]:!p-0',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(
  (
    {
      asChild = false,
      isActive = false,
      variant = 'default',
      size = 'default',
      tooltip,
      className,
      ...props
    },
    ref
  ) => {
    const Comp = asChild ? Slot : 'button';
    const { isMobile, state } = useSidebar();

    const button = (
      <Comp
        ref={ref}
        data-sidebar="menu-button"
        data-size={size}
        data-active={isActive}
        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
        {...props}
      />
    );

    if (!tooltip) {
      return button;
    }

    if (typeof tooltip === 'string') {
      tooltip = {
        children: tooltip,
      };
    }

    return (
      <Tooltip>
        <TooltipTrigger asChild>{button}</TooltipTrigger>
        <TooltipContent
          side="right"
          align="center"
          hidden={state !== 'collapsed' || isMobile}
          {...tooltip}
        />
      </Tooltip>
    );
  }
);
SidebarMenuButton.displayName = 'SidebarMenuButton';

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'button';

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        'absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0',
        // Increases the hit area of the button on mobile.
        'after:absolute after:-inset-2 after:md:hidden',
        'peer-data-[size=sm]/menu-button:top-1',
        'peer-data-[size=default]/menu-button:top-1.5',
        'peer-data-[size=lg]/menu-button:top-2.5',
        'group-data-[collapsible=icon]:hidden',
        showOnHover &&
          'group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0',
        className
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = 'SidebarMenuAction';

const SidebarMenuBadge = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="menu-badge"
    className={cn(
      'absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none',
      'peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',
      'peer-data-[size=sm]/menu-button:top-1',
      'peer-data-[size=default]/menu-button:top-1.5',
      'peer-data-[size=lg]/menu-button:top-2.5',
      'group-data-[collapsible=icon]:hidden',
      className
    )}
    {...props}
  />
));
SidebarMenuBadge.displayName = 'SidebarMenuBadge';

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);
  const widthClass = `max-w-[${width}]`;

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn('rounded-md h-8 flex gap-2 px-2 items-center', className)}
      {...props}
    >
      {showIcon && (
        <Skeleton
          className="size-4 rounded-md"
          data-sidebar="menu-skeleton-icon"
        />
      )}
      <Skeleton
        className={cn('h-4 flex-1', widthClass)}
        data-sidebar="menu-skeleton-text"
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = 'SidebarMenuSkeleton';

const SidebarMenuSub = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<'ul'>
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu-sub"
    className={cn(
      'mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5',
      'group-data-[collapsible=icon]:hidden',
      className
    )}
    {...props}
  />
));
SidebarMenuSub.displayName = 'SidebarMenuSub';

const SidebarMenuSubItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<'li'>
>(({ ...props }, ref) => <li ref={ref} {...props} />);
SidebarMenuSubItem.displayName = 'SidebarMenuSubItem';

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<'a'> & {
    asChild?: boolean;
    size?: 'sm' | 'md';
    isActive?: boolean;
  }
>(({ asChild = false, size = 'md', isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : 'a';

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        'flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground',
        'data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground',
        size === 'sm' && 'text-xs',
        size === 'md' && 'text-sm',
        'group-data-[collapsible=icon]:hidden',
        className
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = 'SidebarMenuSubButton';

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};
import * as React from 'react';

import { cn } from '@/lib/utils';

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn('w-full caption-bottom text-sm', className)}
      {...props}
    />
  </div>
));
Table.displayName = 'Table';

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn('[&_tr]:border-b', className)} {...props} />
));
TableHeader.displayName = 'TableHeader';

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn('[&_tr:last-child]:border-0', className)}
    {...props}
  />
));
TableBody.displayName = 'TableBody';

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      'border-t bg-muted/50 font-medium [&>tr]:last:border-b-0',
      className
    )}
    {...props}
  />
));
TableFooter.displayName = 'TableFooter';

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',
      className
    )}
    {...props}
  />
));
TableRow.displayName = 'TableRow';

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      'h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0',
      className
    )}
    {...props}
  />
));
TableHead.displayName = 'TableHead';

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn('p-4 align-middle [&:has([role=checkbox])]:pr-0', className)}
    {...props}
  />
));
TableCell.displayName = 'TableCell';

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn('mt-4 text-sm text-muted-foreground', className)}
    {...props}
  />
));
TableCaption.displayName = 'TableCaption';

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
};
'use client';

import * as React from 'react';
import * as SeparatorPrimitive from '@radix-ui/react-separator';

import { cn } from '@/lib/utils';

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = 'horizontal', decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        'shrink-0 bg-border',
        orientation === 'horizontal' ? 'h-[1px] w-full' : 'h-full w-[1px]',
        className
      )}
      {...props}
    />
  )
);
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };
import * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const buttonVariants = cva(
  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive:
          'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline:
          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary:
          'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

export interface ButtonProps
  extends
    React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button';
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    );
  }
);
Button.displayName = 'Button';

export { Button, buttonVariants };
'use client';

import React, { useRef, useState, type MouseEvent } from 'react';
import { motion } from 'framer-motion';
import { ArrowUpRight } from 'lucide-react';

/**
 * AntigravityCTA - Botão CTA inspirado em Lo&Behold Studio
 *
 * Características principais:
 * - Pílula e círculo separados mas conectados na ponta
 * - Animação ao hover: círculo se afasta da pílula (x: +8px)
 * - Ícone rotaciona de -45° para 0° simultaneamente
 * - Spring physics: stiffness 300, damping 25
 *
 * @param text - Texto do botão (default: "let's build something great")
 * @param href - URL de destino
 * @param onClick - Callback ao clicar
 * @param className - Classes CSS customizadas (sobrescreve posicionamento padrão)
 */

interface AntigravityCTAProps {
  text?: string;
  href?: string;
  onClick?: (_event: MouseEvent<HTMLAnchorElement>) => void;
  className?: string;
}

const AntigravityCTA: React.FC<AntigravityCTAProps> = ({
  text = "let's build something great",
  href = '/',
  onClick,
  // Mobile: bottom-20 para evitar gesture bar, right-4 para edge comfort
  // Desktop: posição original
  className = 'fixed bottom-20 right-4 sm:bottom-12 sm:right-8 lg:bottom-12 lg:right-12 z-100 md:z-50',
}) => {
  // State para controlar hover
  const [isHovered, setIsHovered] = useState(false);
  const iconRef = useRef<HTMLDivElement>(null);

  // Spring physics config
  const springTransition = {
    type: 'spring' as const,
    stiffness: 300,
    damping: 25,
  };

  // Variantes de animação do ícone (rotação + movimento para direita)
  const arrowVariants = {
    initial: { rotate: -45, x: 0 },
    hover: { rotate: 0, x: 8 }, // Move 8px para direita criando gap
  };

  // Variantes de animação do botão completo
  const buttonVariants = {
    initial: { scale: 1, y: 0 },
    hover: { scale: 1.02, y: -2 },
  };

  return (
    <motion.a
      href={href}
      onClick={onClick}
      className={`
        relative group 
        inline-flex items-center 
        cursor-pointer 
        focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-blue-500/50 focus-visible:ring-offset-2 focus-visible:ring-offset-background
        ${className}
      `}
      onHoverStart={() => setIsHovered(true)}
      onHoverEnd={() => setIsHovered(false)}
      variants={buttonVariants}
      initial="initial"
      animate={isHovered ? 'hover' : 'initial'}
      transition={springTransition}
      role="button"
      tabIndex={0}
      aria-label={`${text} - Clique para acessar`}
    >
      {/* Ghost Glow - Apenas no hover, muito sutil */}
      <motion.div
        className="absolute inset-0 rounded-full blur-2xl opacity-0 pointer-events-none"
        style={{ backgroundColor: '#8705f2' }}
        animate={{
          opacity: isHovered ? 0.2 : 0,
          scale: isHovered ? 1.3 : 1,
        }}
        transition={springTransition}
      />

      {/* Pílula de Texto - Mobile-First Sizing */}
      <motion.div
        className="
          relative z-10 
          flex items-center justify-center 
          h-12 sm:h-14 lg:h-[68px]
          pl-5 pr-4 sm:pl-8 sm:pr-6 lg:pl-10 lg:pr-8
          min-w-cta-mobile sm:min-w-cta-tablet lg:min-w-cta-desktop
          text-white 
          shadow-lg
          rounded-full
          select-none
          transition-colors duration-200
          active:scale-[0.98]
        "
        style={{
          backgroundColor: isHovered ? '#8705f2' : '#0048ff',
        }}
      >
        <span className="text-sm sm:text-base lg:text-lg font-medium tracking-wide sm:tracking-wider whitespace-nowrap leading-none font-sans">
          {text}
        </span>
      </motion.div>

      {/* Círculo com Ícone - Mobile-First Touch Target (min 48px) */}
      <motion.div
        ref={iconRef}
        className="
          relative z-20 
          flex items-center justify-center 
          h-12 w-12 sm:h-14 sm:w-14 lg:h-[68px] lg:w-[68px]
          -ml-0.5 sm:-ml-1
          text-white 
          shadow-lg
          rounded-full
          transition-colors duration-200
          active:scale-95
        "
        style={{
          backgroundColor: isHovered ? '#8705f2' : '#0048ff',
        }}
        variants={arrowVariants}
        initial="initial"
        animate={isHovered ? 'hover' : 'initial'}
        transition={springTransition}
      >
        <ArrowUpRight
          className="w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7"
          strokeWidth={2.5}
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </motion.div>
    </motion.a>
  );
};

export default AntigravityCTA;
'use client';

import * as React from 'react';
import * as ToastPrimitives from '@radix-ui/react-toast';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      'fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]',
      className
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',
  {
    variants: {
      variant: {
        default: 'border bg-background text-foreground',
        destructive:
          'destructive group border-destructive bg-destructive text-destructive-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  );
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',
      className
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn('text-sm font-semibold', className)}
    {...props}
  />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn('text-sm opacity-90', className)}
    {...props}
  />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};
'use client';

import * as React from 'react';
import * as CheckboxPrimitive from '@radix-ui/react-checkbox';
import { Check } from 'lucide-react';

import { cn } from '@/lib/utils';

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      'peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground',
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn('flex items-center justify-center text-current')}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };
'use client';

import * as CollapsiblePrimitive from '@radix-ui/react-collapsible';

const Collapsible = CollapsiblePrimitive.Root;

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger;

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent;

export { Collapsible, CollapsibleTrigger, CollapsibleContent };
'use client';

import * as React from 'react';
import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';
import { Check, ChevronRight, Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
      inset && 'pl-8',
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn('ml-auto text-xs tracking-widest opacity-60', className)}
      {...props}
    />
  );
};
DropdownMenuShortcut.displayName = 'DropdownMenuShortcut';

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};
'use client';

import * as React from 'react';
import * as SelectPrimitive from '@radix-ui/react-select';
import { Check, ChevronDown, ChevronUp } from 'lucide-react';

import { cn } from '@/lib/utils';

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = 'popper', ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        'relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        position === 'popper' &&
          'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          'p-1',
          position === 'popper' &&
            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]'
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn('py-1.5 pl-8 pr-2 text-sm font-semibold', className)}
    {...props}
  />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};
import * as React from 'react';

import { cn } from '@/lib/utils';

const Textarea = React.forwardRef<
  HTMLTextAreaElement,
  React.ComponentProps<'textarea'>
>(({ className, ...props }, ref) => {
  return (
    <textarea
      className={cn(
        'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
        className
      )}
      ref={ref}
      {...props}
    />
  );
});
Textarea.displayName = 'Textarea';

export { Textarea };
import * as React from 'react';

import { cn } from '@/lib/utils';

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<'input'>>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Input.displayName = 'Input';

export { Input };
import { cn } from '@/lib/utils';

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn('animate-pulse rounded-md bg-muted', className)}
      {...props}
    />
  );
}

export { Skeleton };
'use client';

import React, {
  Component,
  type PropsWithChildren,
  type ErrorInfo,
} from 'react';

interface ErrorBoundaryState {
  hasError: boolean;
  error: Error | null;
  errorInfo: ErrorInfo | null;
}

/**
 * ErrorBoundary component to catch and display React errors in production.
 * Especially for debugging Error #62 (style prop as string).
 */
export default class ErrorBoundary extends Component<
  PropsWithChildren,
  ErrorBoundaryState
> {
  constructor(props: PropsWithChildren) {
    super(props);
    this.state = { hasError: false, error: null, errorInfo: null };
  }

  static getDerivedStateFromError(error: Error): Partial<ErrorBoundaryState> {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('=== ERROR BOUNDARY CAUGHT ===');
    console.error('Error:', error);
    console.error('Error Message:', error.message);
    console.error('Error Stack:', error.stack);
    console.error('Component Stack:', errorInfo.componentStack);
    console.error('=== END ERROR BOUNDARY ===');

    this.setState({ errorInfo });
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="min-h-screen bg-red-900/20 flex items-center justify-center p-8">
          <div className="max-w-2xl w-full bg-black/90 text-white p-8 rounded-xl">
            <h1 className="text-2xl font-bold mb-4 text-red-400">
              🚨 Something went wrong
            </h1>

            <div className="mb-4 p-4 bg-red-900/30 rounded-lg">
              <p className="font-mono text-sm break-all">
                <strong>Error:</strong> {this.state.error?.message}
              </p>
            </div>

            {this.state.error?.stack && (
              <details className="mb-4">
                <summary className="cursor-pointer text-yellow-400 hover:text-yellow-300">
                  View full error stack
                </summary>
                <pre className="mt-2 p-4 bg-gray-900 text-xs overflow-auto max-h-64 rounded">
                  {this.state.error.stack}
                </pre>
              </details>
            )}

            {this.state.errorInfo?.componentStack && (
              <details className="mb-4">
                <summary className="cursor-pointer text-yellow-400 hover:text-yellow-300">
                  View component stack
                </summary>
                <pre className="mt-2 p-4 bg-gray-900 text-xs overflow-auto max-h-64 rounded whitespace-pre-wrap">
                  {this.state.errorInfo.componentStack}
                </pre>
              </details>
            )}

            <div className="flex gap-4 mt-6">
              <button
                onClick={() => window.location.reload()}
                className="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded text-white font-medium"
              >
                Reload Page
              </button>
              <button
                onClick={() => {
                  this.setState({
                    hasError: false,
                    error: null,
                    errorInfo: null,
                  });
                }}
                className="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white font-medium"
              >
                Try Again
              </button>
            </div>
          </div>
        </div>
      );
    }

    return this.props.children;
  }
}
'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { Slot } from '@radix-ui/react-slot';
import {
  Controller,
  FormProvider,
  useFormContext,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from 'react-hook-form';

import { cn } from '@/lib/utils';
import { Label } from '@/components/ui/label';

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error('useFormField should be used within <FormField>');
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
);

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId();

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn('space-y-2', className)} {...props} />
    </FormItemContext.Provider>
  );
});
FormItem.displayName = 'FormItem';

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return (
    <Label
      ref={ref}
      className={cn(error && 'text-destructive', className)}
      htmlFor={formItemId}
      {...props}
    />
  );
});
FormLabel.displayName = 'FormLabel';

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } =
    useFormField();

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  );
});
FormControl.displayName = 'FormControl';

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField();

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn('text-sm text-muted-foreground', className)}
      {...props}
    />
  );
});
FormDescription.displayName = 'FormDescription';

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField();
  const body = error ? String(error?.message ?? '') : children;

  if (!body) {
    return null;
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn('text-sm font-medium text-destructive', className)}
      {...props}
    >
      {body}
    </p>
  );
});
FormMessage.displayName = 'FormMessage';

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
};
'use client';

import * as React from 'react';
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from 'embla-carousel-react';
import { ArrowLeft, ArrowRight } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: 'horizontal' | 'vertical';
  setApi?: (_api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error('useCarousel must be used within a <Carousel />');
  }

  return context;
}

const Carousel = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & CarouselProps
>(
  (
    {
      orientation = 'horizontal',
      opts,
      setApi,
      plugins,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === 'horizontal' ? 'x' : 'y',
      },
      plugins
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === 'ArrowLeft') {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === 'ArrowRight') {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext]
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on('reInit', onSelect);
      api.on('select', onSelect);

      return () => {
        api?.off('select', onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api,
          opts,
          orientation:
            orientation || (opts?.axis === 'y' ? 'vertical' : 'horizontal'),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn('relative', className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  }
);
Carousel.displayName = 'Carousel';

const CarouselContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel();

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div
        ref={ref}
        className={cn(
          'flex',
          orientation === 'horizontal' ? '-ml-4' : '-mt-4 flex-col',
          className
        )}
        {...props}
      />
    </div>
  );
});
CarouselContent.displayName = 'CarouselContent';

const CarouselItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel();

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn(
        'min-w-0 shrink-0 grow-0 basis-full',
        orientation === 'horizontal' ? 'pl-4' : 'pt-4',
        className
      )}
      {...props}
    />
  );
});
CarouselItem.displayName = 'CarouselItem';

const CarouselPrevious = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel();

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute  h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-left-12 top-1/2 -translate-y-1/2'
          : '-top-12 left-1/2 -translate-x-1/2 rotate-90',
        className
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft className="h-4 w-4" />
      <span className="sr-only">Previous slide</span>
    </Button>
  );
});
CarouselPrevious.displayName = 'CarouselPrevious';

const CarouselNext = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollNext, canScrollNext } = useCarousel();

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-right-12 top-1/2 -translate-y-1/2'
          : '-bottom-12 left-1/2 -translate-x-1/2 rotate-90',
        className
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight className="h-4 w-4" />
      <span className="sr-only">Next slide</span>
    </Button>
  );
});
CarouselNext.displayName = 'CarouselNext';

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
};
'use client';

import { motion, useReducedMotion } from 'framer-motion';
import Image from 'next/image';
import { HOME_CONTENT } from '@/config/content';

/**
 * ClientsBrandsSection - Exibe logotipos das marcas/clientes
 * Segue o Ghost System v3.0 com animações sutis e responsividade
 */
export default function ClientsBrandsSection() {
  const reducedMotion = useReducedMotion();
  const logos = HOME_CONTENT.clients.logos.slice(0, 12);

  return (
    <section
      id="clients"
      className="bg-[#0048ff] py-16 md:py-20 lg:py-24 relative z-10 overflow-hidden"
      aria-labelledby="clients-heading"
    >
      {/* Container usando std-grid padrão do projeto */}
      <div className="std-grid">
        {/* Título da seção */}
        <motion.div
          initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 16 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{
            duration: 0.6,
            ease: [0.22, 1, 0.36, 1] as [number, number, number, number],
          }}
          className="mb-10 md:mb-16 lg:mb-20"
        >
          <h2
            id="clients-heading"
            className="text-white text-[1.5rem] md:text-[2rem] font-bold text-center tracking-tight leading-tight lowercase"
          >
            {HOME_CONTENT.clients.title}
          </h2>
        </motion.div>

        {/* Grid de Logos com acessibilidade */}
        <motion.ul
          role="list"
          aria-label="Logotipos das marcas parceiras"
          initial="hidden"
          whileInView="show"
          viewport={{ once: true, margin: '-10%' }}
          variants={{
            hidden: {},
            show: {
              transition: {
                staggerChildren: 0.08,
                delayChildren: 0.1,
              },
            },
          }}
          className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6 sm:gap-8 md:gap-12 items-center justify-items-center w-full"
        >
          {logos.map((logo) => {
            const isSvg = logo.src?.toLowerCase().endsWith('.svg');

            return (
              <motion.li
                key={logo.id}
                role="listitem"
                variants={{
                  hidden: { opacity: 0, y: 20, filter: 'blur(4px)' },
                  show: {
                    opacity: 1,
                    y: 0,
                    filter: 'blur(0px)',
                    transition: {
                      duration: 0.8,
                      ease: [0.22, 1, 0.36, 1],
                    },
                  },
                }}
              >
                <div className="group relative w-28 h-14 sm:w-32 sm:h-16 md:w-40 md:h-20 flex items-center justify-center">
                  <Image
                    src={logo.src || ''}
                    alt={logo.alt}
                    fill
                    className="w-full h-full object-contain filter brightness-0 invert opacity-60 transition-all duration-500 group-hover:opacity-100 group-hover:scale-110 will-change-transform"
                    sizes="(max-width: 640px) 112px, (max-width: 768px) 128px, 160px"
                    loading="lazy"
                    unoptimized={isSvg}
                  />
                </div>
              </motion.li>
            );
          })}
        </motion.ul>
      </div>
    </section>
  );
}
'use client';

import React from 'react';

interface InputFieldProps extends React.InputHTMLAttributes<HTMLInputElement> {
  label: string;
  error?: string;
}

export const InputField: React.FC<InputFieldProps> = ({
  label,
  error,
  id,
  className = '',
  ...props
}) => (
  <div>
    <label
      htmlFor={id}
      className="block text-[13px] font-bold text-[#111111]/60 mb-2 uppercase tracking-wider"
    >
      {label}
    </label>
    <input
      id={id}
      aria-invalid={!!error}
      aria-describedby={error ? `${id}-error` : undefined}
      className={`w-full min-h-[48px] rounded-lg border border-[#111111]/10 bg-[#f8fafc] px-4 py-4 text-[#111111] placeholder:text-[#111111]/30 transition-all outline-none focus:border-[#0057FF] focus:ring-2 focus:ring-[#0057FF]/20 ${
        error ? 'border-red-500' : ''
      } ${className}`}
      {...props}
    />
    {error && (
      <p
        id={`${id}-error`}
        className="mt-2 text-xs text-red-500 font-bold uppercase"
      >
        {error}
      </p>
    )}
  </div>
);

interface TextAreaFieldProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {
  label: string;
  error?: string;
}

export const TextAreaField: React.FC<TextAreaFieldProps> = ({
  label,
  error,
  id,
  className = '',
  ...props
}) => (
  <div>
    <label
      htmlFor={id}
      className="block text-[13px] font-bold text-[#111111]/60 mb-2 uppercase tracking-wider"
    >
      {label}
    </label>
    <textarea
      id={id}
      aria-invalid={!!error}
      aria-describedby={error ? `${id}-error` : undefined}
      className={`w-full resize-none rounded-lg border border-[#111111]/10 bg-[#f8fafc] px-4 py-4 text-[#111111] placeholder:text-[#111111]/30 transition-all outline-none focus:border-[#0057FF] focus:ring-2 focus:ring-[#0057FF]/20 min-h-[120px] ${
        error ? 'border-red-500' : ''
      } ${className}`}
      {...props}
    />
    {error && (
      <p
        id={`${id}-error`}
        className="mt-2 text-xs text-red-500 font-bold uppercase"
      >
        {error}
      </p>
    )}
  </div>
);
'use client';

import React, { useState } from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import { InputField, TextAreaField } from './FormFields';
import { CONTACT_FORM } from '@/config/navigation';

const ContactForm: React.FC = () => {
  const prefersReducedMotion = useReducedMotion();
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    phone: '',
    message: '',
  });
  const [errors, setErrors] = useState<Record<string, string>>({});
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [submitSuccess, setSubmitSuccess] = useState(false);

  const validateField = (name: string, value: string) => {
    switch (name) {
      case 'name':
        return value.trim() ? '' : 'Nome é obrigatório';
      case 'email':
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(value) ? '' : 'Email inválido';
      case 'message':
        return value.trim().length >= 10
          ? ''
          : 'Mensagem deve ter pelo menos 10 caracteres';
      default:
        return '';
    }
  };

  const handleChange = (
    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>
  ) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));

    if (errors[name]) {
      setErrors((prev) => {
        const newErrors = { ...prev };
        delete newErrors[name];
        return newErrors;
      });
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    const newErrors: Record<string, string> = {};
    Object.entries(formData).forEach(([key, value]) => {
      const error = validateField(key, value);
      if (error) newErrors[key] = error;
    });

    if (Object.keys(newErrors).length > 0) {
      setErrors(newErrors);
      return;
    }

    setIsSubmitting(true);

    try {
      const formDataToSend = new FormData();
      Object.entries(formData).forEach(([key, value]) => {
        formDataToSend.append(key, value);
      });

      const response = await fetch(
        `${CONTACT_FORM.action.replace('formsubmit.co/', 'formsubmit.co/ajax/')}`,
        {
          method: 'POST',
          body: formDataToSend,
        }
      );

      if (response.ok) {
        setSubmitSuccess(true);
        setFormData({ name: '', email: '', phone: '', message: '' });
        setTimeout(() => setSubmitSuccess(false), 5000);
      } else {
        throw new Error('Submission failed');
      }
    } catch {
      setErrors({
        submit: 'Falha ao enviar mensagem. Por favor tente novamente.',
      });
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <motion.div
      initial={prefersReducedMotion ? {} : { opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      viewport={{ once: true, margin: '-50px' }}
      transition={{ duration: 0.6, ease: [0.22, 1, 0.36, 1] }}
      className="w-full max-w-[640px] mx-auto lg:ml-auto bg-white p-8 md:p-12 rounded-[24px] shadow-sm border border-textInverse/5"
    >
      <div className="p-0">
        {submitSuccess ? (
          <div className="text-center py-12">
            <div className="inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600 mb-6">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                className="h-10 w-10"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth={2}
                  d="M5 13l4 4L19 7"
                />
              </svg>
            </div>
            <h3 className="text-3xl font-bold text-textInverse mb-4">
              Mensagem Enviada!
            </h3>
            <p className="text-textInverse/60 text-lg">
              Obrigado pelo contato. Responderei o mais breve possível.
            </p>
          </div>
        ) : (
          <form
            onSubmit={handleSubmit}
            action={CONTACT_FORM.action}
            method="POST"
            className="space-y-8"
          >
            <noscript>
              <p className="p-4 mb-4 text-sm text-amber-800 bg-amber-50 rounded-lg">
                JavaScript está desativado. O formulário será enviado via
                redirecionamento padrão.
              </p>
            </noscript>
            <input
              type="text"
              name="_honey"
              className="hidden"
              aria-hidden="true"
              tabIndex={-1}
              title="Ignore this field"
              autoComplete="off"
            />
            <input type="hidden" name="_captcha" value="false" />

            <div className="grid grid-cols-1 gap-8">
              <InputField
                label="Seu nome"
                id="name"
                name="name"
                value={formData.name}
                onChange={handleChange}
                error={errors.name}
                required
                autoComplete="name"
                placeholder="João da Silva"
              />

              <InputField
                label="Seu email"
                id="email"
                name="email"
                type="email"
                value={formData.email}
                onChange={handleChange}
                error={errors.email}
                required
                autoComplete="email"
                placeholder="joao@empresa.com"
              />

              <InputField
                label="Telefone"
                id="phone"
                name="phone"
                type="tel"
                value={formData.phone}
                onChange={handleChange}
                error={errors.phone}
                placeholder="(11) 99999-9999"
              />

              <TextAreaField
                label="Sua mensagem"
                id="message"
                name="message"
                value={formData.message}
                onChange={handleChange}
                error={errors.message}
                required
                rows={4}
                placeholder="Conte-me sobre seu projeto..."
              />
            </div>

            {errors.submit && (
              <p className="text-sm text-red-500 font-bold uppercase">
                {errors.submit}
              </p>
            )}

            <motion.button
              type="submit"
              disabled={isSubmitting}
              whileHover={{ y: -1, scale: 1.02 }}
              whileTap={{ scale: 0.98 }}
              className="w-full h-[60px] md:h-[64px] flex items-center justify-center gap-3 bg-[#0048ff] text-white font-bold rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#0048ff] focus-visible:ring-offset-2 tracking-tight text-lg shadow-[0_10px_30px_-10px_rgba(0,72,255,0.3)]"
            >
              {isSubmitting ? 'Enviando...' : 'Enviar Mensagem'}
              {!isSubmitting && (
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  className="h-5 w-5 ml-1"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  aria-hidden="true"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M14 5l7 7m0 0l-7 7m7-7H3"
                  />
                </svg>
              )}
            </motion.button>
          </form>
        )}
      </div>
    </motion.div>
  );
};

export default ContactForm;
import { FC } from 'react';
import { motion } from 'framer-motion';
import { SOCIALS } from '@/config/navigation';
import { Button } from '@/components/ui/button';
import {
  Mail,
  MapPin,
  Linkedin,
  Instagram,
  Twitter,
  Facebook,
} from 'lucide-react';

const ContactDetails: FC = () => {
  const contactInfo = [
    {
      label: SOCIALS.emailPrimary.replace('mailto:', ''),
      href: SOCIALS.emailPrimary,
      icon: <Mail className="w-5 h-5" />,
    },
    // {
    //   label: SOCIALS.phone?.replace('tel:', '') || '',
    //   href: SOCIALS.phone || '#',
    //   icon: <Phone className="w-5 h-5" />,
    // },
    {
      label: 'São Paulo, SP',
      href: '#',
      icon: <MapPin className="w-5 h-5" />,
    },
  ];

  /* Helper for social icons matching Footer logic or reusing specific list */
  const socialList = [
    {
      platform: 'LinkedIn',
      url: SOCIALS.linkedin,
      icon: <Linkedin className="w-5 h-5" />,
    },
    {
      platform: 'Instagram',
      url: SOCIALS.instagram,
      icon: <Instagram className="w-5 h-5" />,
    },
    {
      platform: 'Facebook',
      url: SOCIALS.facebook,
      icon: <Facebook className="w-5 h-5" />,
    },
    {
      platform: 'Twitter',
      url: SOCIALS.twitter,
      icon: <Twitter className="w-5 h-5" />,
    },
  ];

  return (
    <motion.div
      initial={{ opacity: 0, x: -30 }}
      whileInView={{ opacity: 1, x: 0 }}
      viewport={{ once: true, margin: '-50px' }}
      transition={{ duration: 0.8, ease: [0.22, 1, 0.36, 1] }}
    >
      <div className="space-y-6 flex flex-col items-center md:items-start w-full">
        {contactInfo.map((item, idx) => (
          <Button
            key={idx}
            variant="ghost"
            asChild
            className="justify-start text-lg font-medium text-text-dark hover:text-primary hover:bg-black/5 gap-4 h-auto py-3 px-4"
          >
            <a href={item.href}>
              <span className="rounded-full bg-blue-50 p-2 text-primary shadow-sm group-hover:scale-110 transition-transform">
                {item.icon}
              </span>
              {item.label}
            </a>
          </Button>
        ))}
      </div>

      <div className="flex gap-4 justify-center md:justify-start">
        {socialList.map((social) => (
          <Button
            key={social.platform}
            variant="secondary"
            size="icon"
            asChild
            className="rounded-full bg-gray-100 text-text-dark shadow-sm hover:text-primary hover:bg-gray-200 h-12 w-12 border border-black/5"
          >
            <a
              href={social.url}
              target="_blank"
              rel="noopener noreferrer"
              aria-label={social.platform}
            >
              {social.icon}
            </a>
          </Button>
        ))}
      </div>
    </motion.div>
  );
};

export default ContactDetails;
'use client';

import React from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import {
  Mail,
  Phone,
  Instagram,
  Linkedin,
  Twitter,
  Facebook,
  Globe,
} from 'lucide-react';

import { BRAND } from '@/config/brand';
import { HOME_CONTENT } from '@/config/content';
import { SOCIALS } from '@/config/navigation';
import ContactForm from './ContactForm';
import { Container } from '@/components/layout/Container';

export default function ContactSection() {
  const reducedMotion = useReducedMotion();

  const contactLinks = [
    {
      label: SOCIALS.phone,
      href: `tel:${SOCIALS.phone.replace(/\D/g, '')}`,
      icon: <Phone className="h-5 w-5" aria-hidden="true" />,
      ariaLabel: `Ligar para ${SOCIALS.phone}`,
    },
    {
      label: SOCIALS.emailPrimary.replace('mailto:', ''),
      href: SOCIALS.emailPrimary,
      icon: <Mail className="h-5 w-5" aria-hidden="true" />,
      ariaLabel: `Enviar email para ${SOCIALS.emailPrimary.replace('mailto:', '')}`,
    },
    {
      label: SOCIALS.emailSecondary.replace('mailto:', ''),
      href: SOCIALS.emailSecondary,
      icon: <Mail className="h-5 w-5" aria-hidden="true" />,
      ariaLabel: `Enviar email para ${SOCIALS.emailSecondary.replace('mailto:', '')}`,
    },
  ];

  const socialLinks = [
    {
      label: 'Instagram',
      href: SOCIALS.instagram,
      icon: <Instagram className="h-5 w-5" aria-hidden="true" />,
    },
    {
      label: 'Facebook',
      href: SOCIALS.facebook,
      icon: <Facebook className="h-5 w-5" aria-hidden="true" />,
    },
    {
      label: 'LinkedIn',
      href: SOCIALS.linkedin,
      icon: <Linkedin className="h-5 w-5" aria-hidden="true" />,
    },
    {
      label: 'Twitter',
      href: SOCIALS.twitter,
      icon: <Twitter className="h-5 w-5" aria-hidden="true" />,
    },
    {
      label: 'Portfolio',
      href: `https://${BRAND.domain}`,
      icon: <Globe className="h-5 w-5" aria-hidden="true" />,
    },
  ];

  return (
    <section
      id="contact"
      data-light-section
      aria-label="Contato"
      className="bg-[#f0f0f0] py-12 sm:py-16 md:py-24 lg:py-32 relative z-10"
    >
      <Container>
        {/* 2 & 3. Info & Form Grid */}
        <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 lg:gap-24 items-start">
          {/* Left Side: Headline + Contact Info */}
          <motion.div
            initial={
              reducedMotion ? { opacity: 1, y: 0 } : { opacity: 0, y: 24 }
            }
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.6, delay: 0.1 }}
            className="lg:col-span-5 flex flex-col space-y-10 order-1 md:order-1 lg:order-0"
          >
            {/* Header */}
            <div className="text-center lg:text-left mb-6 lg:mb-10">
              <h2 className="text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-bold text-[#0057FF] uppercase tracking-tighter mb-4 leading-[0.9]">
                {HOME_CONTENT.contact.title}
              </h2>
              <p className="text-[#111111] text-lg md:text-xl font-medium max-w-md mx-auto lg:mx-0">
                {HOME_CONTENT.contact.subtitle}
              </p>
            </div>

            {/* Direct Channels */}
            <div className="flex flex-col space-y-6">
              {contactLinks.map((link) => (
                <a
                  key={link.href}
                  href={link.href}
                  target={link.href.startsWith('http') ? '_blank' : undefined}
                  rel={
                    link.href.startsWith('http')
                      ? 'noopener noreferrer'
                      : undefined
                  }
                  aria-label={link.ariaLabel}
                  className="flex items-center gap-3 sm:gap-4 group w-fit py-2 active:opacity-80 transition-opacity"
                >
                  {/* Touch target: 48px minimum */}
                  <span className="flex h-12 w-12 sm:h-12 sm:w-12 items-center justify-center rounded-full bg-transparent border-2 border-[#0057FF] text-[#0057FF] transition-all duration-200 group-hover:bg-[#0057FF] group-hover:text-white group-active:bg-[#0057FF] group-active:text-white group-active:scale-95">
                    {link.icon}
                  </span>
                  <span className="text-base sm:text-lg md:text-xl font-semibold text-[#111111] transition-all duration-200 group-hover:text-[#0057FF] group-hover:underline group-hover:underline-offset-4">
                    {link.label}
                  </span>
                </a>
              ))}
            </div>

            {/* Social Icons (Desktop) */}
            <div className="hidden lg:flex flex-wrap items-center gap-4 pt-10 border-t border-[#0e0e0e]/20">
              {socialLinks.map((social) => (
                <a
                  key={social.href}
                  href={social.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  aria-label={social.label}
                  className="flex h-14 w-14 items-center justify-center rounded-full border border-[#0e0e0e]/30 bg-transparent text-[#0e0e0e] transition-all hover:border-[#0048ff] hover:bg-[#0048ff] hover:text-white hover:scale-110"
                >
                  {social.icon}
                </a>
              ))}
            </div>
          </motion.div>

          {/* Mobile Socials - Touch-optimized with 48px targets */}
          <div className="lg:hidden flex flex-wrap justify-center gap-3 sm:gap-4 py-6 sm:py-8 border-t border-[#0e0e0e]/20 w-full order-2">
            {socialLinks.map((social) => (
              <a
                key={`mobile-${social.href}`}
                href={social.href}
                target="_blank"
                rel="noopener noreferrer"
                aria-label={social.label}
                className="flex h-12 w-12 items-center justify-center rounded-full border-2 border-[#0e0e0e]/30 bg-transparent text-[#0e0e0e] shadow-sm transition-all duration-200 active:scale-90 active:bg-[#0048ff] active:border-[#0048ff] active:text-white"
              >
                {social.icon}
              </a>
            ))}
          </div>

          {/* Right Side: Form */}
          <div className="lg:col-span-7 w-full order-3 lg:order-0">
            <ContactForm />
          </div>
        </div>
      </Container>
    </section>
  );
}
'use client';

import { useRef, useState } from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import AntigravityCTA from '@/components/ui/AntigravityCTA';
import { Container } from '@/components/layout/Container';
import { CategoryStripe } from './CategoryStripe';
import { getAssetUrl } from '@/utils/utils';
import { GHOST_EASE } from '@/config/motion';

// Category data with assets
const CATEGORIES = [
  {
    id: 'brand-campaigns',
    title: 'Brand & Campaigns',
    slug: 'branding',
    thumbnail: getAssetUrl('site-assets/home/showcase/Branding-Project.webp'),
    alignment: 'right' as const,
    showLabel: true, // Show floating label on this stripe
  },
  {
    id: 'videos-motions',
    title: 'Videos & Motions',
    slug: 'motion',
    thumbnail: getAssetUrl('site-assets/home/showcase/show.video.mp4'),
    alignment: 'center' as const,
    showLabel: false,
  },
  {
    id: 'websites-tech',
    title: ['Web Campaigns,', 'Websites & Tech'],
    slug: 'web',
    thumbnail: getAssetUrl('site-assets/home/showcase/webdesigner-2.gif'),
    alignment: 'left' as const,
    showLabel: false,
  },
] as const;

/**
 * Portfolio Showcase Section
 * Lo&Behold inspired accordion stripes with category navigation
 */
export default function PortfolioShowcase() {
  const sectionRef = useRef<HTMLElement>(null);
  const [hoveredCategory, setHoveredCategory] = useState<string | null>(null);
  const prefersReducedMotion = !!useReducedMotion();

  return (
    <section
      id="portfolio-showcase"
      ref={sectionRef}
      className="relative w-full bg-background py-20 lg:py-32"
      aria-labelledby="portfolio-showcase-heading"
    >
      <Container>
        {/* Headline - "portfólio" italic, "showcase" normal */}
        <motion.header
          initial={
            prefersReducedMotion ? { opacity: 1 } : { opacity: 0, y: 30 }
          }
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.7, ease: GHOST_EASE }}
          className="text-center mb-10 lg:mb-14"
        >
          <h2
            id="portfolio-showcase-heading"
            className="text-4xl md:text-5xl lg:text-6xl xl:text-7xl tracking-tight"
          >
            <span className="text-white italic font-light">portfólio </span>
            <span className="text-bluePrimary font-bold">showcase</span>
          </h2>
        </motion.header>

        {/* Category Stripes */}
        <div className="relative flex flex-col">
          {CATEGORIES.map((category, index) => (
            <CategoryStripe
              key={category.id}
              category={category}
              index={index}
              isHovered={hoveredCategory === category.id}
              onHover={setHoveredCategory}
              prefersReducedMotion={prefersReducedMotion}
            />
          ))}

          {/* Bottom border */}
          <div className="border-t border-blueAccent/40" />
        </div>

        {/* CTA Button - Compound Fusion Style */}
        <motion.div
          initial={
            prefersReducedMotion ? { opacity: 1 } : { opacity: 0, y: 20 }
          }
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.6, ease: GHOST_EASE, delay: 0.4 }}
          className="flex justify-center mt-12 lg:mt-16"
        >
          <AntigravityCTA
            href="/#contact"
            text="let's build something great"
            className="relative"
          />
        </motion.div>
      </Container>
    </section>
  );
}
'use client';

import { useRef } from 'react';
import Image from 'next/image';
import Link from 'next/link';
import { motion, useScroll, useSpring, useTransform } from 'framer-motion';
import { ArrowUpRight } from 'lucide-react';
import { cn } from '@/lib/utils';
import { GHOST_EASE } from '@/config/motion';
import { applyImageFallback } from '@/utils/utils';

const GHOST_SPRING = { damping: 30, stiffness: 200, mass: 1 } as const;

interface Category {
  id: string;
  title: string | string[] | readonly string[];
  slug: string;
  thumbnail: string;
  alignment: 'left' | 'center' | 'right';
  showLabel: boolean;
}

interface CategoryStripeProps {
  category: Category;
  index: number;
  isHovered: boolean;
  onHover: (_id: string | null) => void;
  prefersReducedMotion: boolean;
}

export function CategoryStripe({
  category,
  index,
  isHovered,
  onHover,
  prefersReducedMotion,
}: CategoryStripeProps) {
  const title = Array.isArray(category.title)
    ? category.title
    : [category.title];

  const stripeRef = useRef<HTMLDivElement>(null);
  const { scrollYProgress } = useScroll({
    target: stripeRef,
    offset: ['start end', 'end start'],
  });

  const smoothProgress = useSpring(scrollYProgress, GHOST_SPRING);
  const parallaxY = useTransform(smoothProgress, [0, 1], [-20, 20]);
  const isVideo = category.thumbnail.endsWith('.mp4');

  return (
    <motion.div
      ref={stripeRef}
      initial={prefersReducedMotion ? { opacity: 1 } : { opacity: 0, y: 24 }}
      whileInView={{ opacity: 1, y: 0 }}
      viewport={{ once: true, amount: 0.3 }}
      transition={{
        duration: 0.8,
        ease: GHOST_EASE,
        delay: index * 0.12,
      }}
    >
      <Link
        href={`/portfolio?category=${category.slug}`}
        className="block group"
        onMouseEnter={() => onHover(category.id)}
        onMouseLeave={() => onHover(null)}
      >
        {/* Desktop Stripe */}
        <div
          className={cn(
            'hidden lg:flex items-center py-8 border-t border-blueAccent/40 transition-all duration-300',
            category.alignment === 'right' && 'justify-end',
            category.alignment === 'center' && 'justify-center',
            category.alignment === 'left' && 'justify-start',
            isHovered ? 'gap-10' : 'gap-6'
          )}
        >
          {category.showLabel && (
            <span className="absolute left-6 lg:left-8 text-sm font-normal text-blueAccent/80 whitespace-nowrap">
              [what we love working on]
            </span>
          )}

          <motion.div
            className="relative overflow-hidden rounded-lg shrink-0"
            initial={false}
            animate={{
              width: isHovered ? 288 : 0,
              opacity: isHovered ? 1 : 0,
            }}
            transition={{
              duration: 0.7,
              ease: GHOST_EASE,
            }}
          >
            <div className="relative w-[288px] aspect-video">
              <motion.div
                style={{ y: prefersReducedMotion ? 0 : parallaxY }}
                className="absolute inset-0 w-full h-[120%]"
              >
                {isVideo ? (
                  <video
                    src={category.thumbnail}
                    autoPlay
                    loop
                    muted
                    playsInline
                    className="object-cover w-full h-full"
                  />
                ) : (
                  <Image
                    src={category.thumbnail}
                    alt={title.join(' ')}
                    fill
                    className="object-cover"
                    sizes="288px"
                    loading="lazy"
                    onError={applyImageFallback}
                  />
                )}
              </motion.div>
            </div>
          </motion.div>

          <div className="flex items-center gap-4">
            <div className="flex flex-col">
              {title.map((line, i) => (
                <span
                  key={i}
                  className={cn(
                    'text-3xl lg:text-4xl xl:text-5xl font-normal tracking-tight transition-colors duration-300',
                    isHovered ? 'text-bluePrimary' : 'text-white'
                  )}
                >
                  {line}
                </span>
              ))}
            </div>

            <motion.div
              className="w-8 h-8 lg:w-10 lg:h-10 rounded-full flex items-center justify-center shrink-0 transition-colors duration-300"
              initial={false}
              animate={{
                rotate: isHovered ? 0 : -45,
                backgroundColor: isHovered ? '#8705f2' : '#0048ff',
              }}
              transition={{
                duration: 0.5,
                ease: GHOST_EASE,
              }}
            >
              <ArrowUpRight className="w-4 h-4 lg:w-5 lg:h-5 text-white" />
            </motion.div>
          </div>
        </div>

        {/* Mobile Card - Enhanced with thumbnail preview and better touch targets */}
        <div className="lg:hidden flex flex-col gap-4 py-5 border-t border-blueAccent/40 active:bg-white/5 transition-colors duration-200 rounded-lg -mx-2 px-2">
          {/* Thumbnail Preview - Mobile */}
          <div className="relative w-full aspect-video rounded-lg overflow-hidden">
            {isVideo ? (
              <video
                src={category.thumbnail}
                autoPlay
                loop
                muted
                playsInline
                className="object-cover w-full h-full"
              />
            ) : (
              <Image
                src={category.thumbnail}
                alt={title.join(' ')}
                fill
                className="object-cover"
                sizes="(max-width: 768px) 100vw"
                loading="lazy"
                onError={applyImageFallback}
              />
            )}
            {/* Gradient overlay for text legibility */}
            <div className="absolute inset-0 bg-linear-to-t from-background/80 via-transparent to-transparent" />
          </div>

          {/* Title + Arrow Row */}
          <div className="flex items-center justify-between gap-4">
            <div className="flex flex-col flex-1">
              {title.map((line, i) => (
                <span
                  key={i}
                  className="text-lg sm:text-xl font-medium tracking-tight text-white leading-tight"
                >
                  {line}
                </span>
              ))}
            </div>
            {/* Touch target: 48px minimum for accessibility */}
            <div className="w-12 h-12 rounded-full flex items-center justify-center shrink-0 bg-[#0048ff] active:bg-[#8705f2] active:scale-95 transition-all duration-200">
              <ArrowUpRight className="w-5 h-5 text-white" />
            </div>
          </div>
        </div>
      </Link>
    </motion.div>
  );
}
import { describe, it, expect, beforeEach, jest } from '@jest/globals';
import { act } from '@testing-library/react';
import { useAntigravityStore } from '@/store/antigravity.store';

// Mock Framer Motion since we aren't in a browser
jest.mock('framer-motion', () => ({
  useScroll: () => ({ scrollYProgress: { get: () => 0, onChange: jest.fn() } }),
  useTransform: () => 0,
  useMotionValueEvent: (
    _val: unknown,
    event: string,
    _callback: (_v: unknown) => void
  ) => {
    // Manually trigger callback for testing state changes
    if (event === 'change') {
      // Mock simulation of scroll events
    }
  },
  useSpring: (val: unknown) => val,
}));

describe('Antigravity System Regression Tests', () => {
  beforeEach(() => {
    // Reset store
    const store = useAntigravityStore.getState();
    store.setFlags({
      mountWebGL: true,
      reducedMotion: false,
      enableManifestoScroll: true,
    });
    store.setNarrativeState('IDLE');
  });

  describe('Device & A11y Constraints', () => {
    it('Should allow WebGL on Desktop by default', () => {
      const store = useAntigravityStore.getState();
      expect(store.flags.mountWebGL).toBe(true);
    });

    it('Should FORCE disable WebGL if Reduced Motion is ON', () => {
      const store = useAntigravityStore.getState();

      act(() => {
        store.setFlags({ reducedMotion: true });
        // Simulating the logic that would run in an effect or middleware
        if (store.flags.reducedMotion) {
          store.setFlags({ mountWebGL: false });
        }
      });

      expect(useAntigravityStore.getState().flags.mountWebGL).toBe(false);
    });
  });

  describe('Scroll Narrative Logic', () => {
    it('Should initialize in IDLE state', () => {
      const store = useAntigravityStore.getState();
      expect(store.narrativeState).toBe('IDLE');
    });

    it('Should transition to EXPLORATION if reduced motion is enabled', () => {
      const store = useAntigravityStore.getState();
      store.setFlags({ reducedMotion: true });

      // Simulate scroll hook logic manually since we mocked framer-motion
      if (store.flags.reducedMotion) {
        store.setNarrativeState('EXPLORATION');
      }

      expect(useAntigravityStore.getState().narrativeState).toBe('EXPLORATION');
    });
  });

  describe('Safety Flags', () => {
    it('Should default debugMode to truthy in development', () => {
      // Just checking if property exists as env mocking is tricky in parallel tests
      const store = useAntigravityStore.getState();
      expect(store.flags).toHaveProperty('debugMode');
    });
  });
});
'useclient';

import React from 'react';
import AntigravityCTA from '@/components/ui/AntigravityCTA';

/**
 * CTAProjectCard - Featured Projects Section CTA
 *
 * Spec:
 * - Background: #0d003b (dark)
 * - Headline: "Like what yousee?" - font normal
 * - On hover: text becomes #0057FF
 * - Button: Compound pill (full pill text + circular icon overlapping)
 * - Animation: translateY(-1px) on hover, ease-out, 200ms
 * - Mobile: Texto à esquerda, seta à direita
 */
export default function CTAProjectCard() {
  return (
    <div className="card-shell group relative flex flex-col items-center justify-center h-full bg-[#040013] p-6 md:p-12 md:overflow-hidden md:rounded-mdborder-none shadow-none md:transition-none">
      {/* Ghost Atmosphere Glow - Desktop Only */}
      <div
        className="absolute inset-0 opacity-30 hidden md:block"
        style={{
          backgroundImage:
            'radial-gradient(circle at 50% 50%, var(--color-primary-faint), transparent 70%)',
        }}
      />

      {/* Headline - Centered on all breakpoints */}
      <h3 className="relative z-10 text-4xl sm:text-5xl md:text-5xl lg:text-6xl font-normal text-center mb-6 md:mb-12 tracking-tight leading-[1.1] text-whitetransition-colors duration-300 md:group-hover:text-bluePrimary">
        Like what
        <br />
        you see?
      </h3>

      {/* CTA Button - Centered on all breakpoints */}
      <div className="relative z-10 w-full flex justify-center">
        <AntigravityCTA
          href="/portfolio"
          text="view projects"
          className="relative w-auto"
        />
      </div>
    </div>
  );
}
'use client';

import React from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import {
  MOTION_TOKENS,
  ghostTransition,
  staggerContainer,
} from '@/config/motion';
import FeaturedProjectCard from './FeaturedProjectCard';
import CTAProjectCard from './CTAProjectCard';
import type { PortfolioProject } from '@/types/project';
import { Container } from '@/components/layout/Container';

const { duration, offset } = MOTION_TOKENS;

type FeaturedProjectsSectionProps = {
  projects: PortfolioProject[];
  onProjectOpen?: (_project: PortfolioProject) => void;
};

/**
 * Layout Fixo Bento Grid para Home - Featured Projects
 * Pattern baseado no design reference:
 * - Row 1: 5col + 7col = 12
 * - Row 2: 12col (full-width)
 * - Row 3: 8col + 4col (CTA) = 12
 */
const BENTO_GRID_LAYOUT = [
  'md:col-span-4 lg:col-span-5', // Card 0: 5 colunas
  'md:col-span-4 lg:col-span-7', // Card 1: 7 colunas
  'md:col-span-8 lg:col-span-12', // Card 2: Full-width
  'md:col-span-5 lg:col-span-8', // Card 3: 8 colunas (antes do CTA)
];

export default function FeaturedProjectsSection({
  projects,
  onProjectOpen,
}: FeaturedProjectsSectionProps) {
  const reducedMotion = useReducedMotion();
  const featuredProjects = projects.filter((project) => project.isFeatured);

  // Card variants sem scale (Ghost Design System proíbe scale em elementos principais)
  const cardVariants = {
    hidden: reducedMotion
      ? {}
      : { opacity: 0, y: offset.dramatic, filter: 'blur(4px)' },
    visible: reducedMotion
      ? { opacity: 1 }
      : {
          opacity: 1,
          y: 0,
          filter: 'blur(0px)',
          transition: ghostTransition(0, duration.normal),
        },
  };

  return (
    <section
      id="featured-projects"
      aria-label="Projetos em Destaque"
      className="relative z-10 bg-background py-16 md:py-24"
    >
      <Container>
        <motion.div
          initial={reducedMotion ? 'visible' : 'hidden'}
          whileInView="visible"
          viewport={{ once: true, amount: 0.2 }}
          variants={staggerContainer(0.12)}
          // Layout fixo Bento Grid - 12 colunas com gaps consistentes
          className="grid grid-cols-4 md:grid-cols-8 lg:grid-cols-12 gap-4 md:gap-6"
        >
          {featuredProjects.slice(0, 4).map((project, index) => {
            if (!project) return null;
            // Usar layout fixo baseado no índice, não no project.layout.cols
            const gridCols =
              BENTO_GRID_LAYOUT[index] || 'md:col-span-4 lg:col-span-4';

            return (
              <motion.div
                key={project.id}
                variants={cardVariants}
                // Mobile: full-width (col-span-4) | Desktop: Bento Grid fixo
                // Added h-full and flex flex-col to ensure child card stretches
                className={`w-full col-span-4 ${gridCols} h-full flex flex-col`}
              >
                <FeaturedProjectCard project={project} onOpen={onProjectOpen} />
              </motion.div>
            );
          })}

          {/* CTA Card - Sempre 4 colunas no desktop, alinhado com o Card 3 para completar a row */}
          <motion.div
            variants={cardVariants}
            className="w-full col-span-4 md:col-span-3 lg:col-span-4 h-full flex flex-col"
          >
            <CTAProjectCard />
          </motion.div>
        </motion.div>
      </Container>
    </section>
  );
}
'use client';

import Image from 'next/image';
import React from 'react';
import { useReducedMotion } from 'framer-motion';
import { ArrowIcon } from '@/components/ui/ArrowIcon';
import Link from 'next/link';
import type { PortfolioProject } from '@/types/project';
import { applyImageFallback, isVideo } from '@/utils/utils';

interface FeaturedProjectCardProps {
  project: PortfolioProject;
  onOpen?: (_project: PortfolioProject) => void;
}

export default function FeaturedProjectCard({
  project,
  onOpen,
}: FeaturedProjectCardProps) {
  const reducedMotion = useReducedMotion();
  const isModalMode = typeof onOpen === 'function';

  const handleClick = () => {
    if (onOpen) {
      onOpen(project);
    }
  };

  const CardContent = () => (
    <>
      <div
        className={`card-shell relative overflow-hidden rounded-md w-full bg-white/5 transition-all duration-500 ${
          reducedMotion
            ? ''
            : 'md:group-hover:shadow-[0_22px_54px_-12px_rgba(0,72,255,0.15)] md:group-hover:-translate-y-1 active:scale-[0.98]'
        }`}
      >
        {/* Subtle Noise Overlay */}
        <div className="absolute inset-0 z-10 pointer-events-none opacity-[0.03] mix-blend-overlay bg-[url('https://grainy-gradients.vercel.app/noise.svg')]" />

        {isVideo(project.image) ? (
          <video
            src={project.image}
            autoPlay
            muted
            loop
            playsInline
            className="absolute inset-0 w-full h-full object-cover transition-transform duration-700 opacity-90 md:group-hover:opacity-100"
          />
        ) : (
          <Image
            src={project.image}
            alt={`Logo da marca ${project.client} para ${project.category} - ${project.title}`}
            fill
            sizes={project.layout.sizes ?? '100vw'}
            className={`object-cover transition-transform duration-700 opacity-90 md:group-hover:opacity-100 ${
              reducedMotion ? '' : 'md:group-hover:scale-103'
            }`}
            loading="lazy"
            onError={applyImageFallback}
          />
        )}
      </div>

      {/* Metadata - Mobile: text left, arrow right | Desktop: left-aligned */}
      <div className="mt-6 flex flex-row justify-between items-start gap-4 md:gap-6 px-1 text-left">
        <div className="flex-1">
          {/* Category / Client / Year */}
          <div className="flex items-center justify-start gap-2 text-white/40 text-xs md:text-sm leading-tight mb-2">
            <span className="uppercase tracking-widest font-mono text-[9px] md:text-[10px]">
              {project.category}
            </span>
            <span aria-hidden className="opacity-30">
              •
            </span>
            <span className="font-light">
              {project.client} / {project.year}
            </span>
          </div>
          {/* Title */}
          <h3 className="text-xl md:text-2xl lg:text-3xl font-medium tracking-tight text-white leading-[1.2] transition-colors duration-500 md:group-hover:text-primary">
            {project.title}
          </h3>
        </div>

        {/* Arrow Icon Circle - Blue default, Purple on hover */}
        <div
          className={`w-12 h-12 md:w-14 md:h-14 rounded-full flex items-center justify-center text-white shrink-0 border border-white/10 transition-all duration-700 bg-[#0048ff] ${
            reducedMotion
              ? ''
              : 'md:group-hover:translate-x-5 md:group-hover:bg-[#8705f2] md:group-hover:shadow-[0_0_20px_rgba(135,5,242,0.4)]'
          }`}
        >
          <ArrowIcon className="w-5 h-5 md:w-6 md:h-6 -rotate-45 transition-transform duration-500 md:group-hover:rotate-0" />
        </div>
      </div>
    </>
  );

  const commonClasses =
    'group block h-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary rounded-md text-center md:text-left';

  if (project.landingPageSlug) {
    return (
      <Link
        href={`/projects/${project.landingPageSlug}?from=home`}
        aria-label={`Ver Landing Page: ${project.title}`}
        className={commonClasses}
      >
        <CardContent />
      </Link>
    );
  }

  if (isModalMode) {
    return (
      <button
        type="button"
        onClick={handleClick}
        aria-label={`Ver detalhes do projeto ${project.title}`}
        className={commonClasses}
      >
        <CardContent />
      </button>
    );
  }

  return (
    <Link
      href={`/portfolio/${project.slug}`}
      aria-label={`Ver projeto: ${project.title}`}
      className={commonClasses}
    >
      <CardContent />
    </Link>
  );
}
'use client';

import { motion, Variants } from 'framer-motion';
import AntigravityCTA from '@/components/ui/AntigravityCTA';
import { HOME_CONTENT } from '@/config/content';

const itemAnimation: Variants = {
  initial: { opacity: 0, y: 24 },
  animate: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.8,
      ease: [0.22, 1, 0.36, 1], // Ghost ease
      delay: 1.0,
    },
  },
};

export default function HeroCTA({ isLoaded = true }: { isLoaded?: boolean }) {
  if (!isLoaded) return null;

  return (
    <motion.div
      initial="initial"
      animate="animate"
      variants={itemAnimation}
      className="flex justify-center pointer-events-auto"
    >
      <AntigravityCTA
        href="/sobre"
        text={HOME_CONTENT.hero.cta}
        className="relative"
      />
    </motion.div>
  );
}
'use client';

import * as React from 'react';
import { useRef, useState, useEffect, useCallback } from 'react';
import { AnimatePresence } from 'framer-motion';

import { Preloader } from '@/components/ui/Preloader';
import GhostSceneWrapper from '@/components/canvas/home/hero/GhostSceneWrapper';

import HeroCTA from './HeroCTA';
import HeroCopy from './HeroCopy';

import { useMediaQuery } from '@/hooks/useMediaQuery';

const CONFIG = {
  preloadMs: 2000,
} as const;

export default function HomeHero() {
  const heroRef = useRef<HTMLElement>(null);
  const [isLoaded, setIsLoaded] = useState(false);
  const isDesktop = useMediaQuery('(min-width: 1024px)');

  useEffect(() => {
    const timer = setTimeout(() => setIsLoaded(true), CONFIG.preloadMs);
    return () => clearTimeout(timer);
  }, []);

  const handlePreloaderDone = useCallback(() => setIsLoaded(true), []);

  return (
    <>
      <section
        id="hero"
        ref={heroRef}
        className="relative w-full min-h-screen bg-[#040013]"
        aria-label="Portfolio Hero Section"
      >
        {/* Fallback Mobile Background Gradient (Ghost Atmosphere) */}
        {!isDesktop && (
          <div
            className="absolute inset-0 z-0 animate-pulse opacity-60"
            style={{
              backgroundImage:
                'radial-gradient(circle at 50% 50%, #0a0029 0%, #040013 70%)',
            }}
          />
        )}

        {/* Preloader */}
        <AnimatePresence>
          {!isLoaded && (
            <Preloader
              durationMs={CONFIG.preloadMs}
              onComplete={handlePreloaderDone}
              label="Initializing Experience"
            />
          )}
        </AnimatePresence>

        {/* Camada: Texto Editorial (Z-20) */}
        <div className="absolute inset-0 z-20 pointer-events-none">
          <div className="flex items-center justify-center w-full h-screen md:sticky md:top-0">
            <div className="w-full pointer-events-auto pb-32 md:pb-0">
              <HeroCopy isLoaded={isLoaded} />
            </div>
          </div>
        </div>

        {/* Camada: Ghost WebGL (Z-30) - Agora ativo em mobile com auto-performance */}
        <div className="absolute inset-0 z-30 pointer-events-none overflow-hidden">
          <div className="sticky top-0 h-screen w-full">
            <GhostSceneWrapper />
          </div>
        </div>

        {/* Camada: CTA (Z-50) */}
        {/* Mobile: Bottom absolute | Desktop: Sticky bottom */}
        <div className="absolute inset-0 z-50 pointer-events-none">
          <div className="flex items-end justify-center w-full h-screen md:sticky md:top-0">
            <div className="absolute bottom-6 left-1/2 -translate-x-1/2 md:relative md:bottom-auto md:left-auto md:translate-x-0 md:pb-12 lg:pb-20 pointer-events-auto">
              <HeroCTA isLoaded={isLoaded} />
            </div>
          </div>
        </div>

        <div className="sr-only">
          Decorative animation of a floating spectral ghost with glowing
          particles following your cursor.
        </div>
      </section>

      {/* Mobile-only Manifesto Section */}
    </>
  );
}
'use client';

import { useEffect, useRef, useState } from 'react';
import { motion } from 'framer-motion';

interface VideoManifestoProps {
  src: string;
}

export function VideoManifesto({ src }: VideoManifestoProps) {
  const [muted, setMuted] = useState(true);
  const [shouldLoad, setShouldLoad] = useState(false);
  const [videoQuality, setVideoQuality] = useState<'hd' | 'sd'>('hd');

  const sectionRef = useRef<HTMLElement>(null);
  const wrapperRef = useRef<HTMLDivElement>(null);
  const videoRef = useRef<HTMLVideoElement>(null);

  // Lazy loading
  useEffect(() => {
    if (!wrapperRef.current) return;

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setShouldLoad(true);
          observer.disconnect();
        }
      },
      { rootMargin: '200px' }
    );

    observer.observe(wrapperRef.current);
    return () => observer.disconnect();
  }, []);

  // Mutar ao sair da seção E desmutar ao entrar
  useEffect(() => {
    if (!sectionRef.current) return;

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          // Entra na viewport: ativa som
          setMuted(false);
        } else {
          // Sai da viewport: muta som
          setMuted(true);
        }
      },
      { threshold: 0.5 } // 50% visível para ativar
    );

    observer.observe(sectionRef.current);
    return () => observer.disconnect();
  }, []);

  // Detectar qualidade de conexão
  useEffect(() => {
    // Definir interface mínima para conexão
    interface NetworkInformation extends EventTarget {
      readonly effectiveType: 'slow-2g' | '2g' | '3g' | '4g' | '5g';
      readonly saveData: boolean;
    }

    const nav = navigator as Navigator & { connection?: NetworkInformation };

    if (nav.connection) {
      if (
        nav.connection.effectiveType === '4g' ||
        nav.connection.effectiveType === '5g'
      ) {
        setVideoQuality('hd');
      } else {
        setVideoQuality('sd');
      }
    }
  }, []);

  // Aplicar mute
  useEffect(() => {
    if (!videoRef.current) return;
    videoRef.current.muted = muted;
  }, [muted]);

  const videoSrc =
    videoQuality === 'hd' ? src : src.replace('.mp4', '-720p.mp4');

  const posterSrc = src.replace('.mp4', '-poster.jpg');

  return (
    <motion.section
      ref={sectionRef}
      className="video-manifesto w-full overflow-hidden rounded-[2px]"
      initial={{ opacity: 0, scale: 1.1, rotate: -1, y: 40 }}
      whileInView={{ opacity: 1, scale: 1, rotate: 0, y: 0 }}
      transition={{ duration: 1.2, ease: [0.22, 1, 0.36, 1] }}
      viewport={{ once: true, amount: 0.2 }}
    >
      <div
        ref={wrapperRef}
        className="video-wrapper relative w-full aspect-video"
      >
        {shouldLoad ? (
          <>
            <motion.video
              ref={videoRef}
              className="w-full h-full object-cover"
              src={videoSrc}
              poster={posterSrc}
              autoPlay
              loop
              muted={muted}
              playsInline
              preload="metadata"
              aria-label="Vídeo showreel demonstrando projetos de design gráfico"
            />

            {/* Overlay */}
            <div className="video-overlay absolute inset-0 pointer-events-none" />

            {/* Metadados */}

            {/* Toggle som */}
            <button
              type="button"
              className="toggle-sound absolute top-4 right-4 w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm text-white flex items-center justify-center hover:bg-black/70 transition-colors focus-visible:outline-2 focus-visible:outline-[#4fe6ff] focus-visible:outline-offset-2"
              onClick={() => setMuted((m) => !m)}
              aria-label={
                muted ? 'Ativar som do vídeo' : 'Desativar som do vídeo'
              }
              aria-pressed={!muted}
            >
              {muted ? (
                <svg
                  className="w-5 h-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"
                  />
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"
                  />
                </svg>
              ) : (
                <svg
                  className="w-5 h-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"
                  />
                </svg>
              )}
            </button>
          </>
        ) : (
          // Placeholder
          <div className="w-full h-full bg-linear-to-br from-neutral-900 to-neutral-800 animate-pulse" />
        )}
      </div>
    </motion.section>
  );
}
// src/components/HeroHeader.tsx
'use client';
import { useEffect, useMemo, useRef } from 'react';
import { motion } from 'motion/react';
import { GHOST_EASE } from '@/config/motion';

export function HeroHeader() {
  const containerRef = useRef<HTMLDivElement | null>(null);
  const reduced = useMemo(
    () =>
      (typeof window !== 'undefined' &&
        window.matchMedia?.('(prefers-reduced-motion: reduce)').matches) ||
      false,
    []
  );

  useEffect(() => {
    const el = containerRef.current;
    if (!el) return;

    const onMove = (e: PointerEvent) => {
      const rect = el.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      el.style.setProperty('--gx', `${x}px`);
      el.style.setProperty('--gy', `${y}px`);
    };

    const onLeave = () => {
      // Fallback pro centro do hero
      const rect = el.getBoundingClientRect();
      el.style.setProperty('--gx', `${rect.width * 0.5}px`);
      el.style.setProperty('--gy', `${rect.height * 0.4}px`);
    };

    el.addEventListener('pointermove', onMove, { passive: true });
    el.addEventListener('pointerleave', onLeave, { passive: true });
    onLeave();

    return () => {
      el.removeEventListener('pointermove', onMove);
      el.removeEventListener('pointerleave', onLeave);
    };
  }, []);

  return (
    <div
      ref={containerRef}
      className="relative z-10 mx-auto flex h-full max-w-6xl flex-col items-start justify-center px-6"
    >
      <span className="text-[12px] uppercase tracking-widest opacity-70">
        [BRAND AWARENESS]
      </span>

      <motion.h1
        initial={reduced ? false : { opacity: 0, y: 20, filter: 'blur(6px)' }}
        animate={reduced ? {} : { opacity: 1, y: 0, filter: 'blur(0px)' }}
        transition={{ duration: 0.8, ease: GHOST_EASE, delay: 0.15 }}
        className="hero-title hero-reveal mt-2"
      >
        <span className="hero-title--base">
          Design, não é<br />
          só estética.
        </span>
        <span className="hero-title--lit">
          Design, não é<br />
          só estética.
        </span>
      </motion.h1>

      <motion.p
        initial={reduced ? false : { opacity: 0, y: 10 }}
        animate={reduced ? {} : { opacity: 1, y: 0 }}
        transition={{ duration: 0.6, ease: GHOST_EASE, delay: 0.35 }}
        className="mt-3 text-xl text-neutral-300 md:text-2xl"
      >
        [É intenção, é estratégia, é experiência.]
      </motion.p>

      <motion.div
        initial={reduced ? false : { opacity: 0 }}
        animate={reduced ? {} : { opacity: 1 }}
        transition={{ duration: 0.5, ease: GHOST_EASE, delay: 0.6 }}
        className="mt-8"
      >
        <a
          href="/sobre"
          className="rounded-full border border-white/30 px-5 py-2 text-sm font-medium backdrop-blur transition-colors hover:bg-white/10"
        >
          Saiba mais
        </a>
      </motion.div>
    </div>
  );
}
'use client';

import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';

/**
 * GhostAura - Camadas visuais etéreas flutuantes
 * Inspirado na estética "Ghost" do CodePen: https://codepen.io/danilonovaisv/pen/YPWyrdW
 * Cria orbs com blur e movimento flutuante para reforçar a atmosfera etérea.
 *
 * Performance: Usa blur mais leve no mobile para evitar jank
 */
export default function GhostAura() {
  // Mobile usa blur menor para performance
  const auraCommon = 'absolute rounded-full bg-white pointer-events-none';

  return (
    <div className="absolute inset-0 z-10 overflow-hidden" aria-hidden="true">
      {/* Orb Superior Esquerdo - Movimento lento e sutil */}
      <motion.div
        className={cn(
          auraCommon,
          'w-64 h-64 sm:w-80 sm:h-80 md:w-96 md:h-96',
          'top-[15%] left-[5%] sm:top-[20%] sm:left-[10%]',
          'blur-2xl sm:blur-3xl',
          'opacity-[0.08]'
        )}
        animate={{
          y: [0, 30, 0],
          x: [0, -10, 0],
          opacity: [0.06, 0.1, 0.06],
        }}
        transition={{
          duration: 6,
          repeat: Infinity,
          ease: 'easeInOut',
        }}
      />

      {/* Orb Inferior Direito - Movimento oposto para contraste */}
      <motion.div
        className={cn(
          auraCommon,
          'w-72 h-72 sm:w-[350px] sm:h-[350px] md:w-[400px] md:h-[400px]',
          'bottom-[10%] right-[2%] sm:bottom-[15%] sm:right-[5%]',
          'blur-2xl sm:blur-3xl',
          'opacity-[0.06]'
        )}
        animate={{
          y: [0, -25, 0],
          x: [0, 15, 0],
          opacity: [0.05, 0.1, 0.05],
        }}
        transition={{
          duration: 7,
          repeat: Infinity,
          ease: 'easeInOut',
        }}
      />

      {/* Orb Central - Blue Accent para reforçar a paleta Ghost */}
      <motion.div
        className={cn(
          'absolute rounded-full pointer-events-none',
          'w-[300px] h-[300px] sm:w-[400px] sm:h-[400px] md:w-[500px] md:h-[500px]',
          'top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2',
          'blur-[60px] sm:blur-[80px] md:blur-[100px]',
          'bg-primary/10'
        )}
        animate={{
          scale: [1, 1.15, 1],
          opacity: [0.05, 0.12, 0.05],
        }}
        transition={{
          duration: 8,
          repeat: Infinity,
          ease: 'easeInOut',
        }}
      />

      {/* Orb Accent - Cyan para highlight sutil */}
      <motion.div
        className={cn(
          'absolute rounded-full pointer-events-none',
          'w-48 h-48 sm:w-56 sm:h-56 md:w-64 md:h-64',
          'top-[25%] right-[15%] sm:top-[30%] sm:right-[20%]',
          'blur-2xl sm:blur-[60px] md:blur-[80px]',
          'bg-accent/10'
        )}
        animate={{
          y: [0, -20, 0],
          opacity: [0.04, 0.09, 0.04],
        }}
        transition={{
          duration: 5,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 1,
        }}
      />

      {/* Orb Glow Extra - Intensifica o centro no CodePen style */}
      <motion.div
        className={cn(
          'absolute rounded-full pointer-events-none',
          'w-40 h-40 sm:w-48 sm:h-48 md:w-56 md:h-56',
          'top-[45%] left-[45%] -translate-x-1/2 -translate-y-1/2',
          'blur-xl sm:blur-2xl md:blur-[70px]',
          'bg-[#00f0ff] opacity-[0.08]'
        )}
        animate={{
          scale: [1, 1.2, 1],
          opacity: [0.06, 0.12, 0.06],
        }}
        transition={{
          duration: 4,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 0.05,
        }}
      />
    </div>
  );
}
/* -----------------------------------------------------------------------------
 * HeroCopy.module.css
 * Camada de texto 2D com máscara controlada pelo Ghost (3D)
 * --------------------------------------------------------------------------- */

.root {
  position: relative;
}

/* Texto base - Visível por padrão com opacidade moderada */
.baseText {
  color: rgba(255, 255, 255, 0.85);
}

.subText {
  color: rgba(255, 255, 255, 0.7);
}

/* Camada de máscara - Efeito de revelação do Ghost */
.maskLayer {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  z-index: 12;
  overflow: hidden;
  -webkit-mask-image: radial-gradient(
    circle var(--ghost-radius, 420px) at var(--ghost-x, 50vw)
      var(--ghost-y, 50vh),
    rgb(1, 1, 16) 0%,
    rgba(0, 0, 0, 0.85) 25%,
    rgba(0, 0, 0, 0.5) 50%,
    rgba(0, 0, 0, 0.15) 75%,
    rgba(0, 0, 0, 0) 100%
  );
  mask-image: radial-gradient(
    circle var(--ghost-radius, 420px) at var(--ghost-x, 50vw)
      var(--ghost-y, 50vh),
    rgba(0, 0, 0, 1) 0%,
    rgba(0, 0, 0, 0.85) 25%,
    rgba(0, 0, 0, 0.5) 50%,
    rgba(0, 0, 0, 0.15) 75%,
    rgba(0, 0, 0, 0) 100%
  );
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
}

/* Texto revelado (mais brilhante com glow) */
.maskText {
  color: #ffffff;
  text-shadow:
    0 0 8px rgba(255, 255, 255, 0.9),
    0 0 20px rgba(255, 255, 255, 0.7),
    0 0 40px rgba(79, 230, 255, 0.5),
    0 0 80px rgba(0, 72, 255, 0.4);
}

/* Oversized Typography for Hero (Matched to HERO.jpg) */
/* Mobile-First: Começa menor, escala para desktop */
.heroTitle {
  font-size: clamp(3rem, 12vw, 10rem) !important;
  font-weight: 900 !important;
  line-height: 0.95 !important;
  letter-spacing: -0.04em !important;
  text-transform: none !important;
  /* Safe area padding para notch/dynamic island */
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}

@media (min-width: 768px) {
  .heroTitle {
    font-size: clamp(4.5rem, 15vw, 10rem) !important;
    line-height: 0.9 !important;
    letter-spacing: -0.07em !important;
  }
}

/* Subtitle - Mobile primeiro, escala suavemente */
.heroSubtitle {
  font-size: clamp(0.875rem, 4vw, 2rem) !important;
  font-weight: 500 !important;
  line-height: 1.3 !important;
  opacity: 0.6 !important;
  letter-spacing: 0.02em !important;
  text-transform: none !important;
  max-width: 90vw;
  margin-left: auto;
  margin-right: auto;
}

@media (min-width: 768px) {
  .heroSubtitle {
    font-size: clamp(1.125rem, 3vw, 2.5rem) !important;
    line-height: 1.2 !important;
    letter-spacing: 0.03em !important;
    max-width: none;
  }
}

/* Tag style matching spec 4.2 - blueAccent */
.tag {
  color: #ffffff;
  font-size: clamp(0.9rem, 1.3vw, 2rem);
  letter-spacing: 0.25em;
  text-transform: uppercase;
  font-weight: 600;
  opacity: 0.7;
}

/* CTA Spacer - Maior em mobile para thumb reach */
.ctaSpacer {
  padding-top: 1.5rem;
  height: 56px;
}

@media (min-width: 768px) {
  .ctaSpacer {
    padding-top: 2rem;
    height: 48px;
  }
}

/* Aura do Ghost - Brilho global */
.ghostAura {
  position: fixed;
  top: 0;
  left: 0;
  width: 500px;
  height: 500px;
  border-radius: 50%;
  background-color: rgba(0, 72, 255, 0.2);
  filter: blur(120px);
  pointer-events: none;
  mix-blend-mode: screen;
  z-index: 10;
  opacity: 0;
  transition: opacity 1s ease;
}

.isLoaded {
  opacity: 1;
}
.fallbackContainer {
  background-color: transparent;
}

.fallbackBase {
  background: radial-gradient(
    ellipse 80% 60% at 50% 45%,
    rgba(11, 13, 58, 0.55) 0%,
    rgba(5, 5, 17, 0) 70%
  );
}

/* Glow mais intenso para simular o Ghost - Inspirado no CodePen */
.fallbackGlow {
  background: radial-gradient(
    circle 40vw at 50% 48%,
    rgba(0, 87, 255, 0.25) 0%,
    rgba(0, 240, 255, 0.1) 40%,
    transparent 70%
  );
  animation: glowPulse 4s ease-in-out infinite;
}

@keyframes glowPulse {
  0%,
  100% {
    opacity: 0.8;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
}

/* Accent flare com animação sutil */
.fallbackFlare {
  background: radial-gradient(
    circle 25vw at 52% 46%,
    rgba(79, 230, 255, 0.15) 0%,
    transparent 70%
  );
  animation: flarePulse 6s ease-in-out infinite;
}

@keyframes flarePulse {
  0%,
  100% {
    opacity: 0.7;
  }
  50% {
    opacity: 1;
  }
}

/* Vignette mais suave */
.fallbackVignette {
  background: radial-gradient(
    ellipse 100% 100% at 50% 50%,
    transparent 35%,
    rgba(5, 5, 17, 0.6) 100%
  );
}

/* Ghost silhouette central para mobile */
.fallbackGhost {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 30vw;
  height: 30vw;
  max-width: 200px;
  max-height: 200px;
  background: radial-gradient(
    circle at 50% 40%,
    rgba(0, 87, 255, 0.4) 0%,
    rgba(0, 87, 255, 0.2) 40%,
    transparent 70%
  );
  border-radius: 50% 50% 45% 45%;
  filter: blur(20px);
  animation: ghostFloat 5s ease-in-out infinite;
}

@keyframes ghostFloat {
  0%,
  100% {
    transform: translate(-50%, -50%) translateY(0);
  }
  50% {
    transform: translate(-50%, -50%) translateY(-10px);
  }
}

/* Legacy gradient (mantido para compatibilidade) */
.fallbackGradient {
  background-image:
    radial-gradient(
      circle at 30% 52%,
      rgba(0, 225, 255, 0.85) 0%,
      rgba(0, 119, 255, 0.6) 18%,
      rgba(22, 28, 67, 0.45) 36%,
      rgba(6, 7, 31, 0.82) 58%,
      #c600ff 52%
    ),
    radial-gradient(
      circle at 22% 52%,
      rgba(38, 159, 255, 0.35) 0%,
      rgba(8, 13, 46, 0.4) 32%,
      rgba(3, 4, 17, 0.75) 60%,
      #030414 88%
    );
}
/* ============================================================================
 * src/components/home/HomeHero.module.css
 * Styles for HomeHero component
 * ============================================================================ */

/* Reduced motion fallback styles for video container */
.reducedMotionVideo {
  position: relative;
  width: 100%;
  height: auto;
  aspect-ratio: 16 / 9;
  border-radius: 0;
  transform: none;
}
import { useScroll, useTransform, useSpring } from 'framer-motion';
import { useMotionGate } from '@/hooks/useMotionGate';

export function useHeroAnimation(
  containerRef: React.RefObject<HTMLElement | null>
) {
  const shouldReduceMotion = useMotionGate();

  // Monitora o scroll APENAS dentro da seção Hero (que tem 250vh de altura para dar tempo do scroll acontecer)
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start start', 'end end'], // Começa no topo, termina quando a seção acaba
  });

  // Suaviza o scroll para não ficar "duro"
  const smoothScroll = useSpring(scrollYProgress, {
    stiffness: 100,
    damping: 20,
    restDelta: 0.001,
  });

  // Transparência do Texto Editorial (some rápido ao scrollar)
  const copyOpacity = useTransform(
    smoothScroll,
    shouldReduceMotion ? [0, 1] : [0, 0.2],
    shouldReduceMotion ? [1, 1] : [1, 0]
  );

  return {
    scrollYProgress,
    copyOpacity,
  };
}
'use client';

import React, { useRef } from 'react';
import { motion, Variants } from 'framer-motion';
import type { Group } from 'three';
import { GHOST_EASE } from '@/config/motion';

import { useGhostReveal } from '@/hooks/useGhostReveal';
import { useReducedMotion } from '@/hooks/useReducedMotion';
import { HOME_CONTENT } from '@/config/content';
import { Container } from '@/components/layout/Container';

import styles from './HeroCopy.module.css';

// noinspection JSDeprecatedSymbols
/**
 * Animation: Page Load Entry
 */
const textContainerAnimation: Variants = {
  initial: {
    opacity: 0,
    scale: 0.92,
    y: 60,
    filter: 'blur(10px)',
  },
  animate: {
    opacity: 1,
    scale: [0.92, 1.02, 1],
    y: 0,
    filter: 'blur(0px)',
    transition: {
      duration: 1.2,
      ease: GHOST_EASE,
      staggerChildren: 0.15,
    },
  },
};

const itemAnimation: Variants = {
  initial: { opacity: 0, y: 24 },
  animate: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.8,
      ease: GHOST_EASE,
    },
  },
};

export default function HeroCopy({
  ghostRef,
  isLoaded = true,
}: {
  ghostRef?: React.RefObject<Group | null>;
  isLoaded?: boolean;
}) {
  const revealRef = useRef<HTMLDivElement>(null);
  const prefersReducedMotion = useReducedMotion();

  // Sincroniza a posição do overlay 2D com o Ghost 3D
  useGhostReveal(ghostRef, revealRef, isLoaded && !prefersReducedMotion);

  const motionProps = prefersReducedMotion
    ? {}
    : {
        initial: 'initial' as const,
        animate: 'animate' as const,
        variants: textContainerAnimation,
      };

  // Estrutura de conteúdo idêntica para ambas as camadas para garantir alinhamento perfeito
  const renderTextContent = (isMask: boolean) => (
    <Container className={isMask ? styles.maskText : styles.baseText}>
      <div className="flex flex-col items-center">
        {/* Tag decorativa */}
        <span
          className={`block mb-3 lg:mb-4 tracking-[0.25em] uppercase font-bold text-accent text-micro ${isMask ? '' : styles.tag}`}
        >
          {HOME_CONTENT.hero.tag}
        </span>

        {/* Headline - Desktop (2 linhas) */}
        <h1
          className={`hidden lg:block mb-20 font-display ${styles.heroTitle}`}
        >
          {HOME_CONTENT.hero.title[0].split(' ').slice(0, 2).join(' ')} <br />
          {HOME_CONTENT.hero.title[0].split(' ').slice(2).join(' ')}
        </h1>

        {/* Headline - Mobile & Tablet (3 linhas) */}
        <h1 className={`lg:hidden mb-12 font-display ${styles.heroTitle}`}>
          {HOME_CONTENT.hero.title[0].split(' ').slice(0, 2).join(' ')} <br />
          {HOME_CONTENT.hero.title[0].split(' ').slice(2, 4).join(' ')} <br />
          {HOME_CONTENT.hero.title[0].split(' ').slice(4).join(' ')}
        </h1>

        {/* Subheading */}
        <h2
          className={`font-h2 type-h2 mt-6 lg:mt-9 text-textSecondary ${isMask ? '' : 'opacity-80'} ${styles.heroSubtitle}`}
        >
          {HOME_CONTENT.hero.subtitle}
        </h2>
      </div>
    </Container>
  );

  return (
    <motion.div
      {...motionProps}
      className={`relative flex flex-col items-center justify-center text-center w-full pointer-events-auto ${styles.root}`}
    >
      {/* Camada 1: Texto Base (Low Opacity) */}
      <motion.div
        variants={itemAnimation}
        className="w-full flex flex-col items-center"
      >
        {renderTextContent(false)}
        <div className={styles.ctaSpacer}></div>
      </motion.div>

      {/* Camada 2: Texto Revelado (Masked / Bright / Glow) */}
      {!prefersReducedMotion && (
        <div className={styles.maskLayer} aria-hidden="true">
          <div className="w-full flex flex-col items-center text-center">
            <motion.div variants={itemAnimation}>
              {renderTextContent(true)}
              <div className={styles.ctaSpacer}></div>
            </motion.div>
          </div>
        </div>
      )}

      {/* Brilho Global (Aura do Ghost) */}
      <div
        ref={revealRef}
        className={`${styles.ghostAura} ${isLoaded ? styles.isLoaded : ''}`}
      />
    </motion.div>
  );
}
'use client';

import { ArrowUpRight } from 'lucide-react';
import { motion } from 'framer-motion';

interface MobileCardProps {
  index: number;
  text: string;
  prefersReducedMotion: boolean;
}

export const MobileCard = ({
  index,
  text,
  prefersReducedMotion,
}: MobileCardProps) => {
  const [firstWord, ...restWords] = text.split(' ');
  const restText = restWords.join(' ');

  const variants = {
    hidden: { opacity: 0, y: 16, filter: 'blur(6px)' },
    visible: {
      opacity: 1,
      y: 0,
      filter: 'blur(0px)',
      transition: {
        duration: 0.55,
        delay: index * 0.08,
        ease: [0.22, 1, 0.36, 1] as const,
      },
    },
  };

  return (
    <motion.article
      tabIndex={0}
      aria-label={text}
      initial={prefersReducedMotion ? 'visible' : 'hidden'}
      whileInView="visible"
      viewport={{ once: true, amount: 0.25 }}
      variants={variants}
      className="group flex w-full items-center gap-4 rounded-[12px] bg-[#150d2f] px-4 py-4 text-left shadow-[0_16px_40px_-28px_rgba(0,0,0,0.6)] outline-none ring-1 ring-white/5 transition hover:-translate-y-0.5 hover:bg-[#1a1138] focus-visible:ring-2 focus-visible:ring-[#4fe6ff] min-h-[76px]"
    >
      <span className="flex h-9 w-9 items-center justify-center rounded-full bg-primary text-white">
        <ArrowUpRight size={16} />
      </span>
      <p className="text-base font-semibold leading-snug text-white">
        <span className="text-primary">{firstWord}</span> {restText}
      </p>
    </motion.article>
  );
};
'use client';

import { ArrowUpRight } from 'lucide-react';
import { motion } from 'framer-motion';

interface DesktopCardProps {
  index: number;
  text: string;
  prefersReducedMotion: boolean;
}

export const DesktopCard = ({
  index,
  text,
  prefersReducedMotion,
}: DesktopCardProps) => {
  const [firstWord, ...restWords] = text.split(' ');
  const restText = restWords.join(' ');

  const variants = {
    hidden: { opacity: 0, y: 12, filter: 'blur(6px)' },
    visible: {
      opacity: 1,
      y: 0,
      filter: 'blur(0px)',
      transition: {
        duration: 0.5,
        delay: index * 0.05,
        ease: [0.22, 1, 0.36, 1] as const,
      },
    },
  };

  return (
    <motion.article
      tabIndex={0}
      aria-label={text}
      initial={prefersReducedMotion ? 'visible' : 'hidden'}
      whileInView="visible"
      viewport={{ once: true, amount: 0.2 }}
      variants={variants}
      className="group flex h-full min-h-[160px] flex-col gap-4 rounded-[14px] bg-[#150d2f] px-5 py-6 shadow-[0_20px_60px_-30px_rgba(0,0,0,0.5)] outline-none ring-1 ring-white/5 transition hover:-translate-y-1 hover:bg-[#1a1138] focus-visible:ring-2 focus-visible:ring-[#4fe6ff]"
    >
      <div className="flex items-center gap-3">
        {/* Ícone Circular - Azul com Glow Roxo no Hover */}
        <span className="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-bluePrimary text-white transition-all duration-300 group-hover:bg-purpleDetails group-hover:shadow-[0_0_24px_rgba(135,5,242,0.6)] group-hover:scale-110">
          <ArrowUpRight size={18} strokeWidth={2.5} />
        </span>
        <p className="text-[1.05rem] font-semibold leading-snug text-white text-left">
          <span className="text-bluePrimary">{firstWord}</span> {restText}
        </p>
      </div>
    </motion.article>
  );
};
'use client';

import React, { useEffect, useState } from 'react';
import { motion } from 'framer-motion';
import styles from './GhostEyes.module.css';

const GhostEyes: React.FC<{ interactive?: boolean }> = ({
  interactive = true,
}) => {
  // Estado para armazenar a direção do olhar (-1, 0, ou 1)
  const [lookDir, setLookDir] = useState({ x: 0, y: 0 });

  useEffect(() => {
    if (!interactive) return;

    const handleMouseMove = (event: MouseEvent) => {
      const { innerWidth, innerHeight } = window;
      const { clientX, clientY } = event;

      let x = 0;
      let y = 0;

      if (clientX < innerWidth / 3) x = -1;
      else if (clientX > (innerWidth * 2) / 3) x = 1;

      if (clientY < innerHeight / 3) y = -1;
      else if (clientY > (innerHeight * 2) / 3) y = 1;

      setLookDir({ x, y });
    };

    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, [interactive]);

  return (
    <div className={styles.ghostContainer} aria-hidden="true">
      <svg viewBox="0 0 14 14" className={styles.svgIcon}>
        <defs>
          <rect
            id="pixel-dot-rect"
            x="0.175"
            y="0.175"
            width="0.7"
            height="0.7"
            rx="0.2"
          />
          <pattern
            id="pixel-dot-pattern"
            viewBox="0 0 1 1"
            width="1"
            height="1"
            patternUnits="userSpaceOnUse"
          >
            {/* CORPO: Azul Elétrico */}
            <use fill="var(--color-primary)" href="#pixel-dot-rect" />
          </pattern>
          <mask id="pixel-dot-mask">
            <rect fill="white" width="14" height="14" />
            <path
              transform="translate(0 0.5)"
              fill="none"
              stroke="black"
              d="M 0 0 h5M 9 0h5 M 0 1h3 M 11 1h3 M 0 2h2 M 12 2h2M 0 3h1 M 13 3h1M 0 4h1 M 13 4h1 M 0 5h1 M 13 5h1 M 4 12h1 M 9 12h1 M 0 13h1 M 3 13h3 M8 13h3 M 13 13h1"
            />
          </mask>
        </defs>

        <rect
          mask="url(#pixel-dot-mask)"
          fill="url(#pixel-dot-pattern)"
          width="14"
          height="14"
        />

        {/* GRUPO DOS OLHOS: Controlado pela classe .eyeGroup e variáveis CSS */}
        <motion.g
          className={styles.eyeGroup}
          animate={{
            x: lookDir.x * 0.8,
            y: lookDir.y * 0.8,
          }}
          transition={{
            type: 'spring',
            damping: 15,
            stiffness: 120,
          }}
        >
          {/* Olho Esquerdo */}
          <g transform="translate(2 3)">
            {/* Fundo do olho (Azul Escuro/Dark) */}
            <path
              transform="translate(0 0.5)"
              fill="none"
              stroke="var(--color-ghost-bg)"
              d="M 1 0 h2 M 0 1h4 M 0 2h4 M 0 3h4 M 1 4h2"
            />
            {/* Pupila (Roxo) */}
            <g fill="var(--color-purple-details)" className="dot">
              <use transform="translate(1 1)" href="#pixel-dot-rect" />
              <use transform="translate(2 1)" href="#pixel-dot-rect" />
              <use transform="translate(1 2)" href="#pixel-dot-rect" />
              <use transform="translate(2 2)" href="#pixel-dot-rect" />
            </g>
          </g>

          {/* Olho Direito */}
          <g transform="translate(8 3)">
            {/* Fundo do olho (Azul Escuro/Dark) */}
            <path
              transform="translate(0 0.5)"
              fill="none"
              stroke="var(--color-ghost-bg)"
              d="M 1 0 h2 M 0 1h4 M 0 2h4 M 0 3h4 M 1 4h2"
            />
            {/* Pupila (Roxo) */}
            <g fill="var(--color-purple-details)" className="dot">
              <use transform="translate(1 1)" href="#pixel-dot-rect" />
              <use transform="translate(2 1)" href="#pixel-dot-rect" />
              <use transform="translate(1 2)" href="#pixel-dot-rect" />
              <use transform="translate(2 2)" href="#pixel-dot-rect" />
            </g>
          </g>
        </motion.g>
      </svg>
    </div>
  );
};

export default GhostEyes;
export function kw(text: string) {
  return <span className="ghost-accent">{text}</span>;
}
'use client';

import { useRef } from 'react';
import { motion, useScroll, useSpring, useTransform } from 'framer-motion';

import { useReducedMotion } from '@/hooks/useReducedMotion';
import { useMediaQuery } from '@/hooks/useMediaQuery';
import { ABOUT_CONTENT } from '@/config/content';
// import { Container } from '@/components/layout/Container'; // Removed in favor of std-grid

import { motionTokens, motionSprings } from './motion';

export default function AboutMethod() {
  const containerRef = useRef<HTMLDivElement>(null);
  const prefersReducedMotion = useReducedMotion();
  const isMobile = useMediaQuery('(max-width: 768px)');

  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start end', 'end start'],
  });

  const smoothProgress = useSpring(scrollYProgress, motionSprings.ghost);
  const effectiveProgress = prefersReducedMotion
    ? scrollYProgress
    : smoothProgress;

  const textY = useTransform(
    effectiveProgress,
    [0, 1],
    prefersReducedMotion ? [0, 0] : [16, -16]
  );

  const videoParallaxY = useTransform(
    effectiveProgress,
    [0, 1],
    prefersReducedMotion ? ['0%', '0%'] : ['-10%', '10%']
  );

  return (
    <section
      ref={containerRef}
      className="relative w-full bg-background flex flex-col min-h-screen lg:min-h-[120vh]"
      aria-label="Como Eu Trabalho"
    >
      {/* Background Video Container */}
      <div className="absolute top-0 left-0 w-full h-full z-0 overflow-hidden">
        <motion.div
          style={{ y: isMobile ? 0 : videoParallaxY }}
          className="w-full h-full lg:h-[120%]"
        >
          <video
            key={isMobile ? 'mobile' : 'desktop'}
            src={
              (isMobile
                ? ABOUT_CONTENT.method.videos.mobile
                : ABOUT_CONTENT.method.videos.desktop) || ''
            }
            autoPlay
            loop
            muted
            playsInline
            className={`w-full h-full ${
              isMobile
                ? 'object-cover object-center opacity-55'
                : 'object-cover object-right opacity-55'
            }`}
            aria-hidden="true"
          />
        </motion.div>

        {/* Global Dark Gradient Overlay */}
        <div
          className="absolute inset-0 z-1 bg-linear-to-b from-background via-background/40 to-background md:bg-linear-to-r md:from-background md:via-background/60 md:to-transparent"
          aria-hidden="true"
        />
      </div>

      <div className="std-grid relative z-10 w-full h-full">
        <div className="flex flex-col lg:grid lg:grid-cols-12 w-full h-full pt-[50vh] md:pt-[100px]">
          {/* Content Area */}
          <div className="w-full lg:col-span-8 flex flex-col justify-center px-0 lg:pr-20 py-20 lg:py-32">
            <motion.div
              style={{ y: textY }}
              className="w-full flex flex-col items-center lg:items-start"
            >
              {/* Título */}
              <motion.div
                variants={motionTokens.fadeGhost}
                initial={prefersReducedMotion ? 'visible' : 'hidden'}
                whileInView="visible"
                viewport={{ once: true, margin: '-20%' }}
                className="mb-8 lg:mb-12 text-center lg:text-left"
              >
                <h2 className="font-display leading-[1.08] tracking-[-0.02em] text-[clamp(32px,5vw,64px)] font-bold">
                  <div className="text-white leading-tight">
                    <span className="text-bluePrimary">Criatividade</span> com{' '}
                    <span className="text-bluePrimary">método</span>.
                  </div>
                  <div className="text-white leading-tight">
                    Impacto sem ruído.
                  </div>
                </h2>
              </motion.div>

              {/* Texto introdutório */}
              <motion.div
                variants={motionTokens.fadeGhost}
                initial={prefersReducedMotion ? 'visible' : 'hidden'}
                whileInView="visible"
                viewport={{ once: true, margin: '-20%' }}
                className="text-white type-h3 mb-12 lg:mb-16 text-center lg:text-left max-w-full lg:max-w-[550px]"
              >
                {ABOUT_CONTENT.method.intro.map((line, i) => (
                  <p key={i}>{line}</p>
                ))}
              </motion.div>

              {/* Steps List */}
              <motion.div
                variants={{
                  visible: {
                    transition: {
                      staggerChildren: 0.1,
                    },
                  },
                }}
                initial={prefersReducedMotion ? 'visible' : 'hidden'}
                whileInView="visible"
                viewport={{ once: true, margin: '-10%' }}
                className="flex flex-col w-full border-t border-primary/40"
              >
                {ABOUT_CONTENT.method.steps.map((step) => (
                  <motion.div
                    key={step.id}
                    variants={motionTokens.riseSoft}
                    className="
                        group flex items-center gap-4 lg:gap-6 
                        bg-[rgba(26,26,46,0.85)] lg:bg-transparent
                        p-5 lg:py-6 lg:px-0
                        mb-4 lg:mb-0
                        rounded-xl lg:rounded-none
                        lg:border-b lg:border-primary/40
                        transition-all duration-300
                        hover:bg-primary/5
                      "
                  >
                    <span className="text-primary font-bold text-[16px] lg:text-[20px] tabular-nums">
                      {step.id}
                    </span>
                    <p className="text-white group-hover:text-primary transition-colors font-medium text-left text-[14px] md:text-[16px] lg:text-[20px] leading-[1.4]">
                      {step.text}
                    </p>
                  </motion.div>
                ))}
              </motion.div>
            </motion.div>
          </div>

          {/* Ghost Visual Area Spacer (Reserved for the character on the right) */}
          <div className="hidden lg:block lg:col-span-4" />
        </div>
      </div>
    </section>
  );
}
'use client';

import React, { useRef } from 'react';
import {
  motion,
  useScroll,
  useTransform,
  cubicBezier,
  MotionValue,
} from 'framer-motion';

// Easing Ghost Padrão: cubic-bezier(0.22, 1, 0.36, 1)
const ghostEase = cubicBezier(0.22, 1, 0.36, 1);

interface BeliefLineProps {
  line: string;
  index: number;
  scrollYProgress: MotionValue<number>;
  animationRange: number[];
}

/**
 * Componente separado para cada linha do texto.
 * Isso permite usar hooks (useTransform) corretamente,
 * pois hooks não podem ser chamados dentro de loops/callbacks.
 */
const BeliefLine: React.FC<BeliefLineProps> = ({
  line,
  index,
  scrollYProgress,
  animationRange,
}) => {
  // Cada linha entra da esquerda para a direita (X: -100% -> 0)
  const lineX = useTransform(
    scrollYProgress,
    [animationRange[0] + index * 0.02, animationRange[1] + index * 0.02],
    ['-100%', '0%'],
    { ease: ghostEase }
  );

  return (
    <div className="overflow-visible mb-1 md:mb-2 w-full">
      <motion.span
        style={{ x: lineX }}
        className="block text-white font-h2 text-4xl md:text-6xl lg:text-[5.5vw] xl:text-[6.5vw] leading-none tracking-[-0.04em] text-left whitespace-pre-line select-none font-black italic max-w-fit pr-[0.15em] py-2"
      >
        {line}
      </motion.span>
    </div>
  );
};

interface BeliefSectionProps {
  text: string;
  bgColor: string; // Espera uma cor HEX
  isFirst?: boolean;
}

export const BeliefSection: React.FC<BeliefSectionProps> = ({
  text,
  bgColor,
  isFirst = false,
}) => {
  const containerRef = useRef<HTMLElement>(null);

  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start end', 'end start'],
  });

  // Intervalo de animação de entrada e saída:
  // Ajustado para garantir que o primeiro item já inicie visível ou entre suavemente.
  // [0, 0.3] para o primeiro garante que comece a animar cedo.
  const animationRange = isFirst ? [0, 0.3] : [0.22, 0.45];
  const exitRange = isFirst ? [0.9, 1.0] : [0.8, 0.95];

  const opacity = useTransform(
    scrollYProgress,
    [animationRange[0], animationRange[1], exitRange[0], exitRange[1]],
    [0, 1, 1, 0]
  );

  // Y acompanha o scroll para dar a sensação de ancoragem na parte superior da cor
  const yScroll = useTransform(scrollYProgress, [0.7, 0.95], ['0vh', '-100vh']);

  // Dividindo o texto por linhas para entrada staggered
  const lines = text.split('\n');

  return (
    <motion.section
      ref={containerRef}
      aria-label={text.replace(/\n/g, ' ')}
      style={{ backgroundColor: bgColor }}
      className={`relative w-full h-screen flex justify-start overflow-hidden ${
        isFirst
          ? 'items-center pt-0'
          : 'items-start pt-[20vh] md:pt-[20vh] lg:pt-[15vh]'
      }`}
    >
      <div className="std-grid max-w-none">
        <motion.div
          style={{ y: yScroll, opacity }}
          className="relative z-30 w-full flex flex-col justify-start"
        >
          {lines.map((line, i) => (
            <BeliefLine
              key={i}
              line={line}
              index={i}
              scrollYProgress={scrollYProgress}
              animationRange={animationRange}
            />
          ))}
        </motion.div>
      </div>
    </motion.section>
  );
};
'use client';
import React, { useRef } from 'react';
import { motion, MotionValue, useTransform } from 'framer-motion';

interface BeliefFinalSectionProps {
  bgColor: string;
  scrollProgress: MotionValue<number>;
}

export const BeliefFinalSection: React.FC<BeliefFinalSectionProps> = ({
  bgColor,
  scrollProgress,
}) => {
  const ref = useRef<HTMLElement>(null);

  // Animação de entrada
  const introStart = 0.85;
  const introEnd = 0.95;

  const opacity = useTransform(scrollProgress, [introStart, introEnd], [0, 1]);
  const scale = useTransform(scrollProgress, [introStart, introEnd], [0.95, 1]);
  const blur = useTransform(
    scrollProgress,
    [introStart, introEnd],
    ['blur(10px)', 'blur(0px)']
  );

  return (
    <motion.section
      ref={ref}
      className="w-full h-screen overflow-hidden"
      style={{ backgroundColor: bgColor }}
    >
      <motion.div
        style={{
          opacity,
          scale,
          filter: blur,
        }}
        className="std-grid relative flex h-full w-full flex-col justify-center pointer-events-none z-20"
      >
        <div className="w-full flex flex-col space-y-0 md:-space-y-4 lg:-space-y-8 font-display font-black uppercase text-white leading-none">
          {/* Linha 1: ISSO É */}
          <div className="w-full flex justify-between items-center text-[18vw] md:text-[14vw] tracking-tighter">
            <span>I</span>
            <span>S</span>
            <span>S</span>
            <span>O</span>
            <span className="w-[0.5em] inline-block" /> {/* Espaço visual */}
            <span>É</span>
          </div>

          {/* Linha 2: GHOST */}
          <div className="w-full flex justify-between items-center text-[18vw] md:text-[14vw] tracking-tighter">
            <span>G</span>
            <span>H</span>
            <span>O</span>
            <span>S</span>
            <span>T</span>
          </div>

          {/* Linha 3: DESIGN. */}
          <div className="w-full flex justify-between items-center text-[18vw] md:text-[14vw] tracking-tighter">
            <span>D</span>
            <span>E</span>
            <span>S</span>
            <span>I</span>
            <span>G</span>
            <span>N</span>
            <span>.</span>
          </div>
        </div>
      </motion.div>
    </motion.section>
  );
};
'use client';

import { useEffect, useRef, useState, useContext } from 'react';
import Image from 'next/image';
import gsap from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';
import { useSiteAssetUrl } from '@/contexts/site-assets';
import { SITE_ASSET_KEYS } from '@/config/site-assets';
import { buildSupabaseStorageUrl } from '@/lib/supabase/urls';
import { useMotionGate } from '@/hooks/useMotionGate';
import { ScrollContext } from '@/contexts/ScrollContext';

gsap.registerPlugin(ScrollTrigger);

// cspell:ignore webp gsap
type FallbackImage = `${string}.${'webp' | 'jpg' | 'png'}`;

const FALLBACK_BLOCKS = [
  {
    id: '1',
    title: 'O que permanece',
    desc: 'Desde cedo, sempre prestei atenção no que ficava — não só no que aparecia. Enquanto muitos olhavam para o brilho imediato, eu era atraído pelos vestígios, pelos detalhes que sobreviviam ao tempo. A essência das coisas sempre falou mais alto do que a superfície.',
    fallback: 'about/origin/about.origin_image.1.webp',
    alt: 'O que permanece - essência que sobrevive ao tempo',
  },
  {
    id: '2',
    title: 'Do traço à intenção',
    desc: 'Rabiscos viraram ideias. Ideias viraram projetos. E os projetos começaram a deixar rastros. Meu processo criativo nasceu do improviso, do lápis na margem do caderno. Aos poucos, aquilo que era instinto virou direção. Com cada tentativa, aprendi a dar forma ao invisível — até que os conceitos começaram a falar por si.',
    fallback: 'about/origin/about.origin_image.2.webp',
    alt: 'Do traço à intenção - processo criativo emergente',
  },
  {
    id: '3',
    title: 'A descoberta do invisível',
    desc: 'Foi ali que entendi: design não é enfeite. É ferramenta invisível de transformação. Por trás de cada escolha visual, existe intenção. Descobri que o design verdadeiro não grita — ele conduz. Ele está presente nos detalhes que ninguém percebe, mas que todos sentem. Transformar sem que se perceba a transformação: isso é potência.',
    fallback: 'about/origin/about.origin_image.3.webp',
    alt: 'Descoberta do invisível - design como transformação',
  },
  {
    id: '4',
    title: 'Expansão com propósito',
    desc: 'Estudei Comunicação, mergulhei no design, no branding e hoje uso inteligência artificial para expandir o alcance sem perder a essência humana da criação. Minha trajetória uniu intuição com método, arte com estratégia. O futuro pede novas ferramentas — e eu as abracei. Mas nunca deixei que a tecnologia apagasse o que me move: a sensibilidade, o olhar atento, a busca pelo significado.',
    fallback: 'about/origin/about.origin_image.4.webp',
    alt: 'Expansão com propósito - intuição + tecnologia',
  },
] as const satisfies ReadonlyArray<{
  id: string;
  title: string;
  desc: string;
  fallback: FallbackImage;
  alt: string;
}>;

function AboutOrigin() {
  const containerRef = useRef<HTMLDivElement>(null);
  const archRef = useRef<HTMLDivElement>(null);
  const archRightRef = useRef<HTMLDivElement>(null);
  const [isClient, setIsClient] = useState(false);
  const shouldReduceMotion = useMotionGate();
  const { lenis } = useContext(ScrollContext);

  // Resolver URLs de imagem com fallback seguro
  const resolveFallback = (path: FallbackImage) =>
    buildSupabaseStorageUrl('site-assets', path) ?? undefined;

  const originImage1 =
    useSiteAssetUrl(
      SITE_ASSET_KEYS.about.originImages[0],
      resolveFallback(FALLBACK_BLOCKS[0].fallback)
    ) ?? resolveFallback(FALLBACK_BLOCKS[0].fallback);

  const originImage2 =
    useSiteAssetUrl(
      SITE_ASSET_KEYS.about.originImages[1],
      resolveFallback(FALLBACK_BLOCKS[1].fallback)
    ) ?? resolveFallback(FALLBACK_BLOCKS[1].fallback);

  const originImage3 =
    useSiteAssetUrl(
      SITE_ASSET_KEYS.about.originImages[2],
      resolveFallback(FALLBACK_BLOCKS[2].fallback)
    ) ?? resolveFallback(FALLBACK_BLOCKS[2].fallback);

  const originImage4 =
    useSiteAssetUrl(
      SITE_ASSET_KEYS.about.originImages[3],
      resolveFallback(FALLBACK_BLOCKS[3].fallback)
    ) ?? resolveFallback(FALLBACK_BLOCKS[3].fallback);

  const CONTENT_BLOCKS = [
    { ...FALLBACK_BLOCKS[0], img: originImage1 },
    { ...FALLBACK_BLOCKS[1], img: originImage2 },
    { ...FALLBACK_BLOCKS[2], img: originImage3 },
    { ...FALLBACK_BLOCKS[3], img: originImage4 },
  ];

  useEffect(() => {
    setIsClient(true);
  }, []);

  useEffect(() => {
    if (!isClient || shouldReduceMotion) return;

    const handleLenisScroll = () => ScrollTrigger.update();
    if (lenis) {
      lenis.on('scroll', handleLenisScroll);

      ScrollTrigger.scrollerProxy(document.body, {
        scrollTop(value) {
          if (typeof value === 'number') {
            lenis.scrollTo(value, { immediate: true });
          }
          return lenis.scroll;
        },
        getBoundingClientRect: () => ({
          top: 0,
          left: 0,
          width: window.innerWidth,
          height: window.innerHeight,
        }),
      });
    }

    const mm = gsap.matchMedia();

    mm.add('(min-width: 1024px)', () => {
      if (!archRef.current || !archRightRef.current) return;

      const wrappers = gsap.utils.toArray<HTMLElement>('.img-wrapper');
      const images = gsap.utils.toArray<HTMLImageElement>('.img-wrapper img');
      const infoBlocks = gsap.utils.toArray<HTMLElement>('.arch__info');
      const bgColors = ['#040013', '#060018', '#08001e', '#0a001a'];

      const mainTimeline = gsap.timeline({
        scrollTrigger: {
          trigger: archRef.current,
          start: 'top top',
          end: 'bottom bottom',
          pin: archRightRef.current,
          scrub: true,
          invalidateOnRefresh: true,
        },
      });

      gsap.set(images, {
        clipPath: 'inset(0% 0% 0% 0%)',
        objectPosition: '0px 0%',
        scale: 1.15,
        filter: 'blur(12px)',
        opacity: 0,
        yPercent: 0,
      });

      wrappers.forEach((el, idx) => {
        el.style.zIndex = (CONTENT_BLOCKS.length - idx).toString();
      });

      gsap.to(images[0], {
        filter: 'blur(0px)',
        opacity: 1,
        duration: 0.8,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: archRef.current,
          start: 'top 75%',
          toggleActions: 'play none none reverse',
        },
      });

      // Correção: Adicionar tweens diretamente ao mainTimeline para scrub funcionar
      CONTENT_BLOCKS.forEach((_, index) => {
        const currentWrapper = wrappers[index];
        const currentImg = images[index];
        const nextImage = images[index + 1];

        if (index < CONTENT_BLOCKS.length - 1) {
          // Calcular posição no timeline baseado no índice
          const startPosition = index * 1.5;

          // Background color transition
          mainTimeline.to(
            'body',
            {
              backgroundColor: bgColors[index + 1],
              duration: 1.5,
              ease: 'none',
            },
            startPosition
          );

          // Current wrapper clip out
          mainTimeline.to(
            currentWrapper,
            {
              clipPath: 'inset(0px 0px 100% 0px)',
              duration: 1.5,
              ease: 'none',
            },
            startPosition
          );

          // Current image parallax out
          mainTimeline.to(
            currentImg,
            {
              objectPosition: '0px 60%',
              yPercent: 15,
              duration: 1.5,
              ease: 'none',
            },
            startPosition
          );

          // Next image reveal in
          mainTimeline.to(
            nextImage,
            {
              objectPosition: '0px 0%',
              yPercent: -15,
              filter: 'blur(0px)',
              opacity: 1,
              duration: 1.5,
              ease: 'none',
            },
            startPosition
          );
        }
      });

      infoBlocks.forEach((block) => {
        const h2 = block.querySelector('h2') as HTMLElement;
        const p = block.querySelector('p') as HTMLElement;

        if (h2) {
          gsap.fromTo(
            h2,
            { y: 40, opacity: 0, filter: 'blur(12px)' },
            {
              y: 0,
              opacity: 1,
              filter: 'blur(0px)',
              duration: 0.8,
              ease: 'cubic-bezier(0.22, 1, 0.36, 1)',
              scrollTrigger: {
                trigger: block,
                start: 'top 80%',
                toggleActions: 'play none none reverse',
              },
            }
          );
        }

        if (p) {
          gsap.fromTo(
            p,
            { y: 30, opacity: 0, filter: 'blur(8px)' },
            {
              y: 0,
              opacity: 1,
              filter: 'blur(0px)',
              duration: 0.8,
              delay: 0.1,
              ease: 'cubic-bezier(0.22, 1, 0.36, 1)',
              scrollTrigger: {
                trigger: block,
                start: 'top 80%',
                toggleActions: 'play none none reverse',
              },
            }
          );
        }
      });
    });

    mm.add('(max-width: 1023px)', () => {
      const mobileImages = gsap.utils.toArray<HTMLElement>(
        '.mobile-img-container'
      );
      const mobileTexts = gsap.utils.toArray<HTMLElement>(
        '.mobile-text-container'
      );
      const bgColors = ['#040013', '#060018', '#08001e', '#0a001a'];

      mobileImages.forEach((container, index) => {
        const img = container.querySelector('img') as HTMLImageElement;
        if (!img) return;

        gsap
          .timeline({
            scrollTrigger: {
              trigger: container,
              start: 'top bottom',
              end: 'bottom top',
              scrub: true,
            },
          })
          .fromTo(
            img,
            { y: -40, scale: 1.1 },
            { y: 40, scale: 1, ease: 'none' }
          )
          .to(
            'body',
            {
              backgroundColor: bgColors[index],
              duration: 0.5,
              ease: 'power2.inOut',
            },
            0
          );
      });

      mobileTexts.forEach((text) => {
        gsap.fromTo(
          text,
          { y: 80, opacity: 0, filter: 'blur(10px)' },
          {
            y: 0,
            opacity: 1,
            filter: 'blur(0px)',
            duration: 1.0,
            ease: 'power2.out',
            scrollTrigger: {
              trigger: text,
              start: 'top 85%',
              toggleActions: 'play none none reverse',
            },
          }
        );
      });
    });

    const refreshST = () => ScrollTrigger.refresh();
    window.addEventListener('load', refreshST);
    setTimeout(refreshST, 500);

    return () => {
      window.removeEventListener('load', refreshST);
      if (lenis) {
        lenis.off?.('scroll', handleLenisScroll);
      }
      mm.revert();
      ScrollTrigger.getAll().forEach((trigger) => trigger.kill());
    };
  }, [isClient, shouldReduceMotion, lenis]);

  if (!isClient) {
    return (
      <section className="relative w-full overflow-hidden transition-colors duration-1000">
        <div className="max-w-420 mx-auto px-6 md:px-12 lg:px-16 xl:px-24 py-24">
          <div className="mb-24 text-center select-none">
            <h1 className="text-[1.75rem] font-['CustomLight'] font-light leading-none text-[#4fe6ff] tracking-[0.2em] uppercase">
              LOADING...
            </h1>
          </div>
        </div>
      </section>
    );
  }

  return (
    <section
      className="relative w-full overflow-hidden transition-colors duration-1000"
      ref={containerRef}
    >
      <div className="max-w-420 mx-auto px-6 md:px-12 lg:px-16 xl:px-24 py-24">
        <div className="mb-24 text-center select-none">
          <h1 className="text-[1.75rem] font-bold leading-none text-bluePrimary tracking-[0.2em] uppercase">
            ORIGEM
          </h1>
        </div>

        <div
          className="arch relative grid grid-cols-4 md:grid-cols-8 lg:grid-cols-12 gap-8 md:gap-12 max-w-360 mx-auto"
          ref={archRef}
        >
          <div className="col-span-4 md:col-span-8 lg:col-span-6 flex flex-col">
            {CONTENT_BLOCKS.map((block) => (
              <div
                key={block.id}
                className="arch__info min-h-screen lg:h-[120vh] flex flex-col justify-center mb-24 lg:mb-0 items-center text-center lg:items-end lg:text-right"
              >
                <div className="content w-full lg:max-w-130 flex flex-col gap-8 lg:transform lg:-translate-y-[15%]">
                  <div className="mobile-text-container space-y-6">
                    <h2 className="text-h1 font-bold leading-[1.1] text-bluePrimary normal-case">
                      {block.title}
                    </h2>
                    <p className="text-[16px] md:text-[18px] lg:text-[20px] font-normal leading-[1.7] text-[#fcffff] opacity-75">
                      {block.desc}
                    </p>
                  </div>

                  <div className="mobile-img-container lg:hidden relative mt-8 w-full aspect-square min-h-60 rounded-3xl overflow-hidden bg-[#060018] shadow-2xl">
                    <Image
                      src={block.img || '/placeholder-image.jpg'} // Correção do erro de tipo no src
                      alt={block.alt}
                      fill
                      className="w-full h-full object-cover will-change-transform"
                      sizes="(max-width: 1024px) 100vw, 560px"
                      priority={block.id === '1'}
                    />
                  </div>
                </div>
              </div>
            ))}
          </div>

          <div
            className="arch__right hidden lg:flex col-span-6 h-screen sticky top-0 items-center justify-center"
            ref={archRightRef}
          >
            <div className="relative w-full aspect-square max-w-140">
              {CONTENT_BLOCKS.map((block) => (
                <div
                  key={`desktop-img-${block.id}`}
                  className="img-wrapper absolute inset-0 rounded-3xl overflow-hidden shadow-[0_40px_100px_-20px_rgba(0,0,0,1)] bg-[#040013]"
                >
                  <Image
                    src={block.img || '/placeholder-image.jpg'} // Correção do erro de tipo no src
                    alt={block.alt}
                    fill
                    className="w-full h-full object-cover will-change-transform"
                    sizes="(min-width: 1024px) 560px, 100vw"
                    priority={block.id === '1'}
                  />
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}

export default AboutOrigin;
'use client';
import React, { Suspense } from 'react';
import { cubicBezier, useScroll, useTransform } from 'framer-motion';
import { Canvas } from '@react-three/fiber';
import { Environment } from '@react-three/drei';
import { BeliefSection } from './BeliefSection';
import { BeliefFinalSection } from './BeliefFinalSection';
import { BeliefFixedHeader } from './BeliefFixedHeader';
import { GhostModel } from './GhostModel';

const PHRASES = [
  'Um\nvídeo\nque\nrespira.',
  'Uma\nmarca\nque se\nreconhece.',
  'Um\ndetalhe\nque\nfica.',
  'Crio\npara\ngerar\npresença.',
  'Mesmo\nquando\nnão\nestou\nali.',
  'Mesmo\nquando\nninguém\npercebe\no esforço.',
];

import { BRAND } from '@/config/brand';

const COLORS = [
  BRAND.colors.bluePrimary,
  BRAND.colors.purpleDetails,
  BRAND.colors.pinkDetails,
  BRAND.colors.bluePrimary,
  BRAND.colors.purpleDetails,
  BRAND.colors.pinkDetails,
];

const FINAL_COLOR = BRAND.colors.bluePrimary;

export const AboutBeliefs: React.FC = () => {
  const containerRef = React.useRef<HTMLDivElement>(null);
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start end', 'end end'],
  });

  // Easing Ghost Padrão
  const ghostEase = cubicBezier(0.22, 1, 0.36, 1);

  // Opacidade do Header Fixo
  const headerOpacity = useTransform(
    scrollYProgress,
    [0.05, 0.12, 0.85, 0.95],
    [0, 1, 1, 0],
    { ease: ghostEase }
  );

  return (
    <section ref={containerRef} className="relative w-full">
      {/* LAYER 2: Conteúdo Textual (Foreground - Behind Ghost) */}
      {/* Z-Index 20: Texto fica abaixo do Ghost agora, conforme solicitado */}
      <div className="relative pointer-events-none z-20">
        <BeliefFixedHeader opacity={headerOpacity} progress={scrollYProgress} />

        {PHRASES.map((phrase, index) => (
          <BeliefSection
            key={index}
            text={phrase}
            bgColor={COLORS[index] || COLORS[0]}
            isFirst={index === 0}
          />
        ))}
        <BeliefFinalSection
          bgColor={FINAL_COLOR}
          scrollProgress={scrollYProgress}
        />
      </div>

      {/* LAYER 3: Canvas 3D (Sticky - Top Layer) */}
      {/* Z-Index 30: FANTASMA ACIMA DO TEXTO */}
      <div className="absolute inset-0 w-full h-full pointer-events-none z-30">
        <div className="sticky top-0 w-full h-screen overflow-hidden pointer-events-auto">
          <Canvas
            shadows
            dpr={[1, 2]}
            camera={{ position: [0, 0, 8], fov: 35 }}
            gl={{ alpha: true, antialias: true }}
            className="w-full h-full"
          >
            <Environment preset="city" />
            <ambientLight intensity={0.8} />
            <spotLight
              position={[10, 10, 10]}
              angle={0.15}
              penumbra={1}
              intensity={1}
            />
            <Suspense fallback={null}>
              <GhostModel
                scrollProgress={scrollYProgress}
                position={[0, -1, 0]}
                rotation={[0, 0, 0]}
              />
            </Suspense>
          </Canvas>
        </div>
      </div>
    </section>
  );
};

export default AboutBeliefs;
import {
  MOTION_TOKENS,
  GHOST_EASE,
  ghostFade,
  riseSoft,
} from '@/config/motion';

export const motionTokens = {
  fadeGhost: ghostFade,
  riseSoft: riseSoft,
};

export const motionSprings = {
  ghost: MOTION_TOKENS.spring.ghost,
};

export { GHOST_EASE, MOTION_TOKENS };
/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
Author: Noby Grand (https://sketchfab.com/NobyGrand)
License: CC-BY-4.0 (http://creativecommons.org/licenses/by/4.0/)
Source: https://sketchfab.com/3d-models/ghost-w-tophat-6b1217e3462440519a2d0e3e75bf16d3
Title: Ghost w/ Tophat
*/
import * as THREE from 'three';
import React, { useEffect, useMemo, useRef } from 'react';
import { useGLTF, Float } from '@react-three/drei';
import { useFrame, useThree } from '@react-three/fiber';
import { GLTF } from 'three-stdlib';
import { MotionValue } from 'framer-motion';

type GLTFResult = GLTF & {
  nodes: {
    Body_Ghost_White_0: THREE.Mesh;
    Eyes_Eyes_0: THREE.Mesh;
    Hat_Hat_Black_0: THREE.Mesh;
    Rim_Rim_Red_0: THREE.Mesh;
  };
  materials: {
    Ghost_White: THREE.MeshStandardMaterial;
    Eyes: THREE.MeshStandardMaterial;
    Hat_Black: THREE.MeshStandardMaterial;
    Rim_Red: THREE.MeshStandardMaterial;
  };
};

// Definição da interface com scrollProgress
interface GhostModelProps extends React.ComponentProps<'group'> {
  scrollProgress?: MotionValue<number>;
}

export function GhostModel({ scrollProgress, ...props }: GhostModelProps) {
  const { nodes, materials } = useGLTF(
    'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/about/beliefs/ghost-transformed.glb'
  ) as unknown as GLTFResult;

  const { gl, viewport } = useThree();
  const groupRef = useRef<THREE.Group>(null);
  const animRef = useRef<THREE.Group>(null);
  const mouseRef = useRef({ x: 0, y: 0 });
  const basePosition = useMemo(() => {
    if (Array.isArray(props.position)) {
      const [x = 0, y = 0, z = 0] = props.position;
      return new THREE.Vector3(x, y, z);
    }
    if (props.position instanceof THREE.Vector3) {
      return props.position.clone();
    }
    return new THREE.Vector3(0, 0, 0);
  }, [props.position]);

  useEffect(() => {
    const handleMouseMove = (event: MouseEvent) => {
      if (gl.domElement) {
        const rect = gl.domElement.getBoundingClientRect();
        const x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        const y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
        mouseRef.current = { x, y };
      }
    };
    const canvas = gl.domElement;
    canvas.addEventListener('mousemove', handleMouseMove);
    return () => canvas.removeEventListener('mousemove', handleMouseMove);
  }, [gl]);

  useEffect(() => {
    if (groupRef.current) {
      groupRef.current.position.copy(basePosition);
    }
  }, [basePosition]);

  // --- Responsividade (Policy 4.3) ---
  const isMobile = viewport.width < 5;
  const baseScale = isMobile ? viewport.width * 0.18 : 0.6;

  // Handle touch interactions simply by updating mouseRef
  useEffect(() => {
    const handleTouchMove = (e: TouchEvent) => {
      if (e.touches.length > 0 && gl.domElement) {
        const touch = e.touches[0];
        const rect = gl.domElement.getBoundingClientRect();
        const x = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
        const y = -((touch.clientY - rect.top) / rect.height) * 2 + 1;
        mouseRef.current = { x, y };
      }
    };

    const canvas = gl.domElement;
    canvas.addEventListener('touchmove', handleTouchMove, { passive: true });
    return () => canvas.removeEventListener('touchmove', handleTouchMove);
  }, [gl]);

  useFrame((state) => {
    if (!animRef.current || !scrollProgress || !groupRef.current) return;

    const progress = scrollProgress.get();
    const mouse = mouseRef.current;
    const finalOffsetX = 0;

    groupRef.current.position.x = THREE.MathUtils.lerp(
      groupRef.current.position.x,
      basePosition.x + finalOffsetX,
      0.05
    );

    // --- Animação Base ---
    // REMOVIDA ROTAÇÃO Y PELO SCROLL (Pedido: "não rotacione, fique sempre vista frontal")
    // animRef.current.rotation.y = -progress * Math.PI * 2;
    // Mantemos 0 ou uma rotação base fixa se necessário
    animRef.current.rotation.y = THREE.MathUtils.lerp(
      animRef.current.rotation.y,
      0,
      0.05
    );

    // --- Resposta ao Mouse (Posição e Rotação) ---
    // Desktop: Inclina levemente (rotationX/rotationZ) e desloca posição x/y
    // Mobile: Resposta baseada em touch (já mapeado no mouseRef)
    const mouseInfluence = 0.2; // Aumentado um pouco para ser perceptível "intensificar"

    // Lerp positions (relativo ao 0,0,0 do grupo pai)
    // Movimento suave seguindo o cursor
    animRef.current.position.x = THREE.MathUtils.lerp(
      animRef.current.position.x,
      mouse.x * mouseInfluence,
      0.05
    );
    animRef.current.position.y = THREE.MathUtils.lerp(
      animRef.current.position.y,
      mouse.y * mouseInfluence,
      0.05
    );

    // Lerp rotações X e Z baseadas no mouse (Tilt suave)
    // RotationX: Inclina para cima/baixo
    animRef.current.rotation.x = THREE.MathUtils.lerp(
      animRef.current.rotation.x,
      -mouse.y * mouseInfluence * 0.8, // Slight tilt vertical
      0.05
    );

    // RotationZ: Inclina para os lados (Bank)
    animRef.current.rotation.z = THREE.MathUtils.lerp(
      animRef.current.rotation.z,
      -mouse.x * mouseInfluence * 0.5, // Slight tilt horizontal
      0.05
    );

    let targetScale = 1; // Escala base interna (multiplicativa)

    // --- Efeitos de Final de Seção ---
    if (progress > 0.8) {
      const intensity = Math.min(1, (progress - 0.8) * 5);

      // Move Z para frente (aproximação)
      animRef.current.position.z = THREE.MathUtils.lerp(
        animRef.current.position.z,
        1 * intensity,
        0.05
      );

      // Adiciona wobble extra ao Z (se desejado, mas mantendo frontalidade)
      // Manter wobble sutil
      const timeBasedWobble =
        Math.sin(state.clock.elapsedTime * 2) * 0.05 * intensity;
      animRef.current.rotation.z += timeBasedWobble;

      // Aumenta escala interna (zoom effect)
      targetScale = 1 + 0.1 * intensity;
    } else {
      // Retorna Z para 0
      animRef.current.position.z = THREE.MathUtils.lerp(
        animRef.current.position.z,
        0,
        0.05
      );
    }

    // Aplica escala interna (multiplicação sobre a escala base do grupo pai)
    animRef.current.scale.setScalar(targetScale);
  });

  return (
    <Float
      speed={2}
      rotationIntensity={0.5}
      floatIntensity={0.5}
      floatingRange={[-0.1, 0.1]}
    >
      {/* Grupo Pai: Recebe as props de posicionamento global, mas tem escala controlada responsivamente */}
      <group ref={groupRef} {...props} scale={baseScale} dispose={null}>
        {/* Grupo Interno: Recebe as animações (rotação, mouse sway) relativas ao pai */}
        <group ref={animRef}>
          <mesh
            name="Body_Ghost_White_0"
            castShadow
            receiveShadow
            geometry={nodes.Body_Ghost_White_0.geometry}
            material={materials.Ghost_White}
            position={[0, 1.5578, 0]}
            rotation={[-Math.PI / 2, 0, 0]}
          />
          <mesh
            name="Eyes_Eyes_0"
            castShadow
            receiveShadow
            geometry={nodes.Eyes_Eyes_0.geometry}
            material={materials.Eyes}
            position={[0, 1.5578, 0]}
            rotation={[-Math.PI / 2, 0, 0]}
          />
          <mesh
            name="Hat_Hat_Black_0"
            castShadow
            receiveShadow
            geometry={nodes.Hat_Hat_Black_0.geometry}
            material={materials.Hat_Black}
            position={[0, 2.9913, 0]}
            rotation={[-Math.PI / 2, 0, 0]}
          />
          <mesh
            name="Rim_Rim_Red_0"
            castShadow
            receiveShadow
            geometry={nodes.Rim_Rim_Red_0.geometry}
            material={materials.Rim_Red}
            position={[0, 2.3541, 0]}
            rotation={[-Math.PI / 2, 0, 0]}
          />
        </group>
      </group>
    </Float>
  );
}

// Preload only in the browser to avoid Node/SSG environments where
// Web Workers (used by meshopt decoding) are unavailable.
if (typeof window !== 'undefined') {
  useGLTF.preload(
    'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/about/beliefs/ghost-transformed.glb'
  );
}
'use client';

import { motion, useReducedMotion } from 'framer-motion';

import AntigravityCTA from '@/components/ui/AntigravityCTA';
import { ABOUT_CONTENT } from '@/config/content';

import { motionTokens } from './motion';

export function AboutClosing() {
  const prefersReducedMotion = useReducedMotion();

  return (
    <section
      className="std-grid bg-background py-20 md:py-32"
      aria-label="Fechamento do Manifesto"
    >
      <motion.div
        variants={motionTokens.fadeGhost}
        initial={prefersReducedMotion ? 'visible' : 'hidden'}
        whileInView="visible"
        viewport={{ once: true, margin: '-80px' }}
        className="w-full flex-col items-center text-center"
      >
        {/* Bloco 1: Título Principal e Linhas */}
        <div className="w-full">
          <div className="mb-10 h-px w-full bg-blueAccent/30" />
          <h2 className="text-display font-bold leading-tight text-white md:leading-[1.1]">
            Hoje sou{' '}
            <span className="text-bluePrimary">Diretor de Criação</span>,
            <br />
            com mais de{' '}
            <span className="text-bluePrimary">12 anos de estrada.</span>
          </h2>
          <div className="mt-10 h-px w-full bg-blueAccent/30" />
        </div>

        {/* Bloco 2: Frase 1 e Vídeo */}
        <div className="mt-16 md:mt-20 flex flex-col items-center">
          <p className="text-h2 text-white max-w-200 leading-snug mx-auto text-center">
            Já liderei marcas, agências, eventos e{' '}
            <span className="text-bluePrimary">criei experiências</span> para
            todos os canais.
          </p>

          {/* Vídeo em Loop - Container flexível para manter aspecto nativo do vídeo */}
          <div className="mt-12 w-full overflow-hidden rounded-xl shadow-2xl md:mt-11">
            {/* Desktop Video - Mantém aspecto nativo sem corte */}
            <video
              className="hidden md:block w-full h-auto"
              src="https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/about/beliefs/VIDEO-SKILLS-FINAL_compressed.mp4"
              autoPlay
              loop
              muted
              playsInline
              preload="auto"
              aria-label="Demonstração visual de experiências"
            />
            {/* Mobile Video - Mantém aspecto nativo sem corte */}
            <video
              className="md:hidden w-full h-auto"
              src="https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/about/beliefs/VIDEO-SKILLS-MOBILE-FINAL.mp4"
              autoPlay
              loop
              muted
              playsInline
              preload="auto"
              aria-label="Demonstração visual de experiências"
            />
          </div>
        </div>

        {/* Bloco 3: Frase 2 e CTAs */}
        <div className="mt-16 md:mt-20 flex flex-col items-center">
          <p className="text-h2 text-white leading-snug">
            Agora, quero criar algo que permaneça —{' '}
            <span className="text-bluePrimary">com você.</span>
          </p>

          <div className="mt-12 flex flex-row flex-wrap items-center justify-center gap-6 md:mt-16 md:gap-8">
            {ABOUT_CONTENT.closing.ctas.map((cta, index) => (
              <AntigravityCTA
                key={index}
                href={cta.href}
                text={cta.label}
                className="relative min-w-50"
              />
            ))}
          </div>
        </div>
      </motion.div>
    </section>
  );
}
'use client';

import { useRef, useEffect } from 'react';
import {
  motion,
  useReducedMotion,
  useScroll,
  useSpring,
  useTransform,
} from 'framer-motion';

import { ABOUT_CONTENT } from '@/config/content';
import { motionTokens, motionSprings } from './motion';
import { useSiteAssetUrl } from '@/contexts/site-assets';
import { SITE_ASSET_KEYS } from '@/config/site-assets';

export function AboutHero() {
  const prefersReducedMotion = useReducedMotion();
  const containerRef = useRef<HTMLElement>(null);
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start end', 'end start'],
  });

  // REDUCE PLAYBACK SPEED FOR SUBTLE LOOK
  const videoRef = useRef<HTMLVideoElement>(null);
  const mobileVideoRef = useRef<HTMLVideoElement>(null);

  useEffect(() => {
    if (videoRef.current) videoRef.current.playbackRate = 0.4;
    if (mobileVideoRef.current) mobileVideoRef.current.playbackRate = 0.4;
  }, []);

  const smoothProgress = useSpring(scrollYProgress, motionSprings.ghost);

  const mediaY = useTransform(
    smoothProgress,
    [0, 1],
    prefersReducedMotion ? [0, 0] : [48, -48]
  );

  // Forçar uso dos URLs padrão do HOME_CONTENT caso os assets do Supabase não estejam disponíveis
  const desktopVideo = useSiteAssetUrl(
    SITE_ASSET_KEYS.heroVideos.aboutDesktop,
    ABOUT_CONTENT.hero.videos.desktop ||
      '/public/videos/about.hero.desktop_video.mp4'
  );
  const mobileVideo = useSiteAssetUrl(
    SITE_ASSET_KEYS.heroVideos.aboutMobile,
    ABOUT_CONTENT.hero.videos.mobile ||
      '/public/videos/about.hero.mobile_video.mp4'
  );

  return (
    <section
      ref={containerRef}
      className="relative min-h-screen bg-background overflow-hidden"
      aria-label="Hero - Manifesto"
    >
      {/* Background Video - Desktop - Forçar exibição mesmo se o URL estiver vazio */}
      <motion.video
        ref={videoRef}
        src={desktopVideo || '/public/videos/about.hero.desktop_video.mp4'}
        autoPlay
        muted
        loop
        playsInline
        preload="metadata"
        className="hidden lg:block absolute inset-0 w-full h-full object-cover opacity-[0.55]"
        aria-hidden="true"
      />

      {/* Desktop Overlay - Contrast Exception Control */}
      <div
        className="hidden lg:block absolute inset-0 bg-background/60 bg-linear-to-r from-background via-background/40 to-background/80 pointer-events-none z-1"
        aria-hidden="true"
      />

      {/* Desktop Content - 12 Column Grid Concept */}
      <div className="relative z-10 hidden lg:flex h-screen items-center overflow-hidden w-full">
        <div className="std-grid w-full">
          <div className="grid grid-cols-12 w-full gap-8">
            {/* Columns 1-6: Empty Space / Negative Space for Video Presence */}
            <div className="col-span-6" aria-hidden="true" />

            {/* Columns 7-12: Content Block */}
            {/* Columns 7-12: Content Block */}
            <motion.div
              initial="hidden"
              whileInView="visible"
              viewport={{ once: true, amount: 0.3 }}
              className="col-span-6 flex flex-col items-end text-right -translate-y-[10%]"
            >
              <div className="w-full flex flex-col items-end max-w-[750px] ml-auto">
                {/* Intro & Manifesto - Unified for natural wrapping */}
                <motion.div
                  initial={{ opacity: 0, y: 24, filter: 'blur(10px)' }}
                  whileInView={{ opacity: 1, y: 0, filter: 'blur(0px)' }}
                  transition={{
                    duration: 1.2,
                    ease: [0.22, 1, 0.36, 1],
                    delay: 0,
                  }}
                  className="mb-12 flex flex-col items-end gap-1"
                >
                  <h1 className="text-[clamp(44px,4.5vw,64px)] font-medium leading-[1.08] tracking-[-0.02em] text-text-light text-right">
                    {ABOUT_CONTENT.hero.title.text}
                    {ABOUT_CONTENT.hero.title.highlight && (
                      <span className="text-bluePrimary font-semibold ml-2">
                        {ABOUT_CONTENT.hero.title.highlight}
                      </span>
                    )}
                  </h1>

                  <div className="flex flex-col items-end">
                    {ABOUT_CONTENT.hero.manifesto.map((item, index) => (
                      <p
                        key={index}
                        className="text-[clamp(44px,4.5vw,64px)] font-medium leading-[1.08] tracking-[-0.02em] text-text-light text-right"
                      >
                        {item.text}
                        {item.highlight && (
                          <span className="text-bluePrimary font-semibold ml-2">
                            {item.highlight}
                          </span>
                        )}
                        {item.textEnd}
                      </p>
                    ))}
                  </div>
                </motion.div>

                {/* Description - Responsive line breaks */}
                <motion.div
                  initial={{ opacity: 0, y: 24 }}
                  whileInView={{ opacity: 1, y: 0 }}
                  transition={{
                    duration: 1.2,
                    ease: [0.22, 1, 0.36, 1],
                    delay: 0.4,
                  }}
                >
                  <h3 className="type-h3 text-white text-right font-medium max-w-[620px]">
                    {ABOUT_CONTENT.hero.description.join(' ')}
                  </h3>
                </motion.div>
              </div>
            </motion.div>
          </div>
        </div>
      </div>

      {/* Gradient Bottom Decay */}
      {/* Gradient Bottom Decay - Suaviza transição para próxima sessão */}
      <div className="absolute bottom-0 left-0 w-full h-[30vh] md:h-[40vh] bg-linear-to-t from-background via-background/80 to-transparent pointer-events-none z-20" />

      {/* Mobile Hero Video */}
      <div className="lg:hidden">
        <div className="relative aspect-square w-full overflow-hidden">
          <motion.video
            ref={mobileVideoRef}
            src={mobileVideo}
            autoPlay
            muted
            loop
            playsInline
            preload="metadata"
            className="absolute inset-0 w-full h-full object-cover object-top opacity-[0.78]"
            style={{ y: mediaY }}
            aria-hidden="true"
          />
          <div className="absolute inset-0 bg-linear-to-t from-background via-transparent to-transparent z-10" />
        </div>
        <div className="relative z-10 px-6 pt-10 pb-20 text-center">
          <motion.div
            initial={prefersReducedMotion ? 'visible' : 'hidden'}
            animate="visible"
            variants={{
              visible: {
                transition: {
                  staggerChildren: 0.2,
                  delayChildren: 0.3,
                },
              },
            }}
            className="space-y-6"
          >
            <motion.div
              variants={{
                hidden: { opacity: 0, filter: 'blur(10px)' },
                visible: {
                  opacity: 1,
                  filter: 'blur(0px)',
                  transition: {
                    duration: 1.4,
                    ease: [0.22, 1, 0.36, 1] as const,
                  },
                },
              }}
              className="space-y-4"
            >
              <h1 className="type-h2 text-white leading-tight flex flex-col gap-1">
                <span>
                  Sou <span className="text-bluePrimary">Danilo Novais.</span>
                </span>
                <span>
                  Você <span className="text-bluePrimary">não vê tudo</span> o
                  que eu faço.
                </span>
                <span>
                  Mas sente quando{' '}
                  <span className="text-bluePrimary">funciona.</span>
                </span>
              </h1>
            </motion.div>
            <motion.div
              variants={motionTokens.fadeGhost}
              className="type-h3 text-white leading-snug tracking-tight max-w-[98%] mx-auto font-medium"
            >
              {ABOUT_CONTENT.hero.description.map((line, index) => (
                <span key={index} className="block">
                  {line}
                </span>
              ))}
            </motion.div>
          </motion.div>
        </div>
      </div>
    </section>
  );
}
/* Ghost.module.css */

/* Cores definidas como variáveis locais para fácil ajuste */
.ghostContainer {
  --color-primary: var(--blue-primary);
  --color-purple-details: var(--purple-details);
  --color-ghost-bg: var(--background-dark);

  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  /* Ajustado para ocupar altura do container pai, não 100vh fixo */
  overflow: hidden;
}

.svgIcon {
  width: 100%;
  max-width: 200px;
  /* Tamanho máximo otimizado para a seção */
  height: auto;
}

/* A animação suave dos olhos */
.eyeGroup {
  will-change: transform;
}
'use client';

import { useRef } from 'react';
import {
  motion,
  useScroll,
  useTransform,
  useSpring,
  useReducedMotion,
} from 'framer-motion';

// =============================================================================
// AboutWhatIDo - Ghost System v3.0
// Horizontal scroll-driven animation with Ghost Design aesthetics
// =============================================================================

const SERVICES = [
  {
    id: '01',
    keyword: 'Direção',
    description: 'criativa que organiza o caos',
  },
  {
    id: '02',
    keyword: 'Design',
    description: 'estratégico que guia decisões',
  },
  {
    id: '03',
    keyword: 'Identidades',
    description: 'que permanecem na memória',
  },
  {
    id: '04',
    keyword: 'Campanhas',
    description: 'multicanais com lógica e emoção',
  },
  {
    id: '05',
    keyword: 'Branding',
    description: 'que não grita — mas marca',
  },
  {
    id: '06',
    keyword: 'Inteligência Artificial',
    description: 'aplicada à criação',
  },
  {
    id: '07',
    keyword: 'Liderança Criativa',
    description: 'com visão e método',
  },
];

const MARQUEE_KEYWORDS = [
  'Branding',
  'Identidade Visual',
  'Motion Design',
  'Campanhas',
  'UI/UX',
  'Direção de Arte',
  'Creative Coding',
  'AI Design',
];

// Ghost easing curve
const ghostEase = [0.22, 1, 0.36, 1] as const;

export function AboutWhatIDo() {
  const containerRef = useRef<HTMLDivElement>(null);
  const prefersReducedMotion = !!useReducedMotion();

  // Scroll-driven horizontal animation for desktop
  // Maps vertical scroll progress (0→1) to horizontal translation
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ['start start', 'end end'],
  });

  // Spring for smoother motion (Ghost feel)
  const smoothProgress = useSpring(scrollYProgress, {
    stiffness: 100,
    damping: 30,
    restDelta: 0.001,
  });

  // X translation: starts at +120vw (off-screen right), ends at -100% (off-screen left)
  const x = useTransform(smoothProgress, [0, 1], ['120vw', '-120%']);

  // Opacity for fade in/out at edges
  const trackOpacity = useTransform(
    smoothProgress,
    [0, 0.05, 0.95, 1],
    [0, 1, 1, 0]
  );

  return (
    <section
      ref={containerRef}
      className="relative z-10 w-full bg-[#040013] text-white"
      aria-labelledby="what-i-do-heading"
    >
      {/* ============================================
          DESKTOP LAYOUT (≥ 1024px)
          Sticky container with horizontal scroll-driven animation
          ============================================ */}
      <div className="hidden lg:block lg:h-[300vh]">
        <div className="sticky top-0 flex h-screen w-full flex-col items-center justify-center overflow-hidden">
          {/* Header */}
          <div className="absolute top-0 z-20 flex w-full justify-center pt-20">
            <div className="max-w-[900px] text-center">
              <h2
                id="what-i-do-heading"
                className="font-display text-5xl font-black leading-[1.15] tracking-tight text-white md:text-6xl"
              >
                Do <span className="text-[#0048ff]">insight</span> ao{' '}
                <span className="text-[#0048ff]">impacto</span>.
              </h2>
              <p className="mt-3 font-display text-4xl font-black leading-[1.15] tracking-tight text-white/90 md:text-5xl">
                Mesmo quando você não percebe.
              </p>
            </div>
          </div>

          {/* Horizontal Track - Cards sliding right→left */}
          <motion.div
            style={{
              x: prefersReducedMotion ? 0 : x,
              opacity: prefersReducedMotion ? 1 : trackOpacity,
            }}
            className="flex gap-6 will-change-transform pt-32"
          >
            {SERVICES.map((service, index) => (
              <motion.article
                key={service.id}
                initial={{ opacity: 0, scale: 0.95 }}
                whileInView={{ opacity: 1, scale: 1 }}
                viewport={{ once: true, margin: '-5%' }}
                transition={{
                  duration: 0.4,
                  delay: index * 0.06,
                  ease: ghostEase,
                }}
                className="group flex min-h-[140px] min-w-[380px] items-center gap-5 rounded-2xl bg-[#0048ff] p-6 shadow-[0_25px_50px_-12px_rgba(0,72,255,0.5)] transition-all duration-300 hover:scale-[1.02] hover:shadow-[0_30px_60px_-12px_rgba(0,72,255,0.65)]"
              >
                {/* Number */}
                <span
                  className="shrink-0 font-display text-5xl font-black text-[#8705f2] transition-transform duration-300 group-hover:scale-110"
                  aria-hidden="true"
                >
                  {service.id}
                </span>
                {/* Text */}
                <p className="font-display text-xl font-bold leading-tight text-white">
                  <strong className="text-[#4fe6ff]">{service.keyword}</strong>{' '}
                  {service.description}
                </p>
              </motion.article>
            ))}
          </motion.div>

          {/* Ghost Gradient Edges */}
          <div className="pointer-events-none absolute inset-y-0 left-0 w-32 bg-linear-to-r from-[#040013] to-transparent" />
          <div className="pointer-events-none absolute inset-y-0 right-0 w-32 bg-linear-to-l from-[#040013] to-transparent" />
        </div>
      </div>

      {/* ============================================
          MOBILE LAYOUT (< 1024px)
          Vertical stack with viewport-triggered horizontal entrance
          ============================================ */}
      <div className="block py-16 lg:hidden">
        <div className="std-grid">
          {/* Header */}
          <header className="mb-12 text-center">
            <h2
              id="what-i-do-heading-mobile"
              className="font-display text-[2.5rem] font-black leading-[1.1] tracking-tight text-white"
            >
              Do <span className="text-[#0048ff]">insight</span> ao{' '}
              <span className="text-[#0048ff]">impacto</span>.
            </h2>
            <p className="mt-2 font-display text-[1.75rem] font-black leading-[1.1] tracking-tight text-white/90">
              Mesmo quando você não percebe.
            </p>
          </header>

          {/* Mobile Cards - Horizontal entrance from right */}
          <div className="flex flex-col gap-3">
            {SERVICES.map((service, index) => (
              <motion.article
                key={service.id}
                initial={
                  prefersReducedMotion
                    ? { opacity: 1, x: 0 }
                    : { opacity: 0, x: 80 }
                }
                whileInView={{ opacity: 1, x: 0 }}
                viewport={{ once: true, margin: '-10%' }}
                transition={{
                  duration: 0.4,
                  delay: index * 0.08,
                  ease: ghostEase,
                }}
                className="group flex min-h-[76px] w-full items-center gap-4 rounded-xl bg-[#0048ff] px-5 py-4 shadow-[0_16px_40px_-12px_rgba(0,72,255,0.4)] transition-all duration-300 active:scale-[0.98]"
              >
                {/* Number */}
                <span
                  className="shrink-0 font-display text-2xl font-black text-[#8705f2]"
                  aria-hidden="true"
                >
                  {service.id}
                </span>
                {/* Text */}
                <p className="text-sm font-semibold leading-snug text-white">
                  <strong className="text-[#4fe6ff]">{service.keyword}</strong>{' '}
                  {service.description}
                </p>
              </motion.article>
            ))}
          </div>
        </div>
      </div>

      {/* ============================================
          MARQUEE FOOTER (Ghost Design)
          Infinite horizontal scroll - keywords
          ============================================ */}
      <div className="relative overflow-hidden border-t border-white/5 bg-[#040013] py-6">
        {/* Dual marquee for seamless loop */}
        <div className="flex w-max animate-marquee gap-12">
          {/* First set */}
          {MARQUEE_KEYWORDS.map((keyword, i) => (
            <span
              key={`a-${i}`}
              className="text-sm font-medium uppercase tracking-[0.2em] text-white/30"
            >
              {keyword}
            </span>
          ))}
          {/* Duplicate for seamless loop */}
          {MARQUEE_KEYWORDS.map((keyword, i) => (
            <span
              key={`b-${i}`}
              className="text-sm font-medium uppercase tracking-[0.2em] text-white/30"
            >
              {keyword}
            </span>
          ))}
        </div>

        {/* Ghost gradient edges */}
        <div className="pointer-events-none absolute inset-y-0 left-0 w-16 bg-linear-to-r from-[#040013] to-transparent" />
        <div className="pointer-events-none absolute inset-y-0 right-0 w-16 bg-linear-to-l from-[#040013] to-transparent" />
      </div>
    </section>
  );
}

export default AboutWhatIDo;
'use client';

import React from 'react';
import { motion, MotionValue, useTransform, cubicBezier } from 'framer-motion';

interface BeliefFixedHeaderProps {
  opacity: MotionValue<number>;
  progress: MotionValue<number>;
}

// Helper para encapsular a lógica de Morph (Blur + Opacity + Y)
const MorphText: React.FC<{
  children: React.ReactNode;
  progress: MotionValue<number>;
  range: [number, number];
  className?: string;
}> = ({ children, progress, range, className }) => {
  const ghostEase = cubicBezier(0.22, 1, 0.36, 1);
  const blur = useTransform(progress, range, ['blur(12px)', 'blur(0px)'], {
    ease: ghostEase,
  });
  const opacity = useTransform(progress, range, [0, 1], { ease: ghostEase });
  const y = useTransform(progress, range, [40, 0], { ease: ghostEase });

  return (
    <motion.span
      style={{ filter: blur, opacity, y }}
      className={`block ${className || ''}`}
    >
      {children}
    </motion.span>
  );
};

export const BeliefFixedHeader: React.FC<BeliefFixedHeaderProps> = ({
  opacity,
  progress,
}) => {
  return (
    <motion.header
      style={{ opacity }}
      className="sticky top-0 z-30 flex h-screen items-center pointer-events-none"
    >
      <div className="std-grid w-full flex justify-end">
        <div className="flex flex-col items-end text-right w-full max-w-[320px] md:max-w-[500px] lg:max-w-[750px]">
          {/* Primeira parte: "Acredito no..." */}
          <h1 className="text-white text-3xl md:text-5xl lg:text-7xl xl:text-8xl font-display leading-[1.1] tracking-tighter mb-8 uppercase font-black mix-blend-difference whitespace-nowrap">
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.1, 0.2]}>
                Acredito no
              </MorphText>
            </div>
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.12, 0.22]}>
                design que
              </MorphText>
            </div>
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.14, 0.24]}>
                muda o dia
              </MorphText>
            </div>
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.16, 0.26]}>
                de alguém.
              </MorphText>
            </div>
          </h1>

          {/* Segunda parte: "Não pelo choque..." */}
          <div className="flex flex-col items-end gap-1 text-white text-sm md:text-2xl lg:text-4xl font-h2 leading-[1.2] tracking-normal font-bold whitespace-nowrap">
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.22, 0.32]}>
                Não pelo choque,
              </MorphText>
            </div>
            <div className="overflow-visible">
              <MorphText progress={progress} range={[0.24, 0.34]}>
                mas pela conexão.
              </MorphText>
            </div>
          </div>
        </div>
      </div>
    </motion.header>
  );
};
import React from 'react';
import Link from 'next/link';
import { Instagram, Linkedin, Twitter } from 'lucide-react';
import { NAVIGATION, SOCIALS } from '@/config/navigation';

/**
 * SiteFooter Component (Ghost Era Spec 4.7 & Workflow Footer)
 *
 * Protocol:
 * - Desktop (>=1024px): Fixed bar at bottom, 48-64px height, bg-[#0057FF].
 * - Mobile (<1024px): Static section, vertical stack (Copyright → Nav → Social), space-y-8, py-10.
 */
export default function SiteFooter() {
  const socialLinks = [
    {
      label: 'Instagram',
      href: SOCIALS.instagram,
      icon: <Instagram className="w-5 h-5 lg:w-4 lg:h-4" />,
    },
    {
      label: 'LinkedIn',
      href: SOCIALS.linkedin,
      icon: <Linkedin className="w-5 h-5 lg:w-4 lg:h-4" />,
    },
    {
      label: 'Twitter',
      href: SOCIALS.twitter,
      icon: <Twitter className="w-5 h-5 lg:w-4 lg:h-4" />,
    },
  ];

  return (
    <footer
      className="w-full bg-[#0057FF] text-white lg:fixed lg:bottom-0 lg:left-0 lg:z-10 relative z-0 footer-safe-area"
      aria-label="Rodapé do site"
    >
      <div className="std-grid flex flex-col lg:flex-row items-center justify-between py-12 lg:py-0 lg:h-[64px] gap-10 lg:gap-0">
        {/* 1. Copyright (Order 1 on Mobile, Left on Desktop) */}
        <div className="order-1 lg:order-0">
          <p className="text-[0.875rem] lg:text-[10px] font-medium tracking-[0.05em] uppercase opacity-90 lg:opacity-100 text-center lg:text-left">
            {NAVIGATION.footer.copyright}
          </p>
        </div>

        {/* 2. Navigation (Order 2 on Mobile, Center/Right on Desktop) */}
        <nav
          className="flex flex-row flex-wrap justify-center items-center gap-2 sm:gap-4 lg:gap-8 order-2 lg:order-0"
          aria-label="Navegação do rodapé"
        >
          {NAVIGATION.footer.links.map((link) => (
            <Link
              key={link.label}
              href={link.href}
              className="group relative text-[11px] sm:text-[12px] font-bold uppercase tracking-widest hover:opacity-80 transition-opacity duration-200 py-4 px-3 sm:px-4 lg:py-0 lg:px-0 min-h-[48px] flex items-center"
            >
              {link.label}
              {/* Hover Underline (Desktop Only) */}
              <span className="absolute bottom-[-2px] left-0 w-0 h-px bg-white transition-all duration-200 ease-out group-hover:w-full hidden lg:block" />
            </Link>
          ))}
        </nav>

        {/* 3. Social Media (Order 3 on Mobile, Right on Desktop) */}
        <div
          className="flex flex-row items-center justify-center gap-4 order-3 lg:order-0"
          aria-label="Redes sociais"
        >
          {socialLinks.map((social) => (
            <a
              key={social.label}
              href={social.href}
              target="_blank"
              rel="noopener noreferrer"
              className="hover:scale-105 transition-transform duration-200 opacity-100 lg:opacity-90 lg:hover:opacity-100 p-3 lg:p-0 flex items-center justify-center min-w-[48px] min-h-[48px] lg:min-w-0 lg:min-h-0"
              aria-label={social.label}
            >
              {social.icon}
            </a>
          ))}
        </div>
      </div>
    </footer>
  );
}
import React from 'react';
import { cn } from '@/lib/utils';

interface ContainerProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
  as?: React.ElementType;
}

export function Container({
  children,
  className,
  as: Component = 'div',
  ...props
}: ContainerProps) {
  return (
    <Component className={cn('std-grid', className)} {...props}>
      {children}
    </Component>
  );
}
'use client';

import React, { useState, useEffect } from 'react';
import { SiteAssetsProvider } from '@/contexts/site-assets';
import { getClientSiteAssets } from '@/lib/supabase/site-assets-client';
import ClientLayout from '@/components/layout/ClientLayout';
import ErrorBoundary from '@/components/ui/ErrorBoundary';

interface AssetLoaderWrapperProps {
  children: React.ReactNode;
}

export default function AssetLoaderWrapper({
  children,
}: AssetLoaderWrapperProps) {
  const [assets, setAssets] = useState<any[]>([]);
  const [assetsLoaded, setAssetsLoaded] = useState(false);

  useEffect(() => {
    const loadAssets = async () => {
      try {
        const loadedAssets = await getClientSiteAssets();
        setAssets(loadedAssets);
      } catch (error) {
        console.error(
          'Falha ao carregar site_assets:',
          error instanceof Error ? error.message : error
        );

        // Try fallback API call
        try {
          const response = await fetch('/api/site-assets');
          if (response.ok) {
            const assetsData = await response.json();
            setAssets(assetsData);
          } else {
            console.error(
              'Erro ao buscar site_assets via API:',
              response.status,
              response.statusText
            );
          }
        } catch (fallbackError) {
          console.error(
            'Erro fallback de site_assets:',
            fallbackError instanceof Error
              ? fallbackError.message
              : fallbackError
          );
        }
      } finally {
        setAssetsLoaded(true);
      }
    };

    loadAssets();
  }, []);

  // If assets haven't loaded yet, render the children without the provider
  // This allows the page to render while assets are being fetched
  if (!assetsLoaded) {
    return <ClientLayout>{children}</ClientLayout>;
  }

  return (
    <ErrorBoundary>
      <SiteAssetsProvider assets={assets}>
        <ClientLayout>{children}</ClientLayout>
      </SiteAssetsProvider>
    </ErrorBoundary>
  );
}
'use client';

import { ReactNode, useEffect, useMemo, useState } from 'react';
import { usePathname } from 'next/navigation';
import Lenis from 'lenis';
import { ScrollContext } from '@/contexts/ScrollContext';

import { useAntigravityStore } from '@/store/antigravity.store';

interface SmoothScrollProps {
  children: ReactNode;
}

export default function SmoothScroll({ children }: SmoothScrollProps) {
  const { flags } = useAntigravityStore();
  const pathname = usePathname();

  // Admin screens should keep the browser's native scroll to avoid
  // smooth-scroll side effects (Playwright needs window.scrollY to change).
  const isAdminRoute = useMemo(
    () => pathname?.startsWith('/admin') ?? false,
    [pathname]
  );

  const [lenisInstance, setLenisInstance] = useState<Lenis | null>(null);

  useEffect(() => {
    if (isAdminRoute) {
      document.documentElement.classList.add('admin-page');
    } else {
      document.documentElement.classList.remove('admin-page');
    }
  }, [isAdminRoute]);

  useEffect(() => {
    // ♿ SE REDUCED MOTION → SEM LENIS
    if (flags.reducedMotion || isAdminRoute) {
      setLenisInstance(null);
      return;
    }

    const lenis = new Lenis({
      lerp: 0.08,
      wheelMultiplier: 1,
      touchMultiplier: 1.2,
    });

    setLenisInstance(lenis);

    function raf(time: number) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }

    requestAnimationFrame(raf);

    return () => {
      lenis.destroy();
      setLenisInstance(null);
    };
  }, [flags.reducedMotion, isAdminRoute]);

  return (
    <ScrollContext.Provider
      value={{ lenis: isAdminRoute ? null : lenisInstance }}
    >
      {children}
    </ScrollContext.Provider>
  );
}
'use client';

// Canonical Header Component
import SiteHeader from '@/components/layout/header/SiteHeader';
import { BRAND } from '@/config/brand';
import { NAVIGATION } from '@/config/navigation';

export default function Header() {
  return (
    <SiteHeader
      navItems={NAVIGATION.header || []}
      gradient={['rgba(0,87,255,0.55)', 'rgba(82,39,255,0.45)']}
      accentColor={BRAND.colors.bluePrimary}
    />
  );
}
'use client';

import ClientsBrandsSection from '@/components/home/clients/ClientsBrandsSection';
import ContactSection from '@/components/home/contact/ContactSection';
import SiteFooter from '@/components/layout/SiteFooter';

/**
 * SiteClosure Component
 *
 * This component unifies the mandatory ending sections of every page:
 * 1. Clients/Brands Grid (Blue)
 * 2. Contact Section (Light Grey/Form)
 * 3. Site Footer (Blue)
 *
 * Regra Absoluta (Ghost Era): Estas seções devem sempre aparecer juntas nesta ordem
 * para manter a consistência visual e narrativa do portfólio.
 */
export function SiteClosure() {
  return (
    <>
      <ClientsBrandsSection />
      <ContactSection />
      <SiteFooter />
    </>
  );
}
import { BRAND } from '@/config/brand';
// ============================================================================
// src/components/header/headerTokens.ts
// Tokens de layout, cor e motion específicos do Header
// ============================================================================

export const headerColors = {
  primary: BRAND.colors.bluePrimary,
  background: BRAND.colors.background,
  text: BRAND.colors.text,
  textInverse: BRAND.colors.textInverse,
  accent: BRAND.colors.blueAccent,
};

export const headerZ = {
  heroContent: 20,
  header: 40,
};

export const glassMotionTokens = {
  maxTranslateX: 50,
  scaleX: [1, 1] as [number, number],
  scaleY: [1, 1] as [number, number],
  followDamping: 0.12,
};

export const mobileMenuMotionTokens = {
  overlayDuration: 0.22,
  panelDuration: 0.28,
  itemDuration: 0.22,
  itemInitialY: 16,
  staggerDelay: 0.08,
};

// Backwards compatibility
export const HEADER_TOKENS = {
  zIndex: headerZ.header,
  desktop: {
    height: 64,
    maxTranslateX: glassMotionTokens.maxTranslateX,
    maxScaleX: glassMotionTokens.scaleX[1],
    maxScaleY: glassMotionTokens.scaleY[1],
    followDamping: 18,
  },
  mobile: {
    height: 56,
    staggerDelay: mobileMenuMotionTokens.staggerDelay,
  },
  colors: headerColors,
} as const;
.headerContainer {
  position: relative;
  overflow: hidden;
  border-radius: 9999px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2);
}

.fallbackBackground {
  height: 100%;
  width: 100%;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.08),
    rgba(255, 255, 255, 0.02)
  );
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}

.subtleBorder {
  position: absolute;
  inset: 0;
  border-radius: 9999px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  pointer-events: none;
}

.headerDark {
  background-color: rgba(4, 0, 19, 0.4);
  border-color: rgba(255, 255, 255, 0.1);
}

.headerLight {
  background-color: rgba(4, 0, 19, 0.6);
  border-color: rgba(255, 255, 255, 0.15);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}
'use client';

import React, { useCallback, useEffect, useMemo, useState } from 'react';
import { useRouter, usePathname } from 'next/navigation';

import { BRAND } from '@/config/brand';
import { useMediaQuery } from '@/hooks/useMediaQuery';
import { useSiteAssetUrl } from '@/contexts/site-assets';
import { SITE_ASSET_KEYS } from '@/config/site-assets';

import type { NavItem, SiteHeaderProps } from './types';
import DesktopFluidHeader from './DesktopFluidHeader';
import MobileStaggeredMenu from './MobileStaggeredMenu';
import { useActiveSection } from './useActiveSection';

function isHashHref(href: string) {
  return href.startsWith('#') || href.startsWith('/#');
}

function getHashFromHref(href: string) {
  if (href.startsWith('/#')) return href.substring(1);
  if (href.startsWith('#')) return href;
  return '';
}

function scrollToHash(hashHref: string) {
  const id = hashHref.replace('#', '');
  const el = document.getElementById(id);
  if (!el) return;
  el.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function isExternalHref(href: string) {
  return (
    /^https?:\/\//.test(href) ||
    href.startsWith('mailto:') ||
    href.startsWith('tel:')
  );
}

export default function SiteHeader({
  navItems,
  gradient,
  accentColor,
}: SiteHeaderProps) {
  const router = useRouter();
  const [isOpen, setIsOpen] = useState(false);
  const [isOnLightSection, setIsOnLightSection] = useState(false);
  const [isMounted, setIsMounted] = useState(false);

  const isDesktop = useMediaQuery('(min-width: 1024px)');

  // Hydration safety
  useEffect(() => {
    setIsMounted(true);
  }, []);

  const sectionIds = useMemo(
    () =>
      navItems
        .filter((n) => isHashHref(n.href))
        .map((n) => getHashFromHref(n.href).replace('#', '')),
    [navItems]
  );

  const activeSection = useActiveSection(sectionIds);
  const pathname = usePathname();

  const activeHref = useMemo(() => {
    if (pathname === '/') return activeSection;
    return pathname ?? undefined;
  }, [pathname, activeSection]);

  const isSobrePage = pathname?.startsWith('/sobre');

  const onNavigate = useCallback(
    (href: string) => {
      const hash = getHashFromHref(href);

      if (hash) {
        const isHomePage = window.location.pathname === '/';
        const isTargetingCurrentPageHash =
          href.startsWith('#') || (href.startsWith('/#') && isHomePage);

        if (isTargetingCurrentPageHash) {
          scrollToHash(hash);
          setIsOpen(false);
          return;
        }
      }

      if (isExternalHref(href)) {
        window.open(href, '_blank', 'noopener,noreferrer');
        setIsOpen(false);
        return;
      }

      router.push(href);
      setIsOpen(false);
    },
    [router]
  );

  const normalizedNavItems: NavItem[] = useMemo(() => navItems, [navItems]);

  useEffect(() => {
    const sections = Array.from(
      document.querySelectorAll<HTMLElement>('[data-light-section]')
    );
    if (!sections.length) return;

    const observer = new IntersectionObserver(
      (entries) => {
        const isLight = entries.some((e) => e.isIntersecting);
        setIsOnLightSection(isLight);
      },
      { threshold: 0.12, rootMargin: '-60px 0px 0px 0px' }
    );

    sections.forEach((sec) => observer.observe(sec));
    return () => observer.disconnect();
  }, []);

  const logoUrl =
    useSiteAssetUrl(
      SITE_ASSET_KEYS.logos.headerLight,
      BRAND.assets.logos.logoLight
    ) ?? BRAND.assets.logos.logoLight;
  const logoDesktop = logoUrl;
  const logoMobile = logoUrl;

  if (!isMounted) return null;

  return (
    <>
      {isDesktop ? (
        <DesktopFluidHeader
          navItems={normalizedNavItems}
          logoUrl={logoDesktop}
          isLight={isOnLightSection}
          isPageActive={isSobrePage}
          onNavigate={onNavigate}
          activeHref={activeHref}
        />
      ) : (
        <MobileStaggeredMenu
          navItems={normalizedNavItems}
          logoUrl={logoMobile}
          isLight={isOnLightSection}
          gradient={gradient}
          accentColor={accentColor}
          isOpen={isOpen}
          onOpen={() => setIsOpen(true)}
          onClose={() => setIsOpen(false)}
          onNavigate={onNavigate}
          activeHref={activeHref}
          isPageActive={isSobrePage}
        />
      )}
    </>
  );
}
'use client';

import Link from 'next/link';
import Image from 'next/image';
import { useMemo, useRef } from 'react';
import type { NavItem } from './types';
import styles from './DesktopFluidHeader.module.css';

// Forced static behavior - removing dynamic import for WebGL
// const HeaderFluidGlass = dynamic(
//   () => import('@/components/canvas/header/HeaderFluidGlass'),
//   {
//     ssr: false,
//   }
// );

export interface DesktopFluidHeaderProps {
  navItems: NavItem[];
  logoUrl: string;
  onNavigate: (_href: string) => void;
  activeHref?: string;
  isLight?: boolean;
  isPageActive?: boolean;
}

function isExternalHref(href: string) {
  return (
    /^https?:\/\//.test(href) ||
    href.startsWith('mailto:') ||
    href.startsWith('tel:')
  );
}

export default function DesktopFluidHeader({
  navItems,
  logoUrl,
  onNavigate,
  activeHref,
  isLight,
  isPageActive,
}: DesktopFluidHeaderProps) {
  const wrapRef = useRef<HTMLDivElement>(null);

  const nav = useMemo(() => navItems, [navItems]);
  const shouldHighlightPage = Boolean(isPageActive);

  return (
    <header
      className={`hidden lg:block fixed top-6 left-0 right-0 z-40 w-full pointer-events-none transition-all duration-300 ease-in-out ${
        isLight ? 'header--light' : ''
      }`}
    >
      <div
        className={
          'flex justify-center w-full max-w-[1680px] mx-auto px-6 md:px-12 lg:px-16 xl:px-24'
        }
      >
        <div ref={wrapRef} className="pointer-events-auto w-full relative">
          <div
            className={`${styles.headerContainer} ${
              isLight ? styles.headerLight : styles.headerDark
            } h-16 w-[calc(100%+5rem)] -ml-10 rounded-4xl backdrop-blur-md border border-white/10 bg-black/20 transition-all duration-300`}
          >
            {/* glass background - Static only */}
            {/* <div className="absolute inset-0 rounded-full overflow-hidden">
               Static fallback always
                <div className={styles.fallbackBackground} />
            </div> */}

            {/* content */}
            <div className="relative z-10 h-full px-10 flex items-center justify-between gap-6">
              <Link
                href="/"
                aria-label="Ir para Home"
                className="flex items-center gap-3 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-transparent rounded-full"
              >
                <Image
                  src={logoUrl}
                  alt="Danilo"
                  width={32}
                  height={32}
                  className="h-22 w-22 object-contain transition-colors duration-300"
                />
              </Link>

              <nav
                aria-label="Navegação principal"
                className="flex items-center gap-7"
              >
                {nav.map((item) => {
                  const hash = item.href.startsWith('/#')
                    ? item.href.substring(1)
                    : item.href;
                  const isActive = activeHref === hash;

                  const common =
                    'transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-transparent rounded-md text-xs uppercase tracking-[0.2em]';
                  const baseText = isLight ? 'text-white' : 'text-white/70';
                  const hoverText = isLight
                    ? 'hover:text-blueAccent'
                    : 'hover:text-white';
                  const activeText = isLight
                    ? 'text-blueAccent'
                    : 'text-bluePrimary';
                  const textColor = isActive
                    ? `${activeText} font-semibold`
                    : `${baseText} ${hoverText} font-medium`;
                  const pageOverride = shouldHighlightPage
                    ? 'text-bluePrimary font-semibold'
                    : '';
                  const underline = isActive
                    ? 'after:absolute after:-bottom-1 after:left-0 after:w-full after:h-[1px] after:bg-current'
                    : 'after:absolute after:-bottom-1 after:left-0 after:w-0 after:h-[1px] after:bg-current group-hover:after:w-full after:transition-all after:duration-300';

                  if (isExternalHref(item.href) || item.external) {
                    return (
                      <a
                        key={item.href}
                        href={item.href}
                        target="_blank"
                        rel="noopener noreferrer"
                        className={`group ${common} ${textColor} ${pageOverride} relative flex items-center`}
                      >
                        <span className="tracking-tight">{item.label}</span>
                        <span className={underline} />
                      </a>
                    );
                  }

                  return (
                    <button
                      key={item.href}
                      type="button"
                      onClick={() => onNavigate(item.href)}
                      className={`group ${common} ${textColor} ${pageOverride} relative flex items-center`}
                    >
                      <span className="tracking-tight">{item.label}</span>
                      <span className={underline} />
                    </button>
                  );
                })}
              </nav>
            </div>
          </div>
        </div>
      </div>
    </header>
  );
}
'use client';

import { useEffect, useState } from 'react';

export function useActiveSection(
  sectionIds: string[],
  rootMargin = '-45% 0px -45% 0px'
) {
  const [active, setActive] = useState<string>('#hero');

  useEffect(() => {
    const els = sectionIds
      .map((id) => document.getElementById(id))
      .filter(Boolean) as HTMLElement[];

    if (!els.length) return;

    const obs = new IntersectionObserver(
      (entries) => {
        const visible = entries
          .filter((e) => e.isIntersecting)
          .sort(
            (a, b) => (b.intersectionRatio ?? 0) - (a.intersectionRatio ?? 0)
          )[0];

        if (visible?.target?.id) setActive(`#${visible.target.id}`);
      },
      { root: null, threshold: [0.15, 0.25, 0.35], rootMargin }
    );

    els.forEach((el) => obs.observe(el));
    return () => obs.disconnect();
  }, [rootMargin, sectionIds]);

  return active;
}
'use client';

import {
  MobileMenuButton,
  MobileMenuPanel,
  MobilePreLayers,
  MobileHeaderBar,
} from './mobile';

import React, { useEffect } from 'react';
import { useMobileMenuAnimation } from '@/hooks/useMobileMenuAnimation';

export interface NavItem {
  label: string;
  href: string;
  external?: boolean;
}

export interface MobileStaggeredMenuProps {
  navItems: NavItem[];
  logoUrl: string;
  isLight?: boolean;
  gradient?: [string, string];
  accentColor?: string;
  isOpen: boolean;
  onOpen: () => void;
  onClose: () => void;
  onNavigate: (_href: string) => void;
  activeHref?: string;
  isPageActive?: boolean;
}

export default function MobileStaggeredMenu({
  navItems,
  logoUrl,
  isLight = false,
  accentColor = '#0057FF',
  isOpen,
  onOpen,
  onClose,
  onNavigate,
  activeHref,
  isPageActive,
}: MobileStaggeredMenuProps) {
  const {
    refs: {
      panelRef,
      preLayersRef,

      socialsRef,
      toggleBtnRef,
      plusHRef,
      plusVRef,
      iconRef,
      textInnerRef,
    },
    state: { open, textLines },
    actions: { toggleMenu, syncState },
  } = useMobileMenuAnimation(isOpen, onOpen, onClose);

  // Sync with external isOpen prop
  useEffect(() => {
    syncState();
  }, [isOpen, syncState]);

  // Lock body scroll
  useEffect(() => {
    if (open) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
    return () => {
      document.body.style.overflow = '';
    };
  }, [open]);

  // Handle ESC key
  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => {
      if (e.key === 'Escape' && open) onClose();
    };
    window.addEventListener('keydown', handleEsc);
    return () => window.removeEventListener('keydown', handleEsc);
  }, [onClose]);

  // Focus trap
  useEffect(() => {
    if (!open || !panelRef.current) return;
    const focusableElements = panelRef.current.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
    const firstElement = focusableElements[0] as HTMLElement;
    const lastElement = focusableElements[
      focusableElements.length - 1
    ] as HTMLElement;

    const handleTab = (e: KeyboardEvent) => {
      if (e.key !== 'Tab') return;
      if (e.shiftKey) {
        if (document.activeElement === firstElement) {
          lastElement.focus();
          e.preventDefault();
        }
      } else {
        if (document.activeElement === lastElement) {
          firstElement.focus();
          e.preventDefault();
        }
      }
    };

    firstElement?.focus();
    window.addEventListener('keydown', handleTab);
    return () => window.removeEventListener('keydown', handleTab);
  }, [open]);

  return (
    <div className="lg:hidden relative z-60">
      <MobileHeaderBar
        logoUrl={logoUrl}
        onLogoClick={onClose}
        isLight={open ? false : isLight}
      >
        <MobileMenuButton
          ref={toggleBtnRef}
          open={open}
          textLines={textLines}
          textInnerRef={textInnerRef}
          iconRef={iconRef}
          plusHRef={plusHRef}
          plusVRef={plusVRef}
          onToggle={toggleMenu}
        />
      </MobileHeaderBar>

      <MobilePreLayers ref={preLayersRef} accentColor={accentColor} />

      <MobileMenuPanel
        ref={panelRef}
        navItems={navItems}
        accentColor={accentColor}
        open={open}
        socialsRef={socialsRef}
        onNavigate={onNavigate}
        onClose={onClose}
        activeHref={activeHref}
        isPageActive={isPageActive}
      />
    </div>
  );
}
// ============================================================================
// src/components/header/types.ts
// Tipos públicos do sistema de Header (mantendo a API descrita na especificação)
// ============================================================================

export interface NavItem {
  label: string;
  href: string;
  external?: boolean;
}

export interface SiteHeaderProps {
  navItems: NavItem[];
  logoUrl?: string;
  logoUrlMobile?: string;
  gradient: [string, string]; // gradiente principal para mobile
  accentColor: string;
  reducedMotion?: boolean;
}

export interface DesktopFluidHeaderProps {
  navItems: NavItem[];
  logoUrl: string;
  isLight?: boolean;
  height?: number;
  onNavigate: (_href: string) => void;
  activeHref?: string;
  glass?: {
    ior?: number;
    thickness?: number;
    chromaticAberration?: number;
    anisotropy?: number;
    smoothness?: number;
    maxTranslateX?: number;
    followDamping?: number;
  };
}

export interface MobileStaggeredMenuProps {
  navItems: NavItem[];
  logoUrl: string;
  isLight?: boolean;
  gradient: [string, string];
  accentColor: string;
  isOpen: boolean;
  isFixed?: boolean;
  onOpen?: () => void;
  onClose?: () => void;
  onNavigate?: (_href: string) => void;
  staggerDelay?: number;
}
'use client';

import React, { forwardRef } from 'react';
import { motion } from 'framer-motion';

interface MobilePreLayersProps {
  accentColor: string;
}

const MobilePreLayers = forwardRef<HTMLDivElement, MobilePreLayersProps>(
  (_, ref) => {
    // Ghost theme colors for pre-layers using CSS variables fallback
    const preLayerColors = [
      '#4fe6ff', // blueAccent
      '#8705f2', // purpleDetails
      '#f501d3', // Pink vibrant
    ];

    return (
      <div
        ref={ref}
        className="fixed top-0 right-0 bottom-0 w-full pointer-events-none z-49"
        aria-hidden="true"
      >
        {preLayerColors.map((color, i) => (
          <motion.div
            key={i}
            className="sm-prelayer absolute top-0 right-0 h-full w-full"
            initial={false}
            animate={{ backgroundColor: color }}
          />
        ))}
      </div>
    );
  }
);

MobilePreLayers.displayName = 'MobilePreLayers';
export default MobilePreLayers;
export { default as MobileMenuButton } from './MobileMenuButton';
export { default as MobileMenuPanel } from './MobileMenuPanel';
export { default as MobilePreLayers } from './MobilePreLayers';
export { default as MobileHeaderBar } from './MobileHeaderBar';
export type { NavItem } from './MobileMenuPanel';
'use client';

import React, { forwardRef, RefObject } from 'react';
import { motion } from 'framer-motion';
import { Instagram, Linkedin, Mail } from 'lucide-react';
import { SOCIALS } from '@/config/navigation';

export interface NavItem {
  label: string;
  href: string;
  external?: boolean;
}

interface MobileMenuPanelProps {
  navItems: NavItem[];
  accentColor: string;
  open: boolean;
  socialsRef: RefObject<HTMLDivElement | null>;
  onNavigate: (_href: string) => void;
  onClose: () => void;
  activeHref?: string;
  isPageActive?: boolean;
}

const MobileMenuPanel = forwardRef<HTMLElement, MobileMenuPanelProps>(
  (
    {
      navItems,
      accentColor,
      open,
      socialsRef,
      onNavigate,
      onClose,
      activeHref,
      isPageActive,
    },
    ref
  ) => {
    return (
      <nav
        ref={ref}
        id="mobile-menu-panel"
        className="fixed inset-0 bg-[#0048ff] backdrop-blur-xl flex flex-col justify-center px-8 z-50 pointer-events-auto sm:px-12 md:px-16"
        style={{
          paddingTop: 'env(safe-area-inset-top, 2rem)',
          paddingBottom: 'env(safe-area-inset-bottom, 2rem)',
          paddingLeft: 'max(2rem, env(safe-area-inset-left, 2rem))',
          paddingRight: 'max(2rem, env(safe-area-inset-right, 2rem))',
        }}
        aria-hidden={open ? 'false' : 'true'}
        onClick={(e) => {
          if (e.target === e.currentTarget) {
            onClose();
          }
        }}
      >
        {/* Menu items */}
        <ul className="flex flex-col gap-4" role="list">
          {navItems.map((item) => {
            const hash = item.href.startsWith('/#')
              ? item.href.substring(1)
              : item.href;
            const isActive = activeHref === hash;
            const pageHighlight = isPageActive
              ? 'text-blueAccent font-semibold'
              : '';

            return (
              <li key={item.href} className="overflow-hidden leading-none">
                <button
                  onClick={() => onNavigate(item.href)}
                  className={`sm-panel-item w-full py-4 text-4xl sm:text-5xl font-light tracking-wide transition-all text-left leading-none uppercase will-change-transform origin-bottom min-h-[56px] active:translate-x-2 active:opacity-70 ${
                    pageHighlight ||
                    (isActive
                      ? 'text-blueAccent font-medium underline underline-offset-4'
                      : 'text-white/80 hover:text-white')
                  }`}
                >
                  {item.label}
                </button>
              </li>
            );
          })}
        </ul>

        {/* Social links */}
        <div
          ref={socialsRef}
          className="mt-12 pt-8 border-t border-white/10 flex flex-col gap-4"
        >
          <motion.h3
            className="sm-social-title text-sm font-medium uppercase tracking-wider"
            initial={false}
            animate={{ color: accentColor }}
          >
            Connect
          </motion.h3>
          <div className="flex gap-4">
            {[
              {
                label: 'LinkedIn',
                href: SOCIALS.linkedin,
                icon: <Linkedin className="w-5 h-5" />,
              },
              {
                label: 'Instagram',
                href: SOCIALS.instagram,
                icon: <Instagram className="w-5 h-5" />,
              },
              {
                label: 'Email',
                href: SOCIALS.emailPrimary,
                icon: <Mail className="w-5 h-5" />,
              },
            ].map((s) => (
              <a
                key={s.label}
                href={s.href}
                target="_blank"
                rel="noopener noreferrer"
                aria-label={s.label}
                className="sm-social-link flex h-12 w-12 items-center justify-center rounded-full border border-white/20 bg-white/5 text-white transition-all hover:bg-primary hover:border-primary hover:scale-105 active:scale-95"
              >
                {s.icon}
              </a>
            ))}
          </div>
        </div>
      </nav>
    );
  }
);

MobileMenuPanel.displayName = 'MobileMenuPanel';
export default MobileMenuPanel;
'use client';

import React, { forwardRef, RefObject } from 'react';

interface MobileMenuButtonProps {
  open: boolean;
  textLines: string[];
  textInnerRef: RefObject<HTMLSpanElement | null>;
  iconRef: RefObject<HTMLSpanElement | null>;
  plusHRef: RefObject<HTMLSpanElement | null>;
  plusVRef: RefObject<HTMLSpanElement | null>;
  onToggle: () => void;
}

const MobileMenuButton = forwardRef<HTMLButtonElement, MobileMenuButtonProps>(
  (
    { open, textLines, textInnerRef, iconRef, plusHRef, plusVRef, onToggle },
    ref
  ) => {
    return (
      <button
        ref={ref}
        type="button"
        onClick={onToggle}
        aria-label={open ? 'Fechar menu' : 'Abrir menu'}
        aria-expanded={open ? 'true' : 'false'}
        className={`relative inline-flex items-center justify-center gap-2 bg-transparent border-0 cursor-pointer font-medium leading-none overflow-visible z-110 min-h-12 min-w-12 px-3 transition-colors duration-300 ${
          open ? 'text-white' : 'text-white hover:text-primary'
        }`}
      >
        {/* Animated text */}
        <span
          className="relative inline-block h-[1em] overflow-hidden whitespace-nowrap"
          aria-hidden="true"
        >
          <span ref={textInnerRef} className="flex flex-col leading-none">
            {textLines.map((line, i) => (
              <span
                className={`block h-[1em] leading-none text-sm tracking-wide ${
                  i === textLines.length - 1 ? 'visible' : 'invisible'
                }`}
                key={`${line}-${i}`}
              >
                {line}
              </span>
            ))}
          </span>
        </span>

        {/* Animated plus/X icon */}
        <span
          ref={iconRef}
          className="relative w-[18px] h-[18px] shrink-0 inline-flex items-center justify-center will-change-transform"
          aria-hidden="true"
        >
          <span
            ref={plusHRef}
            className="absolute left-1/2 top-1/2 w-full h-[1.5px] bg-current rounded-sm -translate-x-1/2 -translate-y-1/2 will-change-transform"
          />
          <span
            ref={plusVRef}
            className="absolute left-1/2 top-1/2 w-full h-[1.5px] bg-current rounded-sm -translate-x-1/2 -translate-y-1/2 will-change-transform"
          />
        </span>
      </button>
    );
  }
);

MobileMenuButton.displayName = 'MobileMenuButton';
export default MobileMenuButton;
'use client';

import React, { ReactNode } from 'react';
import Image from 'next/image';
import Link from 'next/link';

import { motion, Variants } from 'framer-motion';

interface MobileHeaderBarProps {
  logoUrl: string;
  onLogoClick: () => void;
  children: ReactNode;
  isLight?: boolean;
}
export default function MobileHeaderBar({
  logoUrl,
  onLogoClick,
  children,
  isLight = false,
}: MobileHeaderBarProps) {
  const containerVariants: Variants = {
    hidden: { y: -64, opacity: 0 },
    show: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.8,
        ease: [0.22, 1, 0.36, 1], // Ghost Era Signature
        staggerChildren: 0.1,
        delayChildren: 0.2,
      },
    },
  };

  const itemVariants: Variants = {
    hidden: { opacity: 0, y: -15, filter: 'blur(8px)' },
    show: {
      opacity: 1,
      y: 0,
      filter: 'blur(0px)',
      transition: {
        duration: 0.8,
        ease: [0.22, 1, 0.36, 1],
      },
    },
  };

  return (
    <motion.header
      variants={containerVariants}
      initial="hidden"
      animate="show"
      className={`fixed top-0 left-0 right-0 z-50 pointer-events-none ${
        isLight ? 'header--light' : ''
      }`}
    >
      <div
        className={`w-full h-[60px] pointer-events-auto transition-colors duration-300 ${
          isLight
            ? 'bg-background/40 border-b border-white/10 shadow-xl'
            : 'bg-background/40 backdrop-blur-md border-b border-white/5 shadow-lg shadow-black/20'
        }`}
      >
        <div className="flex items-center justify-between h-full w-full max-w-[1680px] mx-auto px-6 md:px-12 lg:px-16 xl:px-24">
          <motion.div variants={itemVariants}>
            <Link href="/" onClick={onLogoClick}>
              <Image
                src={logoUrl}
                alt="Danilo"
                width={32}
                height={32}
                className="h-20 w-20 object-contain"
                unoptimized
                loading="eager"
              />
            </Link>
          </motion.div>

          <motion.div variants={itemVariants}>{children}</motion.div>
        </div>
      </div>
    </motion.header>
  );
}
'use client';

import React, { useMemo } from 'react';
import { usePathname } from 'next/navigation';
import SmoothScroll from '@/components/layout/SmoothScroll';
import Header from '@/components/layout/Header';

import { useExperience } from '@/hooks/useExperience';
import { useEffect } from 'react';

import { AntigravityDebugger } from '@/components/debug/AntigravityDebugger';

/**
 * Client-side layout wrapper that handles:
 * - Smooth scrolling (Lenis)
 * - Experience orchestration (device detection, WebGL flags)
 * - Header/Footer rendering
 * - Debug overlay
 */
export default function ClientLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const pathname = usePathname();
  const isAdmin = useMemo(
    () => pathname?.startsWith('/admin') ?? false,
    [pathname]
  );

  // 🧠 ORQUESTRAÇÃO GLOBAL DA EXPERIÊNCIA (desativada no /admin para evitar scroll lock)
  useExperience(!isAdmin);

  useEffect(() => {
    if (isAdmin) {
      document.documentElement.classList.add('admin-page');
      return () => {
        document.documentElement.classList.remove('admin-page');
      };
    }
    return;
  }, [isAdmin]);

  if (isAdmin) {
    return (
      <main
        id="main-content"
        className="admin-surface relative min-h-screen bg-slate-950 text-slate-50"
      >
        {children}
      </main>
    );
  }

  return (
    <SmoothScroll>
      <Header />
      <main id="main-content" className="relative grow">
        {children}
      </main>
      {process.env.NODE_ENV === 'development' && <AntigravityDebugger />}
    </SmoothScroll>
  );
}
'use client';

import React from 'react';
import { motion } from 'framer-motion';
import Image from 'next/image';
import Link from 'next/link';
import { useSearchParams } from 'next/navigation';
import { ArrowLeft } from 'lucide-react';
import { LandingPageBlock } from '@/types/landing-page';
import BlockRenderer from './BlockRenderer';

interface ProjectRendererProps {
  project: {
    title: string;
    cover: string;
    content: LandingPageBlock[];
  };
}

export default function ProjectRenderer({ project }: ProjectRendererProps) {
  // Resolve cover URL
  const supabaseBaseUrl =
    process.env.NEXT_PUBLIC_SUPABASE_URL?.replace(/\/$/, '') ?? '';
  const coverUrl =
    project.cover && !project.cover.startsWith('http')
      ? supabaseBaseUrl
        ? `${supabaseBaseUrl}/storage/v1/object/public/site-assets/${project.cover}`
        : ''
      : project.cover || '';

  const searchParams = useSearchParams();
  const from = searchParams.get('from');
  const backUrl = from === 'portfolio' ? '/portfolio' : '/';
  const backLabel =
    from === 'portfolio' ? 'Voltar ao Portfólio' : 'Voltar para Home';

  return (
    <div className="bg-[#040013] text-white selection:bg-blue-600 selection:text-white">
      {/* Hero Section */}
      <section className="relative h-[90vh] w-full flex flex-col items-center justify-center overflow-hidden">
        {coverUrl && (
          <motion.div
            initial={{ scale: 1.1, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            transition={{ duration: 2, ease: [0.22, 1, 0.36, 1] }}
            className="absolute inset-0 z-0"
          >
            <Image
              src={coverUrl}
              alt={project.title}
              fill
              className="object-cover opacity-60"
              priority
            />
            <div className="absolute inset-0 bg-linear-to-b from-transparent via-[#040013]/50 to-[#040013]" />
          </motion.div>
        )}

        <div className="absolute top-0 left-0 z-50 p-6 md:p-10 w-full flex justify-between items-start pointer-events-none">
          <Link
            href={backUrl}
            className="pointer-events-auto group flex items-center gap-3 text-white/50 hover:text-white transition-colors duration-300"
          >
            <div className="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center bg-black/20 backdrop-blur-md group-hover:bg-white/10 transition-all">
              <ArrowLeft className="w-4 h-4 group-hover:-translate-x-0.5 transition-transform" />
            </div>
            <span className="text-sm font-medium uppercase tracking-widest opacity-0 group-hover:opacity-100 -translate-x-2 group-hover:translate-x-0 transition-all duration-300">
              {backLabel}
            </span>
          </Link>
        </div>

        <div className="std-grid relative z-10 text-center">
          <motion.h1
            initial={{ opacity: 0, y: 40 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 1.2, delay: 0.5, ease: [0.22, 1, 0.36, 1] }}
            className="text-6xl md:text-8xl lg:text-9xl font-bold tracking-tighter"
          >
            {project.title}
          </motion.h1>
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ duration: 1, delay: 1.5 }}
            className="mt-12 flex justify-center"
          >
            <div className="w-px h-24 bg-linear-to-b from-blue-600 to-transparent" />
          </motion.div>
        </div>
      </section>

      {/* Dynamic Content Sections */}
      <div className="space-y-32 md:space-y-64 pb-32">
        {project.content && Array.isArray(project.content) ? (
          (project.content as LandingPageBlock[]).map(
            (block: LandingPageBlock, index: number) => (
              <BlockRenderer
                key={block.id ?? `block-${index}`}
                block={block}
                index={index}
              />
            )
          )
        ) : (
          <div className="text-center text-slate-500 py-20">
            Sem conteúdo disponível.
          </div>
        )}
      </div>

      {/* Footer / CTA */}
      <section className="py-32 border-t border-white/5">
        <div className="std-grid text-center space-y-8">
          <p className="text-sm uppercase tracking-[0.3em] text-blue-400 font-bold">
            Obrigado por assistir
          </p>
          <h2 className="text-4xl md:text-6xl font-bold">
            Quer criar algo incrível?
          </h2>
          <div className="flex justify-center pt-8">
            <Link
              href="/#contact"
              className="inline-block px-12 py-5 bg-blue-600 rounded-full text-lg font-bold hover:bg-white hover:text-blue-600 transition-all duration-500"
            >
              Vamos Conversar
            </Link>
          </div>
        </div>
      </section>
    </div>
  );
}
'use client';

import React from 'react';
import Image from 'next/image';
import { motion } from 'framer-motion';
import { LandingPageBlock } from '@/types/landing-page';
import ReactMarkdown from 'react-markdown';

const fadeInUp = {
  hidden: { opacity: 0, y: 40 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.8,
      ease: [0.22, 1, 0.36, 1] as const,
    },
  },
};

interface BlockRendererProps {
  block: LandingPageBlock;
  index: number;
}

/** Configuration for text styling in blocks */
interface TextConfig {
  fontSize?: string;
  fontWeight?: string;
  textAlign?: string;
  color?: string;
}

export default function BlockRenderer({
  block,
  index: _index,
}: BlockRendererProps) {
  const { type, content } = block;

  const resolveMedia = (path?: string): string => {
    if (!path) return '';
    if (path.startsWith('http')) return path;
    return `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${path}`;
  };

  const getYouTubeId = (url: string): string | null => {
    const regExp =
      /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
    const match = url.match(regExp);
    return match && match[2].length === 11 ? match[2] : null;
  };

  const renderText = (text?: string, config?: TextConfig, className = '') => {
    if (!text) return null;

    // Sanitiza HTML embutido removendo atributos style/class perigosos que geram style como string (React error #62)
    const sanitizedText = text
      .replace(/\sstyle\s*=\s*(?:"[^"]*"|'[^']*')/gi, '')
      .replace(/\sclass(Name)?\s*=\s*(?:"[^"]*"|'[^']*')/gi, '');

    const textClasses = [
      config?.fontSize || 'text-lg md:text-xl',
      config?.fontWeight || 'font-light',
      config?.textAlign || '',
      config?.color && !config.color.startsWith('#') ? config.color : '',
      'mb-4 leading-relaxed',
    ].join(' ');

    const hexColor =
      config?.color && config.color.startsWith('#') ? config.color : null;
    const dynamicColorClass = hexColor
      ? `md-text-${hexColor.replace(/[^a-zA-Z0-9]/g, '')}`
      : '';

    return (
      <>
        {hexColor && (
          <style jsx global>{`
            .${dynamicColorClass} {
              color: ${hexColor};
            }
            .${dynamicColorClass} a {
              color: ${hexColor};
            }
          `}</style>
        )}

        <div
          className={`prose prose-invert max-w-none ${className} ${dynamicColorClass}`}
        >
          <ReactMarkdown
            skipHtml
            components={{
              p: ({ children }) => <p className={textClasses}>{children}</p>,
              h1: ({ children }) => (
                <h1
                  className={`${config?.textAlign || ''} font-bold text-4xl md:text-6xl mb-8`}
                >
                  {children}
                </h1>
              ),
              h2: ({ children }) => (
                <h2
                  className={`${config?.textAlign || ''} font-bold text-3xl md:text-5xl mb-6`}
                >
                  {children}
                </h2>
              ),
              h3: ({ children }) => (
                <h3
                  className={`${config?.textAlign || ''} font-bold text-2xl md:text-4xl mb-4`}
                >
                  {children}
                </h3>
              ),
              ul: ({ children }) => (
                <ul
                  className={`${textClasses} list-disc pl-6 mb-4 space-y-2 text-left`}
                >
                  {children}
                </ul>
              ),
              ol: ({ children }) => (
                <ol
                  className={`${textClasses} list-decimal pl-6 mb-4 space-y-2 text-left`}
                >
                  {children}
                </ol>
              ),
              strong: ({ children }) => (
                <strong className="font-bold text-white">{children}</strong>
              ),
              em: ({ children }) => <em className="italic">{children}</em>,
            }}
          >
            {sanitizedText}
          </ReactMarkdown>
        </div>
      </>
    );
  };

  const renderMedia = (
    src?: string,
    type?: 'image' | 'video' | 'youtube',
    autoplay = true
  ) => {
    if (!src) return null;

    const youtubeId = getYouTubeId(src);
    const actualType = youtubeId
      ? 'youtube'
      : type || (src.match(/\.(mp4|webm|ogg)$/i) ? 'video' : 'image');

    if (actualType === 'youtube' && youtubeId) {
      return (
        <div className="w-full relative rounded-2xl overflow-hidden bg-slate-900/50 border border-white/5 aspect-video">
          <iframe
            src={`https://www.youtube.com/embed/${youtubeId}?autoplay=1&mute=0&loop=1&playlist=${youtubeId}&controls=1&modestbranding=1&rel=0`}
            title="YouTube video player"
            className="absolute inset-0 w-full h-full"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowFullScreen
          />
        </div>
      );
    }

    if (actualType === 'video') {
      const url = resolveMedia(src);
      return (
        <div className="w-full relative rounded-2xl overflow-hidden bg-slate-900/50 border border-white/5">
          <video
            src={url}
            className="w-full h-auto"
            autoPlay={autoplay}
            muted={false} // Autoplay with sound per user request
            loop={autoplay}
            controls={true}
            playsInline
          />
        </div>
      );
    }

    // Default to image
    const url = resolveMedia(src);
    return (
      <div className="w-full relative rounded-2xl overflow-hidden bg-slate-900/50">
        <Image
          src={url}
          alt="Project Media"
          width={0}
          height={0}
          sizes="(max-width: 768px) 100vw, 80vw"
          className="w-full h-auto object-contain"
        />
      </div>
    );
  };

  // Content Switching
  const renderContent = () => {
    switch (type) {
      case 'text':
        return (
          <div className="std-grid">
            <div className="max-w-4xl mx-auto text-center">
              {renderText(content.text, content.textConfig)}
            </div>
          </div>
        );

      case 'image':
        return (
          <div className="w-full max-w-screen-2xl mx-auto px-4 md:px-0">
            {renderMedia(content.media, 'image')}
          </div>
        );

      case 'video':
        return (
          <div className="w-full max-w-screen-2xl mx-auto px-4 md:px-0">
            {renderMedia(content.media, 'video', false)}
          </div>
        );

      case 'video-autoplay':
        return (
          <div className="w-full max-w-screen-2xl mx-auto px-4 md:px-0">
            {renderMedia(content.media, 'video', true)}
          </div>
        );

      case 'image-text':
        return (
          <div className="std-grid">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
              <div>{renderMedia(content.media, 'image')}</div>
              <div>{renderText(content.text, content.textConfig)}</div>
            </div>
          </div>
        );

      case 'text-image':
        return (
          <div className="std-grid">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
              <div className="order-2 md:order-1">
                {renderText(content.text, content.textConfig)}
              </div>
              <div className="order-1 md:order-2">
                {renderMedia(content.media, 'image')}
              </div>
            </div>
          </div>
        );

      case 'image-image':
        return (
          <div className="std-grid">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {renderMedia(content.media, 'image')}
              {renderMedia(content.media2, 'image')}
            </div>
          </div>
        );

      case 'image-video':
        return (
          <div className="std-grid">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
              {renderMedia(content.media, 'image')}
              {renderMedia(content.media2, 'video', true)}
            </div>
          </div>
        );

      case 'video-text':
        return (
          <div className="std-grid">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
              {renderMedia(content.media, 'video', true)}
              {renderText(content.text, content.textConfig)}
            </div>
          </div>
        );

      default:
        return null;
    }
  };

  return (
    <motion.section
      className="w-full"
      initial="hidden"
      whileInView="visible"
      viewport={{ once: true, margin: '-10%' }}
      variants={fadeInUp}
    >
      {renderContent()}
    </motion.section>
  );
}
import { useState, useEffect } from 'react';
import {
  Image as ImageIcon,
  Video,
  Link as LinkIcon,
  Trash2,
} from 'lucide-react';

interface MediaInputProps {
  label: string;
  type: 'image' | 'video';
  value?: string; // URL or path
  previewUrl?: string;
  onFileSelect: (_file: File) => void;
  onUrlChange: (_url: string) => void;
  onClear: () => void;
}

export function MediaInput({
  label,
  type,
  value,
  previewUrl,
  onFileSelect,
  onUrlChange,
  onClear,
}: MediaInputProps) {
  const [mode, setMode] = useState<'upload' | 'url'>('upload');
  // Detect if initial value is an external URL to set mode
  useEffect(() => {
    if (value && (value.startsWith('http') || value.startsWith('www'))) {
      // If it's a Supabase storage URL, we might consider it an "upload" technically,
      // but for editing input purposes, if it's text, it's a URL.
      // However, we usually browse files. Let's keep it simple.
      // If the user pasted a YouTube link, set to URL mode.
      if (!value.includes('supabase.co')) {
        setMode('url');
      }
    }
  }, [value]);

  const getYouTubeId = (url: string) => {
    const regExp =
      /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
    const match = url.match(regExp);
    return match && match[2].length === 11 ? match[2] : null;
  };

  const youtubeId = mode === 'url' && value ? getYouTubeId(value) : null;
  const showPreview = !!previewUrl || (!!value && mode === 'url');

  // Helper to determine accurate preview source
  const displaySrc = previewUrl || value;

  return (
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <label className="text-xs uppercase tracking-widest text-slate-500 font-medium">
          {label}
        </label>
        <div className="flex bg-slate-800 p-1 rounded-lg">
          <button
            onClick={() => setMode('upload')}
            className={`px-2 py-1 text-xs rounded-md transition-all ${mode === 'upload' ? 'bg-slate-600 text-white' : 'text-slate-400 hover:text-white'}`}
          >
            Upload
          </button>
          <button
            onClick={() => setMode('url')}
            className={`px-2 py-1 text-xs rounded-md transition-all ${mode === 'url' ? 'bg-slate-600 text-white' : 'text-slate-400 hover:text-white'}`}
          >
            Link
          </button>
        </div>
      </div>

      {showPreview ? (
        <div className="relative rounded-xl overflow-hidden border border-white/10 group bg-black/20">
          {youtubeId ? (
            <div className="aspect-video w-full bg-black">
              <iframe
                src={`https://www.youtube.com/embed/${youtubeId}?autoplay=0&mute=1&modestbranding=1`}
                title="YouTube preview"
                className="w-full h-full border-none"
                allowFullScreen
              />
            </div>
          ) : type === 'image' ? (
            <div className="relative min-h-[12.5rem] max-h-[25rem] w-full flex justify-center bg-black/40">
              {/* eslint-disable-next-line @next/next/no-img-element */}
              <img
                src={displaySrc}
                alt="Preview"
                className="h-full w-auto max-h-[25rem] object-contain"
              />
            </div>
          ) : (
            <video
              src={displaySrc}
              className="w-full max-h-[25rem] object-contain"
              controls
              muted
              loop
              autoPlay
            />
          )}

          <div className="absolute top-2 right-2 flex gap-2">
            <button
              onClick={onClear}
              className="bg-red-500 p-2 rounded-full hover:bg-red-600 transition-colors shadow-lg"
              title="Remover mídia"
            >
              <Trash2 size={16} />
            </button>
          </div>
        </div>
      ) : mode === 'upload' ? (
        <label className="flex flex-col items-center justify-center py-12 rounded-xl border-2 border-dashed border-white/10 hover:border-blue-500 hover:bg-blue-500/5 cursor-pointer transition-all group">
          {type === 'image' ? (
            <ImageIcon
              className="text-slate-600 mb-2 group-hover:text-blue-400 transition-colors"
              size={32}
            />
          ) : (
            <Video
              className="text-slate-600 mb-2 group-hover:text-blue-400 transition-colors"
              size={32}
            />
          )}
          <span className="text-xs text-slate-500 font-medium uppercase tracking-widest group-hover:text-blue-300">
            Escolher Arquivo
          </span>
          <input
            type="file"
            accept={type === 'image' ? 'image/*' : 'video/*'}
            onChange={(e) => {
              const file = e.target.files?.[0];
              if (file) onFileSelect(file);
            }}
            className="hidden"
          />
        </label>
      ) : (
        <div className="flex items-center gap-2 bg-slate-950 border border-white/10 rounded-xl px-4 py-3 focus-within:border-blue-500 transition-colors">
          <LinkIcon className="text-slate-500" size={18} />
          <input
            type="text"
            placeholder={
              type === 'image'
                ? 'https://exemplo.com/imagem.jpg'
                : 'Pinte aqui o link do YouTube ou .mp4'
            }
            className="bg-transparent border-none outline-none w-full text-sm text-white placeholder-slate-600"
            onChange={(e) => onUrlChange(e.target.value)}
            value={value || ''}
          />
        </div>
      )}
    </div>
  );
}
export type BlockType =
  | 'text'
  | 'image'
  | 'video'
  | 'image-text'
  | 'text-image'
  | 'image-image'
  | 'image-video'
  | 'video-text';

export interface LandingPageBlock {
  id: string;
  type: BlockType;
  content: {
    text?: string;
    text2?: string; // For blocks with multiple text areas
    media?: string; // URL or path
    media2?: string; // For blocks with multiple media
    mediaType?: 'image' | 'video' | 'youtube';
    mediaType2?: 'image' | 'video' | 'youtube';
    autoplay?: boolean; // For videos
  };
  file?: File | null; // Transient, for uploads
  file2?: File | null; // Transient
  previewUrl?: string; // Transient
  previewUrl2?: string; // Transient
}
import { LandingPageBlock } from '@/types/landing-page';
import { MediaInput } from './MediaInput';
import { Type } from 'lucide-react';

interface BlockEditorProps {
  block: LandingPageBlock;
  onChange: (_updates: Partial<LandingPageBlock>) => void;
}

export function BlockEditor({ block, onChange }: BlockEditorProps) {
  const updateContent = (updates: Partial<typeof block.content>) => {
    onChange({ content: { ...block.content, ...updates } });
  };

  const handleFileSelect = (key: 'file' | 'file2', file: File) => {
    const previewKey = key === 'file' ? 'previewUrl' : 'previewUrl2';
    const contentKey = key === 'file' ? 'media' : 'media2';

    onChange({
      [key]: file,
      [previewKey]: URL.createObjectURL(file), // Local preview
      content: { ...block.content, [contentKey]: '' }, // Clear text value to prioritize file
    });
  };

  const handleUrlChange = (key: 'media' | 'media2', url: string) => {
    // Clear file inputs if URL is manually set
    const fileKey = key === 'media' ? 'file' : 'file2';
    const previewKey = key === 'media' ? 'previewUrl' : 'previewUrl2';

    onChange({
      [fileKey]: null,
      [previewKey]: '',
      content: { ...block.content, [key]: url },
    });
  };

  // Helper to render text input
  const renderTextInput = (key: 'text' | 'text2', label: string) => {
    const configKey = key === 'text' ? 'textConfig' : 'textConfig2';
    // @ts-ignore - Dynamic key access
    const config = block.content[configKey] || {};

    const updateConfig = (updates: Record<string, string>) => {
      updateContent({ [configKey]: { ...config, ...updates } });
    };

    return (
      <div className="flex-1 space-y-4">
        <label className="text-xs uppercase tracking-widest text-slate-500 font-medium flex items-center gap-2">
          <Type size={14} /> {label}
        </label>

        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 bg-slate-900/50 p-3 rounded-xl border border-white/5">
          <div className="space-y-1">
            <span className="text-[10px] uppercase text-slate-500 block">
              Tamanho
            </span>
            <select
              value={config.fontSize || ''}
              onChange={(e) => updateConfig({ fontSize: e.target.value })}
              className="w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white"
              title="Tamanho do Texto"
            >
              <option value="">Padrão</option>
              <option value="text-xs">Extra Small</option>
              <option value="text-sm">Small</option>
              <option value="text-base">Base</option>
              <option value="text-lg">Large</option>
              <option value="text-xl">Extra Large</option>
              <option value="text-2xl">2XL</option>
              <option value="text-3xl">3XL</option>
              <option value="text-4xl">4XL</option>
              <option value="text-5xl">5XL</option>
              <option value="text-6xl">6XL</option>
              <option value="text-7xl">7XL</option>
              <option value="text-8xl">8XL</option>
            </select>
          </div>
          <div className="space-y-1">
            <span className="text-[10px] uppercase text-slate-500 block">
              Peso
            </span>
            <select
              value={config.fontWeight || ''}
              onChange={(e) => updateConfig({ fontWeight: e.target.value })}
              className="w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white"
              title="Peso da Fonte"
            >
              <option value="">Padrão</option>
              <option value="font-thin">Thin</option>
              <option value="font-light">Light</option>
              <option value="font-normal">Normal</option>
              <option value="font-medium">Medium</option>
              <option value="font-semibold">SemiBold</option>
              <option value="font-bold">Bold</option>
              <option value="font-extrabold">ExtraBold</option>
              <option value="font-black">Black</option>
            </select>
          </div>
          <div className="space-y-1">
            <span className="text-[10px] uppercase text-slate-500 block">
              Alinhamento
            </span>
            <select
              value={config.textAlign || ''}
              onChange={(e) => updateConfig({ textAlign: e.target.value })}
              className="w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white"
              title="Alinhamento do Texto"
            >
              <option value="">Padrão</option>
              <option value="text-left">Esquerda</option>
              <option value="text-center">Centralizado</option>
              <option value="text-right">Direita</option>
              <option value="text-justify">Justificado</option>
            </select>
          </div>
          <div className="space-y-1">
            <span className="text-[10px] uppercase text-slate-500 block">
              Cor (Hex)
            </span>
            <input
              type="text"
              value={config.color || ''}
              onChange={(e) => updateConfig({ color: e.target.value })}
              placeholder="#FFFFFF"
              className="w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white placeholder-slate-600"
            />
          </div>
        </div>

        <textarea
          value={block.content[key] || ''}
          onChange={(e) => updateContent({ [key]: e.target.value })}
          className="w-full h-full min-h-[200px] bg-slate-950/50 border border-white/10 rounded-xl p-4 outline-none focus:border-blue-500/50 transition-all resize-none font-sans"
          placeholder="# Título... \n\nParágrafo com conteúdo..."
        />
      </div>
    );
  };

  // Helper to render media input
  const renderMediaInput = (
    mediaKey: 'media' | 'media2',
    type: 'image' | 'video',
    fileKey: 'file' | 'file2',
    previewKey: 'previewUrl' | 'previewUrl2',
    label: string
  ) => (
    <div className="flex-1">
      <MediaInput
        label={label}
        type={type}
        value={block.content[mediaKey]}
        previewUrl={block[previewKey]}
        onFileSelect={(f) => handleFileSelect(fileKey, f)}
        onUrlChange={(url) => handleUrlChange(mediaKey, url)}
        onClear={() => {
          onChange({
            [fileKey]: null,
            [previewKey]: '',
            content: { ...block.content, [mediaKey]: '' },
          });
        }}
      />
    </div>
  );

  switch (block.type) {
    case 'text':
      return (
        <div className="p-4">
          {renderTextInput('text', 'Conteúdo de Texto')}
        </div>
      );

    case 'image':
      return (
        <div className="p-4">
          {renderMediaInput(
            'media',
            'image',
            'file',
            'previewUrl',
            'Imagem Full'
          )}
        </div>
      );

    case 'video':
    case 'video-autoplay': // Treat similarly in editor, logic mainly for frontend
      return (
        <div className="p-4">
          {renderMediaInput(
            'media',
            'video',
            'file',
            'previewUrl',
            'Vídeo Full'
          )}
        </div>
      );

    case 'image-text':
      return (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4">
          {renderMediaInput(
            'media',
            'image',
            'file',
            'previewUrl',
            'Imagem (Esquerda)'
          )}
          {renderTextInput('text', 'Texto (Direita)')}
        </div>
      );

    case 'text-image':
      return (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4">
          {renderTextInput('text', 'Texto (Esquerda)')}
          {renderMediaInput(
            'media',
            'image',
            'file',
            'previewUrl',
            'Imagem (Direita)'
          )}
        </div>
      );

    case 'image-image':
      return (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4">
          {renderMediaInput(
            'media',
            'image',
            'file',
            'previewUrl',
            'Imagem 01'
          )}
          {renderMediaInput(
            'media2',
            'image',
            'file2',
            'previewUrl2',
            'Imagem 02'
          )}
        </div>
      );

    case 'image-video':
      return (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4">
          {renderMediaInput('media', 'image', 'file', 'previewUrl', 'Imagem')}
          {renderMediaInput('media2', 'video', 'file2', 'previewUrl2', 'Vídeo')}
        </div>
      );

    case 'video-text':
      return (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4">
          {renderMediaInput(
            'media',
            'video',
            'file',
            'previewUrl',
            'Vídeo (Esquerda)'
          )}
          {renderTextInput('text', 'Texto (Direita)')}
        </div>
      );

    default:
      return <div className="p-4 text-red-500">Tipo de bloco desconhecido</div>;
  }
}
'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import {
  LayoutDashboard,
  FolderOpen,
  Tag,
  Images,
  Settings,
} from 'lucide-react';
import type { ReactNode } from 'react';
import { signOut } from '@/lib/supabase/auth-actions';
import { ADMIN_NAVIGATION } from '@/config/admin-navigation';

type Props = {
  children: ReactNode;
  userEmail?: string;
};

const navItems = [
  {
    href: ADMIN_NAVIGATION.dashboard,
    label: 'Dashboard',
    icon: LayoutDashboard,
  },
  {
    href: ADMIN_NAVIGATION.trabalhos.index,
    label: 'Trabalhos',
    icon: FolderOpen,
  },
  { href: ADMIN_NAVIGATION.tags, label: 'Tags', icon: Tag },
  { href: ADMIN_NAVIGATION.midia, label: 'Mídia & Layout', icon: Images },
  {
    href: ADMIN_NAVIGATION['landing-pages'],
    label: 'Landing Pages',
    icon: LayoutDashboard,
  },
  { href: ADMIN_NAVIGATION.config, label: 'Configurações', icon: Settings },
];

export function AdminShell({ children, userEmail }: Props) {
  const pathname = usePathname();

  return (
    <div className="admin-shell min-h-screen bg-slate-950 text-slate-50">
      <div className="flex">
        <aside className="hidden md:flex w-64 flex-col border-r border-white/10 bg-slate-900/40 backdrop-blur-sm">
          <div className="px-6 py-6 border-b border-white/10">
            <Link
              href={ADMIN_NAVIGATION.dashboard}
              className="text-xl font-semibold tracking-tight"
            >
              Portfólio Admin
            </Link>
            <p className="text-xs text-slate-400 mt-1">CMS interno</p>
          </div>
          <nav className="flex-1 px-3 py-4 space-y-1">
            {navItems.map((item) => {
              const active =
                pathname === item.href || pathname?.startsWith(item.href + '/');
              const Icon = item.icon;
              return (
                <Link
                  key={item.href}
                  href={item.href}
                  className={`flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition hover:bg-white/5 ${
                    active ? 'bg-white/10 text-white' : 'text-slate-300'
                  }`}
                >
                  <Icon size={18} />
                  {item.label}
                </Link>
              );
            })}
          </nav>
          <div className="px-4 py-3 border-t border-white/10 text-xs text-slate-400">
            <div className="flex flex-col gap-2">
              <span>{userEmail ? `Logado como ${userEmail}` : 'Usuário'}</span>
              <form action={signOut}>
                <button
                  type="submit"
                  className="inline-flex items-center justify-center rounded-md border border-white/15 px-3 py-2 text-[11px] font-semibold text-white hover:bg-white/10"
                >
                  Sair
                </button>
              </form>
            </div>
          </div>
        </aside>

        <main className="flex-1">
          <header className="md:hidden sticky top-0 z-20 bg-slate-950/90 backdrop-blur border-b border-white/10 px-4 py-3 flex items-center justify-between">
            <Link
              href={ADMIN_NAVIGATION.dashboard}
              className="text-base font-semibold"
            >
              Admin
            </Link>
            <div className="flex items-center gap-2 text-xs text-slate-400">
              <span>{userEmail || 'Usuário'}</span>
              <form action={signOut}>
                <button className="rounded-md border border-white/15 px-2 py-1 text-[11px] font-semibold text-white hover:bg-white/10">
                  Sair
                </button>
              </form>
            </div>
          </header>
          <div className="px-4 md:px-10 py-6 md:py-10">{children}</div>
        </main>
      </div>
    </div>
  );
}
'use client';

import { useState, useTransition, useEffect } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { createClientComponentClient } from '@/lib/supabase/client';
import { ADMIN_NAVIGATION } from '@/config/admin-navigation';

export default function LoginForm() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState<string | null>(null);
  const [isPending, startTransition] = useTransition();
  const [isRedirecting, setIsRedirecting] = useState(false);
  const router = useRouter();
  const searchParams = useSearchParams();

  // Check for auth errors from callback
  useEffect(() => {
    const authError = searchParams.get('error');
    if (authError) {
      setError('Erro na autenticação. Por favor, tente novamente.');
    }
  }, [searchParams]);

  // Check if already logged in on mount
  useEffect(() => {
    // const checkSession = async () => {
    //   const supabase = createClientComponentClient();
    //   // Use getUser instead of getSession for better server consistency
    //   const {
    //     data: { user },
    //   } = await supabase.auth.getUser();
    //   if (user) {
    //     setIsRedirecting(true);
    //     // Ensure server sync before client navigation
    //     router.refresh();
    //     router.replace(ADMIN_NAVIGATION.dashboard);
    //   }
    // };
    // checkSession();
  }, [router]);

  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setError(null);

    startTransition(async () => {
      try {
        const supabase = createClientComponentClient();
        const { data, error: signInError } =
          await supabase.auth.signInWithPassword({
            email,
            password,
          });

        if (signInError) {
          setError(signInError.message);
          return;
        }

        if (data.session) {
          setIsRedirecting(true);
          // Important: Refresh ensures Next.js Server Components see the new cookies
          router.refresh();

          // Use a small delay and window.location.href for a full reload
          // This ensures cookies are properly picked up by the server on next load
          setTimeout(() => {
            window.location.href = ADMIN_NAVIGATION.dashboard;
          }, 500);
        } else {
          setError('Falha ao estabelecer sessão. Tente novamente.');
        }
      } catch (err) {
        console.error('Login error:', err);
        setError('Ocorreu um erro inesperado.');
      }
    });
  };

  return (
    <div className="space-y-6">
      <div>
        <p className="text-sm uppercase tracking-[0.25em] text-slate-400">
          Admin
        </p>
        <h1 className="text-2xl font-semibold mt-2">Entrar no painel</h1>
        <p className="text-sm text-slate-400 mt-1">
          Use seu email e senha do Supabase Auth.
        </p>
      </div>

      <form className="space-y-4" onSubmit={handleSubmit}>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Email</span>
          <input
            type="email"
            required
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Senha</span>
          <input
            type="password"
            required
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
          />
        </label>

        {error && <div className="text-sm text-red-400">{error}</div>}

        <button
          type="submit"
          className="w-full rounded-md bg-blue-500 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-60"
          disabled={isPending || isRedirecting}
        >
          {isRedirecting
            ? 'Redirecionando...'
            : isPending
              ? 'Entrando...'
              : 'Entrar'}
        </button>
      </form>
    </div>
  );
}
'use client';

import { useState, useTransition } from 'react';
import { useRouter } from 'next/navigation';

import { upsertAsset } from '@/app/admin/(protected)/midia/actions';
import { getSiteAssetRoleByKey } from '@/lib/supabase/asset-roles';
import { uploadSiteAsset } from '@/lib/supabase/storage';

type AssetFormProps = {
  preset?: {
    key: string;
    page: string;
    asset_type: string;
    subPath?: string;
    description?: string;
  };
};

export function AssetForm({ preset }: AssetFormProps) {
  const router = useRouter();
  const [key, setKey] = useState(preset?.key ?? '');
  const [page, setPage] = useState(preset?.page ?? 'global');
  const [assetType, setAssetType] = useState(preset?.asset_type ?? 'image');
  const [description, setDescription] = useState(preset?.description ?? '');
  const [subPath, setSubPath] = useState(preset?.subPath ?? '');
  const [sortOrder, setSortOrder] = useState<number | undefined>();
  const [file, setFile] = useState<File | null>(null);
  const [error, setError] = useState<string | null>(null);
  const [isPending, startTransition] = useTransition();

  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setError(null);
    startTransition(async () => {
      try {
        const role = getSiteAssetRoleByKey(key);
        let file_path: string | null = null;
        if (file) {
          file_path = await uploadSiteAsset({
            file,
            key,
            page,
            subPath: role?.subPath ?? subPath,
            bucket: 'site-assets',
          });
        }

        await upsertAsset({
          key,
          page,
          asset_type: assetType,
          description: description || role?.description || null,
          sort_order: sortOrder ?? null,
          file_path,
          bucket: 'site-assets',
        });
        router.refresh();
        // reset only file
        setFile(null);
      } catch (err) {
        setError(err instanceof Error ? err.message : 'Falha ao salvar');
      }
    });
  };

  return (
    <form className="space-y-3" onSubmit={handleSubmit}>
      <div className="grid gap-3 md:grid-cols-2">
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Key</span>
          <input
            name="asset-key"
            required
            value={key}
            onChange={(e) => setKey(e.target.value)}
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            placeholder="home.hero_background"
          />
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Página</span>
          <select
            name="asset-page"
            value={page}
            onChange={(e) => setPage(e.target.value)}
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
          >
            <option value="global">Global</option>
            <option value="home">Home</option>
            <option value="portfolio">Portfolio</option>
            <option value="about">About</option>
            <option value="clients">Clients</option>
          </select>
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Tipo</span>
          <select
            name="asset-type"
            value={assetType}
            onChange={(e) => setAssetType(e.target.value)}
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
          >
            <option value="image">Imagem</option>
            <option value="video">Vídeo</option>
            <option value="file">Arquivo</option>
            <option value="font">Fonte</option>
          </select>
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Subpasta (opcional)</span>
          <input
            name="asset-subpath"
            value={subPath}
            onChange={(e) => setSubPath(e.target.value)}
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            placeholder="logos, fonts, hero"
          />
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Ordem</span>
          <input
            type="number"
            value={sortOrder ?? ''}
            onChange={(e) =>
              setSortOrder(e.target.value ? Number(e.target.value) : undefined)
            }
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            placeholder="10"
          />
        </label>
      </div>

      <label className="flex flex-col gap-1">
        <span className="text-sm text-slate-300">Descrição</span>
        <textarea
          value={description}
          onChange={(e) => setDescription(e.target.value)}
          rows={3}
          className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
          placeholder="Ex.: Logo principal do header"
        />
      </label>

      <label className="flex flex-col gap-1">
        <span className="text-sm text-slate-300">Arquivo (opcional)</span>
        <input
          type="file"
          accept="image/*,video/*,.ttf,.otf,.woff,.woff2,.pdf,.doc,.docx"
          onChange={(e) => setFile(e.target.files?.[0] ?? null)}
        />
      </label>

      {error && <div className="text-sm text-red-400">{error}</div>}

      <button
        type="submit"
        className="inline-flex items-center justify-center rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-50"
        disabled={isPending}
      >
        {isPending ? 'Salvando...' : 'Salvar asset'}
      </button>
    </form>
  );
}
'use client';

import React from 'react';
import { SITE_ASSET_KEYS } from '@/config/site-assets';

const assetGuide = [
  {
    key: SITE_ASSET_KEYS.logos.headerLight,
    description: 'Logo principal do header (claro)',
    change:
      'Atualize o arquivo (SVG recomendado) e valide o cabeçalho com useSiteAssetUrl.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.logos.headerDark,
    description: 'Logo principal do header (escuro)',
    change: 'Mantenha dimensões iguais ao claro para evitar saltos.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconLight,
    description: 'Favicon claro usado em <head>',
    change:
      'SVG/ICO com fundo transparente; mantenha metadata/JsonLd alinhado.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconDark,
    description: 'Favicon escuro usado em <head>',
    change: 'Mesmo tamanho do claro para consistência.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.fonts.display,
    description: 'Fonte display principal (--font-display)',
    change: 'Atualize e revise tailwind/theme para usar a nova família.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.fonts.body,
    description: 'Fonte do corpo (--font-body)',
    change: 'Confirme fallback stack e pesos no tema tipográfico.',
    page: 'global',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.homeManifesto,
    description: 'Vídeo do manifesto na hero da Home',
    change:
      'Substitua o MP4; gere poster e versão -720p mantendo o mesmo prefixo.',
    page: 'home',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutDesktop,
    description: 'Vídeo da hero Sobre (desktop)',
    change: 'Sincronize com a versão mobile para evitar discrepâncias.',
    page: 'about',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutMobile,
    description: 'Vídeo da hero Sobre (mobile)',
    change: 'O hook AboutHero troca automaticamente entre desktop/mobile.',
    page: 'about',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.method,
    description: 'Vídeo da sessão Método',
    change: 'Use o mesmo prefixo para versões alternativas se necessário.',
    page: 'about',
  },
  ...SITE_ASSET_KEYS.about.originImages.map((key, index) => ({
    key,
    description: `Imagem ${index + 1} da sessão Origem`,
    change: 'Siga o padrão about.origin_image.N para cada card.',
    page: 'about',
  })),
  {
    key: SITE_ASSET_KEYS.heroVideos.portfolioDesktop,
    description: 'Vídeo hero do portfólio (desktop)',
    change: 'Atualize em par com a versão mobile.',
    page: 'portfolio',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.portfolioMobile,
    description: 'Vídeo hero do portfólio (mobile)',
    change: 'Sincronize duração e cor com a versão desktop.',
    page: 'portfolio',
  },
  {
    key: 'clients.strip.*',
    description: 'Strip de logos da sessão de clients',
    change: 'Use clients.strip.N (1-12) e carregue via useSiteAssetsByPrefix.',
    page: 'clients',
  },
  {
    key: 'about.curriculum_pdf',
    description: 'Currículo da seção About',
    change: 'Envie PDF atualizado; mantenha nome consistente.',
    page: 'about',
  },
];

export function AssetGuide() {
  return (
    <div className="rounded-xl border border-white/10 bg-slate-900/40 p-4 space-y-3">
      <h2 className="text-lg font-semibold text-white">Guia de keys</h2>
      <p className="text-xs text-slate-400">
        Use essas keys no Admin para garantir que a sessão pública leia o asset
        correto. Ajuste o campo “Subpasta” para manter o storage organizado.
      </p>
      <div className="grid gap-2 text-xs">
        {assetGuide.map((item) => (
          <div
            key={item.key}
            className="rounded-lg border border-white/10 bg-slate-900/80 p-3"
          >
            <div className="text-[11px] text-slate-300">{item.page}</div>
            <div className="text-sm font-semibold text-white">{item.key}</div>
            <p className="text-[11px] text-slate-400">{item.description}</p>
            <p className="text-[11px] text-blue-300 mt-1">{item.change}</p>
          </div>
        ))}
      </div>
    </div>
  );
}
'use client';

import { useState, useTransition } from 'react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';

import {
  assignAssetRole,
  removeAsset,
} from '@/app/admin/(protected)/midia/actions';
import { AssetRoleMenu } from '@/components/admin/AssetRoleMenu';
import {
  siteAssetRoleMap,
  type SiteAssetRole,
} from '@/lib/supabase/asset-roles';
import { createClientComponentClient } from '@/lib/supabase/client';
import { uploadSiteAsset } from '@/lib/supabase/storage';
import { buildSupabaseStorageUrl } from '@/lib/supabase/urls';
import type { NormalizedSiteAsset } from '@/lib/supabase/site-asset-utils';

type Props = {
  asset: NormalizedSiteAsset;
};

export function AssetCard({ asset }: Props) {
  const router = useRouter();
  const [isPending, startTransition] = useTransition();
  const [error, setError] = useState<string | null>(null);
  const currentRole = siteAssetRoleMap.get(asset.key);
  const roleLabel = currentRole?.label ?? 'Sem papel definido';

  const handleUpload = (file?: File | null) => {
    if (!file) return;
    setError(null);
    startTransition(async () => {
      try {
        const newPath = await uploadSiteAsset({
          file,
          key: asset.key,
          page: asset.page,
          subPath: currentRole?.subPath,
          bucket: asset.bucket as 'site-assets',
        });
        const supabase = createClientComponentClient();
        const { error: updateError } = await supabase
          .from('site_assets')
          .update({ file_path: newPath })
          .eq('id', asset.id);
        if (updateError) throw updateError;
        router.refresh();
      } catch (err) {
        setError(err instanceof Error ? err.message : 'Falha no upload');
      }
    });
  };

  const handleRoleChange = (role: SiteAssetRole) => {
    setError(null);
    startTransition(async () => {
      try {
        await assignAssetRole({ assetId: asset.id, role });
        router.refresh();
      } catch (err) {
        setError(
          err instanceof Error ? err.message : 'Falha na alteração do papel'
        );
      }
    });
  };

  const toggleActive = () => {
    startTransition(async () => {
      const supabase = createClientComponentClient();
      const { error: updateError } = await supabase
        .from('site_assets')
        .update({ is_active: !asset.is_active })
        .eq('id', asset.id);
      if (updateError) {
        setError(updateError.message);
        return;
      }
      router.refresh();
    });
  };

  const handleDelete = () => {
    if (!confirm('Excluir este asset e o arquivo associado?')) return;
    setError(null);
    startTransition(async () => {
      try {
        await removeAsset({
          id: asset.id,
          bucket: asset.bucket,
          file_path: asset.file_path,
        });
        router.refresh();
      } catch (err) {
        setError(err instanceof Error ? err.message : 'Falha na exclusão');
      }
    });
  };

  const previewUrl =
    asset.publicUrl || buildSupabaseStorageUrl(asset.bucket, asset.file_path);
  const resolvedPage = asset.page ?? asset.resolvedPage ?? 'global';

  // Verificar se a chave ou caminho é inválido
  const isInvalidAsset =
    asset.key.startsWith('updated_at:') || asset.key.startsWith('key:');

  if (isInvalidAsset) {
    return (
      <div className="rounded-lg border border-red-500/50 bg-slate-900/60 p-4 flex gap-4">
        <div className="w-24 h-24 rounded-md bg-red-900/30 flex items-center justify-center">
          <span className="text-xs text-red-400">Inválido</span>
        </div>
        <div className="flex-1">
          <div className="flex flex-wrap items-center gap-2">
            <div className="text-sm font-semibold text-red-400">
              {asset.key}
            </div>
            <span className="rounded-full bg-red-500/20 px-2 py-0.5 text-[11px] text-red-200">
              {resolvedPage}
            </span>
          </div>
          <div className="text-xs text-slate-500 mt-1">
            {asset.bucket}/{asset.file_path}
          </div>
          <div className="text-xs text-red-500 mt-2">
            Este asset tem formato inválido e deve ser corrigido ou removido
          </div>
          <button
            type="button"
            onClick={handleDelete}
            className="mt-2 inline-flex items-center rounded-md border border-red-500/60 px-2 py-1 text-[11px] text-red-200 hover:bg-red-500/10"
          >
            Excluir
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="rounded-lg border border-white/10 bg-slate-900/60 p-4 flex gap-4">
      <div className="w-24 h-24 rounded-md bg-slate-800 overflow-hidden relative">
        {asset.asset_type === 'image' && previewUrl ? (
          <Image
            src={previewUrl}
            alt={asset.key}
            fill
            sizes="96px"
            className="object-cover"
            unoptimized={previewUrl.toLowerCase().endsWith('.svg')}
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center text-xs text-slate-400">
            {asset.asset_type}
          </div>
        )}
      </div>
      <div className="flex-1">
        <div className="flex flex-wrap items-center gap-2">
          <div className="text-sm font-semibold text-white">{asset.key}</div>
          <span className="rounded-full bg-white/10 px-2 py-0.5 text-[11px] text-slate-200">
            {resolvedPage}
          </span>
          <span className="rounded-full bg-blue-500/15 px-2 py-0.5 text-[11px] text-blue-100">
            {asset.asset_type}
          </span>
        </div>
        <div className="text-xs text-slate-400">{asset.description}</div>
        <div className="text-xs text-slate-500 mt-1">
          {asset.bucket}/{asset.file_path}
        </div>
        <div className="text-xs text-slate-400 mt-1">Papel: {roleLabel}</div>
        {error && <div className="text-xs text-red-400 mt-2">{error}</div>}
        <label className="mt-3 inline-flex items-center gap-2 text-xs text-blue-300 cursor-pointer">
          <input
            type="file"
            className="hidden"
            onChange={(e) => handleUpload(e.target.files?.[0] ?? null)}
            accept="image/*,video/*"
          />
          {isPending ? 'Enviando...' : 'Substituir arquivo'}
        </label>
        <AssetRoleMenu currentKey={asset.key} onSelectRole={handleRoleChange} />
        <div className="mt-2 text-xs text-slate-400">
          Status: {asset.is_active ? 'Ativo' : 'Inativo'}
        </div>
        <button
          type="button"
          onClick={toggleActive}
          className="mt-1 inline-flex items-center rounded-md border border-white/10 px-2 py-1 text-[11px] text-white hover:bg-white/10"
        >
          {asset.is_active ? 'Desativar' : 'Ativar'}
        </button>
        <button
          type="button"
          onClick={handleDelete}
          className="ml-2 mt-1 inline-flex items-center rounded-md border border-red-500/60 px-2 py-1 text-[11px] text-red-200 hover:bg-red-500/10"
        >
          Excluir
        </button>
      </div>
    </div>
  );
}
'use client';

import { useState, useTransition } from 'react';
import { useRouter } from 'next/navigation';
import { zodResolver } from '@hookform/resolvers/zod';
import { useForm, type Resolver, type SubmitHandler } from 'react-hook-form';
import { z } from 'zod';

import { createClientComponentClient } from '@/lib/supabase/client';
import { uploadToBucket } from '@/lib/supabase/storage';
import type { DbProject, DbTag, DbLandingPage } from '@/types/admin';

const projectSchema = z.object({
  title: z.string().min(3),
  slug: z.string().min(3),
  client_name: z.string().min(2),
  brand_name: z.string().optional(),
  year: z.coerce.number().int().optional(),
  project_type: z.string().min(2),
  short_label: z.string().optional(),
  description: z.string().optional(),
  featured_on_home: z.boolean().optional(),
  featured_on_portfolio: z.boolean().optional(),
  featured_home_order: z.coerce.number().int().optional().nullable(),
  featured_portfolio_order: z.coerce.number().int().optional().nullable(),
  is_published: z.boolean().optional(),
  landing_page_id: z.string().optional().nullable(),
  tags: z.array(z.string()).optional(),
});

type FormValues = z.infer<typeof projectSchema>;

type Props = {
  project?: DbProject;
  tags: DbTag[];
  landingPages: Pick<DbLandingPage, 'id' | 'title' | 'slug'>[];
  selectedTagIds?: string[];
};

export function ProjectForm({
  project,
  tags,
  landingPages,
  selectedTagIds = [],
}: Props) {
  const [thumbnail, setThumbnail] = useState<File | null>(null);
  const [hero, setHero] = useState<File | null>(null);
  const [gallery, setGallery] = useState<File[]>([]);
  const [error, setError] = useState<string | null>(null);
  const [isPending, startTransition] = useTransition();
  const router = useRouter();

  const form = useForm<FormValues>({
    resolver: zodResolver(projectSchema) as Resolver<FormValues>,
    defaultValues: {
      title: project?.title ?? '',
      slug: project?.slug ?? '',
      client_name: project?.client_name ?? '',
      brand_name: project?.brand_name ?? '',
      year: project?.year ?? undefined,
      project_type: project?.project_type ?? 'Branding & Identity',
      short_label: project?.short_label ?? '',
      description: project?.description ?? '',
      featured_on_home: project?.featured_on_home ?? false,
      featured_on_portfolio: project?.featured_on_portfolio ?? false,
      featured_home_order: project?.featured_home_order ?? undefined,
      featured_portfolio_order: project?.featured_portfolio_order ?? undefined,
      is_published: project?.is_published ?? true,
      landing_page_id: project?.landing_page_id ?? '',
      tags: selectedTagIds,
    },
  });

  const selectedTags = form.watch('tags') || [];

  const onSubmit: SubmitHandler<FormValues> = (values) => {
    setError(null);
    startTransition(async () => {
      try {
        const supabase = createClientComponentClient();
        let thumbnail_path = project?.thumbnail_path ?? null;
        let hero_image_path = project?.hero_image_path ?? null;
        const galleryEntries: Array<{ path: string }> = Array.isArray(
          project?.gallery
        )
          ? project?.gallery?.map((item) => ({ path: item.path }))
          : [];

        if (thumbnail) {
          thumbnail_path = await uploadToBucket(
            'portfolio-media',
            `projects/${values.slug}`,
            'thumb',
            thumbnail
          );
        }

        if (hero) {
          hero_image_path = await uploadToBucket(
            'portfolio-media',
            `projects/${values.slug}`,
            'hero',
            hero
          );
        }

        if (gallery.length > 0) {
          for (const file of gallery) {
            const path = await uploadToBucket(
              'portfolio-media',
              `projects/${values.slug}/gallery`,
              file.name.replace(/\W+/g, '-'),
              file
            );
            if (path) {
              galleryEntries.push({ path });
            }
          }
        }

        const { tags: formTags = [], ...payloadData } = values;

        // Clean landing_page_id to be null if empty string
        if (payloadData.landing_page_id === '') {
          payloadData.landing_page_id = null;
        }

        const { data, error: upsertError } = await supabase
          .from('portfolio_projects')
          .upsert(
            {
              id: project?.id,
              ...payloadData,
              gallery: galleryEntries,
              thumbnail_path,
              hero_image_path,
            },
            { onConflict: 'id' }
          )
          .select()
          .single();

        if (upsertError) throw upsertError;

        if (data?.id) {
          await supabase
            .from('portfolio_project_tags')
            .delete()
            .eq('project_id', data.id);
          const tagIds = formTags.length > 0 ? formTags : selectedTags;
          if (tagIds.length > 0) {
            await supabase.from('portfolio_project_tags').insert(
              tagIds.map((tagId) => ({
                project_id: data.id,
                tag_id: tagId,
              }))
            );
          }
        }

        router.push('/admin/trabalhos');
        router.refresh();
      } catch (err) {
        setError(
          err instanceof Error ? err.message : 'Ocorreu um erro desconhecido'
        );
      }
    });
  };

  return (
    <form className="space-y-6" onSubmit={form.handleSubmit(onSubmit)}>
      <div className="grid gap-4 md:grid-cols-2">
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Título</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('title')}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Slug</span>
          <div className="flex flex-col gap-2">
            {tags.length > 0 && (
              <select
                className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm text-slate-200"
                defaultValue=""
                onChange={(event) => {
                  const selectedSlug = event.target.value;
                  if (selectedSlug) {
                    form.setValue('slug', selectedSlug);
                  }
                }}
              >
                <option value="">Usar slug das tags existentes</option>
                {tags.map((tag) => (
                  <option key={tag.id} value={tag.slug}>
                    {tag.label} — {tag.slug}
                  </option>
                ))}
              </select>
            )}
            <input
              className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
              {...form.register('slug')}
            />
          </div>
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Cliente</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('client_name')}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Marca</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('brand_name')}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Ano</span>
          <input
            type="number"
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('year')}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Tipo de projeto</span>
          <select
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('project_type')}
          >
            <option>Branding & Identity</option>
            <option>Campanhas & Advertising</option>
            <option>Web & Digital</option>
            <option>Motion & Video</option>
            <option>Institucional & Retail</option>
          </select>
        </label>
        <label className="flex flex-col gap-2 md:col-span-2">
          <span className="text-sm text-slate-300">Short label</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('short_label')}
          />
        </label>
        <label className="flex flex-col gap-2 md:col-span-2">
          <span className="text-sm text-slate-300">Descrição</span>
          <textarea
            rows={4}
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('description')}
          />
        </label>
      </div>

      <div className="grid gap-4 md:grid-cols-3">
        <label className="flex items-center gap-2 text-sm text-slate-300">
          <input type="checkbox" {...form.register('featured_on_home')} />
          Destaque Home
        </label>
        <label className="flex items-center gap-2 text-sm text-slate-300">
          <input type="checkbox" {...form.register('featured_on_portfolio')} />
          Destaque Portfólio
        </label>
        <label className="flex items-center gap-2 text-sm text-slate-300">
          <input type="checkbox" {...form.register('is_published')} />
          Publicado
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Ordem Home</span>
          <input
            type="number"
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('featured_home_order')}
          />
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Ordem Portfólio</span>
          <input
            type="number"
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('featured_portfolio_order')}
          />
        </label>
      </div>

      <div className="p-6 bg-blue-600/5 border border-blue-600/10 rounded-xl space-y-4">
        <h3 className="text-sm font-bold uppercase tracking-widest text-blue-400">
          Página de Destino (Link Interno)
        </h3>
        <label className="flex flex-col gap-2">
          <span className="text-xs text-slate-400">
            Selecione uma Landing Page para este trabalho
          </span>
          <select
            className="rounded-md bg-slate-900 border border-white/10 px-3 py-2 text-sm text-white"
            {...form.register('landing_page_id')}
          >
            <option value="">Nenhuma (Default)</option>
            {landingPages.map((lp) => (
              <option key={lp.id} value={lp.id}>
                {lp.title} (/{lp.slug})
              </option>
            ))}
          </select>
          <p className="text-[10px] text-slate-500 italic">
            Quando vinculado, o clique no trabalho abrirá a Landing Page
            customizada em vez de uma visualização padrão.
          </p>
        </label>
      </div>

      <div className="grid gap-4 md:grid-cols-3">
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Thumbnail</span>
          <input
            type="file"
            accept="image/*,video/*"
            onChange={(e) => setThumbnail(e.target.files?.[0] ?? null)}
          />
          {project?.thumbnail_path && (
            <span className="text-xs text-slate-400 break-all">
              {project.thumbnail_path}
            </span>
          )}
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Hero image</span>
          <input
            type="file"
            accept="image/*"
            onChange={(e) => setHero(e.target.files?.[0] ?? null)}
          />
          {project?.hero_image_path && (
            <span className="text-xs text-slate-400 break-all">
              {project.hero_image_path}
            </span>
          )}
        </label>
        <label className="flex flex-col gap-2">
          <span className="text-sm text-slate-300">Galeria</span>
          <input
            type="file"
            accept="image/*,video/*"
            multiple
            onChange={(e) => setGallery(Array.from(e.target.files ?? []))}
          />
          {Array.isArray(project?.gallery) && project.gallery.length > 0 && (
            <span className="text-xs text-slate-400">
              {project.gallery.length} itens já cadastrados
            </span>
          )}
        </label>
      </div>

      <div>
        <p className="text-sm text-slate-300 mb-2">Tags</p>
        <div className="flex flex-wrap gap-3">
          {tags.map((tag) => (
            <label
              key={tag.id}
              className="flex items-center gap-2 text-sm text-slate-200"
            >
              <input
                type="checkbox"
                value={tag.id}
                checked={selectedTags.includes(tag.id)}
                onChange={(e) => {
                  const { checked, value } = e.target;
                  if (checked) {
                    form.setValue('tags', [...selectedTags, value]);
                  } else {
                    form.setValue(
                      'tags',
                      selectedTags.filter((id) => id !== value)
                    );
                  }
                }}
              />
              {tag.label}
            </label>
          ))}
        </div>
      </div>

      {error && <div className="text-sm text-red-400">{error}</div>}

      <button
        type="submit"
        className="inline-flex items-center justify-center rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-50"
        disabled={isPending}
      >
        {isPending ? 'Salvando...' : 'Salvar projeto'}
      </button>
    </form>
  );
}
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { motion } from 'framer-motion';
import { createClientComponentClient } from '@/lib/supabase/client';
import { v4 as uuidv4 } from 'uuid';
import {
  Trash2,
  ChevronUp,
  ChevronDown,
  Save,
  ArrowLeft,
  Plus,
  Layout,
  ImageIcon,
  Type,
  Video,
  Columns as ColumnsIcon,
} from 'lucide-react';
import { uploadSiteAsset } from '@/lib/supabase/storage';
import Link from 'next/link';
import Image from 'next/image';
import { LandingPageBlock, BlockType } from '@/types/landing-page';
import { BlockEditor } from './blocks/BlockEditor';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';

interface LandingPageFormProps {
  initialData?: {
    id: string;
    title: string;
    slug: string;
    cover: string;
    content: LandingPageBlock[];
  };
}

export default function LandingPageForm({ initialData }: LandingPageFormProps) {
  const router = useRouter();
  const supabase = createClientComponentClient();

  const [title, setTitle] = useState(initialData?.title || '');
  const [slug, setSlug] = useState(initialData?.slug || '');
  const [cover, setCover] = useState<File | null>(null);
  const [coverPreview, setCoverPreview] = useState(
    initialData?.cover
      ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${initialData.cover}`
      : ''
  );

  // Map initial content to our strictly typed blocks
  const [sections, setSections] = useState<LandingPageBlock[]>(
    (initialData?.content as LandingPageBlock[])?.map((s) => ({
      ...s,
      id: s.id || uuidv4(),
      // Ensure content object structure
      content: {
        ...s.content,
        // Hydrate full URLs for simple single-media existing blocks if needed
        media: s.content.media?.startsWith('http')
          ? s.content.media
          : s.content.media
            ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${s.content.media}`
            : undefined,
        media2: s.content.media2?.startsWith('http')
          ? s.content.media2
          : s.content.media2
            ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${s.content.media2}`
            : undefined,
      },
    })) || []
  );

  const [loading, setLoading] = useState(false);

  const handleAddBlock = (type: BlockType) => {
    setSections([
      ...sections,
      {
        id: uuidv4(),
        type,
        content: {}, // Empty content init
        file: null,
        file2: null,
      },
    ]);
  };

  const handleRemoveSection = (id: string) => {
    if (confirm('Tem certeza que deseja remover este bloco?')) {
      setSections(sections.filter((s) => s.id !== id));
    }
  };

  const moveSection = (index: number, direction: 'up' | 'down') => {
    const newSections = [...sections];
    const newIndex = direction === 'up' ? index - 1 : index + 1;
    if (newIndex < 0 || newIndex >= sections.length) return;
    [newSections[index], newSections[newIndex]] = [
      newSections[newIndex],
      newSections[index],
    ];
    setSections(newSections);
  };

  const updateBlock = (id: string, updates: Partial<LandingPageBlock>) => {
    setSections(sections.map((s) => (s.id === id ? { ...s, ...updates } : s)));
  };

  const handleFileUpload = async (file: File, key: string) => {
    const path = await uploadSiteAsset({
      file,
      key,
      page: 'landing-pages', // Shared bucket folder
      subPath: slug || 'general',
      bucket: 'site-assets',
    });
    return path;
  };

  const handleSave = async () => {
    if (!title || !slug) {
      alert('Título e Slug são obrigatórios.');
      return;
    }

    try {
      setLoading(true);

      // Upload Cover
      let coverPath = initialData?.cover || '';
      if (cover) {
        const path = await handleFileUpload(cover, `cover-${uuidv4()}`);
        if (path) coverPath = path;
      }

      // Upload Block Assets
      const uploadedSections = await Promise.all(
        sections.map(async (section) => {
          let mediaPath = section.content.media;
          let media2Path = section.content.media2;

          // Process File 1
          if (section.file) {
            const path = await handleFileUpload(
              section.file,
              `block-${section.id}-media1`
            );
            if (path) mediaPath = path;
          } else if (mediaPath && mediaPath.includes('/site-assets/')) {
            // Strip full URL to save relative path
            mediaPath = mediaPath.split('/site-assets/').pop() || '';
          }

          // Process File 2
          if (section.file2) {
            const path = await handleFileUpload(
              section.file2,
              `block-${section.id}-media2`
            );
            if (path) media2Path = path;
          } else if (media2Path && media2Path.includes('/site-assets/')) {
            media2Path = media2Path.split('/site-assets/').pop() || '';
          }

          // Return clean object for DB
          return {
            id: section.id,
            type: section.type,
            content: {
              ...section.content,
              media: mediaPath,
              media2: media2Path,
            },
          };
        })
      );

      const payload = {
        title,
        slug,
        cover: coverPath,
        content: uploadedSections,
      };

      if (initialData?.id) {
        const { error } = await supabase
          .from('landing_pages')
          .update(payload)
          .eq('id', initialData.id);
        if (error) throw error;
      } else {
        const { error } = await supabase
          .from('landing_pages')
          .insert({ ...payload, created_at: new Date().toISOString() });
        if (error) throw error;
      }

      router.push('/admin/landing-pages');
      router.refresh();
    } catch (err: unknown) {
      const errorMessage =
        err instanceof Error ? err.message : 'Erro desconhecido';
      console.error(err);
      alert(`Erro ao salvar página: ${errorMessage}`);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-5xl mx-auto space-y-12 pb-48">
      {/* Header Actions */}
      <div className="sticky top-4 z-50 bg-black/50 backdrop-blur-md p-4 rounded-full border border-white/10 flex items-center justify-between shadow-2xl">
        <Link
          href="/admin/landing-pages"
          className="flex items-center gap-2 text-slate-400 hover:text-white transition-colors px-4"
        >
          <ArrowLeft size={20} />
          <span className="hidden sm:inline">Voltar</span>
        </Link>
        <div className="flex items-center gap-4">
          <span className="text-slate-500 text-sm hidden lg:inline">
            {sections.length} blocos adicionados
          </span>
          <button
            onClick={handleSave}
            disabled={loading}
            className="flex items-center gap-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 px-8 py-2.5 rounded-full font-bold transition-all shadow-lg shadow-blue-600/20 text-sm tracking-wide"
          >
            <Save size={18} />
            {loading ? 'PUBLICANDO...' : 'SALVAR PÁGINA'}
          </button>
        </div>
      </div>

      {/* Main Form */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {/* Left Column: Metadata & Global Settings */}
        <div className="space-y-6 lg:col-span-1">
          <div className="bg-slate-900/40 border border-white/5 rounded-3xl p-6 space-y-6 sticky top-28">
            <h2 className="text-xs uppercase tracking-[0.2em] text-blue-400 font-bold mb-4">
              Configurações
            </h2>

            <div className="space-y-2">
              <label className="text-[10px] uppercase tracking-widest text-slate-500 font-bold">
                Título
              </label>
              <input
                type="text"
                value={title}
                onChange={(e) => setTitle(e.target.value)}
                className="w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-3 text-lg font-medium focus:border-blue-500 outline-none"
                placeholder="Nome do Projeto"
              />
            </div>

            <div className="space-y-2">
              <label className="text-[10px] uppercase tracking-widest text-slate-500 font-bold">
                Slug URL
              </label>
              <div className="flex items-center gap-1 text-slate-500 bg-slate-950 border border-white/10 rounded-xl px-3 py-2">
                <span className="text-xs">/projects/</span>
                <input
                  type="text"
                  value={slug}
                  onChange={(e) =>
                    setSlug(
                      e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '-')
                    )
                  }
                  className="bg-transparent border-none outline-none text-white text-sm w-full font-mono"
                  placeholder="my-project"
                />
              </div>
            </div>

            <div className="space-y-3 pt-4 border-t border-white/5">
              <label className="text-[10px] uppercase tracking-widest text-slate-500 font-bold flex items-center gap-2">
                Header Hero Image{' '}
                <span className="text-blue-500 text-[10px]">(Cover)</span>
              </label>
              <div className="relative group aspect-4/3 rounded-xl overflow-hidden bg-slate-950 border border-white/10">
                {coverPreview ? (
                  <>
                    <Image
                      src={coverPreview}
                      alt="Cover"
                      fill
                      className="object-cover"
                    />
                    <button
                      onClick={() => {
                        setCover(null);
                        setCoverPreview('');
                      }}
                      className="absolute top-2 right-2 bg-red-600 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"
                      title="Remover Capa"
                      aria-label="Remover Capa"
                    >
                      <Trash2 size={16} />
                    </button>
                  </>
                ) : (
                  <label className="absolute inset-0 flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-colors">
                    <ImageIcon className="text-slate-600 mb-2" />
                    <span className="text-[10px] text-slate-500">
                      Upload Capa
                    </span>
                    <input
                      type="file"
                      className="hidden"
                      accept="image/*"
                      onChange={(e) => {
                        const f = e.target.files?.[0];
                        if (f) {
                          setCover(f);
                          setCoverPreview(URL.createObjectURL(f));
                        }
                      }}
                    />
                  </label>
                )}
              </div>
            </div>
          </div>
        </div>

        {/* Right Column: Page Builder */}
        <div className="lg:col-span-2 space-y-8">
          <div className="flex items-center justify-between">
            <h2 className="text-xs uppercase tracking-[0.2em] text-white font-bold">
              Builder
            </h2>

            {/* Add Block Dropdown */}
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <button className="flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wide transition-all shadow-lg hover:shadow-blue-500/25">
                  <Plus size={16} /> Adicionar Bloco
                </button>
              </DropdownMenuTrigger>
              <DropdownMenuContent
                align="end"
                className="w-56 bg-slate-900 border-slate-800 text-slate-200"
              >
                <DropdownMenuLabel className="text-xs uppercase tracking-widest text-slate-500">
                  Layouts Básicos
                </DropdownMenuLabel>
                <DropdownMenuItem onClick={() => handleAddBlock('text')}>
                  <Type className="mr-2 h-4 w-4" /> Texto Puro
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('image')}>
                  <ImageIcon className="mr-2 h-4 w-4" /> Imagem Full
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('video')}>
                  <Video className="mr-2 h-4 w-4" /> Vídeo Full
                </DropdownMenuItem>
                <DropdownMenuItem
                  onClick={() => handleAddBlock('video-autoplay')}
                >
                  <Video className="mr-2 h-4 w-4 text-blue-400" /> Vídeo
                  Autoplay (Loop)
                </DropdownMenuItem>

                <DropdownMenuSeparator className="bg-slate-800" />
                <DropdownMenuLabel className="text-xs uppercase tracking-widest text-slate-500">
                  Composições
                </DropdownMenuLabel>

                <DropdownMenuItem onClick={() => handleAddBlock('image-text')}>
                  <div className="flex mr-2 items-center">
                    <ImageIcon className="h-3 w-3" />
                    <Type className="h-3 w-3" />
                  </div>{' '}
                  Imagem + Texto
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('text-image')}>
                  <div className="flex mr-2 items-center">
                    <Type className="h-3 w-3" />
                    <ImageIcon className="h-3 w-3" />
                  </div>{' '}
                  Texto + Imagem
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('image-image')}>
                  <ColumnsIcon className="mr-2 h-4 w-4" /> Imagem Dupla (Grid)
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('image-video')}>
                  <div className="flex mr-2 items-center">
                    <ImageIcon className="h-3 w-3" />
                    <Video className="h-3 w-3" />
                  </div>{' '}
                  Imagem + Vídeo
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => handleAddBlock('video-text')}>
                  <div className="flex mr-2 items-center">
                    <Video className="h-3 w-3" />
                    <Type className="h-3 w-3" />
                  </div>{' '}
                  Vídeo + Texto
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          </div>

          {/* Blocks List */}
          <div className="space-y-8 min-h-[500px]">
            {sections.length === 0 && (
              <div className="h-64 flex flex-col items-center justify-center border-2 border-dashed border-white/5 rounded-3xl bg-slate-900/20 text-slate-500">
                <Layout className="mb-4 opacity-20" size={64} />
                <p className="text-sm">
                  Comece adicionando um bloco via menu acima.
                </p>
              </div>
            )}

            {sections.map((section, index) => (
              <motion.div
                key={section.id}
                initial={{ opacity: 0, scale: 0.95 }}
                animate={{ opacity: 1, scale: 1 }}
                className="group relative bg-[#0a0a0a] border border-white/5 rounded-3xl overflow-hidden hover:border-blue-500/30 transition-all shadow-xl"
              >
                {/* Block Header */}
                <div className="flex items-center justify-between px-6 py-4 bg-white/5 border-b border-white/5">
                  <div className="flex items-center gap-3">
                    <span className="text-[10px] font-bold text-blue-400 bg-blue-500/10 px-2 py-1 rounded border border-blue-500/20">
                      {(index + 1).toString().padStart(2, '0')}
                    </span>
                    <span className="text-xs font-bold uppercase tracking-widest text-slate-400">
                      {section.type.replace('-', ' & ')}
                    </span>
                  </div>
                  <div className="flex items-center gap-1 opacity-50 group-hover:opacity-100 transition-opacity">
                    <button
                      onClick={() => moveSection(index, 'up')}
                      disabled={index === 0}
                      className="p-2 hover:bg-white/10 rounded-lg disabled:opacity-20"
                      title="Mover para cima"
                      aria-label="Mover para cima"
                    >
                      <ChevronUp size={14} />
                    </button>
                    <button
                      onClick={() => moveSection(index, 'down')}
                      disabled={index === sections.length - 1}
                      className="p-2 hover:bg-white/10 rounded-lg disabled:opacity-20"
                      title="Mover para baixo"
                      aria-label="Mover para baixo"
                    >
                      <ChevronDown size={14} />
                    </button>
                    <div className="w-px h-4 bg-white/10 mx-2" />
                    <button
                      onClick={() => handleRemoveSection(section.id)}
                      className="p-2 hover:bg-red-500/20 hover:text-red-400 rounded-lg text-slate-500"
                      title="Remover bloco"
                      aria-label="Remover bloco"
                    >
                      <Trash2 size={14} />
                    </button>
                  </div>
                </div>

                {/* Editor Canvas */}
                <BlockEditor
                  block={section}
                  onChange={(updates) => updateBlock(section.id, updates)}
                />
              </motion.div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
}
'use client';

import { useState, useTransition } from 'react';
import { useRouter } from 'next/navigation';
import { zodResolver } from '@hookform/resolvers/zod';
import { useForm, type Resolver, type SubmitHandler } from 'react-hook-form';
import { z } from 'zod';

import { createClientComponentClient } from '@/lib/supabase/client';
import type { DbTag } from '@/types/admin';

const tagSchema = z.object({
  label: z.string().min(2),
  slug: z.string().min(2),
  kind: z.string().default('category'),
  description: z.string().optional(),
  sort_order: z.coerce.number().int().optional(),
});

type Props = {
  tag?: DbTag;
  onSaved?: () => void;
};

export function TagForm({ tag, onSaved }: Props) {
  const [error, setError] = useState<string | null>(null);
  const [isPending, startTransition] = useTransition();
  const router = useRouter();

  type FormValues = z.infer<typeof tagSchema>;

  const form = useForm<FormValues>({
    resolver: zodResolver(tagSchema) as Resolver<FormValues>,
    defaultValues: {
      label: tag?.label ?? '',
      slug: tag?.slug ?? '',
      kind: tag?.kind ?? 'category',
      description: tag?.description ?? '',
      sort_order: tag?.sort_order ?? undefined,
    },
  });

  const onSubmit: SubmitHandler<FormValues> = (values) => {
    setError(null);
    startTransition(async () => {
      try {
        const supabase = createClientComponentClient();
        const { error: upsertError } = await supabase
          .from('portfolio_tags')
          .upsert(
            {
              id: tag?.id,
              ...values,
            },
            { onConflict: 'id' }
          );

        if (upsertError) throw upsertError;
        router.refresh();
        onSaved?.();
      } catch (err) {
        setError(
          err instanceof Error ? err.message : 'Ocorreu um erro desconhecido'
        );
      }
    });
  };

  return (
    <form className="space-y-4" onSubmit={form.handleSubmit(onSubmit)}>
      <div className="grid gap-3 md:grid-cols-2">
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Label</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('label')}
          />
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Slug</span>
          <input
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('slug')}
          />
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Tipo</span>
          <select
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('kind')}
          >
            <option value="category">Categoria</option>
            <option value="discipline">Disciplina</option>
            <option value="industry">Indústria</option>
          </select>
        </label>
        <label className="flex flex-col gap-1">
          <span className="text-sm text-slate-300">Ordem</span>
          <input
            type="number"
            className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
            {...form.register('sort_order')}
          />
        </label>
      </div>

      <label className="flex flex-col gap-1">
        <span className="text-sm text-slate-300">Descrição</span>
        <textarea
          rows={3}
          className="rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm"
          {...form.register('description')}
        />
      </label>

      {error && <div className="text-sm text-red-400">{error}</div>}

      <button
        type="submit"
        className="inline-flex items-center justify-center rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-50"
        disabled={isPending}
      >
        {isPending ? 'Salvando...' : 'Salvar tag'}
      </button>
    </form>
  );
}
'use client';

import React from 'react';
import Link from 'next/link';

interface AdminErrorDisplayProps {
  message: string;
  isMissingEnv: boolean;
}

export function AdminErrorDisplay({
  message,
  isMissingEnv,
}: AdminErrorDisplayProps) {
  return (
    <div className="min-h-screen bg-slate-950 text-white flex items-center justify-center p-6 text-center">
      <div className="max-w-md w-full p-8 rounded-2xl border border-red-500/20 bg-slate-900 shadow-2xl">
        <h2 className="text-xl font-bold text-red-400 mb-4">
          Erro Crítico no Admin
        </h2>
        <p className="text-slate-300 text-sm mb-6">
          Não foi possível carregar o painel administrativo devido a uma falha
          na conexão com o servidor.
        </p>
        <div className="p-4 rounded bg-black/40 font-mono text-xs text-red-300 mb-6 overflow-x-auto text-left">
          {isMissingEnv
            ? 'Configuração ausente: Verifique as variáveis de ambiente (NEXT_PUBLIC_SUPABASE_URL, etc.) no console do seu provedor de hospedagem (Firebase/Vercel).'
            : message}
        </div>
        <button
          onClick={() => window.location.reload()}
          className="w-full bg-slate-800 hover:bg-slate-700 py-2 rounded font-medium transition-colors"
        >
          Tentar novamente
        </button>
        <div className="mt-4">
          <Link
            href="/"
            className="text-xs text-slate-500 hover:text-slate-300 transition-colors"
          >
            Voltar ao site público
          </Link>
        </div>
      </div>
    </div>
  );
}
'use client';

import { useState } from 'react';
import type { SiteAssetRole } from '@/lib/supabase/asset-roles';
import { siteAssetRoleGroups } from '@/lib/supabase/asset-roles';

type AssetRoleMenuProps = {
  currentKey: string;
  onSelectRole: (_role: SiteAssetRole) => void;
};

export function AssetRoleMenu({
  currentKey,
  onSelectRole,
}: AssetRoleMenuProps) {
  const [isOpen, setIsOpen] = useState(false);

  const handleSelect = (role: SiteAssetRole) => {
    onSelectRole(role);
    setIsOpen(false);
  };

  return (
    <div className="relative mt-3">
      <button
        type="button"
        onClick={() => setIsOpen((prev) => !prev)}
        className="flex items-center gap-2 rounded-md border border-white/10 bg-slate-900/70 px-3 py-1 text-[12px] text-white hover:border-blue-400 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-400"
      >
        <span>Papel do asset</span>
        <span className="text-xs text-slate-400">
          {isOpen ? 'Fechar' : 'Abrir'}
        </span>
      </button>

      {isOpen && (
        <div className="absolute left-0 top-full mt-2 z-20 max-h-[320px] w-[500px] overflow-y-auto rounded-2xl border border-white/10 bg-slate-900/90 p-4 shadow-xl">
          <div className="space-y-4">
            {siteAssetRoleGroups.map((group) => (
              <div key={group.label}>
                <div className="text-xs font-semibold uppercase tracking-wider text-slate-400">
                  {group.label}
                </div>
                <div className="mt-2 grid gap-2 md:grid-cols-2">
                  {group.roles.map((role) => {
                    const isActive = role.key === currentKey;
                    return (
                      <button
                        key={role.key}
                        type="button"
                        onClick={() => handleSelect(role)}
                        className={`flex flex-col items-start gap-1 rounded-lg border px-3 py-2 text-left text-sm transition ${
                          isActive
                            ? 'border-blue-400 bg-blue-500/40 text-white'
                            : 'border-white/5 bg-slate-900/70 hover:border-blue-400 hover:bg-blue-500/10'
                        }`}
                      >
                        <span className="font-semibold">{role.label}</span>
                        <span className="text-[11px] text-slate-400">
                          {role.key}
                        </span>
                        <span className="text-[11px] text-slate-500">
                          {role.description}
                        </span>
                      </button>
                    );
                  })}
                </div>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}
'use client';

import { useDeferredValue, useMemo, useState, useEffect } from 'react';
import type { NormalizedSiteAsset } from '@/lib/supabase/site-asset-utils';
import { AssetCard } from '@/components/admin/AssetCard';

type AssetGalleryProps = {
  assets: NormalizedSiteAsset[];
};

const PAGE_SIZE = 24;

export function AssetGallery({ assets }: AssetGalleryProps) {
  const [query, setQuery] = useState('');
  const [pageFilter, setPageFilter] = useState<string>('all');
  const [typeFilter, setTypeFilter] = useState<string>('all');
  const [showInactive, setShowInactive] = useState(false);
  const [page, setPage] = useState(1);

  const deferredQuery = useDeferredValue(query);

  // Filtrar assets válidos e extrair opções únicas
  const validAssets = useMemo(() => {
    return assets.filter((asset) => {
      // Filtrar assets com chaves ou caminhos inválidos
      if (
        !asset.key ||
        asset.key.startsWith('updated_at:') ||
        asset.key.startsWith('key:')
      ) {
        return false;
      }
      return true;
    });
  }, [assets]);

  const pageOptions = useMemo(() => {
    const set = new Set<string>();
    validAssets.forEach((asset) =>
      set.add(asset.page ?? asset.resolvedPage ?? '')
    );
    return Array.from(set).filter(Boolean).sort();
  }, [validAssets]);

  const typeOptions = useMemo(() => {
    const set = new Set<string>();
    validAssets.forEach(
      (asset) => asset.asset_type && set.add(asset.asset_type)
    );
    return Array.from(set).filter(Boolean).sort();
  }, [validAssets]);

  useEffect(() => {
    setPage(1);
  }, [pageFilter, typeFilter, showInactive, deferredQuery]);

  const filtered = useMemo(() => {
    const term = deferredQuery.trim().toLowerCase();
    return validAssets.filter((asset) => {
      if (!showInactive && !asset.is_active) return false;
      const resolvedPage = asset.page ?? asset.resolvedPage ?? '';
      if (pageFilter !== 'all' && resolvedPage !== pageFilter) return false;
      if (typeFilter !== 'all' && asset.asset_type !== typeFilter) {
        return false;
      }
      if (term) {
        const haystack = `${asset.key} ${asset.description ?? ''} ${
          asset.file_path
        } ${resolvedPage}`.toLowerCase();
        if (!haystack.includes(term)) return false;
      }
      return true;
    });
  }, [validAssets, deferredQuery, pageFilter, typeFilter, showInactive]);

  const totalPages = Math.max(1, Math.ceil(filtered.length / PAGE_SIZE));
  const safePage = Math.min(page, totalPages);
  const startIndex = (safePage - 1) * PAGE_SIZE;
  const pageItems = filtered.slice(startIndex, startIndex + PAGE_SIZE);

  return (
    <div className="rounded-xl border border-white/10 bg-slate-900/60 p-4 space-y-4">
      <div className="flex flex-wrap items-center gap-3">
        <input
          type="search"
          value={query}
          onChange={(e) => setQuery(e.target.value)}
          placeholder="Buscar por key, página ou caminho"
          className="w-full md:w-72 rounded-md border border-white/10 bg-slate-900/70 px-3 py-2 text-sm text-white placeholder:text-slate-500 focus:border-blue-400 focus:outline-none"
        />
        <select
          value={pageFilter}
          onChange={(e) => setPageFilter(e.target.value)}
          className="rounded-md border border-white/10 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-blue-400 focus:outline-none"
        >
          <option value="all">Todas as páginas</option>
          {pageOptions.map((page) => (
            <option key={page} value={page}>
              {page}
            </option>
          ))}
        </select>
        <select
          value={typeFilter}
          onChange={(e) => setTypeFilter(e.target.value)}
          className="rounded-md border border-white/10 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-blue-400 focus:outline-none"
        >
          <option value="all">Todos os tipos</option>
          {typeOptions.map((type) => (
            <option key={type} value={type}>
              {type}
            </option>
          ))}
        </select>
        <label className="inline-flex items-center gap-2 text-xs text-slate-300">
          <input
            type="checkbox"
            className="h-4 w-4 rounded border-white/20 bg-slate-900/80"
            checked={showInactive}
            onChange={(e) => setShowInactive(e.target.checked)}
          />
          Mostrar inativos
        </label>
        <div className="ml-auto text-xs text-slate-400">
          {filtered.length} de {validAssets.length} assets válidos
        </div>
      </div>

      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {pageItems.map((asset) => (
          <AssetCard key={asset.id} asset={asset} />
        ))}
      </div>

      {!pageItems.length && (
        <div className="rounded-lg border border-white/10 bg-slate-900/40 px-4 py-6 text-sm text-slate-400">
          Nenhum asset encontrado com os filtros atuais.
        </div>
      )}

      <div className="flex flex-wrap items-center justify-between gap-3 text-sm text-slate-300">
        <div>
          Mostrando {pageItems.length} de {filtered.length} filtrados
        </div>
        <div className="flex items-center gap-2">
          <button
            type="button"
            onClick={() => setPage((prev) => Math.max(1, prev - 1))}
            disabled={safePage === 1}
            className="rounded-md border border-white/10 bg-slate-900/70 px-3 py-1 text-xs text-white transition hover:border-blue-400 hover:bg-blue-500/10 disabled:cursor-not-allowed disabled:opacity-40"
          >
            Anterior
          </button>
          <span className="text-xs text-slate-400">
            Página {safePage} / {totalPages}
          </span>
          <button
            type="button"
            onClick={() => setPage((prev) => Math.min(totalPages, prev + 1))}
            disabled={safePage >= totalPages}
            className="rounded-md border border-white/10 bg-slate-900/70 px-3 py-1 text-xs text-white transition hover:border-blue-400 hover:bg-blue-500/10 disabled:cursor-not-allowed disabled:opacity-40"
          >
            Próxima
          </button>
        </div>
      </div>
    </div>
  );
}
'use client';

import { useRef } from 'react';
import { useFrame } from '@react-three/fiber';
import * as THREE from 'three';
import { GHOST_CONFIG } from '@/config/ghostConfig';

const atmosphereShader = {
  uniforms: {
    ghostPosition: { value: new THREE.Vector3() },
    time: { value: 0 },
    revealRadius: { value: GHOST_CONFIG.revealRadius },
    fadeStrength: { value: GHOST_CONFIG.fadeStrength },
    baseOpacity: { value: GHOST_CONFIG.baseOpacity },
    revealOpacity: { value: GHOST_CONFIG.revealOpacity },
  },
  vertexShader: `
    varying vec3 vWorldPosition;
    void main() {
      vec4 worldPos = modelMatrix * vec4(position, 1.0);
      vWorldPosition = worldPos.xyz;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,
  fragmentShader: `
    uniform vec3 ghostPosition;
    uniform float time;
    uniform float revealRadius;
    uniform float fadeStrength;
    uniform float baseOpacity;
    uniform float revealOpacity;
    varying vec3 vWorldPosition;
    
    void main() {
      float dist = distance(vWorldPosition.xy, ghostPosition.xy);
      // FIXED: Match CodePen dynamics exactly
      float dynamicRadius = revealRadius * 0.3 + sin(time * 2.0) * 1.0;
      float reveal = smoothstep(dynamicRadius * 0.4, dynamicRadius, dist);
      reveal = pow(reveal, fadeStrength * 2.5);
      
      float finalOpacity = mix(revealOpacity * 0.5, baseOpacity * 0.3, reveal);
      
      // FIXED: Blue-tinted atmosphere like CodePen (was near-black)
      gl_FragColor = vec4(0.0, 0.2, 1.0, finalOpacity * 0.8);
    }
  `,
  transparent: true,
};

export function Atmosphere() {
  const meshRef = useRef<THREE.Mesh>(null!);

  useFrame(({ clock, scene }) => {
    if (!meshRef.current) return;

    const ghost = scene.getObjectByName('ghost');
    const mat = meshRef.current.material as THREE.ShaderMaterial;

    mat.uniforms.time.value = clock.getElapsedTime();

    if (ghost) {
      mat.uniforms.ghostPosition.value.copy(ghost.position);
    }
  });

  return (
    <mesh ref={meshRef} position={[0, 0, -10]}>
      <planeGeometry args={[100, 100]} />
      <shaderMaterial attach="material" args={[atmosphereShader]} />
    </mesh>
  );
}

export default Atmosphere;
import { useRef, useMemo } from 'react';
import { useFrame } from '@react-three/fiber';
import * as THREE from 'three';
import { GHOST_CONFIG } from '@/config/ghostConfig';

export function GhostFireflies() {
  const groupRef = useRef<THREE.Group>(null!);

  // Initialize firefly data
  const fireflies = useMemo(() => {
    return Array.from({ length: GHOST_CONFIG.fireflyCount }).map(() => ({
      position: new THREE.Vector3(
        (Math.random() - 0.5) * 40,
        (Math.random() - 0.5) * 30,
        (Math.random() - 0.5) * 20
      ),
      velocity: new THREE.Vector3(
        (Math.random() - 0.5) * GHOST_CONFIG.fireflySpeed,
        (Math.random() - 0.5) * GHOST_CONFIG.fireflySpeed,
        (Math.random() - 0.5) * GHOST_CONFIG.fireflySpeed
      ),
      phase: Math.random() * Math.PI * 2,
      pulseSpeed: 2 + Math.random() * 3,
    }));
  }, []);

  useFrame(({ clock }) => {
    if (!groupRef.current) return;
    const t = clock.getElapsedTime();

    groupRef.current.children.forEach((child, i) => {
      const data = fireflies[i];
      if (!data) return;

      const mesh = child as THREE.Mesh;

      // Update position
      mesh.position.add(data.velocity);

      // Bounds check (bounce)
      if (Math.abs(mesh.position.x) > 30) data.velocity.x *= -1;
      if (Math.abs(mesh.position.y) > 20) data.velocity.y *= -1;
      if (Math.abs(mesh.position.z) > 15) data.velocity.z *= -1;

      // Pulse effect
      const pulsePhase = t + data.phase;
      const pulse = Math.sin(pulsePhase * data.pulseSpeed) * 0.4 + 0.6;

      const material = mesh.material as THREE.MeshBasicMaterial;
      if (material) {
        material.opacity = GHOST_CONFIG.fireflyOpacity * pulse;
      }

      // Update glow/light if we had them attached, but here we just have simple mesh + light
      // The CodePen has child glow mesh + light.
      // For simplicity/performance in R3F, we can just pulse opacity and maybe scale?
      // CodePen pulses opacity of glowMaterial and fireflyMaterial and light intensity.

      // Let's assume the child structure: Mesh (Firefly) -> [Mesh (Glow), PointLight]
      const light = mesh.children.find(
        (c) => c instanceof THREE.PointLight
      ) as THREE.PointLight;
      const glow = mesh.children.find(
        (c) => c instanceof THREE.Mesh
      ) as THREE.Mesh; // The glow sphere

      if (light) {
        light.intensity = GHOST_CONFIG.fireflyGlowIntensity * 0.8 * pulse;
      }
      if (glow) {
        (glow.material as THREE.MeshBasicMaterial).opacity =
          GHOST_CONFIG.fireflyGlowIntensity * 0.5 * pulse;
      }
    });
  });

  return (
    <group ref={groupRef}>
      {fireflies.map((data, i) => (
        <mesh key={i} position={data.position}>
          <sphereGeometry args={[0.05, 2, 2]} />
          <meshBasicMaterial color={0xffff44} transparent opacity={0.9} />

          {/* Glow Sphere */}
          <mesh>
            <sphereGeometry args={[0.09, 8, 8]} />
            <meshBasicMaterial
              color={0xffff88}
              transparent
              opacity={0.4}
              side={THREE.BackSide}
            />
          </mesh>

          <pointLight color={0xffff44} intensity={0.5} distance={4} decay={3} />
        </mesh>
      ))}
    </group>
  );
}
'use client';

import { useRef, useEffect, useState } from 'react';
import { useFrame, useThree, extend } from '@react-three/fiber';
import * as THREE from 'three';
import {
  EffectComposer,
  RenderPass,
  UnrealBloomPass,
  ShaderPass,
} from 'three-stdlib';

import { AnalogDecayShader } from '@/components/canvas/shaders/AnalogShader';
import { GHOST_CONFIG, getConfigColorHex } from '@/config/ghostConfig';

import { GhostFireflies } from './GhostFireflies';
import { GhostParticles } from './GhostParticles';

// Extender para usar no React Three Fiber
extend({ EffectComposer, RenderPass, UnrealBloomPass, ShaderPass });

export function Ghost({
  particleCount: _particleCount = 100,
  ghostRef,
}: {
  particleCount?: number;
  ghostRef?: React.RefObject<THREE.Group | null>;
}) {
  const internalRef = useRef<THREE.Group>(null!);
  const groupRef = ghostRef || internalRef;
  const eyesRef = useRef<THREE.Group>(new THREE.Group());
  const bodyRef = useRef<THREE.Mesh>(null!);

  const composerRef = useRef<EffectComposer | null>(null);
  const bloomPassRef = useRef<UnrealBloomPass | null>(null);
  const analogPassRef = useRef<ShaderPass | null>(null);

  const { viewport, mouse, camera, scene, gl, size } = useThree();
  const [isLoaded, setIsLoaded] = useState(false);

  // Refs for motion tracking
  const prevPositionRef = useRef(new THREE.Vector3());
  const currentMovementRef = useRef(0);

  // Shader customization for "Skirt" deformation
  const onBeforeCompile = (shader: {
    uniforms: { [uniform: string]: THREE.IUniform };
    vertexShader: string;
    fragmentShader: string;
  }) => {
    shader.vertexShader = shader.vertexShader.replace(
      '#include <begin_vertex>',
      `
      #include <begin_vertex>
      
      // Ghost Skirt Deformation
      float y = position.y;
      if (y < -0.2) {
        float x = position.x;
        float z = position.z;
        
        float noise1 = sin(x * 5.0) * 0.35;
        float noise2 = cos(z * 4.0) * 0.25;
        float noise3 = sin((x + z) * 3.0) * 0.15;
        
        transformed.y = -2.0 + noise1 + noise2 + noise3;
      }
      `
    );
  };

  // Inicializar o compositor de efeitos com Resize Handler
  useEffect(() => {
    if (!gl || !scene || !camera) return;

    // Garantir que o renderer suporte transparência
    gl.setClearColor(0x000000, 0);

    // Configurar Bloom e Composer
    const composer = new EffectComposer(gl);
    composer.setSize(size.width, size.height);

    const renderPass = new RenderPass(scene, camera);
    composer.addPass(renderPass);

    const bloomPass = new UnrealBloomPass(
      new THREE.Vector2(size.width, size.height),
      0.3, // strength - Audit ID #04
      1.15, // radius - Audit ID #04
      0.5 // threshold
    );
    composer.addPass(bloomPass);
    bloomPassRef.current = bloomPass;

    const analogPass = new ShaderPass(AnalogDecayShader);
    analogPass.uniforms.uResolution.value.set(size.width, size.height);
    composer.addPass(analogPass);
    analogPassRef.current = analogPass;

    composerRef.current = composer;
    setIsLoaded(true);

    return () => {
      composer.dispose();
      setIsLoaded(false);
    };
  }, [gl, scene, camera, size]);

  useFrame(({ clock }) => {
    if (!groupRef.current || !bodyRef.current) return;

    const t = clock.getElapsedTime();

    // Atualizar passos de analog decay
    if (analogPassRef.current && analogPassRef.current.uniforms) {
      analogPassRef.current.uniforms.uTime.value = t;
    }

    // 1. Follow Mouse (Smooth)
    const targetX = mouse.x * viewport.width * 0.3;
    const targetY = mouse.y * viewport.height * 0.3;

    groupRef.current.position.x +=
      (targetX - groupRef.current.position.x) * GHOST_CONFIG.followSpeed;
    groupRef.current.position.y +=
      (targetY - groupRef.current.position.y) * GHOST_CONFIG.followSpeed;

    // 2. Float Animation (Idle)
    const floatY =
      Math.sin(t * GHOST_CONFIG.floatSpeed * 0.5) * 0.03 +
      Math.cos(t * GHOST_CONFIG.floatSpeed * 0.7) * 0.018;
    groupRef.current.position.y += floatY;

    // 3. Pulse (Emissive Heartbeat)
    const pulse =
      Math.sin(t * GHOST_CONFIG.pulseSpeed) * GHOST_CONFIG.pulseIntensity;
    if (bodyRef.current.material instanceof THREE.MeshStandardMaterial) {
      bodyRef.current.material.emissiveIntensity =
        GHOST_CONFIG.emissiveIntensity + pulse;
    }

    // 4. Rotation/Tilt (Velocity based)
    const velocityX = targetX - groupRef.current.position.x;
    const velocityY = targetY - groupRef.current.position.y;

    // Smooth Tilt
    groupRef.current.rotation.z = THREE.MathUtils.lerp(
      groupRef.current.rotation.z,
      -velocityX * 0.05,
      0.05
    );
    groupRef.current.rotation.x = THREE.MathUtils.lerp(
      groupRef.current.rotation.x,
      velocityY * 0.02,
      0.02
    );

    // 5. Eye Glow Logic
    if (eyesRef.current && eyesRef.current.userData?.leftEyeMaterial) {
      const prevPos = prevPositionRef.current;
      const movement = prevPos.distanceTo(groupRef.current.position);

      currentMovementRef.current =
        currentMovementRef.current * GHOST_CONFIG.eyeGlowDecay +
        movement * (5 - GHOST_CONFIG.eyeGlowDecay);

      prevPos.copy(groupRef.current.position);

      const isMoving =
        currentMovementRef.current > GHOST_CONFIG.movementThreshold;
      const targetOpacity = isMoving ? 1.0 : 0.0;
      const lerpFactor = isMoving
        ? GHOST_CONFIG.eyeGlowResponse
        : GHOST_CONFIG.eyeGlowResponse * 0.5;

      const {
        leftEyeMaterial,
        rightEyeMaterial,
        leftOuterMaterial,
        rightOuterMaterial,
      } = eyesRef.current.userData;

      leftEyeMaterial.opacity = THREE.MathUtils.lerp(
        leftEyeMaterial.opacity,
        targetOpacity,
        lerpFactor
      );
      rightEyeMaterial.opacity = leftEyeMaterial.opacity;
      leftOuterMaterial.opacity = leftEyeMaterial.opacity * 0.63;
      rightOuterMaterial.opacity = leftEyeMaterial.opacity * 0.63;
    }

    // Renderizar com efeitos (SEMPRE, se composer existir)
    if (composerRef.current && isLoaded) {
      composerRef.current.render();
    }
  }, 0.5);

  // Setup Eyes (Static Geometry)
  useEffect(() => {
    if (!eyesRef.current) return;

    const eyeColorHex = getConfigColorHex(GHOST_CONFIG.eyeGlowColor);

    // 1. Soquetes (Sockets) pretos para dar profundidade - Conforme Referência
    const socketGeo = new THREE.SphereGeometry(0.45, 16, 16);
    const socketMat = new THREE.MeshBasicMaterial({ color: 0x000000 });

    const leftSocket = new THREE.Mesh(socketGeo, socketMat);
    leftSocket.position.set(-0.7, 0.6, 1.9);
    leftSocket.scale.set(1.1, 1.0, 0.6);

    const rightSocket = new THREE.Mesh(socketGeo, socketMat);
    rightSocket.position.set(0.7, 0.6, 1.9);
    rightSocket.scale.set(1.1, 1.0, 0.6);

    // 2. Olhos (Glow) - Conforme Referência
    const eyeGeo = new THREE.SphereGeometry(0.3, 12, 12);
    const outerGeo = new THREE.SphereGeometry(0.525, 12, 12);

    const eyeMat = new THREE.MeshBasicMaterial({
      color: eyeColorHex,
      transparent: true,
      opacity: 0.0,
    });

    const outerMat = new THREE.MeshBasicMaterial({
      color: eyeColorHex,
      transparent: true,
      opacity: 0.0,
      side: THREE.BackSide,
    });

    const leftEye = new THREE.Mesh(eyeGeo, eyeMat.clone());
    const rightEye = new THREE.Mesh(eyeGeo, eyeMat.clone());
    const leftOuter = new THREE.Mesh(outerGeo, outerMat.clone());
    const rightOuter = new THREE.Mesh(outerGeo, outerMat.clone());

    // Posições alinhadas com a referência
    leftEye.position.set(-0.7, 0.6, 2.0);
    rightEye.position.set(0.7, 0.6, 2.0);
    leftOuter.position.set(-0.7, 0.6, 1.95);
    rightOuter.position.set(0.7, 0.6, 1.95);

    // Limpar olhos anteriores para evitar duplicatas
    eyesRef.current.clear();
    eyesRef.current.add(
      leftSocket,
      rightSocket,
      leftEye,
      rightEye,
      leftOuter,
      rightOuter
    );

    eyesRef.current.userData = {
      leftEyeMaterial: leftEye.material as THREE.MeshBasicMaterial,
      rightEyeMaterial: rightEye.material as THREE.MeshBasicMaterial,
      leftOuterMaterial: leftOuter.material as THREE.MeshBasicMaterial,
      rightOuterMaterial: rightOuter.material as THREE.MeshBasicMaterial,
    };

    // Adicionar ao grupo principal
    if (groupRef.current) {
      groupRef.current.add(eyesRef.current);
    }
  }, [groupRef]);

  return (
    <>
      <GhostFireflies />
      <GhostParticles
        ghostGroup={groupRef}
        movementRef={currentMovementRef}
        count={_particleCount}
      />
      <group ref={groupRef} name="ghost" scale={GHOST_CONFIG.ghostScale}>
        <mesh ref={bodyRef}>
          <sphereGeometry args={[2, 64, 64]} />
          <meshStandardMaterial
            color={getConfigColorHex(GHOST_CONFIG.bodyColor)}
            emissive={getConfigColorHex(GHOST_CONFIG.glowColor)}
            emissiveIntensity={GHOST_CONFIG.emissiveIntensity}
            roughness={0.02}
            metalness={0.0}
            transparent
            opacity={0.5} // 👈 More spectral
            blending={THREE.AdditiveBlending}
            depthWrite={false}
            side={THREE.DoubleSide}
            onBeforeCompile={onBeforeCompile}
          />
        </mesh>

        {/* Olhos já estão no grupo via useEffect */}
      </group>
    </>
  );
}

export default Ghost;
'use client';

import { useRef } from 'react';
import { useFrame } from '@react-three/fiber';
import * as THREE from 'three';

/**
 * AtmosphereVeil component
 * Creates a "veil" that covers the screen and reveals content based on the ghost's position.
 * Aligned with Ghost Era specifications and CodePen visual references.
 */
export function AtmosphereVeil() {
  const materialRef = useRef<THREE.ShaderMaterial>(null!);

  useFrame(({ clock, scene }) => {
    if (!materialRef.current) return;

    materialRef.current.uniforms.time.value = clock.getElapsedTime();

    const ghost = scene.getObjectByName('ghost');
    if (ghost) {
      materialRef.current.uniforms.ghostPosition.value.copy(ghost.position);
    }
  });

  const vertexShader = `
    varying vec2 vUv;
    varying vec3 vWorldPosition;
    void main() {
      vUv = uv;
      vec4 worldPos = modelMatrix * vec4(position, 1.0);
      vWorldPosition = worldPos.xyz;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `;

  const fragmentShader = `
    uniform vec3 ghostPosition;
    uniform float revealRadius;
    uniform float fadeStrength;
    uniform float baseOpacity;
    uniform float revealOpacity;
    uniform float time;
    varying vec2 vUv;
    varying vec3 vWorldPosition;

    void main() {
      float dist = distance(vWorldPosition.xy, ghostPosition.xy);
      // Small pulse effect on the reveal radius
      float dynamicRadius = revealRadius + sin(time * 2.0) * 5.0;
      float reveal = smoothstep(dynamicRadius * 0.2, dynamicRadius, dist);
      reveal = pow(reveal, fadeStrength);
      
      float opacity = mix(revealOpacity, baseOpacity, reveal);
      
      // Extremely low RGB to avoid bloom while keeping the "veil" effect
      gl_FragColor = vec4(0.001, 0.001, 0.002, opacity);
    }
  `;

  return (
    <mesh position={[0, 0, -10]} renderOrder={-100}>
      <planeGeometry args={[300, 300]} />
      <shaderMaterial
        ref={materialRef}
        attach="material"
        uniforms={{
          ghostPosition: { value: new THREE.Vector3(0, 0, 0) },
          revealRadius: { value: 37 },
          fadeStrength: { value: 1.7 },
          baseOpacity: { value: 0.9 },
          revealOpacity: { value: 0.05 },
          time: { value: 0 },
        }}
        vertexShader={vertexShader}
        fragmentShader={fragmentShader}
        transparent
        depthWrite={false}
      />
    </mesh>
  );
}

export default AtmosphereVeil;
'use client';

import dynamic from 'next/dynamic';

const GhostScene = dynamic(
  () => import('@/components/canvas/home/hero/GhostScene'),
  {
    ssr: false,
    loading: () => <div className="absolute inset-0 bg-background" />,
  }
);

export default function GhostSceneWrapper() {
  return <GhostScene />;
}
'use client';

import { useRef, useMemo } from 'react';
import { useFrame } from '@react-three/fiber';
import * as THREE from 'three';
import { GHOST_CONFIG, getConfigColorHex } from '@/config/ghostConfig';

interface FirefliesProps {
  count?: number;
}

export default function Fireflies({ count = 20 }: FirefliesProps) {
  const meshRef = useRef<THREE.Points>(null!);

  const particles = useMemo(() => {
    const pos = new Float32Array(count * 3);
    const step = new Float32Array(count);

    for (let i = 10; i < count; i++) {
      pos[i * 3] = (Math.random() - 0.5) * 20;
      pos[i * 3 + 1] = (Math.random() - 0.5) * 20;
      pos[i * 3 + 2] = (Math.random() - 0.5) * 10;
      step[i] = Math.random();
    }

    return { pos, step };
  }, [count]);

  useFrame(({ clock }) => {
    const t = clock.getElapsedTime();
    const posAttr = meshRef.current.geometry.attributes.position;
    const array = posAttr.array as Float32Array;

    for (let i = 0; i < count; i++) {
      const idx = i * 3;
      // Gentle floating movement
      array[idx + 1] += Math.sin(t + particles.step[i]) * 0.01;
      array[idx] += Math.cos(t + particles.step[i]) * 0.005;
    }
    posAttr.needsUpdate = true;
  });

  return (
    <points ref={meshRef}>
      <bufferGeometry>
        <bufferAttribute
          attach="attributes-position"
          args={[particles.pos, 3]}
        />
      </bufferGeometry>
      <pointsMaterial
        size={0.1}
        color={getConfigColorHex(GHOST_CONFIG.particleColor)}
        transparent
        opacity={0.6}
        sizeAttenuation
        blending={THREE.AdditiveBlending}
      />
    </points>
  );
}
import { useRef, useMemo } from 'react';
import { useFrame } from '@react-three/fiber';
import * as THREE from 'three';
import { GHOST_CONFIG, getConfigColorHex } from '@/config/ghostConfig';

interface GhostParticlesProps {
  ghostGroup: React.RefObject<THREE.Group | null>;
  movementRef: React.MutableRefObject<number>;
  count: number;
}

// Particle data structure stored in userData
interface ParticleData {
  life: number;
  decay: number;
  velocity: THREE.Vector3;
  rotationSpeed: THREE.Vector3;
  active: boolean;
}

export function GhostParticles({
  ghostGroup,
  movementRef,
  count,
}: GhostParticlesProps) {
  const groupRef = useRef<THREE.Group>(null!);
  const lastSpawnTime = useRef(2);

  // Initialize particles strictly with geometry and material
  // We use userData to store simulation state
  const particles = useMemo(() => {
    const geoms = [
      new THREE.SphereGeometry(0.05, 6, 6),
      new THREE.TetrahedronGeometry(0.04, 0),
      new THREE.OctahedronGeometry(0.045, 0),
    ];

    return Array.from({ length: count }).map((_, i) => {
      const geom = geoms[Math.floor(Math.random() * geoms.length)];
      return {
        key: i,
        geometry: geom,
      };
    });
  }, [count]);

  useFrame(({ clock }) => {
    if (!groupRef.current || !ghostGroup.current) return;

    const now = clock.getElapsedTime() * 1000; // ms
    const moveAmt = movementRef.current;

    // SPAWN LOGIC
    const shouldSpawn = GHOST_CONFIG.createParticlesOnlyWhenMoving
      ? moveAmt > 0.005
      : moveAmt > 0.005;

    if (shouldSpawn && now - lastSpawnTime.current > 200) {
      // Find inactive particles to spawn
      // CodePen rate: Math.min(params.particleCreationRate, Math.max(1, speedRate))
      // Simpler rate here:
      const spawnCount = GHOST_CONFIG.particleCreationRate;

      let spawned = 0;
      for (const child of groupRef.current.children) {
        if (spawned >= spawnCount) break;
        const mesh = child as THREE.Mesh;
        if (!mesh.visible) {
          // Activate particle
          mesh.visible = true;
          mesh.position.copy(ghostGroup.current.position);
          mesh.position.z -= 0.8 + Math.random() * 0.6; // Behind ghost

          // Scatter
          const scatter = 3.5;
          mesh.position.x += (Math.random() - 0.5) * scatter;
          mesh.position.y += (Math.random() - 0.5) * scatter - 0.8;

          // Scale
          const s = 0.6 + Math.random() * 0.7;
          mesh.scale.set(s, s, s);

          // Rotation
          mesh.rotation.set(
            Math.random() * 6,
            Math.random() * 6,
            Math.random() * 6
          );

          // Color variation
          const color = new THREE.Color(
            getConfigColorHex(GHOST_CONFIG.particleColor)
          );
          color.offsetHSL(Math.random() * 0.1 - 0.05, 0, 0);
          (mesh.material as THREE.MeshBasicMaterial).color = color;
          (mesh.material as THREE.MeshBasicMaterial).opacity =
            Math.random() * 0.9;

          // Init Data
          mesh.userData = {
            life: 1.0,
            decay: Math.random() * 0.003 + GHOST_CONFIG.particleDecayRate,
            velocity: new THREE.Vector3(
              (Math.random() - 0.5) * 0.015,
              (Math.random() - 0.5) * 0.012 - 0.002, // slight down
              (Math.random() - 0.5) * 0.012 - 0.006
            ),
            rotationSpeed: new THREE.Vector3(
              (Math.random() - 0.5) * 0.015,
              (Math.random() - 0.5) * 0.015,
              (Math.random() - 0.5) * 0.015
            ),
          } as ParticleData;

          spawned++;
        }
      }
      lastSpawnTime.current = now;
    }

    // UPDATE LOGIC
    groupRef.current.children.forEach((child) => {
      const mesh = child as THREE.Mesh;
      if (!mesh.visible) return;

      const data = mesh.userData as ParticleData;
      data.life -= data.decay;
      (mesh.material as THREE.MeshBasicMaterial).opacity = data.life * 0.85;

      mesh.position.add(data.velocity);

      const swirl =
        Math.cos(clock.getElapsedTime() * 1.8 + mesh.position.y) * 0.0008;
      mesh.position.x += swirl;

      mesh.rotation.x += data.rotationSpeed.x;
      mesh.rotation.y += data.rotationSpeed.y;
      mesh.rotation.z += data.rotationSpeed.z;

      if (data.life <= 0) {
        mesh.visible = false;
      }
    });
  });

  return (
    <group ref={groupRef}>
      {particles.map((p) => (
        <mesh key={p.key} geometry={p.geometry} visible={false}>
          <meshBasicMaterial
            color={getConfigColorHex(GHOST_CONFIG.particleColor)}
            transparent
            opacity={0}
            alphaTest={0.1}
          />
        </mesh>
      ))}
    </group>
  );
}
'use client';

import { useEffect, useRef } from 'react';
import * as THREE from 'three';
import { usePerformanceAdaptive } from '@/hooks/usePerformanceAdaptive';

// Importações de pós-processamento do diretório de exemplos do Three.js
// Importações de pós-processamento via three-stdlib
// @ts-ignore
import { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer';
// @ts-ignore
import { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass';
// @ts-ignore
import { UnrealBloomPass } from 'three/examples/jsm/postprocessing/UnrealBloomPass';
// @ts-ignore
import { OutputPass } from 'three/examples/jsm/postprocessing/OutputPass';
// @ts-ignore
import { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass';

export default function GhostScene() {
  const mountRef = useRef<HTMLDivElement>(null);
  const preloaderRef = useRef<HTMLDivElement>(null);
  const progressBarRef = useRef<HTMLDivElement>(null);
  const performanceConfig = usePerformanceAdaptive();

  useEffect(() => {
    const mountElement = mountRef.current;
    if (!mountElement) return;

    // --- CONFIGURAÇÃO INICIAL E VARIÁVEIS ---

    // Gestão do Preloader (Adaptado para usar Refs)
    const preloaderManager = {
      loadingSteps: 0,
      totalSteps: 5,
      isComplete: false,
      updateProgress: (step: number) => {
        const loadingSteps = Math.min(step, 5);
        const percentage = (loadingSteps / 5) * 100;
        if (progressBarRef.current) {
          progressBarRef.current.style.width = `${percentage}%`;
        }
      },
      complete: (canvas: HTMLCanvasElement) => {
        if (preloaderManager.isComplete) return;
        preloaderManager.isComplete = true;
        preloaderManager.updateProgress(5);

        setTimeout(() => {
          if (preloaderRef.current)
            preloaderRef.current.classList.add('fade-out');

          canvas.classList.add('fade-in');

          setTimeout(() => {
            if (preloaderRef.current)
              preloaderRef.current.style.display = 'none';
          }, 1000);
        }, 1500);
      },
    };

    // --- THREE.JS SETUP ---

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.z = 20;

    preloaderManager.updateProgress(1);

    const renderer = new THREE.WebGLRenderer({
      antialias: true,
      powerPreference: 'high-performance',
      alpha: true,
      premultipliedAlpha: false,
      stencil: false,
      depth: true,
      preserveDrawingBuffer: false,
    });

    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 0.9;
    renderer.setClearColor(0x000000, 0);

    // Estilos do Canvas
    renderer.domElement.style.position = 'absolute';
    renderer.domElement.style.top = '0';
    renderer.domElement.style.left = '0';
    renderer.domElement.style.zIndex = '0';
    renderer.domElement.style.pointerEvents = 'none';
    renderer.domElement.style.background = 'transparent';

    // Anexar ao ref em vez do body
    mountElement.appendChild(renderer.domElement);

    preloaderManager.updateProgress(2);

    // --- PÓS-PROCESSAMENTO ---

    const originalBloomSettings = {
      strength: 0.3,
      radius: 1.25,
      threshold: 0.0,
    };
    const composer = new EffectComposer(renderer);
    const renderPass = new RenderPass(scene, camera);
    composer.addPass(renderPass);

    const bloomPass = new UnrealBloomPass(
      new THREE.Vector2(window.innerWidth, window.innerHeight),
      originalBloomSettings.strength,
      originalBloomSettings.radius,
      originalBloomSettings.threshold
    );
    composer.addPass(bloomPass);

    preloaderManager.updateProgress(3);

    // Shader de Decaimento Analógico (Analog Decay)
    const analogDecayShader = {
      uniforms: {
        tDiffuse: { value: null },
        uTime: { value: 0.0 },
        uResolution: {
          value: new THREE.Vector2(window.innerWidth, window.innerHeight),
        },
        uAnalogGrain: { value: 0.4 },
        uAnalogBleeding: { value: 1.0 },
        uAnalogVSync: { value: 1.0 },
        uAnalogScanlines: { value: 1.0 },
        uAnalogVignette: { value: 1.0 },
        uAnalogJitter: { value: 0.4 },
        uAnalogIntensity: { value: 0.6 },
        uLimboMode: { value: 0.0 },
      },
      vertexShader: `
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,
      fragmentShader: `
        uniform sampler2D tDiffuse;
        uniform float uTime;
        uniform vec2 uResolution;
        uniform float uAnalogGrain;
        uniform float uAnalogBleeding;
        uniform float uAnalogVSync;
        uniform float uAnalogScanlines;
        uniform float uAnalogVignette;
        uniform float uAnalogJitter;
        uniform float uAnalogIntensity;
        uniform float uLimboMode;
        varying vec2 vUv;
        
        float random(vec2 st) { return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123); }
        float random(float x) { return fract(sin(x) * 43758.5453123); }
        float gaussian(float z, float u, float o) { return (1.0 / (o * sqrt(2.0 * 3.1415))) * exp(-(((z - u) * (z - u)) / (2.0 * (o * o)))); }
        
        vec3 grain(vec2 uv, float time, float intensity) {
          float seed = dot(uv, vec2(12.9898, 78.233));
          float noise = fract(sin(seed) * 43758.5453 + time * 2.0);
          noise = gaussian(noise, 0.0, 0.5 * 0.5);
          return vec3(noise) * intensity;
        }
        
        void main() {
          vec2 uv = vUv;
          float time = uTime * 1.8;
          vec2 jitteredUV = uv;
          if (uAnalogJitter > 0.01) {
            float jitterAmount = (random(vec2(floor(time * 60.0))) - 0.5) * 0.003 * uAnalogJitter * uAnalogIntensity;
            jitteredUV.x += jitterAmount;
            jitteredUV.y += (random(vec2(floor(time * 30.0) + 1.0)) - 0.5) * 0.001 * uAnalogJitter * uAnalogIntensity;
          }
          if (uAnalogVSync > 0.01) {
            float vsyncRoll = sin(time * 2.0 + uv.y * 100.0) * 0.02 * uAnalogVSync * uAnalogIntensity;
            float vsyncChance = step(0.95, random(vec2(floor(time * 4.0))));
            jitteredUV.y += vsyncRoll * vsyncChance;
          }
          vec4 color = texture2D(tDiffuse, jitteredUV);
          if (uAnalogBleeding > 0.01) {
            float bleedAmount = 0.012 * uAnalogBleeding * uAnalogIntensity;
            float offsetPhase = time * 1.5 + uv.y * 20.0;
            vec2 redOffset = vec2(sin(offsetPhase) * bleedAmount, 0.0);
            vec2 blueOffset = vec2(-sin(offsetPhase * 1.1) * bleedAmount * 0.8, 0.0);
            float r = texture2D(tDiffuse, jitteredUV + redOffset).r;
            float g = texture2D(tDiffuse, jitteredUV).g;
            float b = texture2D(tDiffuse, jitteredUV + blueOffset).b;
            color = vec4(r, g, b, color.a);
          }
          if (uAnalogGrain > 0.01) {
            vec3 grainEffect = grain(uv, time, 0.075 * uAnalogGrain * uAnalogIntensity);
            grainEffect *= (1.0 - color.rgb);
            color.rgb += grainEffect;
          }
          if (uAnalogScanlines > 0.01) {
            float scanlineFreq = 600.0 + uAnalogScanlines * 400.0;
            float scanlinePattern = sin(uv.y * scanlineFreq) * 0.5 + 0.5;
            float scanlineIntensity = 0.1 * uAnalogScanlines * uAnalogIntensity;
            color.rgb *= (1.0 - scanlinePattern * scanlineIntensity);
            float horizontalLines = sin(uv.y * scanlineFreq * 0.1) * 0.02 * uAnalogScanlines * uAnalogIntensity;
            color.rgb *= (1.0 - horizontalLines);
          }
          if (uAnalogVignette > 0.01) {
            vec2 vignetteUV = (uv - 0.5) * 2.0;
            float vignette = 1.0 - dot(vignetteUV, vignetteUV) * 0.3 * uAnalogVignette * uAnalogIntensity;
            color.rgb *= vignette;
          }
          if (uLimboMode > 0.5) {
            float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));
            color.rgb = vec3(gray);
          }
          gl_FragColor = color;
        }
      `,
    };

    const analogDecayPass = new ShaderPass(analogDecayShader);
    composer.addPass(analogDecayPass);
    const outputPass = new OutputPass();
    composer.addPass(outputPass);

    // --- PARÂMETROS E OBJETOS ---

    const params = {
      bodyColor: 0x0f2027,
      glowColor: 'blue',
      eyeGlowColor: 'violet',
      ghostOpacity: 0.88,
      ghostScale: 2.4,
      emissiveIntensity: 5.8,
      pulseSpeed: 1.6,
      pulseIntensity: 0.6,
      eyeGlowIntensity: 4.5,
      eyeGlowDecay: 0.95,
      eyeGlowResponse: 0.31,
      rimLightIntensity: 1.8,
      followSpeed: 0.05,
      wobbleAmount: 0.35,
      floatSpeed: 1.6,
      movementThreshold: 0.07,
      particleCount: performanceConfig.particleCount * 5, // Scaling for the specific scene density
      particleDecayRate: 0.005,
      particleColor: 'violet',
      createParticlesOnlyWhenMoving: true,
      particleCreationRate: performanceConfig.quality === 'low' ? 2 : 5,
      revealRadius: 37,
      fadeStrength: 1.7,
      baseOpacity: 0.9,
      revealOpacity: 0.05,
      fireflyGlowIntensity: 4.3,
      fireflySpeed: 0.09,
      analogIntensity: 0.9,
      analogGrain: 0.4,
      analogBleeding: 0.9,
      analogVSync: 1.7,
      analogScanlines: 1.0,
      analogVignette: 2.4,
      analogJitter: 0.5,
      limboMode: false,
    };

    const fluorescentColors: { [key: string]: number } = {
      cyan: 0x00ffff,
      lime: 0x00ff00,
      magenta: 0xff00ff,
      yellow: 0xffff00,
      orange: 0xff4500,
      pink: 0xff1493,
      purple: 0x9400d3,
      blue: 0x0080ff,
      green: 0x00ff80,
      red: 0xff0040,
      teal: 0x00ffaa,
      violet: 0x8a2be2,
    };

    // Atmosfera (Fundo)
    const atmosphereGeometry = new THREE.PlaneGeometry(300, 300);
    const atmosphereMaterial = new THREE.ShaderMaterial({
      uniforms: {
        ghostPosition: { value: new THREE.Vector3(0, 0, 0) },
        revealRadius: { value: params.revealRadius },
        fadeStrength: { value: params.fadeStrength },
        baseOpacity: { value: params.baseOpacity },
        revealOpacity: { value: params.revealOpacity },
        time: { value: 0 },
      },
      vertexShader: `
        varying vec2 vUv;
        varying vec3 vWorldPosition;
        void main() {
          vUv = uv;
          vec4 worldPos = modelMatrix * vec4(position, 1.0);
          vWorldPosition = worldPos.xyz;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,
      fragmentShader: `
        uniform vec3 ghostPosition;
        uniform float revealRadius;
        uniform float fadeStrength;
        uniform float baseOpacity;
        uniform float revealOpacity;
        uniform float time;
        varying vec2 vUv;
        varying vec3 vWorldPosition;
        void main() {
          float dist = distance(vWorldPosition.xy, ghostPosition.xy);
          float dynamicRadius = revealRadius + sin(time * 2.0) * 5.0;
          float reveal = smoothstep(dynamicRadius * 0.2, dynamicRadius, dist);
          reveal = pow(reveal, fadeStrength);
          float opacity = mix(revealOpacity, baseOpacity, reveal);
          gl_FragColor = vec4(0.001, 0.001, 0.002, opacity);
        }
      `,
      transparent: true,
      depthWrite: false,
    });

    const atmosphere = new THREE.Mesh(atmosphereGeometry, atmosphereMaterial);
    atmosphere.position.z = -50;
    atmosphere.renderOrder = -100;
    scene.add(atmosphere);

    const ambientLight = new THREE.AmbientLight(0x0a0a2e, 0.08);
    scene.add(ambientLight);

    // Grupo do Fantasma
    const ghostGroup = new THREE.Group();
    scene.add(ghostGroup);

    const ghostGeometry = new THREE.SphereGeometry(2, 40, 40);
    const positionAttribute = ghostGeometry.getAttribute('position');
    const positions = positionAttribute.array as Float32Array;
    for (let i = 0; i < positions.length; i += 3) {
      if (positions[i + 1] < -0.2) {
        const x = positions[i];
        const z = positions[i + 2];
        const noise1 = Math.sin(x * 5) * 0.35;
        const noise2 = Math.cos(z * 4) * 0.25;
        const noise3 = Math.sin((x + z) * 3) * 0.15;
        positions[i + 1] = -2.0 + noise1 + noise2 + noise3;
      }
    }
    ghostGeometry.computeVertexNormals();

    const ghostMaterial = new THREE.MeshStandardMaterial({
      color: params.bodyColor,
      transparent: true,
      opacity: params.ghostOpacity,
      emissive: fluorescentColors[params.glowColor],
      emissiveIntensity: params.emissiveIntensity,
      roughness: 0.02,
      metalness: 0.0,
      side: THREE.DoubleSide,
      alphaTest: 0.1,
    });
    const ghostBody = new THREE.Mesh(ghostGeometry, ghostMaterial);
    ghostGroup.add(ghostBody);

    const rimLight1 = new THREE.DirectionalLight(
      0x4a90e2,
      params.rimLightIntensity
    );
    rimLight1.position.set(-8, 6, -4);
    scene.add(rimLight1);
    const rimLight2 = new THREE.DirectionalLight(
      0x50e3c2,
      params.rimLightIntensity * 0.7
    );
    rimLight2.position.set(8, -4, -6);
    scene.add(rimLight2);

    preloaderManager.updateProgress(4);

    // Olhos
    function createEyes() {
      const eyeGroup = new THREE.Group();
      ghostGroup.add(eyeGroup);
      const socketGeometry = new THREE.SphereGeometry(0.45, 16, 16);
      const socketMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });

      const leftSocket = new THREE.Mesh(socketGeometry, socketMaterial);
      leftSocket.position.set(-0.7, 0.6, 1.9);
      leftSocket.scale.set(1.1, 1.0, 0.6);
      eyeGroup.add(leftSocket);

      const rightSocket = new THREE.Mesh(socketGeometry, socketMaterial);
      rightSocket.position.set(0.7, 0.6, 1.9);
      rightSocket.scale.set(1.1, 1.0, 0.6);
      eyeGroup.add(rightSocket);

      const eyeGeometry = new THREE.SphereGeometry(0.3, 12, 12);
      const leftEyeMaterial = new THREE.MeshBasicMaterial({
        color: fluorescentColors[params.eyeGlowColor],
        transparent: true,
        opacity: 0,
      });
      const leftEye = new THREE.Mesh(eyeGeometry, leftEyeMaterial);
      leftEye.position.set(-0.7, 0.6, 2.0);
      eyeGroup.add(leftEye);

      const rightEyeMaterial = new THREE.MeshBasicMaterial({
        color: fluorescentColors[params.eyeGlowColor],
        transparent: true,
        opacity: 0,
      });
      const rightEye = new THREE.Mesh(eyeGeometry, rightEyeMaterial);
      rightEye.position.set(0.7, 0.6, 2.0);
      eyeGroup.add(rightEye);

      const outerGlowGeometry = new THREE.SphereGeometry(0.525, 12, 12);
      const leftOuterGlowMaterial = new THREE.MeshBasicMaterial({
        color: fluorescentColors[params.eyeGlowColor],
        transparent: true,
        opacity: 0,
        side: THREE.BackSide,
      });
      const leftOuterGlow = new THREE.Mesh(
        outerGlowGeometry,
        leftOuterGlowMaterial
      );
      leftOuterGlow.position.set(-0.7, 0.6, 1.95);
      eyeGroup.add(leftOuterGlow);

      const rightOuterGlowMaterial = new THREE.MeshBasicMaterial({
        color: fluorescentColors[params.eyeGlowColor],
        transparent: true,
        opacity: 0,
        side: THREE.BackSide,
      });
      const rightOuterGlow = new THREE.Mesh(
        outerGlowGeometry,
        rightOuterGlowMaterial
      );
      rightOuterGlow.position.set(0.7, 0.6, 1.95);
      eyeGroup.add(rightOuterGlow);

      return {
        leftEyeMaterial,
        rightEyeMaterial,
        leftOuterGlowMaterial,
        rightOuterGlowMaterial,
      };
    }
    const eyes = createEyes();

    // Pirilampos (Fireflies)
    const fireflies: THREE.Mesh[] = [];
    const fireflyGroup = new THREE.Group();
    scene.add(fireflyGroup);

    const fireflyCount = performanceConfig.fireflyCount;
    for (let i = 0; i < fireflyCount; i++) {
      const fireflyGeom = new THREE.SphereGeometry(0.02, 2, 2);
      const fireflyMat = new THREE.MeshBasicMaterial({
        color: 0xffff44,
        transparent: true,
        opacity: 0.9,
      });
      const firefly = new THREE.Mesh(fireflyGeom, fireflyMat);
      firefly.position.set(
        (Math.random() - 0.5) * 40,
        (Math.random() - 0.5) * 30,
        (Math.random() - 0.5) * 20
      );

      const glowGeom = new THREE.SphereGeometry(0.08, 8, 8);
      const glowMat = new THREE.MeshBasicMaterial({
        color: 0xffff88,
        transparent: true,
        opacity: 0.4,
        side: THREE.BackSide,
      });
      const glow = new THREE.Mesh(glowGeom, glowMat);
      firefly.add(glow);
      const light = new THREE.PointLight(0xffff44, 0.8, 3, 2);
      firefly.add(light);

      firefly.userData = {
        velocity: new THREE.Vector3(
          (Math.random() - 0.5) * params.fireflySpeed,
          (Math.random() - 0.5) * params.fireflySpeed,
          (Math.random() - 0.5) * params.fireflySpeed
        ),
        phase: Math.random() * Math.PI * 2,
        pulseSpeed: 2 + Math.random() * 3,
        glowMat,
        fireflyMat,
        light,
      };
      fireflyGroup.add(firefly);
      fireflies.push(firefly);
    }

    // Partículas
    const particles: THREE.Mesh[] = [];
    const particleGroup = new THREE.Group();
    scene.add(particleGroup);
    const particlePool: THREE.Mesh[] = [];
    const particleGeometries = [
      new THREE.SphereGeometry(0.05, 6, 6),
      new THREE.TetrahedronGeometry(0.04, 0),
      new THREE.OctahedronGeometry(0.045, 0),
    ];
    const particleBaseMaterial = new THREE.MeshBasicMaterial({
      color: fluorescentColors[params.particleColor],
      transparent: true,
      opacity: 0,
      alphaTest: 0.1,
    });

    function initParticlePool(count: number) {
      for (let i = 0; i < count; i++) {
        const geom =
          particleGeometries[
            Math.floor(Math.random() * particleGeometries.length)
          ];
        const p = new THREE.Mesh(geom, particleBaseMaterial.clone());
        p.visible = false;
        particleGroup.add(p);
        particlePool.push(p);
      }
    }
    initParticlePool(100);

    function createParticle() {
      let p;
      if (particlePool.length > 0) {
        p = particlePool.pop();
        if (p) p.visible = true;
      } else if (particles.length < params.particleCount) {
        const geom =
          particleGeometries[
            Math.floor(Math.random() * particleGeometries.length)
          ];
        p = new THREE.Mesh(geom, particleBaseMaterial.clone());
        particleGroup.add(p);
      } else return null;

      if (!p) return null;

      const pColor = new THREE.Color(fluorescentColors[params.particleColor]);
      pColor.offsetHSL(Math.random() * 0.1 - 0.05, 0, 0);
      const pMaterial = p.material as THREE.MeshBasicMaterial;
      pMaterial.color = pColor;
      p.position.copy(ghostGroup.position);
      p.position.z -= 0.8 + Math.random() * 0.6;
      p.position.x += (Math.random() - 0.5) * 3.5;
      p.position.y += (Math.random() - 0.5) * 3.5 - 0.8;

      const s = 0.6 + Math.random() * 0.7;
      p.scale.set(s, s, s);
      p.rotation.set(Math.random() * 6, Math.random() * 6, Math.random() * 6);

      p.userData.life = 1.0;
      p.userData.decay = Math.random() * 0.003 + params.particleDecayRate;
      p.userData.rotationSpeed = {
        x: (Math.random() - 0.5) * 0.015,
        y: (Math.random() - 0.5) * 0.015,
        z: (Math.random() - 0.5) * 0.015,
      };
      p.userData.velocity = {
        x: (Math.random() - 0.5) * 0.012,
        y: (Math.random() - 0.5) * 0.012 - 0.002,
        z: (Math.random() - 0.5) * 0.012 - 0.006,
      };
      pMaterial.opacity = Math.random() * 0.9;
      particles.push(p);
    }

    // Tweakpane removed for production
    // const pane = new Pane({ title: 'Spectral Ghost', expanded: false });
    // ... (rest of the tweakpane code commented out or removed)

    // --- DETECÇÃO DE DISPOSITIVO TOUCH/MOBILE ---
    const isTouchDevice =
      'ontouchstart' in window || navigator.maxTouchPoints > 0;
    const isMobileWidth = window.innerWidth <= 768;
    const isMobile = isTouchDevice || isMobileWidth;

    // Event Listeners
    let scrollY = 0;
    const onScroll = () => {
      scrollY = window.scrollY;
    };
    window.addEventListener('scroll', onScroll, { passive: true });

    const mouse = new THREE.Vector2();
    let hasReceivedMouseInput = false;
    let touchTimeout: NodeJS.Timeout;

    const updateMousePos = (x: number, y: number) => {
      hasReceivedMouseInput = true;
      mouse.x = (x / window.innerWidth) * 2 - 1;
      mouse.y = -(y / window.innerHeight) * 2 + 1;

      clearTimeout(touchTimeout);
      touchTimeout = setTimeout(() => {
        hasReceivedMouseInput = false;
      }, 3000); // Retorna ao modo automático após 3s sem toque/mouse
    };

    const onMouseMove = (e: MouseEvent) => {
      updateMousePos(e.clientX, e.clientY);
    };

    const onTouchMove = (e: TouchEvent) => {
      if (e.touches.length > 0) {
        updateMousePos(e.touches[0].clientX, e.touches[0].clientY);
      }
    };

    window.addEventListener('mousemove', onMouseMove);
    window.addEventListener('touchstart', onTouchMove, { passive: true });
    window.addEventListener('touchmove', onTouchMove, { passive: true });

    const onResize = () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      composer.setSize(window.innerWidth, window.innerHeight);
      bloomPass.setSize(window.innerWidth, window.innerHeight);
      analogDecayPass.uniforms.uResolution.value.set(
        window.innerWidth,
        window.innerHeight
      );
    };
    window.addEventListener('resize', onResize);

    // Loop de Animação
    let time = 0;
    let lastFrameTime = 0;
    let currentMovement = 0;
    let isInitialized = false;
    let animationId: number;
    let lastParticleTime = 0;

    const forceInitialRender = () => {
      for (let i = 0; i < 3; i++) composer.render();
      for (let i = 0; i < 10; i++) createParticle();
      composer.render();
      isInitialized = true;
      preloaderManager.complete(renderer.domElement);
    };

    preloaderManager.updateProgress(5);
    setTimeout(forceInitialRender, 100);

    const animate = (timestamp: number) => {
      animationId = requestAnimationFrame(animate);
      if (!isInitialized) return;

      const deltaTime = timestamp - lastFrameTime;
      lastFrameTime = timestamp;
      if (deltaTime > 100) return;

      const timeIncrement = (deltaTime / 16.67) * 0.01;
      time += timeIncrement;

      // Atualizações de Uniforms
      atmosphereMaterial.uniforms.time.value = time;
      analogDecayPass.uniforms.uTime.value = time;
      analogDecayPass.uniforms.uLimboMode.value = params.limboMode ? 1.0 : 0.0;

      // Movimento do Fantasma
      // Mobile: Movimento automático usando curva de Lissajous (orgânico e fluido)
      // Desktop: Segue o mouse
      let targetX: number;
      let targetY: number;

      // Movimento base automático (Sempre ativo para dar vida)
      const autoSpeed = 0.85;
      const amplitudeX = 9;
      const amplitudeY = 6;

      const autoX =
        Math.sin(time * autoSpeed) * amplitudeX +
        Math.cos(time * autoSpeed * 0.5) * 2;
      const autoY =
        Math.sin(time * autoSpeed * 0.7 + Math.PI / 2) * amplitudeY +
        Math.sin(time * autoSpeed * 1.3) * 1.5;

      if (!hasReceivedMouseInput) {
        targetX = autoX;
        // Offset Y baseado no scroll para mobile sempre presente
        const scrollOffset = (scrollY / window.innerHeight) * -15;
        targetY = autoY + scrollOffset;
      } else {
        // Quando há interação, segue o input mas mantém um pouco do balanço automático
        targetX = mouse.x * 12 + autoX * 0.1;
        targetY =
          mouse.y * 8 + autoY * 0.1 + (scrollY / window.innerHeight) * -15;
      }

      const prevPos = ghostGroup.position.clone();
      ghostGroup.position.x +=
        (targetX - ghostGroup.position.x) * params.followSpeed;
      ghostGroup.position.y +=
        (targetY - ghostGroup.position.y) * params.followSpeed;
      atmosphereMaterial.uniforms.ghostPosition.value.copy(ghostGroup.position);

      const moveAmt = prevPos.distanceTo(ghostGroup.position);
      currentMovement =
        currentMovement * params.eyeGlowDecay +
        moveAmt * (1 - params.eyeGlowDecay);

      // Flutuação
      ghostGroup.position.y += Math.sin(time * params.floatSpeed * 1.5) * 0.03;

      // Pulso
      const pulse1 = Math.sin(time * params.pulseSpeed) * params.pulseIntensity;
      ghostMaterial.emissiveIntensity = params.emissiveIntensity + pulse1;

      // Atualizar Olhos
      const isMoving = currentMovement > params.movementThreshold;
      const targetGlow = isMoving ? 1.0 : 0.0;
      const glowChangeSpeed = isMoving
        ? params.eyeGlowResponse * 2
        : params.eyeGlowResponse;
      const newOpacity =
        eyes.leftEyeMaterial.opacity +
        (targetGlow - eyes.leftEyeMaterial.opacity) * glowChangeSpeed;

      eyes.leftEyeMaterial.opacity = newOpacity;
      eyes.rightEyeMaterial.opacity = newOpacity;
      eyes.leftOuterGlowMaterial.opacity = newOpacity * 0.3;
      eyes.rightOuterGlowMaterial.opacity = newOpacity * 0.3;

      // Atualizar Partículas
      // Mobile: Sempre criar partículas (movimento automático está sempre ativo)
      const shouldCreate = isMobile
        ? currentMovement > 0.003 // Threshold menor para mobile (movimento automático é mais suave)
        : params.createParticlesOnlyWhenMoving
          ? currentMovement > 0.005 && hasReceivedMouseInput
          : currentMovement > 0.005;
      if (shouldCreate && timestamp - lastParticleTime > 100) {
        const count = Math.min(
          params.particleCreationRate,
          Math.max(1, Math.floor(moveAmt * 100))
        );
        Array.from({ length: count }).forEach(() => createParticle());
        lastParticleTime = timestamp;
      }

      // Ciclo de vida das partículas
      particles.forEach((p) => {
        if (!p.visible) return;
        p.userData.life -= p.userData.decay;
        const particleMaterial = p.material as THREE.MeshBasicMaterial;
        particleMaterial.opacity = p.userData.life * 0.85;
        if (p.userData.velocity) {
          p.position.add(p.userData.velocity as THREE.Vector3);
          p.position.x += Math.cos(time * 1.8 + p.position.y) * 0.0008;
        }
        if (p.userData.rotationSpeed) {
          p.rotation.x += p.userData.rotationSpeed.x;
          p.rotation.y += p.userData.rotationSpeed.y;
          p.rotation.z += p.userData.rotationSpeed.z;
        }
        if (p.userData.life <= 0) {
          p.visible = false;
          particleMaterial.opacity = 0;
          particlePool.push(p);
        }
      });

      // Limpeza de array (simplificada)
      for (let i = particles.length - 1; i >= 0; i--) {
        if (!particles[i].visible) particles.splice(i, 1);
      }

      if (performanceConfig.enablePostProcessing) {
        composer.render();
      } else {
        renderer.render(scene, camera);
      }
    };

    animate(0);

    // --- CLEANUP ---
    return () => {
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('mousemove', onMouseMove);
      window.removeEventListener('touchstart', onTouchMove);
      window.removeEventListener('touchmove', onTouchMove);
      window.removeEventListener('resize', onResize);
      cancelAnimationFrame(animationId);
      // pane.dispose(); // Removed
      // --- CLEANUP ---
      // Dispose de geometrias e materiais para evitar memory leaks
      atmosphereGeometry.dispose();
      atmosphereMaterial.dispose();

      ghostGeometry.dispose();
      ghostMaterial.dispose();

      eyes.leftEyeMaterial.dispose();
      eyes.rightEyeMaterial.dispose();
      eyes.leftOuterGlowMaterial.dispose();
      eyes.rightOuterGlowMaterial.dispose();

      fireflies.forEach((f) => {
        f.geometry.dispose();
        (f.material as THREE.Material).dispose();
        if (f.userData.glowMat) f.userData.glowMat.dispose();
        if (f.userData.fireflyMat) f.userData.fireflyMat.dispose();
      });

      // Cleanup de particulas (pool e ativas)
      particleGeometries.forEach((g) => g.dispose());
      particleBaseMaterial.dispose();
      // As particulas clonam o material, entao precisamos limpar todos
      particlePool.forEach((p) => {
        p.geometry.dispose();
        (p.material as THREE.Material).dispose();
      });
      particles.forEach((p) => {
        p.geometry.dispose();
        (p.material as THREE.Material).dispose();
      });

      // Cleanup do Composer e Passes
      renderer.dispose();

      // Alguns passes criam rendertargets internos que precisam ser limpos se expostos
      if (bloomPass.dispose) bloomPass.dispose();
      if (renderPass.dispose) renderPass.dispose();
      // analogDecayPass e outputPass usam shaders simples, sem targets extras geralmente

      if (mountElement && renderer.domElement) {
        mountElement.removeChild(renderer.domElement);
      }
    };
  }, []);

  return (
    <>
      <div ref={mountRef} className="w-full h-full absolute top-0 left-0" />

      {/* HTML UI Overlay (Preloader & Text) */}
      <div ref={preloaderRef} className="preloader" id="preloader">
        <div className="preloader-content">
          <div className="ghost-loader">
            <svg
              className="ghost-svg"
              height="80"
              viewBox="0 0 512 512"
              width="80"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                className="ghost-body"
                d="m508.374 432.802s-46.6-39.038-79.495-275.781c-8.833-87.68-82.856-156.139-172.879-156.139-90.015 0-164.046 68.458-172.879 156.138-32.895 236.743-79.495 275.782-79.495 275.782-15.107 25.181 20.733 28.178 38.699 27.94 35.254-.478 35.254 40.294 70.516 40.294 35.254 0 35.254-35.261 70.508-35.261s37.396 45.343 72.65 45.343 37.389-45.343 72.651-45.343c35.254 0 35.254 35.261 70.508 35.261s35.27-40.772 70.524-40.294c17.959.238 53.798-2.76 38.692-27.94z"
                fill="white"
              />
              <circle
                className="ghost-eye left-eye"
                cx="208"
                cy="225"
                r="22"
                fill="black"
              />
              <circle
                className="ghost-eye right-eye"
                cx="297"
                cy="225"
                r="22"
                fill="black"
              />
            </svg>
          </div>
          <div className="loading-text">Summoning spirits</div>
          <div className="loading-progress">
            <div ref={progressBarRef} className="progress-bar"></div>
          </div>
        </div>
      </div>
    </>
  );
}
// src/components/canvas/shaders/AnalogShader.ts
import * as THREE from 'three';

export const AnalogDecayShader = {
  uniforms: {
    tDiffuse: { value: null },
    uTime: { value: 0.0 },
    uResolution: { value: new THREE.Vector2(1, 1) },
    uAnalogGrain: { value: 0.4 },
    uAnalogBleeding: { value: 1.0 },
    uAnalogVSync: { value: 1.0 },
    uAnalogScanlines: { value: 1.0 },
    uAnalogVignette: { value: 1.0 },
    uAnalogJitter: { value: 0.4 },
    uAnalogIntensity: { value: 0.6 },
    uLimboMode: { value: 0.0 },
  },
  vertexShader: `
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,
  fragmentShader: `
    uniform sampler2D tDiffuse;
    uniform float uTime;
    uniform vec2 uResolution;
    uniform float uAnalogGrain;
    uniform float uAnalogBleeding;
    uniform float uAnalogVSync;
    uniform float uAnalogScanlines;
    uniform float uAnalogVignette;
    uniform float uAnalogJitter;
    uniform float uAnalogIntensity;
    uniform float uLimboMode;
    varying vec2 vUv;

    float random(vec2 st) {
      return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);
    }

    float random(float x) {
      return fract(sin(x) * 43758.5453123);
    }

    float gaussian(float z, float u, float o) {
      return (1.0 / (o * sqrt(2.0 * 3.1415))) * exp(-(((z - u) * (z - u)) / (2.0 * (o * o))));
    }

    vec3 grain(vec2 uv, float time, float intensity) {
      float seed = dot(uv, vec2(12.9898, 78.233));
      float noise = fract(sin(seed) * 43758.5453 + time * 2.0);
      noise = gaussian(noise, 0.0, 0.5 * 0.5);
      return vec3(noise) * intensity;
    }

    void main() {
      vec2 uv = vUv;
      float time = uTime * 1.8;

      vec2 jitteredUV = uv;
      if (uAnalogJitter > 0.01) {
        float jitterAmount = (random(vec2(floor(time * 60.0))) - 0.5) * 0.003 * uAnalogJitter * uAnalogIntensity;
        jitteredUV.x += jitterAmount;
        jitteredUV.y += (random(vec2(floor(time * 30.0) + 1.0)) - 0.5) * 0.001 * uAnalogJitter * uAnalogIntensity;
      }

      if (uAnalogVSync > 0.01) {
        float vsyncRoll = sin(time * 2.0 + uv.y * 100.0) * 0.02 * uAnalogVSync * uAnalogIntensity;
        float vsyncChance = step(0.95, random(vec2(floor(time * 4.0))));
        jitteredUV.y += vsyncRoll * vsyncChance;
      }

      vec4 color = texture2D(tDiffuse, jitteredUV);

      if (uAnalogBleeding > 0.01) {
        float bleedAmount = 0.012 * uAnalogBleeding * uAnalogIntensity;
        float offsetPhase = time * 1.5 + uv.y * 20.0;
        vec2 redOffset = vec2(sin(offsetPhase) * bleedAmount, 0.0);
        vec2 blueOffset = vec2(-sin(offsetPhase * 1.1) * bleedAmount * 0.8, 0.0);
        float r = texture2D(tDiffuse, jitteredUV + redOffset).r;
        float g = texture2D(tDiffuse, jitteredUV).g;
        float b = texture2D(tDiffuse, jitteredUV + blueOffset).b;
        color = vec4(r, g, b, color.a);
      }

      if (uAnalogGrain > 0.01) {
        vec3 grainEffect = grain(uv, time, 0.075 * uAnalogGrain * uAnalogIntensity);
        grainEffect *= (1.0 - color.rgb);
        color.rgb += grainEffect;
      }

      if (uAnalogScanlines > 0.01) {
        float scanlineFreq = 600.0 + uAnalogScanlines * 400.0;
        float scanlinePattern = sin(uv.y * scanlineFreq) * 0.5 + 0.5;
        float scanlineIntensity = 0.1 * uAnalogScanlines * uAnalogIntensity;
        color.rgb *= (1.0 - scanlinePattern * scanlineIntensity);
        float horizontalLines = sin(uv.y * scanlineFreq * 0.1) * 0.02 * uAnalogScanlines * uAnalogIntensity;
        color.rgb *= (1.0 - horizontalLines);
      }

      if (uAnalogVignette > 0.01) {
        vec2 vignetteUV = (uv - 0.5) * 2.0;
        float vignette = 1.0 - dot(vignetteUV, vignetteUV) * 0.3 * uAnalogVignette * uAnalogIntensity;
        color.rgb *= vignette;
      }

      if (uLimboMode > 0.5) {
        float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));
        color.rgb = vec3(gray);
      }

      gl_FragColor = color;
    }
  `,
};
import * as THREE from 'three';

export const createGlassBackgroundScene = () => {
  const scene = new THREE.Scene();
  const gradient = new THREE.ShaderMaterial({
    uniforms: {
      uTime: { value: 0 },
      uParallax: { value: 0 },
    },
    transparent: true,
    fragmentShader: /* glsl */ `
      varying vec2 vUv;
      uniform float uTime;
      uniform float uParallax;

      float hash(vec2 p) {
        return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123);
      }

      float noise(vec2 p) {
        vec2 i = floor(p);
        vec2 f = fract(p);
        float a = hash(i);
        float b = hash(i + vec2(1.0, 0.0));
        float c = hash(i + vec2(0.0, 1.0));
        float d = hash(i + vec2(1.0, 1.0));
        vec2 u = f * f * (3.0 - 2.0 * f);
        return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
      }

      void main() {
        vec2 uv = vUv;
        uv.y += uParallax * 0.2;
        float n = noise(uv * 5.0 + uTime * 0.15);
        vec3 c1 = vec3(0.05, 0.08, 0.14);
        vec3 c2 = vec3(0.24, 0.38, 0.68);
        vec3 c3 = vec3(0.1, 0.18, 0.32);
        float grad = smoothstep(0.0, 1.0, uv.y + n * 0.12);
        vec3 color = mix(c1, c2, grad);
        color = mix(color, c3, 0.25 + n * 0.1);
        gl_FragColor = vec4(color, 1.0);
      }
    `,
    vertexShader: /* glsl */ `
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,
  });

  const plane = new THREE.Mesh(new THREE.PlaneGeometry(10, 6, 1, 1), gradient);
  plane.position.set(0, 0, -2);
  scene.add(plane);

  return { scene, gradientMaterial: gradient, gradientPlane: plane };
};
'use client';

import * as THREE from 'three';
import { Canvas, useFrame } from '@react-three/fiber';
import {
  Image,
  Preload,
  Scroll,
  ScrollControls,
  Text,
  useScroll,
} from '@react-three/drei';
import { useMemo, useRef, useState, useEffect } from 'react';
import type { NavItem as HeaderNavItem } from '@/components/layout/header/types';
import { NavItems } from './NavItems';
import { GlassBar } from './GlassBar';

const DEFAULT_NAV_ITEMS: HeaderNavItem[] = [
  { label: 'HOME', href: '/#hero' },
  { label: 'Sobre', href: '/sobre' },
  { label: 'Portfólio', href: '/portfolio' },
  { label: 'Contato', href: '#contact' },
];

const DEMO_IMAGES = [
  {
    url: '/assets/demo/cs1.webp',
    position: [-2, 0, 0] as const,
    scale: [3, 1.2] as const,
  },
  {
    url: '/assets/demo/cs2.webp',
    position: [2, 0, 3] as const,
    scale: [3, 3] as const,
  },
  {
    url: '/assets/demo/cs3.webp',
    position: [0, -1, -2] as const,
    scale: [2, 2] as const,
  },
] as const;

interface HeaderFluidGlassProps {
  navItems?: HeaderNavItem[];
  accentColor?: string;
}

interface ZoomMaterial extends THREE.Material {
  zoom: number;
}
interface ZoomMesh extends THREE.Mesh<THREE.BufferGeometry, ZoomMaterial> {}
type ZoomGroup = THREE.Group & { children: ZoomMesh[] };

function Images() {
  const group = useRef<ZoomGroup>(null!);
  const data = useScroll();

  useFrame(() => {
    if (!group.current) return;
    group.current.children.forEach((obj: ZoomMesh, index: number) => {
      if (obj.material) {
        obj.material.zoom = 1 + data.range(0, 1 / 3) / 3;
        if (index > 1) {
          obj.material.zoom = 1 + data.range(1.15 / 3, 1 / 3) / 2;
        }
      }
    });
  });

  return (
    <group ref={group}>
      {DEMO_IMAGES.map((image, index) => (
        <Image
          key={`${image.url}-${index}`}
          position={[image.position[0], image.position[1], image.position[2]]}
          scale={[image.scale[0], image.scale[1]]}
          url={image.url}
        />
      ))}
    </group>
  );
}

function Typography() {
  const DEVICE = {
    mobile: { fontSize: 0.2 },
    tablet: { fontSize: 0.4 },
    desktop: { fontSize: 0.6 },
  } as const;

  const getDevice = () => {
    const w = window.innerWidth;
    if (w <= 639) return 'mobile';
    if (w <= 1023) return 'tablet';
    return 'desktop';
  };

  const [device, setDevice] = useState<keyof typeof DEVICE>(getDevice());

  useEffect(() => {
    const onResize = () => setDevice(getDevice());
    window.addEventListener('resize', onResize);
    return () => window.removeEventListener('resize', onResize);
  }, []);

  type DeviceKey = keyof typeof DEVICE;

  const { fontSize } = DEVICE[device as DeviceKey];

  return (
    <Text
      position={[0, 0, 12]}
      fontSize={fontSize}
      letterSpacing={-0.05}
      outlineWidth={0}
      outlineBlur="20%"
      outlineColor="#000"
      outlineOpacity={0.5}
      color="white"
      anchorX="center"
      anchorY="middle"
    >
      React Bits
    </Text>
  );
}

function HeaderFluidGlass({
  navItems,
  accentColor = '#5227FF',
}: HeaderFluidGlassProps) {
  const items = navItems?.length ? navItems : DEFAULT_NAV_ITEMS;
  const clearColor = useMemo(() => new THREE.Color(accentColor), [accentColor]);
  const modeProps = useMemo(
    () => ({
      scale: 0.15,
      thickness: 11,
      roughness: 0.2,
      chromaticAberration: 0.18,
      anisotropy: 0.05,
    }),
    []
  );

  return (
    <Canvas
      style={{ width: '100%', height: '100%' }}
      camera={{ position: [0, 0, 20], fov: 15 }}
      gl={{ alpha: true }}
    >
      <ScrollControls damping={0.2} pages={3} distance={0.4}>
        <NavItems items={items} />
        <GlassBar modeProps={modeProps} clearColor={clearColor}>
          <Scroll>
            <Typography />
            <Images />
          </Scroll>
          <Scroll html />
          <Preload />
        </GlassBar>
      </ScrollControls>
    </Canvas>
  );
}

export default HeaderFluidGlass;
'use client';

import React, { Suspense } from 'react';
import { Canvas } from '@react-three/fiber';
import { OrthographicCamera } from '@react-three/drei';
import * as THREE from 'three';
import FluidGlassScene from './FluidGlassScene';
import { type FluidGlassMaterialProps } from './GlassBar';

export type FluidGlassMode = 'bar';

export interface FluidGlassProps {
  mode: FluidGlassMode;
  barProps?: {
    scale?: [number, number, number];
    ior?: number;
    thickness?: number;
    chromaticAberration?: number;
    anisotropy?: number;
    smoothness?: number;
  };
  pointer?: { x: number; y: number };
  parallax?: number;
  reducedMotion?: boolean;
  className?: string;
}

export function FluidGlass({
  mode = 'bar',
  barProps,
  pointer = { x: 0.5, y: 0.5 },
  parallax = 0,
  reducedMotion = false,
  className,
}: FluidGlassProps) {
  if (mode !== 'bar') return null;

  const materialProps: FluidGlassMaterialProps = {
    ior: 1.15,
    thickness: 2,
    chromaticAberration: 0.05,
    anisotropy: 0.01,
    smoothness: 0.9,
    ...barProps,
  };

  return (
    // Inline style é necessário para altura dinâmica baseada em HEADER_TOKENS
    <div className={`relative w-full h-16 ${className}`}>
      <Canvas
        shadows
        dpr={[1, 2]}
        gl={{
          antialias: true,
          alpha: true,
          powerPreference: 'high-performance',
          toneMapping: THREE.NoToneMapping,
        }}
        frameloop={reducedMotion ? 'demand' : 'always'}
        className="absolute inset-0 z-40 pill-canvas"
      >
        <OrthographicCamera makeDefault position={[0, 0, 10]} zoom={90} />
        <Suspense fallback={null}>
          <FluidGlassScene
            materialProps={materialProps}
            pointer={pointer}
            parallax={parallax}
            reducedMotion={reducedMotion}
          />
        </Suspense>
      </Canvas>
    </div>
  );
}

export default FluidGlass;
'use client';

import { Canvas, useFrame } from '@react-three/fiber';
import React, { memo, useMemo, useRef } from 'react';
import * as THREE from 'three';

function GlassPlane({ accentColor }: { accentColor: string }) {
  const meshRef = useRef<THREE.Mesh>(null);

  const material = useMemo(() => {
    const mat = new THREE.ShaderMaterial({
      transparent: true,
      depthWrite: false,
      uniforms: {
        uTime: { value: 0 },
        uAccent: { value: new THREE.Color(accentColor) },
        uOpacity: { value: 0.55 },
      },
      vertexShader: `
        varying vec2 vUv;
        void main(){
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,
      fragmentShader: `
        precision highp float;
        varying vec2 vUv;
        uniform float uTime;
        uniform vec3 uAccent;
        uniform float uOpacity;

        float hash(vec2 p){
          return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123);
        }

        float noise(vec2 p){
          vec2 i = floor(p);
          vec2 f = fract(p);
          float a = hash(i);
          float b = hash(i + vec2(1.0, 0.0));
          float c = hash(i + vec2(0.0, 1.0));
          float d = hash(i + vec2(1.0, 1.0));
          vec2 u = f*f*(3.0-2.0*f);
          return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
        }

        void main(){
          vec2 uv = vUv;
          float n1 = noise(uv * 6.0 + vec2(uTime * 0.08, uTime * 0.06));
          float n2 = noise(uv * 10.0 - vec2(uTime * 0.10, uTime * 0.04));
          float n = mix(n1, n2, 0.55);

          float edge = smoothstep(0.0, 0.02, uv.x) + smoothstep(1.0, 0.98, uv.x)
                     + smoothstep(0.0, 0.02, uv.y) + smoothstep(1.0, 0.98, uv.y);
          edge = clamp(edge, 0.0, 1.0);

          vec3 base = vec3(0.05, 0.06, 0.12);
          vec3 tint = mix(base, uAccent, 0.55);

          float gloss = 0.35 + n * 0.35;
          vec3 col = mix(base, tint, gloss);
          col += edge * (uAccent * 0.45);

          float band = smoothstep(0.25, 0.0, abs(uv.y - (0.35 + 0.05*sin(uTime*0.25))));
          col += band * uAccent * 0.12;

          gl_FragColor = vec4(col, uOpacity);
        }
      `,
    });

    return mat;
  }, [accentColor]);

  useFrame((state) => {
    if (!meshRef.current) return;

    // Update time
    material.uniforms.uTime.value = state.clock.elapsedTime;

    // "Spring" physics (Lerp) for X-axis follow
    // Mouse x is -1 to 1. We want a small movement, e.g. 0.05
    const targetX = state.pointer.x * 0.15;

    meshRef.current.position.x = THREE.MathUtils.lerp(
      meshRef.current.position.x,
      targetX,
      0.08 // Damping factor (lower = heavier/smoother)
    );
  });

  return (
    <mesh ref={meshRef}>
      {/* Width increased to 2.4 to cover movement gaps */}
      <planeGeometry args={[2.4, 2, 1, 1]} />
      <primitive object={material} attach="material" />
    </mesh>
  );
}

const HeaderGlassCanvas = memo(function HeaderGlassCanvas({
  accentColor,
}: {
  accentColor: string;
}) {
  return (
    <Canvas
      dpr={[1, 2]}
      gl={{ antialias: false, alpha: true, premultipliedAlpha: true }}
      orthographic
      camera={{ position: [0, 0, 1], zoom: 1 }}
    >
      <GlassPlane accentColor={accentColor} />
    </Canvas>
  );
});

export default HeaderGlassCanvas;
import * as THREE from 'three';
import { shaderMaterial } from '@react-three/drei';

export const FluidMaterial = shaderMaterial(
  {
    uTime: 0,
    uScene: new THREE.Texture(),
    uResolution: new THREE.Vector2(1, 1),
    uIOR: 1.15,
    uChromaticAberration: 0.08,
    uThickness: 4,
    uAnisotropy: 0.02,
    uMouse: new THREE.Vector2(0.5, 0.5),
    uParallax: 0,
    uOpacity: 0.95,
  },
  /* glsl */ `
    varying vec2 vUv;
    varying vec3 vNormal;
    varying vec3 vWorldPos;
    uniform float uTime;
    uniform vec2 uMouse;
    uniform float uParallax;

    // Simplex noise from https://github.com/ashima/webgl-noise
    vec3 mod289(vec3 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}
    vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}
    vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}
    vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}
    float snoise(vec3 v){
      const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
      const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
      vec3 i  = floor(v + dot(v, C.yyy) );
      vec3 x0 =   v - i + dot(i, C.xxx) ;
      vec3 g = step(x0.yzx, x0.xyz);
      vec3 l = 1.0 - g;
      vec3 i1 = min( g.xyz, l.zxy );
      vec3 i2 = max( g.xyz, l.zxy );
      vec3 x1 = x0 - i1 + 1.0 * C.xxx;
      vec3 x2 = x0 - i2 + 2.0 * C.xxx;
      vec3 x3 = x0 - 1.0 + 3.0 * C.xxx;
      i = mod289(i);
      vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
      float n_ = 0.142857142857;
      vec3  ns = n_ * D.wyz - D.xzx;
      vec4 j = p - 49.0 * floor(p * ns.z * ns.z);
      vec4 x_ = floor(j * ns.z);
      vec4 y_ = floor(j - 7.0 * x_ );
      vec4 x = x_ *ns.x + ns.yyyy;
      vec4 y = y_ *ns.x + ns.yyyy;
      vec4 h = 1.0 - abs(x) - abs(y);
      vec4 b0 = vec4( x.xy, y.xy );
      vec4 b1 = vec4( x.zw, y.zw );
      vec4 s0 = floor(b0)*2.0 + 1.0;
      vec4 s1 = floor(b1)*2.0 + 1.0;
      vec4 sh = -step(h, vec4(0.0));
      vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
      vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
      vec3 p0 = vec3(a0.xy,h.x);
      vec3 p1 = vec3(a0.zw,h.y);
      vec3 p2 = vec3(a1.xy,h.z);
      vec3 p3 = vec3(a1.zw,h.w);
      vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2,p2), dot(p3,p3)));
      p0 *= norm.x;
      p1 *= norm.y;
      p2 *= norm.z;
      p3 *= norm.w;
      vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
      m = m * m;
      return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                    dot(p2,x2), dot(p3,x3) ) );
    }

    void main() {
      vUv = uv;
      vec3 displaced = position;

      float noise = snoise(vec3(position.xy * 1.8, uTime * 0.45));
      float edge = smoothstep(0.0, 0.35, 1.0 - length(uv - vec2(0.5)));
      displaced += normal * noise * 0.38 * edge;

      vec2 mouse = uMouse;
      float hover = smoothstep(0.35, 0.0, distance(uv, mouse));
      displaced += normal * hover * 0.35;

      vec4 worldPos = modelMatrix * vec4(displaced, 1.0);
      vWorldPos = worldPos.xyz;
      vNormal = normalize(normalMatrix * normalize(displaced));
      gl_Position = projectionMatrix * viewMatrix * worldPos;
    }
  `,
  /* glsl */ `
    varying vec2 vUv;
    varying vec3 vNormal;
    varying vec3 vWorldPos;
    uniform sampler2D uScene;
    uniform vec2 uResolution;
    uniform float uTime;
    uniform float uIOR;
    uniform float uChromaticAberration;
    uniform float uThickness;
    uniform float uAnisotropy;
    uniform vec2 uMouse;
    uniform float uParallax;
    uniform float uOpacity;

    vec3 saturate(vec3 v){return clamp(v,0.0,1.0);}

    void main() {
      vec3 normal = normalize(vNormal);
      vec3 viewDir = normalize(cameraPosition - vWorldPos);

      float fresnel = pow(1.0 - max(dot(viewDir, normal), 0.0), 2.2);
      vec3 refractedDir = refract(viewDir, normal, 1.0 / max(uIOR, 1e-3));
      vec2 refraction = refractedDir.xy * (0.18 + uThickness * 0.06 + uParallax * 0.6);
      refraction.x += normal.y * uAnisotropy * 0.4;
      refraction.y += normal.x * uAnisotropy * 0.25;

      vec2 uvR = vUv + refraction * (1.0 + uChromaticAberration);
      vec2 uvG = vUv + refraction;
      vec2 uvB = vUv + refraction * (1.0 - uChromaticAberration);

      uvR = clamp(uvR, 0.0, 1.0);
      uvG = clamp(uvG, 0.0, 1.0);
      uvB = clamp(uvB, 0.0, 1.0);

      vec3 refracted;
      refracted.r = texture2D(uScene, uvR).r;
      refracted.g = texture2D(uScene, uvG).g;
      refracted.b = texture2D(uScene, uvB).b;

      vec3 tint = mix(vec3(0.78, 0.86, 1.0), vec3(1.0), fresnel * 0.35);
      vec3 color = mix(refracted, tint, 0.15);

      float glow = pow(1.0 - abs(dot(viewDir, normal)), 3.2);
      color += vec3(0.28, 0.42, 0.96) * glow * 0.35;

      float highlight = exp(-10.0 * distance(vUv, uMouse));
      color += vec3(0.8, 0.9, 1.0) * highlight * 0.45;

      float softness = smoothstep(0.0, 0.25, length(refraction)) * 0.25;
      color = saturate(color + softness);

      vec2 vignetteUv = gl_FragCoord.xy / uResolution;
      float vignette = smoothstep(0.75, 0.2, length(vignetteUv - 0.5));
      color *= mix(1.12, 1.0, vignette);

      gl_FragColor = vec4(color, uOpacity);
    }
  `
);

export type FluidMaterialType = InstanceType<typeof FluidMaterial>;
'use client';

import React from 'react';
import { Environment, Lightformer, SpotLight } from '@react-three/drei';
import { GlassBar, type FluidGlassMaterialProps } from './GlassBar';

export interface FluidGlassSceneProps {
  materialProps: FluidGlassMaterialProps;
  pointer: { x: number; y: number };
  parallax: number;
  reducedMotion: boolean;
}

export default function FluidGlassScene({
  materialProps,
  pointer,
  parallax,
  reducedMotion,
}: FluidGlassSceneProps) {
  return (
    <>
      <color attach="background" args={['transparent']} />
      <ambientLight intensity={0.48} />
      <SpotLight
        position={[-2, 3, 6]}
        angle={0.45}
        penumbra={0.7}
        intensity={1.4}
        color="#9fd8ff"
        distance={16}
      />
      <Environment resolution={64}>
        <Lightformer
          intensity={2.4}
          color="#6da8ff"
          position={[0, 0.6, 4]}
          scale={[6, 2, 1]}
          form="rect"
        />
        <Lightformer
          intensity={1.8}
          color="#ffffff"
          position={[2.5, -2, 3]}
          scale={[4, 1, 1]}
          form="rect"
        />
      </Environment>
      <GlassBar
        materialProps={materialProps}
        pointer={pointer}
        parallax={parallax}
        reducedMotion={reducedMotion}
      />
    </>
  );
}
'use client';

import { useFrame, useThree } from '@react-three/fiber';
import { Text } from '@react-three/drei';
import { useRef, useState, useEffect } from 'react';
import * as THREE from 'three';
import type { NavItem } from '@/components/layout/header/types';

export function NavItems({ items }: { items: NavItem[] }) {
  const group = useRef<THREE.Group>(null!);
  const { viewport, camera } = useThree();

  const DEVICE = {
    mobile: { max: 639, spacing: 0.2, fontSize: 0.035 },
    tablet: { max: 1023, spacing: 0.24, fontSize: 0.045 },
    desktop: { max: Infinity, spacing: 0.3, fontSize: 0.05 },
  } as const;

  const getDevice = () => {
    const w = window.innerWidth;
    if (w <= DEVICE.mobile.max) return 'mobile';
    if (w <= DEVICE.tablet.max) return 'tablet';
    return 'desktop';
  };

  const [device, setDevice] = useState<keyof typeof DEVICE>(getDevice());

  useEffect(() => {
    const onResize = () => setDevice(getDevice());
    window.addEventListener('resize', onResize);
    return () => window.removeEventListener('resize', onResize);
  }, []);

  const { spacing, fontSize } = DEVICE[device];

  useFrame(() => {
    if (!group.current) return;
    const v = viewport.getCurrentViewport(camera, [0, 0, 15]);
    group.current.position.set(0, -v.height / 2 + 0.2, 15.1);

    group.current.children.forEach((child, index) => {
      child.position.x = (index - (items.length - 1) / 2) * spacing;
    });
  });

  const handleNavigate = (href: string) => {
    if (!href) return;
    if (href.startsWith('#')) {
      window.location.hash = href;
      return;
    }
    window.location.href = href;
  };

  return (
    <group ref={group} renderOrder={10}>
      {items.map(({ label, href }) => (
        <Text
          key={`${label}-${href}`}
          fontSize={fontSize}
          color="white"
          anchorX="center"
          anchorY="middle"
          outlineWidth={0}
          outlineBlur="20%"
          outlineColor="#000"
          outlineOpacity={0.5}
          renderOrder={10}
          onClick={(event) => {
            event.stopPropagation();
            handleNavigate(href);
          }}
          onPointerOver={() => (document.body.style.cursor = 'pointer')}
          onPointerOut={() => (document.body.style.cursor = 'auto')}
        >
          {label}
        </Text>
      ))}
    </group>
  );
}
'use client';

import * as THREE from 'three';
import {
  createPortal,
  ThreeElements,
  useFrame,
  useThree,
} from '@react-three/fiber';
import { useFBO, useGLTF, MeshTransmissionMaterial } from '@react-three/drei';
import { easing } from 'maath';
import { memo, ReactNode, useEffect, useRef, useState } from 'react';

useGLTF.preload('/assets/3d/bar.glb');

type ModeProps = Record<string, unknown>;

export interface FluidGlassMaterialProps {
  scale?: number | [number, number, number];
  ior?: number;
  thickness?: number;
  chromaticAberration?: number;
  anisotropy?: number;
  roughness?: number;
  smoothness?: number;
  [key: string]: unknown;
}

type ModeWrapperProps = ThreeElements['mesh'] & {
  children?: ReactNode;
  glb: string;
  geometryKey: string;
  lockToBottom?: boolean;
  followPointer?: boolean;
  modeProps?: ModeProps;
  clearColor?: THREE.Color; // Made optional
  customPointer?: { x: number; y: number };
  parallax?: number;
};

export type BarProps = Omit<ModeWrapperProps, 'glb' | 'geometryKey'> & {
  materialProps?: FluidGlassMaterialProps;
  pointer?: { x: number; y: number };
  reducedMotion?: boolean;
};

const ModeWrapper = memo(function ModeWrapper({
  children,
  glb,
  geometryKey,
  lockToBottom = false,
  followPointer = true,
  modeProps = {},
  clearColor,
  customPointer,
  ...props
}: ModeWrapperProps) {
  const ref = useRef<THREE.Mesh<THREE.BufferGeometry, THREE.Material>>(null!);
  const { nodes } = useGLTF(glb) as unknown as {
    nodes: Record<string, THREE.Mesh<THREE.BufferGeometry>>;
  };
  const buffer = useFBO();
  const { viewport: vp } = useThree();
  const [scene] = useState(() => new THREE.Scene());
  const geoWidthRef = useRef(1);

  useEffect(() => {
    const geo = (nodes[geometryKey] as THREE.Mesh<THREE.BufferGeometry>)
      ?.geometry;
    if (geo) {
      geo.computeBoundingBox();
      if (geo.boundingBox) {
        const width = geo.boundingBox.max.x - geo.boundingBox.min.x;
        geoWidthRef.current = width || 1;
      }
    }
  }, [nodes, geometryKey]);

  useFrame((state, delta) => {
    const { gl, viewport, pointer, camera } = state;
    const v = viewport.getCurrentViewport(camera, [0, 0, 15]);

    const pX = customPointer ? customPointer.x * 2 - 1 : pointer.x;
    const pY = customPointer ? -(customPointer.y * 2 - 1) : pointer.y;

    const destX = followPointer ? (pX * v.width) / 2 : 0;
    const destY = lockToBottom
      ? -v.height / 2 + 0.2
      : followPointer
        ? (pY * v.height) / 2
        : 0;

    // Parallax influence?
    // Usually parallax is applied to group, but let's leave it as is for now unless broken.

    easing.damp3(ref.current.position, [destX, destY, 15], 0.15, delta);

    if ((modeProps as { scale?: number }).scale == null) {
      const maxWorld = v.width * 0.9;
      const desired = maxWorld / geoWidthRef.current;
      ref.current.scale.setScalar(Math.min(0.15, desired));
    }

    gl.setRenderTarget(buffer);
    gl.render(scene, camera);
    gl.setRenderTarget(null);
    if (clearColor) {
      gl.setClearColor(clearColor, 1);
    }
  });

  const {
    scale,
    ior,
    thickness,
    anisotropy,
    chromaticAberration,
    ...extraMat
  } = modeProps as {
    scale?: number | [number, number, number];
    ior?: number;
    thickness?: number;
    anisotropy?: number;
    chromaticAberration?: number;
    [key: string]: unknown;
  };

  const finalScale = Array.isArray(scale) ? scale : (scale ?? 0.15);

  return (
    <>
      {createPortal(children, scene)}
      <mesh scale={[vp.width, vp.height, 1]}>
        <planeGeometry />
        <meshBasicMaterial
          map={buffer.texture}
          transparent
          depthWrite={false}
        />
      </mesh>
      <mesh
        ref={ref}
        scale={finalScale}
        rotation-x={Math.PI / 2}
        geometry={
          (nodes[geometryKey] as THREE.Mesh<THREE.BufferGeometry>)?.geometry
        }
        {...props}
      >
        <MeshTransmissionMaterial
          buffer={buffer.texture}
          ior={ior ?? 1.15}
          thickness={thickness ?? 5}
          anisotropy={anisotropy ?? 0.01}
          chromaticAberration={chromaticAberration ?? 0.1}
          {...(typeof extraMat === 'object' && extraMat !== null
            ? extraMat
            : {})}
        />
      </mesh>
    </>
  );
});

export function GlassBar({
  modeProps = {},
  materialProps,
  clearColor,
  children,
  pointer,
  ...props
}: BarProps) {
  const defaultMat = {
    transmission: 1,
    roughness: 0,
    thickness: 10,
    ior: 1.15,
    color: '#ffffff',
    attenuationColor: '#ffffff',
    attenuationDistance: 0.25,
  };

  // Merge materialProps into modeProps if provided
  const finalModeProps = {
    ...defaultMat,
    ...modeProps,
    ...(materialProps || {}),
  };

  return (
    <ModeWrapper
      glb="/assets/3d/bar.glb"
      geometryKey="Cube"
      lockToBottom
      followPointer={!pointer} // If pointer provided, don't follow mouse auto? Or handle via customPointer
      customPointer={pointer}
      modeProps={finalModeProps}
      clearColor={clearColor}
      {...props}
    >
      {children}
    </ModeWrapper>
  );
}
'use client';

import { FC } from 'react';
import type { KeyboardEvent, MouseEvent } from 'react';
import Image from 'next/image';
import { motion, useReducedMotion, type Variants } from 'framer-motion';
import { useRouter } from 'next/navigation';
import type { PortfolioProject } from '@/types/project';
import { applyImageFallback, isVideo } from '@/utils/utils';

interface PortfolioCardProps {
  project: PortfolioProject;
  index: number;
  onOpen?: (_project: PortfolioProject) => void;
  className?: string;
}

const defaultTransition = { duration: 0.35, ease: [0.22, 1, 0.36, 1] } as const;

const overlayVariants: Variants = {
  rest: { opacity: 0 },
  hover: { opacity: 1, transition: { duration: 0.25 } },
};

const infoVariants: Variants = {
  rest: { opacity: 0, y: 12 },
  hover: { opacity: 1, y: 0, transition: { duration: 0.25, delay: 0.05 } },
};

const mediaVariants = (prefersReducedMotion: boolean): Variants => ({
  rest: { scale: 1 },
  hover: {
    scale: prefersReducedMotion ? 1 : 1.08,
    transition: defaultTransition,
  },
});

const PortfolioCard: FC<PortfolioCardProps> = ({
  project,
  index: _index,
  onOpen,
  className = '',
}) => {
  const router = useRouter();
  const prefersReducedMotion = useReducedMotion();

  const handleNavigate = (event?: MouseEvent | KeyboardEvent) => {
    if (event) {
      event.preventDefault();
      event.stopPropagation();
    }

    if (project.landingPageSlug) {
      router.push(`/projects/${project.landingPageSlug}?from=portfolio`);
      return;
    }

    onOpen?.(project);
  };

  const mediaSizing = `${project.layout.aspectRatio ?? 'aspect-[4/3]'} ${project.layout.height ?? ''}`.trim();

  return (
    <motion.article
      className={`relative block ${project.layout.cols ?? ''} ${className} h-full cursor-pointer`}
      initial="rest"
      animate="rest"
      whileHover="hover"
      onClick={handleNavigate}
      role="button"
      tabIndex={0}
      onKeyDown={(event) => {
        if (event.key === 'Enter' || event.key === ' ') {
          handleNavigate(event);
        }
      }}
      aria-label={`Ver projeto: ${project.title}`}
    >
      <motion.figure className="relative block overflow-hidden">
        <motion.a
          href={project.landingPageSlug ? `/projects/${project.landingPageSlug}` : '#'}
          className={`relative block w-full overflow-hidden ${mediaSizing}`}
          onClick={handleNavigate}
          aria-label={`Abrir ${project.title}`}
          style={{ cursor: 'pointer' }}
        >
          <motion.div
            className="text-overlay absolute inset-0 flex items-center justify-center bg-black/60"
            variants={overlayVariants}
            transition={defaultTransition}
            style={{ pointerEvents: 'none' }}
          >
            <motion.div
              className="info text-white uppercase tracking-[0.28em] text-xs md:text-sm"
              variants={infoVariants}
            >
              <span className="block text-center">{project.displayCategory}</span>
            </motion.div>
          </motion.div>

          <motion.div
            className="absolute inset-0"
            variants={mediaVariants(Boolean(prefersReducedMotion))}
          >
            {isVideo(project.image) ? (
              <video
                src={project.image}
                autoPlay
                muted
                loop
                playsInline
                className="h-full w-full object-cover object-center"
              />
            ) : (
              <Image
                src={project.image}
                alt={project.title}
                fill
                className="object-cover object-center"
                sizes={
                  project.layout.sizes ??
                  '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw'
                }
                loading="lazy"
                onError={applyImageFallback}
              />
            )}
          </motion.div>
        </motion.a>
      </motion.figure>

      <motion.div
        className="info mt-4 text-left"
        variants={infoVariants}
        transition={{ ...defaultTransition, delay: 0.05 }}
      >
        <h2 className="text-lg md:text-xl lg:text-2xl font-semibold uppercase tracking-[0.12em] text-white">
          {project.title}
        </h2>
      </motion.div>
    </motion.article>
  );
};

export default PortfolioCard;
'use client';

import React, { useRef } from 'react';
import Image from 'next/image';
import {
  motion,
  useReducedMotion,
  useScroll,
  useTransform,
} from 'framer-motion';

import { PortfolioProject } from '@/types/project';

type Props = {
  project: PortfolioProject;
  index: number;
  className?: string;
  onClick?: (_project: PortfolioProject) => void;
  priority?: boolean;
};

const cn = (...classes: Array<string | false | null | undefined>) =>
  classes.filter(Boolean).join(' ');

export const PortfolioCardParallax: React.FC<Props> = ({
  project,
  index,
  className = '',
  onClick,
  priority = false,
}) => {
  const isTestEnv = process.env.NODE_ENV === 'test';
  const reduceMotion = useReducedMotion();
  const ref = useRef<HTMLDivElement>(null);

  const { scrollYProgress } = useScroll({
    target: ref,
    offset: ['start end', 'end start'],
  });

  const y = useTransform(scrollYProgress, [0, 1], [-40, 40]);

  const heightClass = project.layout?.height ?? 'h-[420px]';
  const colsClass = project.layout?.cols ?? '';
  const aspectRatio = project.layout?.aspectRatio ?? '';
  const sizes =
    project.layout?.sizes ??
    '(min-width: 1280px) 25vw, (min-width: 1024px) 33vw, (min-width: 768px) 50vw, 100vw';

  const motionProps = isTestEnv
    ? {}
    : {
        initial: { opacity: 0, y: 16 },
        whileInView: { opacity: 1, y: 0 },
        viewport: { once: true, margin: '-10% 0px -10% 0px' },
        transition: {
          duration: 0.6,
          delay: Math.min(0.18, index * 0.03),
          ease: [0.22, 1, 0.36, 1] as const,
        },
      };

  const imageLayoutProps = isTestEnv
    ? {
        width: 1200,
        height: 1600,
        style: { width: '100%', height: '100%' },
      }
    : {
        fill: true,
        ...(priority ? { priority: true } : {}),
      };

  return (
    <motion.div
      ref={ref}
      className={cn(
        'parallax-card relative overflow-hidden rounded-2xl border border-white/10 bg-white/5',
        'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400',
        colsClass,
        heightClass,
        aspectRatio,
        className
      )}
      onClick={() => onClick?.(project)}
      {...motionProps}
    >
      <motion.div
        className="card-image-wrapper absolute inset-0 h-[135%] will-change-transform"
        style={reduceMotion ? undefined : { y }}
      >
        <Image
          src={project.image}
          alt={project.title}
          {...imageLayoutProps}
          sizes={sizes}
          className="object-cover"
        />
      </motion.div>

      <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent pointer-events-none" />

      <div className="text-overlay absolute inset-0 flex items-end">
        <div className="info w-full p-4 sm:p-6 text-white">
          <p className="text-[11px] uppercase tracking-[0.18em] text-white/70">
            {project.displayCategory}
          </p>
          <h3 className="mt-1 text-xl sm:text-2xl font-semibold leading-tight">
            {project.title}
          </h3>
          {project.client && (
            <p className="mt-1 text-sm text-white/70">{project.client}</p>
          )}
        </div>
      </div>
    </motion.div>
  );
};

export default PortfolioCardParallax;
'use client';

import { useMemo } from 'react';
import Image from 'next/image';
import type { PortfolioProject } from '@/types/project';
import { useSiteAssetUrl } from '@/hooks/useSiteAssetUrl';

type GalleryCardProps = {
  project: PortfolioProject;
  cardRef: (_el: HTMLDivElement | null) => void;
  onProjectSelect: (_project: PortfolioProject) => void;
};

export function GalleryCard({ project, cardRef, onProjectSelect }: GalleryCardProps) {
  const imageUrl = useSiteAssetUrl(project.image);

  const sizes = useMemo(
    () =>
      project.layout?.sizes ||
      '(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw',
    [project.layout?.sizes]
  );

  return (
    <div
      ref={cardRef}
      className="h-[400px] overflow-hidden cursor-pointer focus:outline-none focus-visible:ring-2 focus-visible:ring-focus-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background"
      role="button"
      tabIndex={0}
      aria-label={`Ver projeto ${project.title}`}
      onClick={() => onProjectSelect(project)}
      onKeyDown={(e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          onProjectSelect(project);
        }
      }}
    >
      <div className="relative h-[135%] card-image-wrapper motion-safe:will-change-transform">
        <Image
          src={imageUrl}
          alt={project.title}
          fill
          className="object-cover"
          sizes={sizes}
          priority={project.isFeatured}
        />
      </div>
    </div>
  );
}

export default GalleryCard;
'use client';

import React, { useRef } from 'react';
import Image from 'next/image';
import { motion, useScroll, useTransform, useReducedMotion } from 'framer-motion';
import { PortfolioProject } from '@/types/project';

function cn(...classes: Array<string | false | null | undefined>) {
  return classes.filter(Boolean).join(' ')
}

interface ProjectCardProps {
  project: PortfolioProject;
  index: number;
  onClick?: (_project: PortfolioProject) => void;
  className?: string; // We will pass col-span classes here
  priority?: boolean;
}

export const ProjectCard = ({
  project,
  index,
  onClick,
  className = '',
  priority = false,
}: ProjectCardProps) => {
  const reduceMotion = useReducedMotion()
  const ref = useRef<HTMLDivElement | null>(null)

  const { scrollYProgress } = useScroll({
    target: ref,
    offset: ['start end', 'end start'],
  })

  // Mapeia o progresso de scroll do card para um offset vertical suave
  // - aproximação do comportamento do script parallax original (wrapper mais alto que o card)
  const y = useTransform(scrollYProgress, [0, 1], [-40, 40])

  return (
    <motion.div
      ref={ref}
      onClick={() => onClick?.(project)}
      className={cn(
        // Keep legacy ".parallax-card" class so E2E tests can locate cards (was used by the previous Parallax card)
        'parallax-card group relative overflow-hidden border border-white/10 bg-white/5 cursor-pointer',
        'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400',
        'min-h-[320px] md:min-h-[420px]',
         className
      )}
      initial={{ opacity: 0, y: 16 }}
      whileInView={{ opacity: 1, y: 0 }}
      viewport={{ once: true, margin: '-10% 0px -10% 0px' }}
      transition={{ duration: 0.6, delay: Math.min(0.18, index * 0.03), ease: [0.22, 1, 0.36, 1] }}
    >
      <div className="absolute inset-0">
        {project.image ? (
          <motion.div
            className="absolute inset-0"
            style={reduceMotion ? undefined : { y }}
          >
            {/* Wrapper mais alto para permitir o efeito parallax vertical, inspirado no CSS da gallery-track */}
            <div className="absolute inset-x-0 top-0 h-[135%]">
              <Image
                src={project.image}
                alt={project.title}
                fill
                priority={priority}
                unoptimized
                sizes="(min-width: 1024px) 33vw, (min-width: 768px) 50vw, 100vw"
                className="object-cover transition duration-700 group-hover:scale-[1.04]"
              />
            </div>
          </motion.div>
        ) : (
          <div className="absolute inset-0 bg-white/10" />
        )}
        <div className="absolute inset-0 bg-linear-to-t from-black/65 via-black/10 to-black/0" />
      </div>

      <div className="relative flex h-full flex-col justify-end p-4 sm:p-5">
        <div className="flex items-center justify-between gap-4">
          <div>
            {project.tags?.[0] && (
              <span className="inline-flex items-center rounded-full bg-white/10 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-wider text-white/80">
                {project.tags[0]}
              </span>
            )}
            <h3 className="mt-2 text-lg font-semibold leading-tight text-white sm:text-xl">
              {project.title}
            </h3>
            <p className="mt-1 text-sm text-white/70">{project.subtitle || project.client}</p>
          </div>

          <div className="flex h-10 w-10 items-center justify-center rounded-full border border-white/15 bg-white/5 text-white/90 transition group-hover:bg-white/10 shrink-0">
            <span aria-hidden>↗</span>
          </div>
        </div>
      </div>
    </motion.div>
  )
}
// =============================================================================
// TypeAContent - Ghost Era v2.0
// Layout de conteúdo para projetos Tipo A (Hero / Grande)
// =============================================================================

'use client';

import { FC } from 'react';
import Image from 'next/image';
import { motion } from 'framer-motion';
import { ArrowUpRight, Calendar, Building2 } from 'lucide-react';
import type { PortfolioProject } from '@/types/project';
import { easing } from '@/components/portfolio/modal/variants';
import { isVideo } from '@/utils/utils';

interface TypeAContentProps {
  project: PortfolioProject;
}

const fadeInUp = {
  initial: { opacity: 0, y: 16 },
  animate: { opacity: 1, y: 0 },
  exit: { opacity: 0, y: -10 },
  transition: { duration: 0.5, ease: easing },
};

// Canon Timeline Delays (Ghost Era)
const TIMELINE = {
  MEDIA: 0.52,
  TITLE: 0.76,
  META: 0.96,
  SECONDARY: 1.12,
};

/**
 * Layout A: Hero image grande no topo + Info abaixo
 * Usado para projetos de destaque
 */
const TypeAContent: FC<TypeAContentProps> = ({ project }) => {
  return (
    <div className="flex flex-col gap-8">
      {/* Hero Image */}
      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ delay: TIMELINE.MEDIA, duration: 0.24, ease: 'easeOut' }}
        className="card-shell relative w-full rounded-2xl overflow-hidden bg-white/5"
      >
        {isVideo(project.image) ? (
          <video
            src={project.image}
            autoPlay
            muted
            loop
            playsInline
            className="absolute inset-0 w-full h-full object-cover"
          />
        ) : (
          <Image
            src={project.image}
            alt={project.title}
            fill
            className="object-cover"
            sizes="(max-width: 1024px) 100vw, 80vw"
            priority
          />
        )}
        
        {/* Gradient overlay */}
        <div className="absolute inset-0 bg-linear-to-t from-black/60 via-transparent to-transparent" />
        
        {/* Category badge */}
        <div className="absolute top-6 left-6">
          <span className="inline-flex items-center rounded-full bg-[#E6EFEF]/60 backdrop-blur-md border border-white/10 px-4 py-1.5 text-xs font-semibold uppercase tracking-wide text-[#040013]">
            {project.displayCategory}
          </span>
        </div>
      </motion.div>

      {/* Content Grid */}
      <div className="grid md:grid-cols-[1.5fr,1fr] gap-8 md:gap-12">
        {/* Left: Title & Description */}
        <div className="flex flex-col gap-6">
          <motion.h2
            initial={{ opacity: 0, y: 6 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: TIMELINE.TITLE, duration: 0.2, ease: easing }}
            className="text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight"
          >
            {project.title}
          </motion.h2>

          {project.subtitle && (
            <motion.p
              variants={fadeInUp}
              className="text-xl text-blueAccent font-medium"
            >
              {project.subtitle}
            </motion.p>
          )}

          {project.detail?.description && (
            <motion.p
              variants={fadeInUp}
              className="text-base md:text-lg text-white/70 leading-relaxed"
            >
              {project.detail.description}
            </motion.p>
          )}

          {/* Highlights */}
          {project.detail?.highlights && (
            <motion.ul variants={fadeInUp} className="flex flex-col gap-3 list-none">
              {project.detail.highlights.map((highlight, i) => (
                <motion.li 
                  key={i}
                  className="flex items-center gap-3 text-sm text-white/80"
                  variants={fadeInUp}
                >
                  <span className="w-1.5 h-1.5 rounded-full bg-blueAccent" aria-hidden="true" />
                  {highlight}
                </motion.li>
              ))}
            </motion.ul>
          )}
        </div>

        {/* Right: Metadata */}
        <motion.div 
          initial={{ opacity: 0, y: 4 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: TIMELINE.META, duration: 0.16, ease: easing }}
          className="flex flex-col gap-6"
        >
          {/* Meta cards */}
          <div className="flex flex-col gap-4">
            <div className="flex items-center gap-3 p-4 rounded-xl bg-white/5 border border-white/10">
              <Building2 className="w-5 h-5 text-blueAccent" />
              <div>
                <span className="block text-xs uppercase tracking-wider text-white/50">Cliente</span>
                <span className="text-sm font-medium text-white">{project.client}</span>
              </div>
            </div>

            <div className="flex items-center gap-3 p-4 rounded-xl bg-white/5 border border-white/10">
              <Calendar className="w-5 h-5 text-blueAccent" />
              <div>
                <span className="block text-xs uppercase tracking-wider text-white/50">Ano</span>
                <span className="text-sm font-medium text-white">{project.year}</span>
              </div>
            </div>
          </div>

          {/* Tags */}
          {project.tags && (
            <div className="flex flex-wrap gap-2">
              {project.tags.map((tag) => (
                <span
                  key={tag}
                  className="px-3 py-1.5 rounded-full bg-[#E6EFEF]/60 backdrop-blur-md border border-white/10 text-xs text-[#040013] font-medium"
                >
                  {tag}
                </span>
              ))}
            </div>
          )}

          {/* External link */}
          {project.detail?.externalUrl && (
            <a
              href={project.detail.externalUrl}
              target="_blank"
              rel="noopener noreferrer"
              className="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-full text-white font-semibold text-sm transition-colors bg-[#0048ff] hover:bg-[#8705f2]"
            >
              Ver projeto completo
              <ArrowUpRight className="w-4 h-4" />
            </a>
          )}
        </motion.div>
      </div>

      {/* Gallery (se disponível) */}
      {project.detail?.gallery && project.detail.gallery.length > 0 && (
        <motion.div variants={fadeInUp} className="mt-8">
          <h3 className="text-lg font-semibold text-white mb-4">Galeria</h3>
          <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
            {project.detail.gallery.map((img, i) => (
              <motion.div
                key={i}
                initial={{ opacity: 0, y: 8 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ 
                  delay: TIMELINE.SECONDARY + i * 0.08, 
                  duration: 0.20,
                  ease: easing,
                }}
                className="relative aspect-square rounded-xl overflow-hidden bg-white/5"
              >
                {isVideo(img) ? (
                  <video
                    src={img}
                    autoPlay
                    muted
                    loop
                    playsInline
                    className="absolute inset-0 w-full h-full object-cover hover:scale-105 transition-transform duration-500"
                  />
                ) : (
                  <Image
                    src={img}
                    alt={`${project.title} - Imagem ${i + 1}`}
                    fill
                    className="object-cover hover:scale-105 transition-transform duration-500"
                    sizes="(max-width: 768px) 50vw, 33vw"
                  />
                )}
              </motion.div>
            ))}
          </div>
        </motion.div>
      )}
    </div>
  );
};

export default TypeAContent;
// =============================================================================
// TypeBContent - Ghost Era v2.0
// Layout de conteúdo para projetos Tipo B (Grid / Compacto)
// =============================================================================

'use client';

import { FC } from 'react';
import Image from 'next/image';
import { motion } from 'framer-motion';
import { Calendar, Building2, Tag } from 'lucide-react';
import type { PortfolioProject } from '@/types/project';
import AntigravityCTA from '@/components/ui/AntigravityCTA';
import { easing } from '@/components/portfolio/modal/variants';
import { isVideo } from '@/utils/utils';

interface TypeBContentProps {
  project: PortfolioProject;
}

const fadeInUp = {
  initial: { opacity: 0, y: 16 },
  animate: { opacity: 1, y: 0 },
  exit: { opacity: 0, y: -8 },
  transition: { duration: 0.4, ease: easing },
};

// Canon Timeline Delays (Ghost Era)
const TIMELINE = {
  MEDIA: 0.52,
  TITLE: 0.76,
  META: 0.96,
  SECONDARY: 1.12,
};


/**
 * Layout B: Imagem à esquerda, conteúdo à direita
 * Usado para projetos menores / grid items
 */
const TypeBContent: FC<TypeBContentProps> = ({ project }) => {
  return (
    <div className="grid md:grid-cols-2 gap-8 md:gap-12">
      {/* Left: Image */}
      <motion.div
        initial={{ opacity: 0, x: -20 }}
        animate={{ opacity: 1, x: 0 }}
        transition={{ delay: TIMELINE.MEDIA, duration: 0.5, ease: easing }}
        className="relative aspect-square md:aspect-4/5 rounded-2xl overflow-hidden bg-white/5"
      >
        {isVideo(project.image) ? (
          <video
            src={project.image}
            autoPlay
            muted
            loop
            playsInline
            className="absolute inset-0 w-full h-full object-cover"
          />
        ) : (
          <Image
            src={project.image}
            alt={project.title}
            fill
            className="object-cover"
            sizes="(max-width: 768px) 100vw, 50vw"
            priority
          />
        )}
        
        {/* Accent color overlay on bottom */}
        {project.accentColor && (
          <motion.div 
            className="absolute inset-x-0 bottom-0 h-1/3"
            style={{ 
              background: `linear-gradient(to top, ${project.accentColor}40, transparent)` 
            }}
          />
        )}

        {/* Category pill */}
        <div className="absolute top-4 left-4">
          <span className="inline-flex items-center rounded-full bg-[#E6EFEF]/60 backdrop-blur-md border border-white/10 px-3 py-1 text-xs font-medium text-[#040013]">
            {project.displayCategory}
          </span>
        </div>
      </motion.div>

      {/* Right: Content */}
      <div className="flex flex-col justify-center gap-6">
        {/* Title section */}
        <div className="flex flex-col gap-2">
          <motion.span
            variants={fadeInUp}
            className="text-xs uppercase tracking-[0.3em] text-blueAccent"
          >
            [{project.category}]
          </motion.span>
          
          <motion.h2
            initial={{ opacity: 0, y: 6 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: TIMELINE.TITLE, duration: 0.2, ease: easing }}
            className="text-2xl md:text-3xl lg:text-4xl font-bold text-white leading-tight"
          >
            {project.title}
          </motion.h2>

          {project.subtitle && (
            <motion.p
              variants={fadeInUp}
              className="text-lg text-white/60"
            >
              {project.subtitle}
            </motion.p>
          )}
        </div>

        {/* Description */}
        {project.detail?.description && (
          <motion.p
            variants={fadeInUp}
            className="text-base text-white/70 leading-relaxed"
          >
            {project.detail.description}
          </motion.p>
        )}

        {/* Meta inline */}
        <motion.div
          initial={{ opacity: 0, y: 4 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: TIMELINE.META, duration: 0.16, ease: easing }}
          className="flex flex-wrap items-center gap-4 text-sm text-white/50"
        >
          <span className="flex items-center gap-2">
            <Building2 className="w-4 h-4" />
            {project.client}
          </span>
          <span className="w-px h-4 bg-white/20" />
          <span className="flex items-center gap-2">
            <Calendar className="w-4 h-4" />
            {project.year}
          </span>
          {project.tags && project.tags.length > 0 && (
            <>
              <span className="w-px h-4 bg-white/20" />
              <span className="flex items-center gap-2">
                <Tag className="w-4 h-4" />
                {project.tags.slice(0, 2).join(', ')}
              </span>
            </>
          )}
        </motion.div>

        {/* Highlights list */}
        {project.detail?.highlights && (
          <ul className="flex flex-col gap-2 mt-2">
            <motion.div variants={fadeInUp} className="contents">
              {project.detail.highlights.map((highlight, i) => (
                <li 
                  key={i}
                  className="flex items-start gap-3 text-sm text-white/70"
                >
                  <span className="mt-1.5 w-1.5 h-1.5 rounded-full bg-blueAccent shrink-0" />
                  {highlight}
                </li>
              ))}
            </motion.div>
          </ul>
        )}

        {/* Tags cloud */}
        {project.tags && (
          <motion.div 
            initial={{ opacity: 0, y: 8 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: TIMELINE.SECONDARY, duration: 0.2, ease: easing }}
            className="flex flex-wrap gap-2"
          >
            {project.tags.map((tag) => (
              <span
                key={tag}
                className="px-3 py-1 rounded-full bg-[#E6EFEF]/60 backdrop-blur-md border border-white/10 text-xs text-[#040013] font-medium"
              >
                {tag}
              </span>
            ))}
          </motion.div>
        )}

        {/* CTA - Using AntigravityCTA component */}
        <motion.div variants={fadeInUp} className="flex gap-3 mt-4">
          {project.detail?.externalUrl && (
            <AntigravityCTA
              href={project.detail.externalUrl}
              text="ver projeto"
              className="relative"
            />
          )}
        </motion.div>
      </div>
    </div>
  );
};

export default TypeBContent;
'use client';

import { useEffect, useMemo, useRef, useState } from 'react';
import { AnimatePresence, motion, useReducedMotion } from 'framer-motion';
import Image from 'next/image';
import { X } from 'lucide-react';
import { createPortal } from 'react-dom';
import type { PortfolioProject } from '@/types/project';
import {
  getBackdropVariants,
  getContainerVariants,
  getMediaVariants,
  getTitleVariants,
  getMetaVariants,
  getContentVariants,
} from './modal/variants';
import { isVideo } from '@/utils/utils';

type ProjectModalProps = {
  project: PortfolioProject | null;
  open: boolean;
  onClose: () => void;
};

export default function ProjectModal({
  project,
  open,
  onClose,
}: ProjectModalProps) {
  const shouldReduceMotion = useReducedMotion();
  const [mounted, setMounted] = useState(false);
  const closeRef = useRef<HTMLButtonElement | null>(null);
  const titleId = useMemo(
    () =>
      project ? `project-modal-title-${project.slug.replace(/[^a-z0-9]/gi, '')}` : undefined,
    [project]
  );

  useEffect(() => setMounted(true), []);

  useEffect(() => {
    const handleKey = (event: KeyboardEvent) => {
      if (event.key === 'Escape') {
        onClose();
      }
    };
    if (open) {
      document.addEventListener('keydown', handleKey);
      closeRef.current?.focus({ preventScroll: true });
    }
    return () => document.removeEventListener('keydown', handleKey);
  }, [open, onClose]);

  const backdropVariants = useMemo(() => getBackdropVariants(shouldReduceMotion), [shouldReduceMotion]);
  const containerVariants = useMemo(() => getContainerVariants(shouldReduceMotion), [shouldReduceMotion]);
  const mediaVariants = useMemo(() => getMediaVariants(shouldReduceMotion), [shouldReduceMotion]);
  const titleVariants = useMemo(() => getTitleVariants(shouldReduceMotion), [shouldReduceMotion]);
  const metaVariants = useMemo(() => getMetaVariants(shouldReduceMotion), [shouldReduceMotion]);
  const contentVariants = useMemo(() => getContentVariants(shouldReduceMotion), [shouldReduceMotion]);

  if (!mounted) return null;

  return createPortal(
    <AnimatePresence>
      {open && project ? (
        <div className="fixed inset-0 z-50 flex items-center justify-center px-4 py-6 md:px-10">
          <motion.button
            type="button"
            aria-label="Fechar modal clicando no fundo"
            className="absolute inset-0 bg-black/70 backdrop-blur-sm"
            variants={backdropVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            onClick={onClose}
          />

          <motion.div
            role="dialog"
            aria-modal="true"
            aria-labelledby={titleId}
            variants={containerVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="relative z-10 w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded-3xl bg-[#0c1024] text-white shadow-[0_24px_90px_-30px_rgba(0,0,0,0.6)] border border-white/10"
          >
            <div className="absolute inset-0 pointer-events-none" style={{
             backgroundImage: 'radial-gradient(circle at 20% 20%, rgba(0,87,255,0.16), transparent 35%), radial-gradient(circle at 80% 10%, rgba(79,230,255,0.18), transparent 35%)'
            }} />

            <div className="relative grid gap-8 p-6 md:grid-cols-[1.25fr,0.9fr] md:p-10">
              <div className="flex flex-col gap-4">
                <motion.div
                  variants={mediaVariants}
                  className="relative aspect-video w-full overflow-hidden rounded-2xl bg-linear-to-br from-white/5 to-white/0 border border-white/10"
                >
                    {isVideo(project.image) ? (
                      <video
                        src={project.image}
                        autoPlay
                        muted
                        loop
                        playsInline
                        className="absolute inset-0 w-full h-full object-cover"
                      />
                    ) : (
                      <Image
                        src={project.image}
                        alt={project.title}
                        fill
                        className="object-cover"
                        sizes="(max-width: 768px) 100vw, 60vw"
                        priority
                      />
                    )}
                </motion.div>
              </div>

              <motion.div
                className="flex flex-col gap-4"
                variants={contentVariants}
                initial="hidden"
                animate="visible"
              >
                <div className="flex items-center justify-between gap-4">
                  <motion.h2
                    id={titleId}
                    variants={titleVariants}
                    className="text-2xl md:text-3xl font-semibold leading-tight"
                  >
                    {project.title}
                  </motion.h2>

                  <button
                    ref={closeRef}
                    type="button"
                    onClick={onClose}
                    className="flex h-10 w-10 items-center justify-center rounded-full border border-white/15 bg-white/5 text-white transition hover:border-white/40 hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ghost-blue"
                    aria-label="Fechar modal"
                  >
                    <X className="h-5 w-5" />
                  </button>
                </div>

                <motion.div
                  variants={metaVariants}
                  className="flex flex-wrap items-center gap-3 text-sm uppercase tracking-[0.18em] text-white/60"
                >
                  <span className="bg-[#E6EFEF]/60 backdrop-blur-md border border-white/10 px-3 py-1 rounded-full text-[#040013] font-medium">
                    {project.category}
                  </span>
                  <span aria-hidden className="opacity-50">
                    •
                  </span>
                  <span>{project.client}</span>
                  <span aria-hidden className="opacity-50">
                    •
                  </span>
                  <span>{project.year}</span>
                </motion.div>

                <motion.div
                  variants={contentVariants}
                  className="space-y-3 text-base leading-relaxed text-white/80"
                >
                  <p>
                    Uma visão ampliada do projeto para leitura confortável,
                    mantendo o contexto do showcase sem quebrar o fluxo.
                  </p>
                  <p>
                    O modal usa a sequência editorial: backdrop → container →
                    mídia → título → meta → detalhes. Nenhum elemento permanece
                    animando após a entrada.
                  </p>
                </motion.div>

                <motion.div
                  variants={contentVariants}
                  className="flex flex-wrap gap-2 pt-2"
                >
                  {(project.tags ?? []).map((tag: string) => (
                    <span
                      key={tag}
                      className="rounded-full border border-white/10 bg-[#E6EFEF]/60 backdrop-blur-md px-3 py-1 text-xs uppercase tracking-[0.2em] text-[#040013] font-medium"
                    >
                      {tag}
                    </span>
                  ))}
                </motion.div>
              </motion.div>
            </div>
          </motion.div>
        </div>
      ) : null}
    </AnimatePresence>,
    document.body
  );
}
//=============================================================================
// PortfolioModalNew - Ghost Era v2.0
// Modal com animações editoriais e timings precisos
// =============================================================================

'use client';

import { useCallback, useEffect, useRef, useState } from 'react';
import { createPortal } from 'react-dom';
import { AnimatePresence, motion, useReducedMotion } from 'framer-motion';
import { X } from 'lucide-react';
import type { PortfolioProject } from '@/types/project';
import { useBodyLock } from '@/hooks/useBodyLock';
import { MOTION_TOKENS, ghostTransition } from '@/config/motion';
import TypeAContent from './content/TypeAContent';
import TypeBContent from './content/TypeBContent';

interface PortfolioModalNewProps {
  project: PortfolioProject | null;
  isOpen: boolean;
  onClose: () => void;
}

const { offset } = MOTION_TOKENS;

export default function PortfolioModalNew({
 project,
  isOpen,
  onClose,
}: PortfolioModalNewProps) {
  const [mounted, setMounted] = useState(false);
  const modalRef = useRef<HTMLDivElement>(null);
  const closeButtonRef = useRef<HTMLButtonElement>(null);
  const prefersReducedMotion = useReducedMotion();

  // Bloqueia scroll do body quando modal está aberto
  useBodyLock(isOpen);

  // Monta o componente apenas no cliente (para createPortal)
  useEffect(() => {
    setMounted(true);
  }, []);

  // Focus trap e ESC handler
  useEffect(() => {
    if (!isOpen) return;

const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        e.preventDefault();
        onClose();
      }

      // Focus trap básico
      if (e.key === 'Tab' && modalRef.current) {
        const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );
        const firstElement = focusableElements[0];
        const lastElement = focusableElements[focusableElements.length - 1];

        if (e.shiftKey && document.activeElement === firstElement) {
          e.preventDefault();
          lastElement?.focus();
        } else if (!e.shiftKey && document.activeElement === lastElement) {
          e.preventDefault();
          firstElement?.focus();
        }
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    
    // Focus no botãode fechar ao abrir
    setTimeout(() => {
      closeButtonRef.current?.focus();
    }, 100);

    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [isOpen, onClose]);

  // Previne click propagation no backdrop
  const handleBackdropClick = useCallback(
    (e:React.MouseEvent) => {
      if (e.target === e.currentTarget) {
        onClose();
      }
    },
    [onClose]
  );

  if (!mounted) return null;

  const modalContent = (
    <AnimatePresence mode="wait">
      {isOpen && project && (
        <>
          {/* Backdrop */}
<motion.div
            key="backdrop"
            initial="hidden"
            animate="visible"
            exit="exit"
            variants={{
              hidden: { opacity: 0 },
              visible: { 
                opacity: 1,
                transition: { duration: 0.18, ease: 'easeOut' }
              },
              exit: { 
                opacity: 0,
                transition: { duration: 0.2, ease: 'easeIn' }
              }
            }}
            onClick={handleBackdropClick}
            className="fixed inset-0 z-100 bg-black/85 backdrop-blur-md"
            aria-hidden="true"
          />

          {/* Modal Container */}
          <motion.div
            key="modal"
            ref={modalRef}
            role="dialog"
            aria-modal="true"
            aria-labelledby="modal-title"
            initial={prefersReducedMotion ? { opacity: 0 } :{ opacity: 0, y: offset.large }}
            animate={{ opacity: 1, y: 0 }}
            exit={prefersReducedMotion ? { opacity: 0 } : { opacity: 0, y: offset.standard }}
            transition={ghostTransition(prefersReducedMotion ? 0 :0.12, prefersReducedMotion ? 0.15 : 0.26)}
            className="fixed inset-0 z-101 overflow-y-auto"
          >
            <div className="min-h-full flex items-start justify-center p-4 md:p-8 lg:p-12">
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                transition={{ duration: 0.26, delay: 0.12, ease: [0.22, 1, 0.36, 1] }}
                className="relative w-full max-w-5xl bg-background/95 backdrop-blur-xl rounded-3xl border border-white/10 shadow-2xl shadow-black/50 overflow-hidden will-change-transform"
              >
                {/* Close button - Always Visible */}
                <button
                  ref={closeButtonRef}
                 onClick={onClose}
                  className="fixed top-6 right-6 md:top-10 md:right-10 z-110 flex items-center justify-center w-10 h-10 md:w-14 md:h-14 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-md border border-white/20 text-white transition-all duration-300 hover:rotate-90"
                  aria-label="Fechar modal"
                >
                  <X className="w-5 h-5 md:w-7 md:h-7" />
                </button>

                {/*Header glow */}
                <div className="absolute top-0 inset-x-0 h-40 pointer-events-none">
                  <div 
                    className="absolute inset-0 opacity-30"
                    style={{
                      backgroundImage: 'radial-gradient(ellipse at center top, var(--glow-color, rgba(0,87,255,0.3)), transparent 70%)',
                      ...(project.accentColor && { '--glow-color': `${project.accentColor}40`})
                    } as React.CSSProperties}
                  />
                </div>

                {/* Content */}
                <div className="relative z-10 p-6 md:p-10 lg:p-12 pt-16 md:pt-20">
                  {/* Renderiza layout baseado no tipo */}
                  {project.type === 'A' ? (
                    <TypeAContent project={project} />
                  ) : (
                    <TypeBContent project={project} />
                  )}
                </div>

                {/* Footer gradient */}
                <div className="absolute bottom-0 inset-x-0 h-24 bg-linear-to-t from-background to-transparent pointer-events-none" />
              </motion.div>
            </div>
          </motion.div>
        </>
      )}
    </AnimatePresence>
  );

  // Renderiza no portal do body
  return createPortal(modalContent, document.body);
}
export type MosaicItem = {
  id: string;
  imageSrc?: string;
  gradient: string;
  accent?: string;
  title: string;
  subtitle: string;
  aspectRatio?: number; // width/height ratio (e.g., 16/10 = 1.6)
};

export type MosaicRow = {
  id: string;
  columns: 1 | 2 | 3;
  items: MosaicItem[];
};
// =============================================================================
// CategoryFilter - Ghost Era v2.0
// Filtro de categorias com pills animados
// =============================================================================

'use client';

import { FC } from 'react';
import { motion } from 'framer-motion';
import type { ProjectCategory } from '@/types/project';
import { PROJECT_CATEGORIES } from '@/data/projects';

interface CategoryFilterProps {
  activeCategory: ProjectCategory;
  onChange: (_category: ProjectCategory) => void;
  className?: string;
}

const easing = [0.22, 1, 0.36, 1] as const;

const CategoryFilter: FC<CategoryFilterProps> = ({
  activeCategory,
  onChange,
  className = '',
}) => {
  return (
    <div 
      className={`flex flex-wrap items-center gap-2 md:gap-3 ${className}`}
      role="group"
      aria-label="Filtrar projetos por categoria"
    >
      {PROJECT_CATEGORIES.map((category, index) => {
        const isActive = activeCategory === category.id;
        
        return (
          <motion.button
            key={category.id}
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ 
              duration: 0.5, 
              ease: easing,
              delay: index * 0.05 
            }}
            onClick={() => onChange(category.id)}
            aria-pressed={isActive}
            className={`
              relative px-4 py-3 md:px-5 md:py-2.5 min-h-[48px] md:min-h-0 flex items-center justify-center rounded-full text-xs md:text-sm font-medium
              transition-colors duration-300 whitespace-nowrap
              ${isActive 
                ? 'text-white' 
                : 'text-white/60 hover:text-white/90'
              }
            `}
          >
            {/* Background animado */}
            {isActive && (
              <motion.div
                layoutId="activeCategory"
                className="absolute inset-0 bg-focus-ring rounded-full"
                transition={{ type: 'spring', bounce: 0.15, duration: 0.5 }}
              />
            )}
            
            {/* Border para inativos */}
            {!isActive && (
              <div className="absolute inset-0 rounded-full border border-white/20 hover:border-white/40 transition-colors duration-300" />
            )}
            
            {/* Label */}
            <span className="relative z-10 hidden md:inline">
              {category.label}
            </span>
            <span className="relative z-10 md:hidden">
              {category.labelMobile}
            </span>
          </motion.button>
        );
      })}
    </div>
  );
};

export default CategoryFilter;
'use client';

import React from 'react';
import Image from 'next/image';
import { motion } from 'framer-motion';
import type { MosaicItem } from './types';

type MosaicCardProps = {
  item: MosaicItem;
  priority?: boolean;
};

const easing = [0.22, 1, 0.36, 1] as const;

const entryVariants = {
  rest: { opacity: 0, y: 24 },
  visible: { opacity: 1, y: 0 },
  hover: { opacity: 1, y: 0 },
};

const overlayVariants = {
  rest: { opacity: 0 },
  visible: { opacity: 0 },
  hover: { opacity: 1 },
};

const textVariants = {
  rest: { opacity: 0, y: 16 },
  visible: { opacity: 0, y: 16 },
  hover: { opacity: 1, y: 0 },
};

export default function MosaicCard({ item, priority = false }: MosaicCardProps) {
  // Calculate the percentage for padding-bottom based on aspect ratio (default to 16:10 if not specified)
  const aspectRatio = item.aspectRatio || 1.6; // 16:10 = 1.6
  const paddingBottomPercentage = (1 / aspectRatio) * 100;

  return (
    <motion.article
      initial="rest"
      whileInView="visible"
      whileHover="hover"
      whileTap="hover"
      viewport={{ once: true, amount: 0.35 }}
      variants={entryVariants}
      transition={{ duration: 0.45, ease: easing }}
      className="relative overflow-hidden rounded-none border border-white/30 bg-[#0f172a]/5"
    >
      {/* Wrapper with fixed aspect ratio to prevent CLS */}
      <div
        className="relative w-full"
        style={{ paddingBottom: `${paddingBottomPercentage}%` }}
      >
        <div
          className="absolute inset-0"
          style={{
            background: item.gradient,
          }}
          aria-hidden="true"
        />

        {item.imageSrc && (
          <Image
            src={item.imageSrc}
            alt={item.title}
            fill
            sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
            priority={priority}
            className="absolute inset-0 h-full w-full object-cover"
          />
        )}

        <div className="absolute inset-0 bg-linear-to-b from-black/20 via-transparent to-black/30 mix-blend-multiply" />

        <motion.div
          variants={overlayVariants}
          transition={{ duration: 0.25, ease: 'easeOut' }}
          className="absolute inset-0 bg-focus-ring flex flex-col justify-end px-6 pb-6 pt-10 text-white"
        >
          <motion.span
            variants={textVariants}
            transition={{ duration: 0.2, ease: 'easeInOut', delay: 0.05 }}
            className="text-[12px] uppercase tracking-[0.4em] text-white/80"
          >
            {item.subtitle}
          </motion.span>
          <motion.h2
            variants={textVariants}
            transition={{ duration: 0.25, ease: 'easeInOut', delay: 0.1 }}
            className="text-2xl font-semibold leading-tight"
          >
            {item.title}
          </motion.h2>
        </motion.div>
      </div>
    </motion.article>
  );
}
// =============================================================================
// PortfolioHeroNew - Ghost Era v2.2
// Hero com video loop responsivo, atmosfera Ghost e animações etéreas
// Conforme especificação: PORTFOLIO - PROTÓTIPO INTERATIVO.md
// =============================================================================

'use client';

import { PORTFOLIO_CONTENT } from '@/config/content';
import { useMediaQuery } from '@/hooks/useMediaQuery';
import { useSiteAssetUrl } from '@/contexts/site-assets';
import { SITE_ASSET_KEYS } from '@/config/site-assets';
import AntigravityCTA from '@/components/ui/AntigravityCTA';

export default function PortfolioHeroNew() {
  const isMobile = useMediaQuery('(max-width: 768px)');
  const desktopVideo = useSiteAssetUrl(
    SITE_ASSET_KEYS.heroVideos.portfolioDesktop,
    PORTFOLIO_CONTENT.hero.video.desktop ?? undefined
  );
  const mobileVideo = useSiteAssetUrl(
    SITE_ASSET_KEYS.heroVideos.portfolioMobile,
    PORTFOLIO_CONTENT.hero.video.mobile ?? undefined
  );

  // Seleciona o vídeo correto baseado no dispositivo
  const videoSrc = isMobile ? mobileVideo : desktopVideo;

  return (
    <section
      id="portfolio-hero"
      aria-label="Portfolio Hero"
      className="relative h-[78vh] md:h-screen w-full overflow-hidden"
    >
      {/* Video Background - Responsivo Desktop/Mobile */}
      <div className="absolute inset-0 z-0">
        <video
          key={videoSrc}
          autoPlay
          loop
          muted
          playsInline
          className="h-full w-full object-cover"
        >
          <source src={videoSrc} type="video/mp4" />
        </video>
      </div>

      <div className="absolute inset-0 z-10 bg-linear-to-b from-black/70 via-transparent to-black/90" />

      {/* Ghost Atmospheric Radial Gradients - Enhanced */}
      <div
        className="absolute inset-0 z-10 pointer-events-none"
        aria-hidden="true"
      >
        <div className="absolute inset-0 portfolio-hero-glow-primary opacity-60" />
        <div className="absolute inset-0 portfolio-hero-glow-accent opacity-40" />
        <div className="absolute inset-x-0 bottom-0 h-1/2 bg-linear-to-t from-background via-background/80 to-transparent" />
      </div>

      {/* Hero Content - Title & CTA Fixed Bottom - Single Visual Line */}
      <div className="absolute bottom-0 left-0 w-full z-30 pb-10 md:pb-16 px-4 md:px-12">
        <div className="max-w-[1400px] mx-auto flex flex-col md:flex-row items-end justify-between gap-6 md:gap-12">
          
          {/* Title - "portfólio showcase" */}
          <div className="flex-1 text-center md:text-left">
             <h1
              id="portfolio-hero-heading"
              className="text-4xl sm:text-6xl md:text-8xl tracking-tighter leading-none font-bold"
            >
              <span className="text-[#4fe6ff] mr-3 md:mr-6">
                portfólio
              </span>
              <span className="text-white">showcase</span>
            </h1>
          </div>

          {/* CTA - "vamos trabalhar juntos" - Aligned to bottom baseline */}
          <div className="shrink-0 flex justify-center md:justify-end">
            <AntigravityCTA
              href="#contact"
              text="vamos trabalhar juntos"
              className="static! transform-none!" // Override default fixed positioning
            />
          </div>
        </div>
      </div>
    </section>
  );
}
'use client';

import { BRAND } from '@/config/brand';
import AntigravityCTA from '@/components/ui/AntigravityCTA';
import { motion } from 'framer-motion';

export function HeroSection() {
  return (
    <section className="relative h-screen w-full overflow-hidden">
      {/* Background Video */}
      <video
        autoPlay
        muted
        loop
        playsInline
        className="absolute inset-0 h-full w-full object-cover"
      >
        <source src={BRAND.video.manifesto} type="video/mp4" />
      </video>

      {/* Overlay */}
      <div className="absolute inset-0 bg-linear-to-b from-black/60 via-black/40 to-black/60" />

      {/* Content */}
      <div className="std-grid relative z-10 flex h-full flex-col justify-end pb-12 sm:pb-16 md:pb-24">
        <div className="col-span-full flex flex-col items-center justify-between gap-6 md:flex-row md:items-end">
          {/* Title */}
          <motion.h1
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, ease: [0.16, 1, 0.3, 1] }}
            className="font-h1 text-4xl font-bold uppercase tracking-tight text-white md:text-6xl lg:text-7xl"
          >
            <span className="text-secondary">portfólio</span>{' '}
            <span className="text-white">showcase</span>
          </motion.h1>

          {/* CTA */}
          <motion.div
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ delay: 0.2, duration: 0.6 }}
          >
            <AntigravityCTA 
                 href="#contact"
                 text="vamos trabalhar juntos"
            />
          </motion.div>
        </div>
      </div>
    </section>
  );
}
// =============================================================================
// Portfolio Components Index - Ghost Era v2.0
// Barrel export para todos os componentes de portfolio
// =============================================================================

// Main components
export { default as PortfolioHeroNew } from './PortfolioHeroNew';
export { ProjectsGallery } from './ProjectsGallery';
export { default as PortfolioCard } from './PortfolioCard';
export { PortfolioCardParallax } from './PortfolioCardParallax';
export { default as CategoryFilter } from './CategoryFilter';
export { default as PortfolioModalNew } from './PortfolioModalNew';

// Content layouts
export { default as TypeAContent } from './content/TypeAContent';
export { default as TypeBContent } from './content/TypeBContent';

// Legacy (para compatibilidade - comentados por estarem ausentes no diretório)
// export { default as PortfolioShowcaseSection } from './PortfolioShowcaseSection';
// export { default as ProjectModal } from './ProjectModal';
// export { default as AccordionRow } from './AccordionRow';
// export { default as MosaicCard } from './MosaicCard';
// export { default as PortfolioMosaicGrid } from './PortfolioMosaicGrid';
'use client';

import { useRef } from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import { Container } from '@/components/layout/Container';
import { GHOST_EASE } from '@/config/motion';
import { ProjectCard } from './ProjectCard';
import type { PortfolioProject } from '@/types/project';

interface PortfolioShowcaseSectionProps {
  projects: PortfolioProject[];
  onProjectSelect?: (_project: PortfolioProject) => void;
}

/**
 * Portfolio Showcase Section (Portfolio Page)
 * Grid de projetos com animações de parallax e overlays (Finch Style)
 * Atualizado conforme AUDITORIA_PORTFOLIO.md
 */
export default function PortfolioShowcaseSection({ projects, onProjectSelect }: PortfolioShowcaseSectionProps) {
  const sectionRef = useRef<HTMLElement>(null);
  const prefersReducedMotion = !!useReducedMotion();

  return (
    <section
      id="portfolio-showcase"
      ref={sectionRef}
      className="relative w-full bg-slate-950 pt-10 pb-20 lg:pb-32" // Updated bg to match audit dark theme preference
      aria-labelledby="portfolio-showcase-heading"
    >
      <Container>
        {/* Headline */}
        <motion.header
          initial={
            prefersReducedMotion ? { opacity: 1 } : { opacity: 0, y: 30 }
          }
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.7, ease: GHOST_EASE }}
          className="text-center mb-16 lg:mb-24"
        >
          <h2
            id="portfolio-showcase-heading"
            className="text-4xl md:text-5xl lg:text-6xl xl:text-7xl tracking-tight text-white"
          >
            <span className="text-sky-500 italic font-light">
              todos os{' '}
            </span>
            <span className="font-bold">projetos</span>
          </h2>
        </motion.header>

        {/* Portfolio Grid - 12 Columns */}
        {/* Adhere to the audit: grid grid-cols-12 gap-3 sm:gap-4 */}
        <div className="grid grid-cols-12 gap-3 sm:gap-4">
          {projects.map((project, index) => (
            <ProjectCard
              key={project.id}
              project={project}
              index={index}
              onClick={onProjectSelect}
              // Map the existing layout.cols string (e.g. 'md:col-span-4') to the class
              // Default to col-span-12 if not specified
              className={`col-span-12 ${project.layout.cols || 'md:col-span-4'}`}
            />
          ))}
        </div>
        
        <div className="mt-8 flex items-center justify-center">
          <button
            type="button"
            className="inline-flex items-center gap-2 rounded-full bg-sky-600 px-5 py-3 text-sm font-semibold text-white shadow-[0_10px_30px_rgba(2,132,199,0.25)] transition hover:bg-sky-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400"
            aria-label="Ver mais projetos (placeholder)"
          >
            <span aria-hidden>←</span> veja mais <span aria-hidden>→</span>
          </button>
        </div>

      </Container>
    </section>
  );
}
export const easing: [number, number, number, number] = [0.22, 1, 0.36, 1];

export const getBackdropVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.18,
      ease: 'linear' as const,
    },
  },
  exit: {
    opacity: 0,
    transition: { duration: shouldReduceMotion ? 0 : 0.15, ease: 'linear' as const },
  },
});

export const getContainerVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0, scale: 0.98, y: 12 },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.26,
      ease: easing,
      delay: shouldReduceMotion ? 0 : 0.12,
    },
  },
  exit: {
    opacity: 0,
    scale: 0.98,
    y: 8,
    transition: { duration: shouldReduceMotion ? 0 : 0.18, ease: easing },
  },
});

export const getMediaVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.24,
      delay: shouldReduceMotion ? 0 : 0.52,
    },
  },
});

export const getTitleVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0, y: 6 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.2,
      delay: shouldReduceMotion ? 0 : 0.76,
      ease: easing,
    },
  },
});

export const getMetaVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0, y: 4 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.16,
      delay: shouldReduceMotion ? 0 : 0.96,
      ease: easing,
    },
  },
});

export const getContentVariants = (shouldReduceMotion: boolean | null) => ({
  hidden: { opacity: 0, y: 8 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: shouldReduceMotion ? 0 : 0.24,
      delay: shouldReduceMotion ? 0 : 1.12,
      ease: easing,
      staggerChildren: shouldReduceMotion ? 0 : 0.08,
    },
  },
});
'use client';

import { motion } from 'framer-motion';
import MosaicCard from './MosaicCard';
import type { MosaicRow } from './types';

type PortfolioMosaicGridProps = {
  rows: MosaicRow[];
};

const itemVariants = {
  hidden: { opacity: 0, y: 30 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.8,
      ease: [0.22, 1, 0.36, 1] as [number, number, number, number],
    },
  },
};

export default function PortfolioMosaicGrid({
  rows,
}: PortfolioMosaicGridProps) {
  const firstCardId = rows[0]?.items[0]?.id;

  return (
    <section
      id="portfolio-mosaic"
      aria-label="Mural de projetos em mosaico"
      className="relative bg-transparent text-text py-24 md:py-32"
    >
      {/* Overlay de fundo (Opcional ou removido se o bg ja for ghost-bg) */}
      <div className="absolute inset-0 bg-linear-to-b from-background via-transparent to-background pointer-events-none opacity-50" />

      <div className="mx-auto w-full px-[clamp(1.5rem,5vw,6rem)] max-w-[1680px] relative z-10">
        {/* Grid Editorial */}
        <div className="flex flex-col gap-8 md:gap-12 pb-10">
          {rows.map((row) => (
            <div key={row.id} className="grid grid-cols-12 gap-4 md:gap-6">
              {row.items.map((item) => {
                const tabletSpan =
                  row.columns === 1 ? 'md:col-span-12' : 'md:col-span-6';

                const desktopSpan =
                  row.columns === 3
                    ? 'lg:col-span-4'
                    : row.columns === 2
                      ? 'lg:col-span-6'
                      : 'lg:col-span-12';

                return (
                  <motion.div
                    key={item.id}
                    variants={itemVariants}
                    initial="hidden"
                    whileInView="visible"
                    viewport={{ once: true, margin: '-50px' }}
                    className={`col-span-12 ${tabletSpan} ${desktopSpan}`}
                  >
                    <MosaicCard
                      item={item}
                      priority={item.id === firstCardId}
                    />
                  </motion.div>
                );
              })}
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}'use client';

import React, { useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X } from 'lucide-react';
import { PortfolioProject } from '@/types/project';
import { createPortal } from 'react-dom';
import { useBodyLock } from '@/hooks/useBodyLock';

import TypeAContent from './content/TypeAContent';
import TypeBContent from './content/TypeBContent';


interface PortfolioModalProps {
  isOpen: boolean;
  onClose: () => void;
  project: PortfolioProject | null;
}

export const PortfolioModal = ({ isOpen, onClose, project }: PortfolioModalProps) => {
  useBodyLock(isOpen);

  // Close on escape
  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => {
      if (e.key === 'Escape') onClose();
    };
    window.addEventListener('keydown', handleEsc);
    return () => window.removeEventListener('keydown', handleEsc);
  }, [onClose]);

  if (!isOpen || !project) return null;

  return createPortal(
    <AnimatePresence>
      {isOpen && (
        <>
          {/* Backdrop - 0.18s linear */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.18, ease: 'linear' }}
            onClick={onClose}
            className="fixed inset-0 z-990 bg-black/90 backdrop-blur-md"
          />

          {/* Container - 0.26s ease (delay 0.12s) */}
          <motion.div
            initial={{ opacity: 0, y: 100, scale: 0.95 }}
            animate={{ opacity: 1, y: 0, scale: 1 }}
            exit={{ opacity: 0, y: 100, scale: 0.95 }}
            transition={{ 
                duration: 0.26, 
                ease: [0.22, 1, 0.36, 1],
                delay: 0.12 
            }}
            className="fixed inset-0 z-995 overflow-y-auto"
          >
             <button 
                onClick={onClose}
                aria-label="Fechar galeria"
                className="fixed top-6 right-6 z-1000 flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-white backdrop-blur transition-colors hover:bg-white/20"
             >
                <X size={24} />
             </button>

             {/* Content Stagger starting from 0.52s (0.12 + 0.26 + leeway or just direct delay) */}
             <motion.div
               initial={{ opacity: 0, y: 20 }}
               animate={{ opacity: 1, y: 0 }}
               transition={{ delay: 0.52, duration: 0.4 }}
               className="min-h-full w-full"
             >
                 {project.type === 'A' ? (
                    <TypeAContent project={project} />
                 ) : (
                    <TypeBContent project={project} />
                 )}
             </motion.div>
          </motion.div>
        </>
      )}
    </AnimatePresence>,
    document.body
  );
};
'use client';

import React, { useRef } from 'react';
import { useLERPScroll } from '@/hooks/useLERPScroll';
import { ProjectCard } from './ProjectCard';
import { PortfolioProject } from '@/types/project';

// MOCK DATA - Replace with real data or imports later
const PROJECTS: PortfolioProject[] = [
  {
    id: '1',
    slug: 'garoto-nestle',
    title: 'Garoto Nestlé',
    client: 'Nestlé',
    category: 'branding',
    displayCategory: 'Branding',
    year: 2024,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/projects/campaign/cover.webp',
    type: 'B',
    layout: { cols: 'col-span-1', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Rebranding completo para uma das maiores marcas de chocolate do Brasil.',
    },
    tags: ['Branding', 'Packaging']
  },
  {
    id: '2',
    slug: 'nescafe',
    title: 'Nescafé',
    client: 'Nestlé',
    category: 'web',
    displayCategory: 'Web Design',
    year: 2023,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/portfolio-media/projects/creative-direction/hero.webp',
    type: 'B',
    layout: { cols: 'col-span-1', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Campanha digital global com foco em sustentabilidade.',
    },
    tags: ['Web', 'Campaign']
  },
  {
    id: '3',
    slug: 'mpdv',
    title: 'MPDV',
    client: 'MPDV',
    category: 'institucional',
    displayCategory: 'Institucional',
    year: 2023,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/projects/key-visual/cover.webp',
    type: 'A',
    layout: { cols: 'col-span-2', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Plataforma de inteligência de dados para varejo.',
    },
    tags: ['Product', 'UI/UX']
  },
  {
    id: '4',
    slug: 'swift',
    title: 'Swift',
    client: 'JBS',
    category: 'motion',
    displayCategory: 'Motion',
    year: 2022,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/portfolio-media/projects/brand_video/hero.png',
    type: 'B',
    layout: { cols: 'col-span-1', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Série de vídeos em motion graphics para mídias sociais.',
    },
    tags: ['Motion', 'Social']
  },
  {
    id: '5',
    slug: 'ambev',
    title: 'Ambev Tech',
    client: 'Ambev',
    category: 'web',
    displayCategory: 'Web',
    year: 2024,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/home/showcase/Key-Visual.webp',
    type: 'A',
    layout: { cols: 'col-span-1', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Portal corporativo para talentos tech.',
    },
    tags: ['Web', 'Dev']
  },
  {
    id: '6',
    slug: 'unilever',
    title: 'Unilever',
    client: 'Unilever',
    category: 'institucional',
    displayCategory: 'Accessibility',
    year: 2023,
    image: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/home/showcase/Branding-Project.webp',
    type: 'B',
    layout: { cols: 'col-span-1', height: 'h-[400px]', colsMobile: 'col-span-1' },
    detail: {
      description: 'Consultoria de acessibilidade e performance.',
    },
    tags: ['Consultoria', 'A11y']
  }
];

interface ProjectsGalleryProps {
  onOpenProject?: (_project: PortfolioProject) => void;
}

export const ProjectsGallery = ({ onOpenProject }: ProjectsGalleryProps) => {
  const trackRef = useRef<HTMLDivElement>(null);

  // Initialize LERP Scroll
  // The hook attaches height to .gallery (we need to make sure the parent has this class or we pass a ref)
  const { galleryRef } = useLERPScroll(trackRef);

  return (
    <div
      className="gallery relative z-0 w-full"
      ref={galleryRef as React.RefObject<HTMLDivElement>}
    >
      <div
        ref={trackRef}
        className="fixed top-0 left-0 w-full will-change-transform"
      >
        <div className="std-grid py-24 sm:py-32">
          <div className="col-span-full grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 md:gap-8">
            {PROJECTS.map((project, index) => (
              <div key={project.id} className="w-full">
                <ProjectCard
                  project={project}
                  index={index}
                  onClick={onOpenProject}
                  priority={index < 3}
                />
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};
.galleryWrap {
  display: flex;
  width: 100%;
  min-height: 60vh;
  overflow: hidden;
  position: relative;
}

.item {
  flex: 1 1 0;
  min-width: 0;
  border: none;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  transition: flex 0.6s ease, transform 0.35s ease;
  cursor: pointer;
  outline: none;
}

.item:hover,
.item:focus-visible {
  flex: 5 1 0;
  transform: scale(1.01);
}

.item + .item {
  border-left: 2px solid rgba(15, 23, 42, 0.05);
}

.item:focus-visible {
  box-shadow: inset 0 0 0 2px rgba(0, 87, 255, 0.4);
}

@media (max-width: 768px) {
  .galleryWrap {
    flex-direction: column;
    min-height: 70vh;
  }

  .item {
    width: 100%;
    min-height: 200px;
    border: none;
    flex: 1 !important;
  }

  .item + .item {
    border-left: none;
    border-top: 1px solid rgba(15, 23, 42, 0.08);
  }
}'use client';

import React, { useEffect, useState } from 'react';
import { motion } from 'framer-motion';
import { useAntigravityStore } from '@/store/antigravity.store';

export const AntigravityDebugger: React.FC = () => {
  const [mounted, setMounted] = useState(false);
  const store = useAntigravityStore();

  useEffect(() => {
    setMounted(true);
  }, []);

  if (
    !mounted ||
    process.env.NODE_ENV !== 'development' ||
    !store.flags.debugMode
  ) {
    return null;
  }

  return (
    <div className="fixed bottom-4 right-4 z-9999 bg-black/90 text-[10px] font-mono p-3 rounded-lg border border-white/10 shadow-2xl backdrop-blur-md text-white w-52">
      <div className="mb-2 uppercase tracking-wider text-neutral-500 font-bold border-b border-white/10 pb-1 flex justify-between">
        Antigravity System
        <span className="text-green-500">●</span>
      </div>

      {/* Narrative State */}
      <div className="mb-3">
        <label className="text-neutral-500 block">Narrative State</label>
        <div className="text-blue-400 font-bold text-xs">
          {store.narrativeState}
        </div>
        <div className="w-full bg-neutral-800 h-1 mt-1 rounded overflow-hidden">
          <motion.div
            className="bg-blue-500 h-full"
            style={{ width: `${store.scrollProgress * 100}%` }}
            transition={{ duration: 0.075, ease: 'linear' }} // Slight smooth
          />
        </div>
      </div>

      {/* Flags Grid */}
      <div className="grid grid-cols-2 gap-2 mb-3">
        <FlagStatus label="WebGL" active={store.flags.mountWebGL} />
        <FlagStatus
          label="Manifesto"
          active={store.flags.enableManifestoScroll}
        />
        <FlagStatus
          label="Hover"
          active={store.flags.enableHoverInteractions}
        />
        <FlagStatus
          label="Reduced Motion"
          active={store.flags.reducedMotion}
          bg="bg-red-500"
        />
      </div>

      {/* Viewport */}
      <div>
        <label className="text-neutral-500 block">Viewport</label>
        <span className="text-neutral-300">
          {store.viewport.width}px × {store.viewport.height}px
        </span>
      </div>
    </div>
  );
};

const FlagStatus = ({
  label,
  active,
  bg = 'bg-green-500',
}: {
  label: string;
  active: boolean;
  bg?: string;
}) => (
  <div className="flex items-center justify-between bg-white/5 p-1 px-2 rounded">
    <span>{label}</span>
    <div className={`w-2 h-2 rounded-full ${active ? bg : 'bg-neutral-700'}`} />
  </div>
);
const { queryRef, executeQuery, mutationRef, executeMutation, validateArgs } = require('firebase/data-connect');

const connectorConfig = {
  connector: 'gemini-test',
  service: 'portfolio-danilo-novais-service',
  location: 'southamerica-west1'
};
exports.connectorConfig = connectorConfig;

const createUserRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'CreateUser', inputVars);
}
createUserRef.operationName = 'CreateUser';
exports.createUserRef = createUserRef;

exports.createUser = function createUser(dcOrVars, vars) {
  return executeMutation(createUserRef(dcOrVars, vars));
};

const getProjectsByUserRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return queryRef(dcInstance, 'GetProjectsByUser', inputVars);
}
getProjectsByUserRef.operationName = 'GetProjectsByUser';
exports.getProjectsByUserRef = getProjectsByUserRef;

exports.getProjectsByUser = function getProjectsByUser(dcOrVars, vars) {
  return executeQuery(getProjectsByUserRef(dcOrVars, vars));
};

const createProjectRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'CreateProject', inputVars);
}
createProjectRef.operationName = 'CreateProject';
exports.createProjectRef = createProjectRef;

exports.createProject = function createProject(dcOrVars, vars) {
  return executeMutation(createProjectRef(dcOrVars, vars));
};

const deleteProjectRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'DeleteProject', inputVars);
}
deleteProjectRef.operationName = 'DeleteProject';
exports.deleteProjectRef = deleteProjectRef;

exports.deleteProject = function deleteProject(dcOrVars, vars) {
  return executeMutation(deleteProjectRef(dcOrVars, vars));
};
import { queryRef, executeQuery, mutationRef, executeMutation, validateArgs } from 'firebase/data-connect';

export const connectorConfig = {
  connector: 'gemini-test',
  service: 'portfolio-danilo-novais-service',
  location: 'southamerica-west1'
};

export const createUserRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'CreateUser', inputVars);
}
createUserRef.operationName = 'CreateUser';

export function createUser(dcOrVars, vars) {
  return executeMutation(createUserRef(dcOrVars, vars));
}

export const getProjectsByUserRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return queryRef(dcInstance, 'GetProjectsByUser', inputVars);
}
getProjectsByUserRef.operationName = 'GetProjectsByUser';

export function getProjectsByUser(dcOrVars, vars) {
  return executeQuery(getProjectsByUserRef(dcOrVars, vars));
}

export const createProjectRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'CreateProject', inputVars);
}
createProjectRef.operationName = 'CreateProject';

export function createProject(dcOrVars, vars) {
  return executeMutation(createProjectRef(dcOrVars, vars));
}

export const deleteProjectRef = (dcOrVars, vars) => {
  const { dc: dcInstance, vars: inputVars} = validateArgs(connectorConfig, dcOrVars, vars, true);
  dcInstance._useGeneratedSdk();
  return mutationRef(dcInstance, 'DeleteProject', inputVars);
}
deleteProjectRef.operationName = 'DeleteProject';

export function deleteProject(dcOrVars, vars) {
  return executeMutation(deleteProjectRef(dcOrVars, vars));
}

{"type":"module"}# Generated TypeScript README
This README will guide you through the process of using the generated JavaScript SDK package for the connector `gemini-test`. It will also provide examples on how to use your generated SDK to call your Data Connect queries and mutations.

**If you're looking for the `React README`, you can find it at [`dataconnect-generated/react/README.md`](./react/README.md)**

***NOTE:** This README is generated alongside the generated SDK. If you make changes to this file, they will be overwritten when the SDK is regenerated.*

# Table of Contents
- [**Overview**](#generated-javascript-readme)
- [**Accessing the connector**](#accessing-the-connector)
  - [*Connecting to the local Emulator*](#connecting-to-the-local-emulator)
- [**Queries**](#queries)
  - [*GetProjectsByUser*](#getprojectsbyuser)
- [**Mutations**](#mutations)
  - [*CreateUser*](#createuser)
  - [*CreateProject*](#createproject)
  - [*DeleteProject*](#deleteproject)

# Accessing the connector
A connector is a collection of Queries and Mutations. One SDK is generated for each connector - this SDK is generated for the connector `gemini-test`. You can find more information about connectors in the [Data Connect documentation](https://firebase.google.com/docs/data-connect#how-does).

You can use this generated SDK by importing from the package `@dataconnect/generated` as shown below. Both CommonJS and ESM imports are supported.

You can also follow the instructions from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#set-client).

```typescript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig } from '@dataconnect/generated';

const dataConnect = getDataConnect(connectorConfig);
```

## Connecting to the local Emulator
By default, the connector will connect to the production service.

To connect to the emulator, you can use the following code.
You can also follow the emulator instructions from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#instrument-clients).

```typescript
import { connectDataConnectEmulator, getDataConnect } from 'firebase/data-connect';
import { connectorConfig } from '@dataconnect/generated';

const dataConnect = getDataConnect(connectorConfig);
connectDataConnectEmulator(dataConnect, 'localhost', 9399);
```

After it's initialized, you can call your Data Connect [queries](#queries) and [mutations](#mutations) from your generated SDK.

# Queries

There are two ways to execute a Data Connect Query using the generated Web SDK:
- Using a Query Reference function, which returns a `QueryRef`
  - The `QueryRef` can be used as an argument to `executeQuery()`, which will execute the Query and return a `QueryPromise`
- Using an action shortcut function, which returns a `QueryPromise`
  - Calling the action shortcut function will execute the Query and return a `QueryPromise`

The following is true for both the action shortcut function and the `QueryRef` function:
- The `QueryPromise` returned will resolve to the result of the Query once it has finished executing
- If the Query accepts arguments, both the action shortcut function and the `QueryRef` function accept a single argument: an object that contains all the required variables (and the optional variables) for the Query
- Both functions can be called with or without passing in a `DataConnect` instance as an argument. If no `DataConnect` argument is passed in, then the generated SDK will call `getDataConnect(connectorConfig)` behind the scenes for you.

Below are examples of how to use the `gemini-test` connector's generated functions to execute each query. You can also follow the examples from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#using-queries).

## GetProjectsByUser
You can execute the `GetProjectsByUser` query using the following action shortcut function, or by calling `executeQuery()` after calling the following `QueryRef` function, both of which are defined in [dataconnect-generated/index.d.ts](./index.d.ts):
```typescript
getProjectsByUser(vars: GetProjectsByUserVariables): QueryPromise<GetProjectsByUserData, GetProjectsByUserVariables>;

interface GetProjectsByUserRef {
  ...
  /* Allow users to create refs without passing in DataConnect */
  (vars: GetProjectsByUserVariables): QueryRef<GetProjectsByUserData, GetProjectsByUserVariables>;
}
export const getProjectsByUserRef: GetProjectsByUserRef;
```
You can also pass in a `DataConnect` instance to the action shortcut function or `QueryRef` function.
```typescript
getProjectsByUser(dc: DataConnect, vars: GetProjectsByUserVariables): QueryPromise<GetProjectsByUserData, GetProjectsByUserVariables>;

interface GetProjectsByUserRef {
  ...
  (dc: DataConnect, vars: GetProjectsByUserVariables): QueryRef<GetProjectsByUserData, GetProjectsByUserVariables>;
}
export const getProjectsByUserRef: GetProjectsByUserRef;
```

If you need the name of the operation without creating a ref, you can retrieve the operation name by calling the `operationName` property on the getProjectsByUserRef:
```typescript
const name = getProjectsByUserRef.operationName;
console.log(name);
```

### Variables
The `GetProjectsByUser` query requires an argument of type `GetProjectsByUserVariables`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:

```typescript
export interface GetProjectsByUserVariables {
  userId: UUIDString;
}
```
### Return Type
Recall that executing the `GetProjectsByUser` query returns a `QueryPromise` that resolves to an object with a `data` property.

The `data` property is an object of type `GetProjectsByUserData`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:
```typescript
export interface GetProjectsByUserData {
  projects: ({
    id: UUIDString;
    title: string;
    description: string;
  } & Project_Key)[];
}
```
### Using `GetProjectsByUser`'s action shortcut function

```typescript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, getProjectsByUser, GetProjectsByUserVariables } from '@dataconnect/generated';

// The `GetProjectsByUser` query requires an argument of type `GetProjectsByUserVariables`:
const getProjectsByUserVars: GetProjectsByUserVariables = {
  userId: ..., 
};

// Call the `getProjectsByUser()` function to execute the query.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await getProjectsByUser(getProjectsByUserVars);
// Variables can be defined inline as well.
const { data } = await getProjectsByUser({ userId: ..., });

// You can also pass in a `DataConnect` instance to the action shortcut function.
const dataConnect = getDataConnect(connectorConfig);
const { data } = await getProjectsByUser(dataConnect, getProjectsByUserVars);

console.log(data.projects);

// Or, you can use the `Promise` API.
getProjectsByUser(getProjectsByUserVars).then((response) => {
  const data = response.data;
  console.log(data.projects);
});
```

### Using `GetProjectsByUser`'s `QueryRef` function

```typescript
import { getDataConnect, executeQuery } from 'firebase/data-connect';
import { connectorConfig, getProjectsByUserRef, GetProjectsByUserVariables } from '@dataconnect/generated';

// The `GetProjectsByUser` query requires an argument of type `GetProjectsByUserVariables`:
const getProjectsByUserVars: GetProjectsByUserVariables = {
  userId: ..., 
};

// Call the `getProjectsByUserRef()` function to get a reference to the query.
const ref = getProjectsByUserRef(getProjectsByUserVars);
// Variables can be defined inline as well.
const ref = getProjectsByUserRef({ userId: ..., });

// You can also pass in a `DataConnect` instance to the `QueryRef` function.
const dataConnect = getDataConnect(connectorConfig);
const ref = getProjectsByUserRef(dataConnect, getProjectsByUserVars);

// Call `executeQuery()` on the reference to execute the query.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await executeQuery(ref);

console.log(data.projects);

// Or, you can use the `Promise` API.
executeQuery(ref).then((response) => {
  const data = response.data;
  console.log(data.projects);
});
```

# Mutations

There are two ways to execute a Data Connect Mutation using the generated Web SDK:
- Using a Mutation Reference function, which returns a `MutationRef`
  - The `MutationRef` can be used as an argument to `executeMutation()`, which will execute the Mutation and return a `MutationPromise`
- Using an action shortcut function, which returns a `MutationPromise`
  - Calling the action shortcut function will execute the Mutation and return a `MutationPromise`

The following is true for both the action shortcut function and the `MutationRef` function:
- The `MutationPromise` returned will resolve to the result of the Mutation once it has finished executing
- If the Mutation accepts arguments, both the action shortcut function and the `MutationRef` function accept a single argument: an object that contains all the required variables (and the optional variables) for the Mutation
- Both functions can be called with or without passing in a `DataConnect` instance as an argument. If no `DataConnect` argument is passed in, then the generated SDK will call `getDataConnect(connectorConfig)` behind the scenes for you.

Below are examples of how to use the `gemini-test` connector's generated functions to execute each mutation. You can also follow the examples from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#using-mutations).

## CreateUser
You can execute the `CreateUser` mutation using the following action shortcut function, or by calling `executeMutation()` after calling the following `MutationRef` function, both of which are defined in [dataconnect-generated/index.d.ts](./index.d.ts):
```typescript
createUser(vars: CreateUserVariables): MutationPromise<CreateUserData, CreateUserVariables>;

interface CreateUserRef {
  ...
  /* Allow users to create refs without passing in DataConnect */
  (vars: CreateUserVariables): MutationRef<CreateUserData, CreateUserVariables>;
}
export const createUserRef: CreateUserRef;
```
You can also pass in a `DataConnect` instance to the action shortcut function or `MutationRef` function.
```typescript
createUser(dc: DataConnect, vars: CreateUserVariables): MutationPromise<CreateUserData, CreateUserVariables>;

interface CreateUserRef {
  ...
  (dc: DataConnect, vars: CreateUserVariables): MutationRef<CreateUserData, CreateUserVariables>;
}
export const createUserRef: CreateUserRef;
```

If you need the name of the operation without creating a ref, you can retrieve the operation name by calling the `operationName` property on the createUserRef:
```typescript
const name = createUserRef.operationName;
console.log(name);
```

### Variables
The `CreateUser` mutation requires an argument of type `CreateUserVariables`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:

```typescript
export interface CreateUserVariables {
  email: string;
  name: string;
  password: string;
}
```
### Return Type
Recall that executing the `CreateUser` mutation returns a `MutationPromise` that resolves to an object with a `data` property.

The `data` property is an object of type `CreateUserData`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:
```typescript
export interface CreateUserData {
  user_insert: User_Key;
}
```
### Using `CreateUser`'s action shortcut function

```typescript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, createUser, CreateUserVariables } from '@dataconnect/generated';

// The `CreateUser` mutation requires an argument of type `CreateUserVariables`:
const createUserVars: CreateUserVariables = {
  email: ..., 
  name: ..., 
  password: ..., 
};

// Call the `createUser()` function to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await createUser(createUserVars);
// Variables can be defined inline as well.
const { data } = await createUser({ email: ..., name: ..., password: ..., });

// You can also pass in a `DataConnect` instance to the action shortcut function.
const dataConnect = getDataConnect(connectorConfig);
const { data } = await createUser(dataConnect, createUserVars);

console.log(data.user_insert);

// Or, you can use the `Promise` API.
createUser(createUserVars).then((response) => {
  const data = response.data;
  console.log(data.user_insert);
});
```

### Using `CreateUser`'s `MutationRef` function

```typescript
import { getDataConnect, executeMutation } from 'firebase/data-connect';
import { connectorConfig, createUserRef, CreateUserVariables } from '@dataconnect/generated';

// The `CreateUser` mutation requires an argument of type `CreateUserVariables`:
const createUserVars: CreateUserVariables = {
  email: ..., 
  name: ..., 
  password: ..., 
};

// Call the `createUserRef()` function to get a reference to the mutation.
const ref = createUserRef(createUserVars);
// Variables can be defined inline as well.
const ref = createUserRef({ email: ..., name: ..., password: ..., });

// You can also pass in a `DataConnect` instance to the `MutationRef` function.
const dataConnect = getDataConnect(connectorConfig);
const ref = createUserRef(dataConnect, createUserVars);

// Call `executeMutation()` on the reference to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await executeMutation(ref);

console.log(data.user_insert);

// Or, you can use the `Promise` API.
executeMutation(ref).then((response) => {
  const data = response.data;
  console.log(data.user_insert);
});
```

## CreateProject
You can execute the `CreateProject` mutation using the following action shortcut function, or by calling `executeMutation()` after calling the following `MutationRef` function, both of which are defined in [dataconnect-generated/index.d.ts](./index.d.ts):
```typescript
createProject(vars: CreateProjectVariables): MutationPromise<CreateProjectData, CreateProjectVariables>;

interface CreateProjectRef {
  ...
  /* Allow users to create refs without passing in DataConnect */
  (vars: CreateProjectVariables): MutationRef<CreateProjectData, CreateProjectVariables>;
}
export const createProjectRef: CreateProjectRef;
```
You can also pass in a `DataConnect` instance to the action shortcut function or `MutationRef` function.
```typescript
createProject(dc: DataConnect, vars: CreateProjectVariables): MutationPromise<CreateProjectData, CreateProjectVariables>;

interface CreateProjectRef {
  ...
  (dc: DataConnect, vars: CreateProjectVariables): MutationRef<CreateProjectData, CreateProjectVariables>;
}
export const createProjectRef: CreateProjectRef;
```

If you need the name of the operation without creating a ref, you can retrieve the operation name by calling the `operationName` property on the createProjectRef:
```typescript
const name = createProjectRef.operationName;
console.log(name);
```

### Variables
The `CreateProject` mutation requires an argument of type `CreateProjectVariables`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:

```typescript
export interface CreateProjectVariables {
  title: string;
  description: string;
  client?: string | null;
  link?: string | null;
  role?: string | null;
}
```
### Return Type
Recall that executing the `CreateProject` mutation returns a `MutationPromise` that resolves to an object with a `data` property.

The `data` property is an object of type `CreateProjectData`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:
```typescript
export interface CreateProjectData {
  project_insert: Project_Key;
}
```
### Using `CreateProject`'s action shortcut function

```typescript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, createProject, CreateProjectVariables } from '@dataconnect/generated';

// The `CreateProject` mutation requires an argument of type `CreateProjectVariables`:
const createProjectVars: CreateProjectVariables = {
  title: ..., 
  description: ..., 
  client: ..., // optional
  link: ..., // optional
  role: ..., // optional
};

// Call the `createProject()` function to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await createProject(createProjectVars);
// Variables can be defined inline as well.
const { data } = await createProject({ title: ..., description: ..., client: ..., link: ..., role: ..., });

// You can also pass in a `DataConnect` instance to the action shortcut function.
const dataConnect = getDataConnect(connectorConfig);
const { data } = await createProject(dataConnect, createProjectVars);

console.log(data.project_insert);

// Or, you can use the `Promise` API.
createProject(createProjectVars).then((response) => {
  const data = response.data;
  console.log(data.project_insert);
});
```

### Using `CreateProject`'s `MutationRef` function

```typescript
import { getDataConnect, executeMutation } from 'firebase/data-connect';
import { connectorConfig, createProjectRef, CreateProjectVariables } from '@dataconnect/generated';

// The `CreateProject` mutation requires an argument of type `CreateProjectVariables`:
const createProjectVars: CreateProjectVariables = {
  title: ..., 
  description: ..., 
  client: ..., // optional
  link: ..., // optional
  role: ..., // optional
};

// Call the `createProjectRef()` function to get a reference to the mutation.
const ref = createProjectRef(createProjectVars);
// Variables can be defined inline as well.
const ref = createProjectRef({ title: ..., description: ..., client: ..., link: ..., role: ..., });

// You can also pass in a `DataConnect` instance to the `MutationRef` function.
const dataConnect = getDataConnect(connectorConfig);
const ref = createProjectRef(dataConnect, createProjectVars);

// Call `executeMutation()` on the reference to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await executeMutation(ref);

console.log(data.project_insert);

// Or, you can use the `Promise` API.
executeMutation(ref).then((response) => {
  const data = response.data;
  console.log(data.project_insert);
});
```

## DeleteProject
You can execute the `DeleteProject` mutation using the following action shortcut function, or by calling `executeMutation()` after calling the following `MutationRef` function, both of which are defined in [dataconnect-generated/index.d.ts](./index.d.ts):
```typescript
deleteProject(vars: DeleteProjectVariables): MutationPromise<DeleteProjectData, DeleteProjectVariables>;

interface DeleteProjectRef {
  ...
  /* Allow users to create refs without passing in DataConnect */
  (vars: DeleteProjectVariables): MutationRef<DeleteProjectData, DeleteProjectVariables>;
}
export const deleteProjectRef: DeleteProjectRef;
```
You can also pass in a `DataConnect` instance to the action shortcut function or `MutationRef` function.
```typescript
deleteProject(dc: DataConnect, vars: DeleteProjectVariables): MutationPromise<DeleteProjectData, DeleteProjectVariables>;

interface DeleteProjectRef {
  ...
  (dc: DataConnect, vars: DeleteProjectVariables): MutationRef<DeleteProjectData, DeleteProjectVariables>;
}
export const deleteProjectRef: DeleteProjectRef;
```

If you need the name of the operation without creating a ref, you can retrieve the operation name by calling the `operationName` property on the deleteProjectRef:
```typescript
const name = deleteProjectRef.operationName;
console.log(name);
```

### Variables
The `DeleteProject` mutation requires an argument of type `DeleteProjectVariables`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:

```typescript
export interface DeleteProjectVariables {
  id: UUIDString;
}
```
### Return Type
Recall that executing the `DeleteProject` mutation returns a `MutationPromise` that resolves to an object with a `data` property.

The `data` property is an object of type `DeleteProjectData`, which is defined in [dataconnect-generated/index.d.ts](./index.d.ts). It has the following fields:
```typescript
export interface DeleteProjectData {
  project_delete?: Project_Key | null;
}
```
### Using `DeleteProject`'s action shortcut function

```typescript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, deleteProject, DeleteProjectVariables } from '@dataconnect/generated';

// The `DeleteProject` mutation requires an argument of type `DeleteProjectVariables`:
const deleteProjectVars: DeleteProjectVariables = {
  id: ..., 
};

// Call the `deleteProject()` function to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await deleteProject(deleteProjectVars);
// Variables can be defined inline as well.
const { data } = await deleteProject({ id: ..., });

// You can also pass in a `DataConnect` instance to the action shortcut function.
const dataConnect = getDataConnect(connectorConfig);
const { data } = await deleteProject(dataConnect, deleteProjectVars);

console.log(data.project_delete);

// Or, you can use the `Promise` API.
deleteProject(deleteProjectVars).then((response) => {
  const data = response.data;
  console.log(data.project_delete);
});
```

### Using `DeleteProject`'s `MutationRef` function

```typescript
import { getDataConnect, executeMutation } from 'firebase/data-connect';
import { connectorConfig, deleteProjectRef, DeleteProjectVariables } from '@dataconnect/generated';

// The `DeleteProject` mutation requires an argument of type `DeleteProjectVariables`:
const deleteProjectVars: DeleteProjectVariables = {
  id: ..., 
};

// Call the `deleteProjectRef()` function to get a reference to the mutation.
const ref = deleteProjectRef(deleteProjectVars);
// Variables can be defined inline as well.
const ref = deleteProjectRef({ id: ..., });

// You can also pass in a `DataConnect` instance to the `MutationRef` function.
const dataConnect = getDataConnect(connectorConfig);
const ref = deleteProjectRef(dataConnect, deleteProjectVars);

// Call `executeMutation()` on the reference to execute the mutation.
// You can use the `await` keyword to wait for the promise to resolve.
const { data } = await executeMutation(ref);

console.log(data.project_delete);

// Or, you can use the `Promise` API.
executeMutation(ref).then((response) => {
  const data = response.data;
  console.log(data.project_delete);
});
```

{
  "name": "@dataconnect/generated",
  "version": "1.0.0",
  "author": "Firebase <firebase-support@google.com> (https://firebase.google.com/)",
  "description": "Generated SDK For gemini-test",
  "license": "Apache-2.0",
  "engines": {
    "node": " >=18.0"
  },
  "typings": "index.d.ts",
  "module": "esm/index.esm.js",
  "main": "index.cjs.js",
  "browser": "esm/index.esm.js",
  "exports": {
    ".": {
      "types": "./index.d.ts",
      "require": "./index.cjs.js",
      "default": "./esm/index.esm.js"
    },
    "./react": {
      "types": "./react/index.d.ts",
      "require": "./react/index.cjs.js",
      "import": "./react/esm/index.esm.js",
      "default": "./react/esm/index.esm.js"
    },
    "./package.json": "./package.json"
  },
  "peerDependencies": {
    "firebase": "^11.3.0 || ^12.0.0",
    "@tanstack-query-firebase/react": "^2.0.0"
  }
}import { ConnectorConfig, DataConnect, QueryRef, QueryPromise, MutationRef, MutationPromise } from 'firebase/data-connect';

export const connectorConfig: ConnectorConfig;

export type TimestampString = string;
export type UUIDString = string;
export type Int64String = string;
export type DateString = string;




export interface CreateProjectData {
  project_insert: Project_Key;
}

export interface CreateProjectVariables {
  title: string;
  description: string;
  client?: string | null;
  link?: string | null;
  role?: string | null;
}

export interface CreateUserData {
  user_insert: User_Key;
}

export interface CreateUserVariables {
  email: string;
  name: string;
  password: string;
}

export interface DeleteProjectData {
  project_delete?: Project_Key | null;
}

export interface DeleteProjectVariables {
  id: UUIDString;
}

export interface GetProjectsByUserData {
  projects: ({
    id: UUIDString;
    title: string;
    description: string;
  } & Project_Key)[];
}

export interface GetProjectsByUserVariables {
  userId: UUIDString;
}

export interface Image_Key {
  id: UUIDString;
  __typename?: 'Image_Key';
}

export interface ProjectSkill_Key {
  projectId: UUIDString;
  skillId: UUIDString;
  __typename?: 'ProjectSkill_Key';
}

export interface Project_Key {
  id: UUIDString;
  __typename?: 'Project_Key';
}

export interface Skill_Key {
  id: UUIDString;
  __typename?: 'Skill_Key';
}

export interface User_Key {
  id: UUIDString;
  __typename?: 'User_Key';
}

interface CreateUserRef {
  /* Allow users to create refs without passing in DataConnect */
  (vars: CreateUserVariables): MutationRef<CreateUserData, CreateUserVariables>;
  /* Allow users to pass in custom DataConnect instances */
  (dc: DataConnect, vars: CreateUserVariables): MutationRef<CreateUserData, CreateUserVariables>;
  operationName: string;
}
export const createUserRef: CreateUserRef;

export function createUser(vars: CreateUserVariables): MutationPromise<CreateUserData, CreateUserVariables>;
export function createUser(dc: DataConnect, vars: CreateUserVariables): MutationPromise<CreateUserData, CreateUserVariables>;

interface GetProjectsByUserRef {
  /* Allow users to create refs without passing in DataConnect */
  (vars: GetProjectsByUserVariables): QueryRef<GetProjectsByUserData, GetProjectsByUserVariables>;
  /* Allow users to pass in custom DataConnect instances */
  (dc: DataConnect, vars: GetProjectsByUserVariables): QueryRef<GetProjectsByUserData, GetProjectsByUserVariables>;
  operationName: string;
}
export const getProjectsByUserRef: GetProjectsByUserRef;

export function getProjectsByUser(vars: GetProjectsByUserVariables): QueryPromise<GetProjectsByUserData, GetProjectsByUserVariables>;
export function getProjectsByUser(dc: DataConnect, vars: GetProjectsByUserVariables): QueryPromise<GetProjectsByUserData, GetProjectsByUserVariables>;

interface CreateProjectRef {
  /* Allow users to create refs without passing in DataConnect */
  (vars: CreateProjectVariables): MutationRef<CreateProjectData, CreateProjectVariables>;
  /* Allow users to pass in custom DataConnect instances */
  (dc: DataConnect, vars: CreateProjectVariables): MutationRef<CreateProjectData, CreateProjectVariables>;
  operationName: string;
}
export const createProjectRef: CreateProjectRef;

export function createProject(vars: CreateProjectVariables): MutationPromise<CreateProjectData, CreateProjectVariables>;
export function createProject(dc: DataConnect, vars: CreateProjectVariables): MutationPromise<CreateProjectData, CreateProjectVariables>;

interface DeleteProjectRef {
  /* Allow users to create refs without passing in DataConnect */
  (vars: DeleteProjectVariables): MutationRef<DeleteProjectData, DeleteProjectVariables>;
  /* Allow users to pass in custom DataConnect instances */
  (dc: DataConnect, vars: DeleteProjectVariables): MutationRef<DeleteProjectData, DeleteProjectVariables>;
  operationName: string;
}
export const deleteProjectRef: DeleteProjectRef;

export function deleteProject(vars: DeleteProjectVariables): MutationPromise<DeleteProjectData, DeleteProjectVariables>;
export function deleteProject(dc: DataConnect, vars: DeleteProjectVariables): MutationPromise<DeleteProjectData, DeleteProjectVariables>;

const { createUserRef, getProjectsByUserRef, createProjectRef, deleteProjectRef, connectorConfig } = require('../index.cjs.js');
const { validateArgs, CallerSdkTypeEnum } = require('firebase/data-connect');
const { useDataConnectQuery, useDataConnectMutation, validateReactArgs } = require('@tanstack-query-firebase/react/data-connect');

exports.useCreateUser = function useCreateUser(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return createUserRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}


exports.useGetProjectsByUser = function useGetProjectsByUser(dcOrVars, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts } = validateReactArgs(connectorConfig, dcOrVars, varsOrOptions, options, true, true);
  const ref = getProjectsByUserRef(dcInstance, inputVars);
  return useDataConnectQuery(ref, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}
exports.useCreateProject = function useCreateProject(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return createProjectRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}

exports.useDeleteProject = function useDeleteProject(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return deleteProjectRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}
import { createUserRef, getProjectsByUserRef, createProjectRef, deleteProjectRef, connectorConfig } from '../../esm/index.esm.js';
import { validateArgs, CallerSdkTypeEnum } from 'firebase/data-connect';
import { useDataConnectQuery, useDataConnectMutation, validateReactArgs } from '@tanstack-query-firebase/react/data-connect';

export function useCreateUser(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return createUserRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}


export function useGetProjectsByUser(dcOrVars, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts } = validateReactArgs(connectorConfig, dcOrVars, varsOrOptions, options, true, true);
  const ref = getProjectsByUserRef(dcInstance, inputVars);
  return useDataConnectQuery(ref, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}
export function useCreateProject(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return createProjectRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}

export function useDeleteProject(dcOrOptions, options) {
  const { dc: dcInstance, vars: inputOpts } = validateArgs(connectorConfig, dcOrOptions, options);
  function refFactory(vars) {
    return deleteProjectRef(dcInstance, vars);
  }
  return useDataConnectMutation(refFactory, inputOpts, CallerSdkTypeEnum.GeneratedReact);
}
{"type":"module"}# Generated React README
This README will guide you through the process of using the generated React SDK package for the connector `gemini-test`. It will also provide examples on how to use your generated SDK to call your Data Connect queries and mutations.

**If you're looking for the `JavaScript README`, you can find it at [`dataconnect-generated/README.md`](../README.md)**

***NOTE:** This README is generated alongside the generated SDK. If you make changes to this file, they will be overwritten when the SDK is regenerated.*

You can use this generated SDK by importing from the package `@dataconnect/generated/react` as shown below. Both CommonJS and ESM imports are supported.

You can also follow the instructions from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#react).

# Table of Contents
- [**Overview**](#generated-react-readme)
- [**TanStack Query Firebase & TanStack React Query**](#tanstack-query-firebase-tanstack-react-query)
  - [*Package Installation*](#installing-tanstack-query-firebase-and-tanstack-react-query-packages)
  - [*Configuring TanStack Query*](#configuring-tanstack-query)
- [**Accessing the connector**](#accessing-the-connector)
  - [*Connecting to the local Emulator*](#connecting-to-the-local-emulator)
- [**Queries**](#queries)
  - [*GetProjectsByUser*](#getprojectsbyuser)
- [**Mutations**](#mutations)
  - [*CreateUser*](#createuser)
  - [*CreateProject*](#createproject)
  - [*DeleteProject*](#deleteproject)

# TanStack Query Firebase & TanStack React Query
This SDK provides [React](https://react.dev/) hooks generated specific to your application, for the operations found in the connector `gemini-test`. These hooks are generated using [TanStack Query Firebase](https://react-query-firebase.invertase.dev/) by our partners at Invertase, a library built on top of [TanStack React Query v5](https://tanstack.com/query/v5/docs/framework/react/overview).

***You do not need to be familiar with Tanstack Query or Tanstack Query Firebase to use this SDK.*** However, you may find it useful to learn more about them, as they will empower you as a user of this Generated React SDK.

## Installing TanStack Query Firebase and TanStack React Query Packages
In order to use the React generated SDK, you must install the `TanStack React Query` and `TanStack Query Firebase` packages.
```bash
npm i --save @tanstack/react-query @tanstack-query-firebase/react
```
```bash
npm i --save firebase@latest # Note: React has a peer dependency on ^11.3.0
```

You can also follow the installation instructions from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#tanstack-install), or the [TanStack Query Firebase documentation](https://react-query-firebase.invertase.dev/react) and [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/installation).

## Configuring TanStack Query
In order to use the React generated SDK in your application, you must wrap your application's component tree in a `QueryClientProvider` component from TanStack React Query. None of your generated React SDK hooks will work without this provider.

```javascript
import { QueryClientProvider } from '@tanstack/react-query';

// Create a TanStack Query client instance
const queryClient = new QueryClient()

function App() {
  return (
    // Provide the client to your App
    <QueryClientProvider client={queryClient}>
      <MyApplication />
    </QueryClientProvider>
  )
}
```

To learn more about `QueryClientProvider`, see the [TanStack React Query documentation](https://tanstack.com/query/latest/docs/framework/react/quick-start) and the [TanStack Query Firebase documentation](https://invertase.docs.page/tanstack-query-firebase/react#usage).

# Accessing the connector
A connector is a collection of Queries and Mutations. One SDK is generated for each connector - this SDK is generated for the connector `gemini-test`.

You can find more information about connectors in the [Data Connect documentation](https://firebase.google.com/docs/data-connect#how-does).

```javascript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig } from '@dataconnect/generated';

const dataConnect = getDataConnect(connectorConfig);
```

## Connecting to the local Emulator
By default, the connector will connect to the production service.

To connect to the emulator, you can use the following code.
You can also follow the emulator instructions from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#emulator-react-angular).

```javascript
import { connectDataConnectEmulator, getDataConnect } from 'firebase/data-connect';
import { connectorConfig } from '@dataconnect/generated';

const dataConnect = getDataConnect(connectorConfig);
connectDataConnectEmulator(dataConnect, 'localhost', 9399);
```

After it's initialized, you can call your Data Connect [queries](#queries) and [mutations](#mutations) using the hooks provided from your generated React SDK.

# Queries

The React generated SDK provides Query hook functions that call and return [`useDataConnectQuery`](https://react-query-firebase.invertase.dev/react/data-connect/querying) hooks from TanStack Query Firebase.

Calling these hook functions will return a `UseQueryResult` object. This object holds the state of your Query, including whether the Query is loading, has completed, or has succeeded/failed, and the most recent data returned by the Query, among other things. To learn more about these hooks and how to use them, see the [TanStack Query Firebase documentation](https://react-query-firebase.invertase.dev/react/data-connect/querying).

TanStack React Query caches the results of your Queries, so using the same Query hook function in multiple places in your application allows the entire application to automatically see updates to that Query's data.

Query hooks execute their Queries automatically when called, and periodically refresh, unless you change the `queryOptions` for the Query. To learn how to stop a Query from automatically executing, including how to make a query "lazy", see the [TanStack React Query documentation](https://tanstack.com/query/latest/docs/framework/react/guides/disabling-queries).

To learn more about TanStack React Query's Queries, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/guides/queries).

## Using Query Hooks
Here's a general overview of how to use the generated Query hooks in your code:

- If the Query has no variables, the Query hook function does not require arguments.
- If the Query has any required variables, the Query hook function will require at least one argument: an object that contains all the required variables for the Query.
- If the Query has some required and some optional variables, only required variables are necessary in the variables argument object, and optional variables may be provided as well.
- If all of the Query's variables are optional, the Query hook function does not require any arguments.
- Query hook functions can be called with or without passing in a `DataConnect` instance as an argument. If no `DataConnect` argument is passed in, then the generated SDK will call `getDataConnect(connectorConfig)` behind the scenes for you.
- Query hooks functions can be called with or without passing in an `options` argument of type `useDataConnectQueryOptions`. To learn more about the `options` argument, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/guides/query-options).
  - ***Special case:***  If the Query has all optional variables and you would like to provide an `options` argument to the Query hook function without providing any variables, you must pass `undefined` where you would normally pass the Query's variables, and then may provide the `options` argument.

Below are examples of how to use the `gemini-test` connector's generated Query hook functions to execute each Query. You can also follow the examples from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#operations-react-angular).

## GetProjectsByUser
You can execute the `GetProjectsByUser` Query using the following Query hook function, which is defined in [dataconnect-generated/react/index.d.ts](./index.d.ts):

```javascript
useGetProjectsByUser(dc: DataConnect, vars: GetProjectsByUserVariables, options?: useDataConnectQueryOptions<GetProjectsByUserData>): UseDataConnectQueryResult<GetProjectsByUserData, GetProjectsByUserVariables>;
```
You can also pass in a `DataConnect` instance to the Query hook function.
```javascript
useGetProjectsByUser(vars: GetProjectsByUserVariables, options?: useDataConnectQueryOptions<GetProjectsByUserData>): UseDataConnectQueryResult<GetProjectsByUserData, GetProjectsByUserVariables>;
```

### Variables
The `GetProjectsByUser` Query requires an argument of type `GetProjectsByUserVariables`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:

```javascript
export interface GetProjectsByUserVariables {
  userId: UUIDString;
}
```
### Return Type
Recall that calling the `GetProjectsByUser` Query hook function returns a `UseQueryResult` object. This object holds the state of your Query, including whether the Query is loading, has completed, or has succeeded/failed, and any data returned by the Query, among other things.

To check the status of a Query, use the `UseQueryResult.status` field. You can also check for pending / success / error status using the `UseQueryResult.isPending`, `UseQueryResult.isSuccess`, and `UseQueryResult.isError` fields.

To access the data returned by a Query, use the `UseQueryResult.data` field. The data for the `GetProjectsByUser` Query is of type `GetProjectsByUserData`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:
```javascript
export interface GetProjectsByUserData {
  projects: ({
    id: UUIDString;
    title: string;
    description: string;
  } & Project_Key)[];
}
```

To learn more about the `UseQueryResult` object, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery).

### Using `GetProjectsByUser`'s Query hook function

```javascript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, GetProjectsByUserVariables } from '@dataconnect/generated';
import { useGetProjectsByUser } from '@dataconnect/generated/react'

export default function GetProjectsByUserComponent() {
  // The `useGetProjectsByUser` Query hook requires an argument of type `GetProjectsByUserVariables`:
  const getProjectsByUserVars: GetProjectsByUserVariables = {
    userId: ..., 
  };

  // You don't have to do anything to "execute" the Query.
  // Call the Query hook function to get a `UseQueryResult` object which holds the state of your Query.
  const query = useGetProjectsByUser(getProjectsByUserVars);
  // Variables can be defined inline as well.
  const query = useGetProjectsByUser({ userId: ..., });

  // You can also pass in a `DataConnect` instance to the Query hook function.
  const dataConnect = getDataConnect(connectorConfig);
  const query = useGetProjectsByUser(dataConnect, getProjectsByUserVars);

  // You can also pass in a `useDataConnectQueryOptions` object to the Query hook function.
  const options = { staleTime: 5 * 1000 };
  const query = useGetProjectsByUser(getProjectsByUserVars, options);

  // You can also pass both a `DataConnect` instance and a `useDataConnectQueryOptions` object.
  const dataConnect = getDataConnect(connectorConfig);
  const options = { staleTime: 5 * 1000 };
  const query = useGetProjectsByUser(dataConnect, getProjectsByUserVars, options);

  // Then, you can render your component dynamically based on the status of the Query.
  if (query.isPending) {
    return <div>Loading...</div>;
  }

  if (query.isError) {
    return <div>Error: {query.error.message}</div>;
  }

  // If the Query is successful, you can access the data returned using the `UseQueryResult.data` field.
  if (query.isSuccess) {
    console.log(query.data.projects);
  }
  return <div>Query execution {query.isSuccess ? 'successful' : 'failed'}!</div>;
}
```

# Mutations

The React generated SDK provides Mutations hook functions that call and return [`useDataConnectMutation`](https://react-query-firebase.invertase.dev/react/data-connect/mutations) hooks from TanStack Query Firebase.

Calling these hook functions will return a `UseMutationResult` object. This object holds the state of your Mutation, including whether the Mutation is loading, has completed, or has succeeded/failed, and the most recent data returned by the Mutation, among other things. To learn more about these hooks and how to use them, see the [TanStack Query Firebase documentation](https://react-query-firebase.invertase.dev/react/data-connect/mutations).

Mutation hooks do not execute their Mutations automatically when called. Rather, after calling the Mutation hook function and getting a `UseMutationResult` object, you must call the `UseMutationResult.mutate()` function to execute the Mutation.

To learn more about TanStack React Query's Mutations, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/guides/mutations).

## Using Mutation Hooks
Here's a general overview of how to use the generated Mutation hooks in your code:

- Mutation hook functions are not called with the arguments to the Mutation. Instead, arguments are passed to `UseMutationResult.mutate()`.
- If the Mutation has no variables, the `mutate()` function does not require arguments.
- If the Mutation has any required variables, the `mutate()` function will require at least one argument: an object that contains all the required variables for the Mutation.
- If the Mutation has some required and some optional variables, only required variables are necessary in the variables argument object, and optional variables may be provided as well.
- If all of the Mutation's variables are optional, the Mutation hook function does not require any arguments.
- Mutation hook functions can be called with or without passing in a `DataConnect` instance as an argument. If no `DataConnect` argument is passed in, then the generated SDK will call `getDataConnect(connectorConfig)` behind the scenes for you.
- Mutation hooks also accept an `options` argument of type `useDataConnectMutationOptions`. To learn more about the `options` argument, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/guides/mutations#mutation-side-effects).
  - `UseMutationResult.mutate()` also accepts an `options` argument of type `useDataConnectMutationOptions`.
  - ***Special case:*** If the Mutation has no arguments (or all optional arguments and you wish to provide none), and you want to pass `options` to `UseMutationResult.mutate()`, you must pass `undefined` where you would normally pass the Mutation's arguments, and then may provide the options argument.

Below are examples of how to use the `gemini-test` connector's generated Mutation hook functions to execute each Mutation. You can also follow the examples from the [Data Connect documentation](https://firebase.google.com/docs/data-connect/web-sdk#operations-react-angular).

## CreateUser
You can execute the `CreateUser` Mutation using the `UseMutationResult` object returned by the following Mutation hook function (which is defined in [dataconnect-generated/react/index.d.ts](./index.d.ts)):
```javascript
useCreateUser(options?: useDataConnectMutationOptions<CreateUserData, FirebaseError, CreateUserVariables>): UseDataConnectMutationResult<CreateUserData, CreateUserVariables>;
```
You can also pass in a `DataConnect` instance to the Mutation hook function.
```javascript
useCreateUser(dc: DataConnect, options?: useDataConnectMutationOptions<CreateUserData, FirebaseError, CreateUserVariables>): UseDataConnectMutationResult<CreateUserData, CreateUserVariables>;
```

### Variables
The `CreateUser` Mutation requires an argument of type `CreateUserVariables`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:

```javascript
export interface CreateUserVariables {
  email: string;
  name: string;
  password: string;
}
```
### Return Type
Recall that calling the `CreateUser` Mutation hook function returns a `UseMutationResult` object. This object holds the state of your Mutation, including whether the Mutation is loading, has completed, or has succeeded/failed, among other things.

To check the status of a Mutation, use the `UseMutationResult.status` field. You can also check for pending / success / error status using the `UseMutationResult.isPending`, `UseMutationResult.isSuccess`, and `UseMutationResult.isError` fields.

To execute the Mutation, call `UseMutationResult.mutate()`. This function executes the Mutation, but does not return the data from the Mutation.

To access the data returned by a Mutation, use the `UseMutationResult.data` field. The data for the `CreateUser` Mutation is of type `CreateUserData`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:
```javascript
export interface CreateUserData {
  user_insert: User_Key;
}
```

To learn more about the `UseMutationResult` object, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/reference/useMutation).

### Using `CreateUser`'s Mutation hook function

```javascript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, CreateUserVariables } from '@dataconnect/generated';
import { useCreateUser } from '@dataconnect/generated/react'

export default function CreateUserComponent() {
  // Call the Mutation hook function to get a `UseMutationResult` object which holds the state of your Mutation.
  const mutation = useCreateUser();

  // You can also pass in a `DataConnect` instance to the Mutation hook function.
  const dataConnect = getDataConnect(connectorConfig);
  const mutation = useCreateUser(dataConnect);

  // You can also pass in a `useDataConnectMutationOptions` object to the Mutation hook function.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useCreateUser(options);

  // You can also pass both a `DataConnect` instance and a `useDataConnectMutationOptions` object.
  const dataConnect = getDataConnect(connectorConfig);
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useCreateUser(dataConnect, options);

  // After calling the Mutation hook function, you must call `UseMutationResult.mutate()` to execute the Mutation.
  // The `useCreateUser` Mutation requires an argument of type `CreateUserVariables`:
  const createUserVars: CreateUserVariables = {
    email: ..., 
    name: ..., 
    password: ..., 
  };
  mutation.mutate(createUserVars);
  // Variables can be defined inline as well.
  mutation.mutate({ email: ..., name: ..., password: ..., });

  // You can also pass in a `useDataConnectMutationOptions` object to `UseMutationResult.mutate()`.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  mutation.mutate(createUserVars, options);

  // Then, you can render your component dynamically based on the status of the Mutation.
  if (mutation.isPending) {
    return <div>Loading...</div>;
  }

  if (mutation.isError) {
    return <div>Error: {mutation.error.message}</div>;
  }

  // If the Mutation is successful, you can access the data returned using the `UseMutationResult.data` field.
  if (mutation.isSuccess) {
    console.log(mutation.data.user_insert);
  }
  return <div>Mutation execution {mutation.isSuccess ? 'successful' : 'failed'}!</div>;
}
```

## CreateProject
You can execute the `CreateProject` Mutation using the `UseMutationResult` object returned by the following Mutation hook function (which is defined in [dataconnect-generated/react/index.d.ts](./index.d.ts)):
```javascript
useCreateProject(options?: useDataConnectMutationOptions<CreateProjectData, FirebaseError, CreateProjectVariables>): UseDataConnectMutationResult<CreateProjectData, CreateProjectVariables>;
```
You can also pass in a `DataConnect` instance to the Mutation hook function.
```javascript
useCreateProject(dc: DataConnect, options?: useDataConnectMutationOptions<CreateProjectData, FirebaseError, CreateProjectVariables>): UseDataConnectMutationResult<CreateProjectData, CreateProjectVariables>;
```

### Variables
The `CreateProject` Mutation requires an argument of type `CreateProjectVariables`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:

```javascript
export interface CreateProjectVariables {
  title: string;
  description: string;
  client?: string | null;
  link?: string | null;
  role?: string | null;
}
```
### Return Type
Recall that calling the `CreateProject` Mutation hook function returns a `UseMutationResult` object. This object holds the state of your Mutation, including whether the Mutation is loading, has completed, or has succeeded/failed, among other things.

To check the status of a Mutation, use the `UseMutationResult.status` field. You can also check for pending / success / error status using the `UseMutationResult.isPending`, `UseMutationResult.isSuccess`, and `UseMutationResult.isError` fields.

To execute the Mutation, call `UseMutationResult.mutate()`. This function executes the Mutation, but does not return the data from the Mutation.

To access the data returned by a Mutation, use the `UseMutationResult.data` field. The data for the `CreateProject` Mutation is of type `CreateProjectData`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:
```javascript
export interface CreateProjectData {
  project_insert: Project_Key;
}
```

To learn more about the `UseMutationResult` object, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/reference/useMutation).

### Using `CreateProject`'s Mutation hook function

```javascript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, CreateProjectVariables } from '@dataconnect/generated';
import { useCreateProject } from '@dataconnect/generated/react'

export default function CreateProjectComponent() {
  // Call the Mutation hook function to get a `UseMutationResult` object which holds the state of your Mutation.
  const mutation = useCreateProject();

  // You can also pass in a `DataConnect` instance to the Mutation hook function.
  const dataConnect = getDataConnect(connectorConfig);
  const mutation = useCreateProject(dataConnect);

  // You can also pass in a `useDataConnectMutationOptions` object to the Mutation hook function.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useCreateProject(options);

  // You can also pass both a `DataConnect` instance and a `useDataConnectMutationOptions` object.
  const dataConnect = getDataConnect(connectorConfig);
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useCreateProject(dataConnect, options);

  // After calling the Mutation hook function, you must call `UseMutationResult.mutate()` to execute the Mutation.
  // The `useCreateProject` Mutation requires an argument of type `CreateProjectVariables`:
  const createProjectVars: CreateProjectVariables = {
    title: ..., 
    description: ..., 
    client: ..., // optional
    link: ..., // optional
    role: ..., // optional
  };
  mutation.mutate(createProjectVars);
  // Variables can be defined inline as well.
  mutation.mutate({ title: ..., description: ..., client: ..., link: ..., role: ..., });

  // You can also pass in a `useDataConnectMutationOptions` object to `UseMutationResult.mutate()`.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  mutation.mutate(createProjectVars, options);

  // Then, you can render your component dynamically based on the status of the Mutation.
  if (mutation.isPending) {
    return <div>Loading...</div>;
  }

  if (mutation.isError) {
    return <div>Error: {mutation.error.message}</div>;
  }

  // If the Mutation is successful, you can access the data returned using the `UseMutationResult.data` field.
  if (mutation.isSuccess) {
    console.log(mutation.data.project_insert);
  }
  return <div>Mutation execution {mutation.isSuccess ? 'successful' : 'failed'}!</div>;
}
```

## DeleteProject
You can execute the `DeleteProject` Mutation using the `UseMutationResult` object returned by the following Mutation hook function (which is defined in [dataconnect-generated/react/index.d.ts](./index.d.ts)):
```javascript
useDeleteProject(options?: useDataConnectMutationOptions<DeleteProjectData, FirebaseError, DeleteProjectVariables>): UseDataConnectMutationResult<DeleteProjectData, DeleteProjectVariables>;
```
You can also pass in a `DataConnect` instance to the Mutation hook function.
```javascript
useDeleteProject(dc: DataConnect, options?: useDataConnectMutationOptions<DeleteProjectData, FirebaseError, DeleteProjectVariables>): UseDataConnectMutationResult<DeleteProjectData, DeleteProjectVariables>;
```

### Variables
The `DeleteProject` Mutation requires an argument of type `DeleteProjectVariables`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:

```javascript
export interface DeleteProjectVariables {
  id: UUIDString;
}
```
### Return Type
Recall that calling the `DeleteProject` Mutation hook function returns a `UseMutationResult` object. This object holds the state of your Mutation, including whether the Mutation is loading, has completed, or has succeeded/failed, among other things.

To check the status of a Mutation, use the `UseMutationResult.status` field. You can also check for pending / success / error status using the `UseMutationResult.isPending`, `UseMutationResult.isSuccess`, and `UseMutationResult.isError` fields.

To execute the Mutation, call `UseMutationResult.mutate()`. This function executes the Mutation, but does not return the data from the Mutation.

To access the data returned by a Mutation, use the `UseMutationResult.data` field. The data for the `DeleteProject` Mutation is of type `DeleteProjectData`, which is defined in [dataconnect-generated/index.d.ts](../index.d.ts). It has the following fields:
```javascript
export interface DeleteProjectData {
  project_delete?: Project_Key | null;
}
```

To learn more about the `UseMutationResult` object, see the [TanStack React Query documentation](https://tanstack.com/query/v5/docs/framework/react/reference/useMutation).

### Using `DeleteProject`'s Mutation hook function

```javascript
import { getDataConnect } from 'firebase/data-connect';
import { connectorConfig, DeleteProjectVariables } from '@dataconnect/generated';
import { useDeleteProject } from '@dataconnect/generated/react'

export default function DeleteProjectComponent() {
  // Call the Mutation hook function to get a `UseMutationResult` object which holds the state of your Mutation.
  const mutation = useDeleteProject();

  // You can also pass in a `DataConnect` instance to the Mutation hook function.
  const dataConnect = getDataConnect(connectorConfig);
  const mutation = useDeleteProject(dataConnect);

  // You can also pass in a `useDataConnectMutationOptions` object to the Mutation hook function.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useDeleteProject(options);

  // You can also pass both a `DataConnect` instance and a `useDataConnectMutationOptions` object.
  const dataConnect = getDataConnect(connectorConfig);
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  const mutation = useDeleteProject(dataConnect, options);

  // After calling the Mutation hook function, you must call `UseMutationResult.mutate()` to execute the Mutation.
  // The `useDeleteProject` Mutation requires an argument of type `DeleteProjectVariables`:
  const deleteProjectVars: DeleteProjectVariables = {
    id: ..., 
  };
  mutation.mutate(deleteProjectVars);
  // Variables can be defined inline as well.
  mutation.mutate({ id: ..., });

  // You can also pass in a `useDataConnectMutationOptions` object to `UseMutationResult.mutate()`.
  const options = {
    onSuccess: () => { console.log('Mutation succeeded!'); }
  };
  mutation.mutate(deleteProjectVars, options);

  // Then, you can render your component dynamically based on the status of the Mutation.
  if (mutation.isPending) {
    return <div>Loading...</div>;
  }

  if (mutation.isError) {
    return <div>Error: {mutation.error.message}</div>;
  }

  // If the Mutation is successful, you can access the data returned using the `UseMutationResult.data` field.
  if (mutation.isSuccess) {
    console.log(mutation.data.project_delete);
  }
  return <div>Mutation execution {mutation.isSuccess ? 'successful' : 'failed'}!</div>;
}
```

{
  "name": "@dataconnect/generated-react",
  "version": "1.0.0",
  "author": "Firebase <firebase-support@google.com> (https://firebase.google.com/)",
  "description": "Generated SDK For gemini-test",
  "license": "Apache-2.0",
  "engines": {
    "node": " >=18.0"
  },
  "typings": "index.d.ts",
  "main": "index.cjs.js",
  "module": "esm/index.esm.js",
  "browser": "esm/index.esm.js",
  "peerDependencies": {
    "@tanstack-query-firebase/react": "^2.0.0"
  }
}import { CreateUserData, CreateUserVariables, GetProjectsByUserData, GetProjectsByUserVariables, CreateProjectData, CreateProjectVariables, DeleteProjectData, DeleteProjectVariables } from '../';
import { UseDataConnectQueryResult, useDataConnectQueryOptions, UseDataConnectMutationResult, useDataConnectMutationOptions} from '@tanstack-query-firebase/react/data-connect';
import { UseQueryResult, UseMutationResult} from '@tanstack/react-query';
import { DataConnect } from 'firebase/data-connect';
import { FirebaseError } from 'firebase/app';


export function useCreateUser(options?: useDataConnectMutationOptions<CreateUserData, FirebaseError, CreateUserVariables>): UseDataConnectMutationResult<CreateUserData, CreateUserVariables>;
export function useCreateUser(dc: DataConnect, options?: useDataConnectMutationOptions<CreateUserData, FirebaseError, CreateUserVariables>): UseDataConnectMutationResult<CreateUserData, CreateUserVariables>;

export function useGetProjectsByUser(vars: GetProjectsByUserVariables, options?: useDataConnectQueryOptions<GetProjectsByUserData>): UseDataConnectQueryResult<GetProjectsByUserData, GetProjectsByUserVariables>;
export function useGetProjectsByUser(dc: DataConnect, vars: GetProjectsByUserVariables, options?: useDataConnectQueryOptions<GetProjectsByUserData>): UseDataConnectQueryResult<GetProjectsByUserData, GetProjectsByUserVariables>;

export function useCreateProject(options?: useDataConnectMutationOptions<CreateProjectData, FirebaseError, CreateProjectVariables>): UseDataConnectMutationResult<CreateProjectData, CreateProjectVariables>;
export function useCreateProject(dc: DataConnect, options?: useDataConnectMutationOptions<CreateProjectData, FirebaseError, CreateProjectVariables>): UseDataConnectMutationResult<CreateProjectData, CreateProjectVariables>;

export function useDeleteProject(options?: useDataConnectMutationOptions<DeleteProjectData, FirebaseError, DeleteProjectVariables>): UseDataConnectMutationResult<DeleteProjectData, DeleteProjectVariables>;
export function useDeleteProject(dc: DataConnect, options?: useDataConnectMutationOptions<DeleteProjectData, FirebaseError, DeleteProjectVariables>): UseDataConnectMutationResult<DeleteProjectData, DeleteProjectVariables>;
'use client';

import { useEffect, useRef } from 'react';
import { useScroll, useTransform, useSpring } from 'framer-motion';
import { useMotionGate } from '@/hooks/useMotionGate';

/**
 * Linear Interpolation Function
 */
export function lerp(start: number, end: number, t: number) {
  return start * (1 - t) + end * t;
}

interface UseParallaxReturn {
  galleryRef: React.RefObject<HTMLDivElement | null>;
  trackRef: React.RefObject<HTMLDivElement | null>;
  y: number; // Current Y position (interpolated)
}

/**
 * Hook de Parallax Engine (Lerp Loop)
 * Gerencia o scroll suave customizado com requestAnimationFrame.
 */
export function useParallax(): UseParallaxReturn {
  const galleryRef = useRef<HTMLDivElement>(null);
  const trackRef = useRef<HTMLDivElement>(null);
  const shouldReduceMotion = useMotionGate();

  // Refs for state to avoid re-renders in the loop
  const state = useRef({
    current: 0,
    target: 0,
    isResizing: false,
  });

  useEffect(() => {
    if (shouldReduceMotion) return;

    const gallery = galleryRef.current;
    const track = trackRef.current;
    const isMobile = window.innerWidth < 1024; // Simple mobile check

    // Disable on mobile if desired, or keep generic
    if (isMobile) return;

    // Helper to update body height to match track height (since track is fixed)
    const updateHeight = () => {
      if (track && gallery) {
        document.body.style.height = `${track.getBoundingClientRect().height}px`;
      }
    };

    const onScroll = () => {
      state.current.target = window.scrollY;
    };

    const onResize = () => {
      state.current.isResizing = true;
      updateHeight();
      state.current.isResizing = false;
    };

    window.addEventListener('scroll', onScroll);
    window.addEventListener('resize', onResize);

    // Initial size set
    updateHeight();

    let animationFrameId: number;

    const loop = () => {
      const { current, target } = state.current;

      // Lerp logic: current moves towards target
      // Damping 0.05
      const newY = lerp(current, target, 0.05);

      // Update state
      state.current.current = newY;

      // Update transform directly for performance
      if (track) {
        // Using translate3d for GPU acceleration
        track.style.transform = `translate3d(0, -${newY}px, 0)`;
      }

      animationFrameId = requestAnimationFrame(loop);
    };

    loop();

    return () => {
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('resize', onResize);
      cancelAnimationFrame(animationFrameId);
      document.body.style.height = ''; // Reset body height
      if (track) track.style.transform = '';
    };
  }, []);

  return {
    galleryRef,
    trackRef,
    y: state.current.current,
  };
}

// =============================================================================
// Hook adicional: useParallaxElement
// Para elementos individuais com parallax (imagens dentro de cards)
// =============================================================================

interface UseParallaxElementOptions {
  /** Velocidade do parallax (0.1 = sutil, 0.5 = forte) */
  speed?: number;
  /** Direção */
  direction?: 'up' | 'down';
  /** Se deve estar ativo */
  enabled?: boolean;
}

/**
 * Hook para parallax em elementos individuais baseado na posição na tela.
 */
export function useParallaxElement<T extends HTMLElement = HTMLDivElement>(
  options: UseParallaxElementOptions = {}
) {
  const { speed = 0.2, direction = 'up', enabled = true } = options;
  const elementRef = useRef<T>(null);

  // Usamos useScroll com a própria ref do elemento
  const { scrollYProgress } = useScroll({
    target: elementRef as React.RefObject<HTMLElement>,
    offset: ['start end', 'end start'],
  });

  // Suavização Ghost
  const smoothProgress = useSpring(scrollYProgress, {
    stiffness: 100,
    damping: 30,
    restDelta: 0.001,
  });

  // Transforma o progresso em offset
  // Em 0 (entra na tela), offset é X. Em 1 (sai), offset é -X.
  const offset = useTransform(
    smoothProgress,
    [0, 1],
    direction === 'up' ? [20 * speed, -20 * speed] : [-20 * speed, 20 * speed]
    // Note: Since we are using framer-motion values here, this returns a MotionValue
  );

  return {
    ref: elementRef,
    style: {
      y: enabled ? offset : 0,
    },
  };
}
import * as React from 'react';

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(
    undefined
  );

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    };
    mql.addEventListener('change', onChange);
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    return () => mql.removeEventListener('change', onChange);
  }, []);

  return !!isMobile;
}
'use client';

import { useContext } from 'react';
import { ScrollContext } from '@/contexts/ScrollContext';

export function useLenis() {
  const context = useContext(ScrollContext);
  if (context === undefined) {
    throw new Error(
      'useLenis must be used within a ScrollContext Provider (SmoothScroll)'
    );
  }
  return context.lenis;
}
import { useRef, useState, useCallback, useLayoutEffect } from 'react';
import { gsap } from 'gsap';
import { useMotionGate } from '@/hooks/useMotionGate';

export function useMobileMenuAnimation(
  isOpen: boolean,
  onOpen: () => void,
  onClose: () => void
) {
  const motionDisabled = useMotionGate();

  // Animation refs
  const panelRef = useRef<HTMLElement>(null);
  const preLayersRef = useRef<HTMLDivElement>(null);
  const preLayerElsRef = useRef<HTMLElement[]>([]);
  const socialsRef = useRef<HTMLDivElement>(null);
  const toggleBtnRef = useRef<HTMLButtonElement>(null);

  // Icon animation refs
  const plusHRef = useRef<HTMLSpanElement>(null);
  const plusVRef = useRef<HTMLSpanElement>(null);
  const iconRef = useRef<HTMLSpanElement>(null);

  // Text animation refs
  const textInnerRef = useRef<HTMLSpanElement>(null);
  const [textLines, setTextLines] = useState<string[]>(['Menu', 'Close']);

  // Timelines
  const openTlRef = useRef<gsap.core.Timeline | null>(null);
  const closeTweenRef = useRef<gsap.core.Tween | null>(null);
  const spinTweenRef = useRef<gsap.core.Timeline | null>(null);
  const textCycleAnimRef = useRef<gsap.core.Tween | null>(null);

  const [open, setOpen] = useState(false);
  const openRef = useRef(false);

  // Initialize GSAP Context
  useLayoutEffect(() => {
    if (motionDisabled) return;

    const ctx = gsap.context(() => {
      const panel = panelRef.current;
      const preContainer = preLayersRef.current;
      const plusH = plusHRef.current;
      const plusV = plusVRef.current;
      const icon = iconRef.current;
      const textInner = textInnerRef.current;

      if (!panel || !plusH || !plusV || !icon || !textInner) return;

      let preLayers: HTMLElement[] = [];
      if (preContainer) {
        preLayers = Array.from(
          preContainer.querySelectorAll('.sm-prelayer')
        ) as HTMLElement[];
      }
      preLayerElsRef.current = preLayers;

      gsap.set([panel, ...preLayers], {
        opacity: 0,
        xPercent: 100, // Sweep starting from right
        filter: 'blur(10px)',
        pointerEvents: 'none',
      });
      gsap.set(plusH, { transformOrigin: '50% 50%', rotate: 0 });
      gsap.set(plusV, { transformOrigin: '50% 50%', rotate: 90 });
      gsap.set(icon, { rotate: 0, transformOrigin: '50% 50%' });
      gsap.set(textInner, { yPercent: 0 });
    });
    return () => ctx.revert();
  }, [motionDisabled]);

  const animateIcon = useCallback((opening: boolean) => {
    if (motionDisabled) return;
    const icon = iconRef.current;
    const h = plusHRef.current;
    const v = plusVRef.current;
    if (!icon || !h || !v) return;

    spinTweenRef.current?.kill();

    if (opening) {
      gsap.set(icon, { rotate: 0, transformOrigin: '50% 50%' });
      spinTweenRef.current = gsap
        .timeline({ defaults: { ease: 'expo.out' } })
        .to(h, { rotate: 45, duration: 0.6 }, 0)
        .to(v, { rotate: -45, duration: 0.6 }, 0);
    } else {
      spinTweenRef.current = gsap
        .timeline({ defaults: { ease: 'expo.inOut' } })
        .to(h, { rotate: 0, duration: 0.45 }, 0)
        .to(v, { rotate: 90, duration: 0.45 }, 0)
        .to(icon, { rotate: 0, duration: 0.001 }, 0);
    }
  }, []);

  const animateText = useCallback((opening: boolean) => {
    if (motionDisabled) {
      setTextLines([opening ? 'Close' : 'Menu']);
      return;
    }

    const inner = textInnerRef.current;
    if (!inner) return;

    textCycleAnimRef.current?.kill();

    const currentLabel = opening ? 'Menu' : 'Close';
    const targetLabel = opening ? 'Close' : 'Menu';
    const cycles = 1; // Reduce cycles for cleaner transition

    const seq: string[] = [currentLabel];
    let last = currentLabel;
    for (let i = 0; i < cycles; i++) {
      last = last === 'Menu' ? 'Close' : 'Menu';
    }
    seq.push(targetLabel);

    setTextLines(seq);
    gsap.set(inner, { yPercent: 0 });

    const lineCount = seq.length;
    const finalShift = ((lineCount - 1) / lineCount) * 100;

    textCycleAnimRef.current = gsap.to(inner, {
      yPercent: -finalShift,
      duration: 0.6,
      ease: 'expo.out',
    });
  }, []);

  const buildOpenTimeline = useCallback(() => {
    if (motionDisabled) return null;
    const panel = panelRef.current;
    const layers = preLayerElsRef.current;
    if (!panel) return null;

    openTlRef.current?.kill();
    closeTweenRef.current?.kill();

    const itemEls = panel.querySelectorAll('.sm-panel-item');
    const socialsEl = socialsRef.current;
    const socialLinks = socialsEl
      ? Array.from(socialsEl.querySelectorAll('.sm-social-link'))
      : [];
    const socialTitle = socialsEl?.querySelector('.sm-social-title');

    if (itemEls.length)
      gsap.set(itemEls, { x: 40, opacity: 0, filter: 'blur(8px)' });
    if (socialTitle) gsap.set(socialTitle, { opacity: 0, filter: 'blur(4px)' });
    if (socialLinks.length) gsap.set(socialLinks, { x: 20, opacity: 0 });

    const tl = gsap.timeline({ paused: true });

    // Ghost Pre-layers: Sweep "membrane" across the screen
    if (layers.length) {
      tl.to(layers, {
        opacity: 0.9,
        xPercent: 0,
        filter: 'blur(0px)',
        duration: 0.8,
        ease: 'expo.out', // Ghost Era Signature behavior
        stagger: 0.08,
      });
    }

    // Panel Reveal: Fade + Glide
    tl.to(
      panel,
      {
        opacity: 1,
        xPercent: 0,
        filter: 'blur(0px)',
        duration: 0.8,
        ease: 'expo.out',
        pointerEvents: 'auto',
      },
      layers.length ? '-=0.5' : 0
    );

    // Staggered Nav Items: Glide from right
    if (itemEls.length) {
      tl.to(
        itemEls,
        {
          x: 0,
          opacity: 1,
          filter: 'blur(0px)',
          duration: 1.0,
          ease: 'expo.out',
          stagger: 0.06,
        },
        '-=0.4'
      );
    }

    // Socials Stagger
    if (socialTitle || socialLinks.length) {
      const socialsStart = '-=0.4';
      if (socialTitle) {
        tl.to(
          socialTitle,
          { opacity: 1, filter: 'blur(0px)', duration: 0.6 },
          socialsStart
        );
      }
      if (socialLinks.length) {
        tl.to(
          socialLinks,
          {
            x: 0,
            opacity: 1,
            duration: 0.8,
            ease: 'expo.out',
            stagger: 0.06,
          },
          socialsStart + '+=0.1'
        );
      }
    }

    openTlRef.current = tl;
    return tl;
  }, []);

  const playOpen = useCallback(() => {
    if (motionDisabled) return;
    // Force reset any closing animation
    if (closeTweenRef.current) {
      closeTweenRef.current.kill();
      closeTweenRef.current = null;
    }

    const tl = buildOpenTimeline();
    if (tl) {
      tl.play(0);
    }
  }, [buildOpenTimeline]);

  const playClose = useCallback(() => {
    if (motionDisabled) return;
    openTlRef.current?.kill();
    openTlRef.current = null;

    const panel = panelRef.current;
    const layers = preLayerElsRef.current;
    if (!panel) return;

    const all: HTMLElement[] = [...layers, panel];
    closeTweenRef.current?.kill();

    closeTweenRef.current = gsap.to(all, {
      opacity: 0,
      xPercent: 100, // Sweep back to right
      filter: 'blur(10px)',
      duration: 0.5,
      ease: 'expo.in', // Aggressive close
      pointerEvents: 'none',
      overwrite: 'auto',
      onComplete: () => {
        const itemEls = panel.querySelectorAll('.sm-panel-item');
        if (itemEls.length)
          gsap.set(itemEls, { x: 40, opacity: 0, filter: 'blur(8px)' });

        const socialsEl = socialsRef.current;
        if (socialsEl) {
          const socialTitle = socialsEl.querySelector('.sm-social-title');
          const socialLinks = Array.from(
            socialsEl.querySelectorAll('.sm-social-link')
          );
          if (socialTitle) gsap.set(socialTitle, { opacity: 0 });
          if (socialLinks.length) gsap.set(socialLinks, { x: 20, opacity: 0 });
        }
      },
    });
  }, []);

  // Sync with external isOpen prop
  const syncState = useCallback(() => {
    if (isOpen !== openRef.current) {
      if (isOpen) {
        openRef.current = true;
        setOpen(true);
        if (!motionDisabled) {
          playOpen();
          animateIcon(true);
          animateText(true);
        } else {
          onOpen();
          setTextLines(['Close']);
        }
      } else {
        openRef.current = false;
        setOpen(false);
        if (!motionDisabled) {
          playClose();
          animateIcon(false);
          animateText(false);
        } else {
          onClose();
          setTextLines(['Menu']);
        }
      }
    }
  }, [
    isOpen,
    playOpen,
    playClose,
    animateIcon,
    animateText,
    motionDisabled,
    onClose,
    onOpen,
  ]);

  // Ensure text is always in sync with isOpen state

  // Update the toggleMenu function to ensure proper state synchronization
  const toggleMenu = useCallback(() => {
    const target = !openRef.current;

    // Only proceed if the target state is different from current state
    if (target === openRef.current) return;

    openRef.current = target;
    setOpen(target);

    if (motionDisabled) {
      if (target) onOpen();
      else onClose();
      setTextLines([target ? 'Close' : 'Menu']);
      return;
    }

    if (target) {
      onOpen();
      playOpen();
    } else {
      onClose();
      playClose();
    }

    animateIcon(target);
    animateText(target);
  }, [
    onOpen,
    onClose,
    playOpen,
    playClose,
    animateIcon,
    animateText,
    motionDisabled,
  ]);

  return {
    refs: {
      panelRef,
      preLayersRef,
      socialsRef,
      toggleBtnRef,
      plusHRef,
      plusVRef,
      iconRef,
      textInnerRef,
    },
    state: {
      open,
      textLines,
    },
    actions: {
      toggleMenu,
      syncState,
    },
  };
}
'use client';

import { useEffect, useRef } from 'react';

/**
 * Applies a continuous parallax translation to card image wrappers.
 * The wrapper must have class `.card-image-wrapper` and height > card.
 */
export const useCardParallax = (
  cardRefs: React.RefObject<(HTMLElement | null)[]>,
  enabled = true
) => {
  const rafId = useRef<number | null>(null);

  useEffect(() => {
    if (!enabled) return undefined;

    const applyParallax = () => {
      cardRefs.current?.forEach((card) => {
        if (!card) return;

        const wrapper = card.querySelector<HTMLElement>('.card-image-wrapper');
        if (!wrapper) return;

        const diff = card.offsetHeight - wrapper.offsetHeight;
        const { top } = card.getBoundingClientRect();
        const progress = top / window.innerHeight;
        const yPos = diff * progress;

        wrapper.style.transform = `translateY(${yPos}px)`;
      });

      rafId.current = requestAnimationFrame(applyParallax);
    };

    rafId.current = requestAnimationFrame(applyParallax);

    return () => {
      if (rafId.current) cancelAnimationFrame(rafId.current);
    };
  }, [enabled, cardRefs]);
};
import { useEffect, useState } from 'react';

type QualityLevel = 'high' | 'medium' | 'low';

export interface PerformanceConfig {
  quality: QualityLevel;
  fireflyCount: number;
  particleCount: number;
  enablePostProcessing: boolean;
  pixelRatio: number;
}

export function usePerformanceAdaptive(): PerformanceConfig {
  const [quality, setQuality] = useState<QualityLevel>('high');

  useEffect(() => {
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const isLowEnd =
      navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 4;
    const hasLowMemory =
      'deviceMemory' in navigator && (navigator as any).deviceMemory < 4;

    if (isMobile || isLowEnd || hasLowMemory) {
      setQuality('low');
      return;
    }

    if (window.devicePixelRatio > 2) {
      setQuality('medium');
      return;
    }

    let frames = 0;
    let lastTime = performance.now();
    let rafId: number;
    let isMounted = true;

    const checkFPS = () => {
      frames++;
      const now = performance.now();

      if (now >= lastTime + 1000) {
        const fps = Math.round((frames * 1000) / (now - lastTime));
        if (fps < 30 && isMounted) {
          setQuality((prev) => (prev === 'low' ? 'low' : 'medium'));
        }
        frames = 0;
        lastTime = now;
      }
      rafId = requestAnimationFrame(checkFPS);
    };

    rafId = requestAnimationFrame(checkFPS);
    return () => {
      isMounted = false;
      cancelAnimationFrame(rafId);
    };
  }, []);

  const configs: Record<QualityLevel, PerformanceConfig> = {
    high: {
      quality: 'high',
      fireflyCount: 20,
      particleCount: 50,
      enablePostProcessing: true,
      pixelRatio: Math.min(window.devicePixelRatio, 2),
    },
    medium: {
      quality: 'medium',
      fireflyCount: 12,
      particleCount: 25,
      enablePostProcessing: false,
      pixelRatio: 1.5,
    },
    low: {
      quality: 'low',
      fireflyCount: 6,
      particleCount: 10,
      enablePostProcessing: false,
      pixelRatio: 1,
    },
  };

  return configs[quality];
}
'use client';

import { useReducedMotion } from 'framer-motion';
import { motionTokens } from '@/config/about-motion';

const reducedTokens = {
  ghostIn: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.5 } },
  },
  fadeGhost: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.5 } },
  },
  riseSoft: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.5 } },
  },
  clipReveal: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.5 } },
  },
  staggerContainer: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { staggerChildren: 0.05 } },
  },
  imageFloat: {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.5 } },
  },
  floatMemory: {
    hidden: { opacity: 1, y: 0 },
    visible: { opacity: 1, y: 0, transition: { duration: 0.5 } },
  },
};

export function useEditorialMotion() {
  const prefersReducedMotion = useReducedMotion();

  return {
    prefersReducedMotion,
    variants: prefersReducedMotion ? reducedTokens : motionTokens,
  };
}
// =============================================================================
// useBodyLock Hook - Ghost Era v2.0
// Bloqueia o scroll do body quando modal está aberto
// =============================================================================

'use client';

import { useEffect, useRef, useCallback } from 'react';

/**
 * Hook para bloquear scroll do body
 * Usado principalmente em modais para evitar scroll indesejado
 */
export function useBodyLock(isLocked: boolean): void {
  const scrollPositionRef = useRef<number>(0);
  const lockedRef = useRef<boolean>(false);

  useEffect(() => {
    if (typeof window === 'undefined') return;

    const html = document.documentElement;
    const body = document.body;

    if (isLocked) {
      // Salva a posição atual do scroll
      scrollPositionRef.current = window.scrollY;
      lockedRef.current = true;

      // Aplica estilos para bloquear scroll
      const scrollbarWidth = window.innerWidth - html.clientWidth;

      body.style.overflow = 'hidden';
      body.style.position = 'fixed';
      body.style.top = `-${scrollPositionRef.current}px`;
      body.style.left = '0';
      body.style.right = '0';
      body.style.paddingRight = `${scrollbarWidth}px`;
      html.style.overflow = 'hidden';
    } else {
      // Remove os estilos e restaura a posição do scroll
      lockedRef.current = false;
      body.style.overflow = '';
      body.style.position = '';
      body.style.top = '';
      body.style.left = '';
      body.style.right = '';
      body.style.paddingRight = '';
      html.style.overflow = '';

      // Restaura a posição do scroll
      window.scrollTo(0, scrollPositionRef.current);
    }

    // Cleanup ao desmontar
    return () => {
      // Apenas limpa se ainda estava locked (componente desmontado enquanto modal aberto)
      if (lockedRef.current) {
        body.style.overflow = '';
        body.style.position = '';
        body.style.top = '';
        body.style.left = '';
        body.style.right = '';
        body.style.paddingRight = '';
        html.style.overflow = '';
        window.scrollTo(0, scrollPositionRef.current);
      }
    };
  }, [isLocked]);
}

/**
 * Hook alternativo que retorna funções de controle
 */
export function useBodyLockControls() {
  const scrollPositionRef = useRef<number>(0);
  const isLockedRef = useRef<boolean>(false);

  const lock = useCallback(() => {
    if (typeof window === 'undefined' || isLockedRef.current) return;

    const html = document.documentElement;
    const body = document.body;

    scrollPositionRef.current = window.scrollY;
    const scrollbarWidth = window.innerWidth - html.clientWidth;

    body.style.overflow = 'hidden';
    body.style.position = 'fixed';
    body.style.top = `-${scrollPositionRef.current}px`;
    body.style.left = '0';
    body.style.right = '0';
    body.style.paddingRight = `${scrollbarWidth}px`;
    html.style.overflow = 'hidden';

    isLockedRef.current = true;
  }, []);

  const unlock = useCallback(() => {
    if (typeof window === 'undefined' || !isLockedRef.current) return;

    const html = document.documentElement;
    const body = document.body;

    body.style.overflow = '';
    body.style.position = '';
    body.style.top = '';
    body.style.left = '';
    body.style.right = '';
    body.style.paddingRight = '';
    html.style.overflow = '';

    window.scrollTo(0, scrollPositionRef.current);
    isLockedRef.current = false;
  }, []);

  const toggle = useCallback(() => {
    if (isLockedRef.current) {
      unlock();
    } else {
      lock();
    }
  }, [lock, unlock]);

  // Cleanup ao desmontar
  useEffect(() => {
    return () => {
      if (isLockedRef.current) {
        const body = document.body;
        const html = document.documentElement;

        body.style.overflow = '';
        body.style.position = '';
        body.style.top = '';
        body.style.left = '';
        body.style.right = '';
        body.style.paddingRight = '';
        html.style.overflow = '';
      }
    };
  }, []);

  return { lock, unlock, toggle, isLocked: isLockedRef.current };
}

export default useBodyLock;
'use client';

import { useState, useEffect } from 'react';

export function useMediaQuery(query: string): boolean {
  const [matches, setMatches] = useState(false);

  useEffect(() => {
    if (typeof window === 'undefined') return;

    const media = window.matchMedia(query);

    if (media.matches !== matches) {
      setMatches(media.matches);
    }

    const listener = (e: MediaQueryListEvent) => setMatches(e.matches);

    media.addEventListener('change', listener);
    return () => media.removeEventListener('change', listener);
  }, [query]);

  return matches;
}
import { useEffect, useState } from 'react';

const checkWebGLSupport = (): boolean => {
  if (typeof window === 'undefined') return false;
  try {
    const canvas = document.createElement('canvas');
    return Boolean(
      window.WebGLRenderingContext &&
      (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'))
    );
  } catch {
    return false;
  }
};

export const useWebGLSupport = (): boolean => {
  const [supportsWebGL, setSupportsWebGL] = useState<boolean | null>(null);

  useEffect(() => {
    setSupportsWebGL(checkWebGLSupport());
  }, []);

  // Return false during SSR to prevent hydration mismatch
  // Returns actual support status after hydration
  return supportsWebGL === true;
};
'use client';

import { useEffect } from 'react';
import { runExperienceOrchestrator } from '@/lib/antigravity/antigravity';
import { useAntigravityStore } from '@/store/antigravity.store';

export function useExperience(enabled = true) {
  /*
   * 🧠 UNIFIED BRAIN: ANTIGRAVITY ORCHESTRATOR
   * Coordinates: Flags (Logic), Viewport (Sensors) and Hydration
   */
  const setFlags = useAntigravityStore((state) => state.setFlags);
  const setViewport = useAntigravityStore((state) => state.setViewport);

  useEffect(() => {
    if (!enabled) return;

    // 1. Initial Sensing
    const handleResize = () => {
      const width = window.innerWidth;
      const height = window.innerHeight;

      setViewport(width, height);

      const viewport =
        width >= 1024 ? 'desktop' : width >= 640 ? 'tablet' : 'mobile';

      const prefersReducedMotion = window.matchMedia(
        '(prefers-reduced-motion: reduce)'
      ).matches;

      // 2. Logic Processing (Orchestrator)
      const flags = runExperienceOrchestrator({
        viewport,
        prefersReducedMotion,
      });

      // 3. State Update
      setFlags(flags);
    };

    // Init
    handleResize();

    // Listeners
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, [enabled, setFlags, setViewport]);
}
'use client';

// Inspired by react-hot-toast library
import * as React from 'react';

import type { ToastActionElement, ToastProps } from '@/components/ui/toast';

const TOAST_LIMIT = 1;
const TOAST_REMOVE_DELAY = 1000000;

type ToasterToast = ToastProps & {
  id: string;
  title?: React.ReactNode;
  description?: React.ReactNode;
  action?: ToastActionElement;
};

const actionTypes = {
  ADD_TOAST: 'ADD_TOAST',
  UPDATE_TOAST: 'UPDATE_TOAST',
  DISMISS_TOAST: 'DISMISS_TOAST',
  REMOVE_TOAST: 'REMOVE_TOAST',
} as const;

let count = 0;

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER;
  return count.toString();
}

type ActionType = typeof actionTypes;

type Action =
  | {
      type: ActionType['ADD_TOAST'];
      toast: ToasterToast;
    }
  | {
      type: ActionType['UPDATE_TOAST'];
      toast: Partial<ToasterToast>;
    }
  | {
      type: ActionType['DISMISS_TOAST'];
      toastId?: ToasterToast['id'];
    }
  | {
      type: ActionType['REMOVE_TOAST'];
      toastId?: ToasterToast['id'];
    };

interface State {
  toasts: ToasterToast[];
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return;
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId);
    dispatch({
      type: 'REMOVE_TOAST',
      toastId: toastId,
    });
  }, TOAST_REMOVE_DELAY);

  toastTimeouts.set(toastId, timeout);
};

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case 'ADD_TOAST':
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      };

    case 'UPDATE_TOAST':
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      };

    case 'DISMISS_TOAST': {
      const { toastId } = action;

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId);
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id);
        });
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      };
    }
    case 'REMOVE_TOAST':
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        };
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      };
  }
};

const listeners: Array<(_state: State) => void> = [];

let memoryState: State = { toasts: [] };

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action);
  listeners.forEach((listener) => {
    listener(memoryState);
  });
}

type Toast = Omit<ToasterToast, 'id'>;

function toast({ ...props }: Toast) {
  const id = genId();

  const update = (props: ToasterToast) =>
    dispatch({
      type: 'UPDATE_TOAST',
      toast: { ...props, id },
    });
  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id });

  dispatch({
    type: 'ADD_TOAST',
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss();
      },
    },
  });

  return {
    id: id,
    dismiss,
    update,
  };
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState);

  React.useEffect(() => {
    listeners.push(setState);
    return () => {
      const index = listeners.indexOf(setState);
      if (index > -1) {
        listeners.splice(index, 1);
      }
    };
  }, [state]);

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),
  };
}

export { useToast, toast };
import { useEffect, useState } from 'react';
import { buildSupabaseStorageUrl } from '@/lib/supabase/urls';

interface SiteAsset {
  id: string;
  key: string;
  file_path: string;
  bucket: string;
  asset_type: string;
  is_active: boolean;
  sort_order: number | null;
  page: string;
  href?: string | null;
  publicUrl: string;
  resolvedPage: string;
}

/**
 * Hook para obter a URL pública de um asset do site
 * @param asset - O objeto asset ou string de caminho do asset
 * @returns URL pública do asset ou string vazia se não encontrado
 */
export function useSiteAssetUrl(
  asset: string | Partial<SiteAsset> | undefined
): string {
  const [url, setUrl] = useState<string>('');

  useEffect(() => {
    if (!asset) {
      setUrl('');
      return;
    }

    let resolvedUrl = '';

    if (typeof asset === 'string') {
      // Se for string, assume que é um caminho direto ou URL
      if (asset.startsWith('http')) {
        resolvedUrl = asset;
      } else {
        // Para caminhos locais, tenta construir a URL com o bucket padrão
        resolvedUrl = buildSupabaseStorageUrl('site-assets', asset) || '';
      }
    } else {
      // Se for um objeto asset
      if (asset.publicUrl) {
        resolvedUrl = asset.publicUrl;
      } else if (asset.file_path) {
        const bucket = asset.bucket || 'site-assets';
        resolvedUrl = buildSupabaseStorageUrl(bucket, asset.file_path) || '';
      } else {
        resolvedUrl = '';
      }
    }

    setUrl(resolvedUrl);
  }, [asset]);

  return url;
}
'use client';

import { useReducedMotion } from 'framer-motion';
import { useAntigravityStore } from '@/store/antigravity.store';

/**
 * Central gate for animations. Returns true when motion should be disabled
 * (user OS pref or runtime flag from the experience store).
 */
export function useMotionGate(): boolean {
  const flags = useAntigravityStore((state) => state.flags);
  const prefersReduced = !!useReducedMotion();
  return prefersReduced || flags.reducedMotion;
}

export default useMotionGate;
import { useEffect, useState } from 'react';

export const useDarkMode = () => {
  const [isDark, setIsDark] = useState(false);

  useEffect(() => {
    if (typeof window === 'undefined') return;

    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
    setIsDark(mediaQuery.matches);

    const handler = (e: MediaQueryListEvent) => setIsDark(e.matches);
    mediaQuery.addEventListener('change', handler);
    return () => mediaQuery.removeEventListener('change', handler);
  }, []);

  return isDark;
};
'use client';

import { useEffect, useRef } from 'react';
import { useReducedMotion } from 'framer-motion';

const LERP_EASING = 0.08;

/**
 * Performs linear interpolation.
 * @param start - The start value.
 * @param end - The end value.
 * @param t - The interpolation factor.
 * @returns The interpolated value.
 */
const lerp = (start: number, end: number, t: number): number => {
  return start * (1 - t) + end * t;
};

/**
 * Custom hook to create a smooth, LERP-based scroll effect for a fixed gallery.
 * This hook manages the animation loop and the height of the scrollable area.
 *
 * @returns A ref to be attached to the gallery's track element.
 */
export function useLERPGalleryScroll<T extends HTMLElement = HTMLDivElement>() {
  const trackRef = useRef<T>(null);
  const prefersReducedMotion = useReducedMotion();

  // Use refs to store state that changes frequently without causing re-renders.
  const scrollState = useRef({
    currentY: 0,
    targetY: 0,
    rafId: 0,
  });

  useEffect(() => {
    if (prefersReducedMotion || !trackRef.current) {
      return;
    }

    const track = trackRef.current;
    const gallery = document.querySelector('.gallery') as HTMLElement; // Wrapper element

    const updateHeight = () => {
      if (gallery && track) {
        // Set the height of the gallery wrapper to the height of the fixed track,
        // creating the scrollable space.
        gallery.style.height = `${track.clientHeight}px`;
      }
    };

    const handleScroll = () => {
      scrollState.current.targetY = window.scrollY;
    };

    const animationLoop = () => {
      const { currentY, targetY } = scrollState.current;

      // Interpolate the current scroll position towards the target.
      const newY = lerp(currentY, targetY, LERP_EASING);
      scrollState.current.currentY = newY;

      // Apply the transform to the track element for the parallax effect.
      track.style.transform = `translateY(-${newY}px)`;

      // Continue the animation loop.
      scrollState.current.rafId = requestAnimationFrame(animationLoop);

      // Stop the loop if the scroll position has stabilized.
      if (Math.abs(targetY - newY) < 0.1) {
        cancelAnimationFrame(scrollState.current.rafId);
        scrollState.current.rafId = 0;
      }
    };

    const startAnimationLoop = () => {
      if (scrollState.current.rafId === 0) {
        scrollState.current.rafId = requestAnimationFrame(animationLoop);
      }
    };

    const init = () => {
      updateHeight();
      handleScroll();
      startAnimationLoop();
    };

    // Set initial height and start the loop.
    updateHeight();

    window.addEventListener('scroll', init, { passive: true });
    window.addEventListener('resize', updateHeight, { passive: true });

    // Use a ResizeObserver to adjust height when content changes (e.g., filtering).
    const resizeObserver = new ResizeObserver(updateHeight);
    resizeObserver.observe(track);

    return () => {
      window.removeEventListener('scroll', init);
      window.removeEventListener('resize', updateHeight);
      cancelAnimationFrame(scrollState.current.rafId);
      resizeObserver.disconnect();
      if (gallery) {
        gallery.style.height = 'auto';
      }
    };
  }, [prefersReducedMotion]);

  return trackRef;
}

/**
 * Custom hook to apply a parallax effect to a card's image wrapper.
 * It calculates the vertical translation based on the card's position in the viewport.
 *
 * @returns A ref to be attached to the card's image wrapper element.
 */
export function useParallaxCard<T extends HTMLElement = HTMLDivElement>() {
  const wrapperRef = useRef<T>(null);
  const cardRef = useRef<HTMLDivElement>(null); // Ref for the parent card
  const prefersReducedMotion = useReducedMotion();

  useEffect(() => {
    if (prefersReducedMotion || !wrapperRef.current || !cardRef.current) {
      return;
    }

    const wrapper = wrapperRef.current;
    const card = cardRef.current;

    const parallaxEffect = () => {
      const wrapperHeight = wrapper.offsetHeight;
      const cardHeight = card.offsetHeight;
      const diff = cardHeight - wrapperHeight;
      const { top } = card.getBoundingClientRect();
      const progress = top / window.innerHeight;
      const yPos = diff * progress;

      wrapper.style.transform = `translateY(${yPos}px)`;
    };

    const rafId = requestAnimationFrame(function animationLoop() {
      parallaxEffect();
      requestAnimationFrame(animationLoop);
    });

    return () => {
      cancelAnimationFrame(rafId);
    };
  }, [prefersReducedMotion]);

  // We need to return both refs to be attached to the correct elements.
  return { wrapperRef, cardRef };
}
import { useState, useEffect } from 'react';

export function usePrefersReducedMotion() {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    // Verifica se window.matchMedia está disponível (SSR e test safety)
    if (typeof window === 'undefined' || !window.matchMedia) {
      return;
    }

    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    setPrefersReducedMotion(mediaQuery.matches);

    const handler = (event: MediaQueryListEvent) => {
      setPrefersReducedMotion(event.matches);
    };

    mediaQuery.addEventListener('change', handler);
    return () => mediaQuery.removeEventListener('change', handler);
  }, []);

  return prefersReducedMotion;
}
import { useRef } from 'react';
import {
  useScroll,
  useTransform,
  useMotionValueEvent,
  useSpring,
  type UseScrollOptions,
} from 'framer-motion';
import { useAntigravityStore } from '@/store/antigravity.store';
import { TIMELINE } from '@/config/timeline';

interface ScrollNarrativeConfig {
  offset?: UseScrollOptions['offset'];
  damping?: number;
}

export const useScrollNarrative = (config: ScrollNarrativeConfig = {}) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const setNarrativeState = useAntigravityStore(
    (state) => state.setNarrativeState
  );
  const setScrollProgress = useAntigravityStore(
    (state) => state.setScrollProgress
  );
  const flags = useAntigravityStore((state) => state.flags);

  // Native Framer Motion Scroll
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: config.offset || ['start start', 'end end'],
  });

  // Smooth scroll progress for store (avoid jitter in UI updates)
  const smoothProgress = useSpring(scrollYProgress, {
    stiffness: 100,
    damping: 30,
    restDelta: 0.001,
  });

  // Narrative Logic Mapper
  // This maps linear scroll (0-1) to discrete semantic states
  useMotionValueEvent(scrollYProgress, 'change', (latest) => {
    setScrollProgress(latest);

    if (flags.reducedMotion) {
      // Simplification for accessibility
      setNarrativeState('EXPLORATION');
      return;
    }

    if (latest < TIMELINE.MANIFESTO.ENTRY_START) {
      setNarrativeState('HERO_EDITORIAL');
    } else if (
      latest >= TIMELINE.MANIFESTO.ENTRY_START &&
      latest < TIMELINE.MANIFESTO.FULL_FOCUS_START
    ) {
      setNarrativeState('MANIFESTO_TRANSITION');
    } else if (
      latest >= TIMELINE.MANIFESTO.FULL_FOCUS_START &&
      latest < TIMELINE.MANIFESTO.EXIT_START
    ) {
      setNarrativeState('MANIFESTO_FULLSCREEN');
    } else {
      setNarrativeState('EXPLORATION');
    }
  });

  // Motion Values for Consumers
  // Pre-calculated transforms to ensure consistency across components
  const heroOpacity = useTransform(
    scrollYProgress,
    [TIMELINE.HERO.FADE_OUT_START, TIMELINE.HERO.FADE_OUT_END],
    [1, 0]
  );
  const manifestoScale = useTransform(
    scrollYProgress,
    [TIMELINE.MANIFESTO.SCALE_START, TIMELINE.MANIFESTO.SCALE_END],
    [0.8, 1]
  );
  const manifestoRadius = useTransform(
    scrollYProgress,
    [TIMELINE.MANIFESTO.SCALE_START, TIMELINE.MANIFESTO.SCALE_END],
    [32, 0]
  );

  return {
    containerRef,
    scrollYProgress,
    smoothProgress,
    transforms: {
      heroOpacity,
      manifestoScale,
      manifestoRadius,
    },
  };
};
import { useReducedMotion as useFramerReducedMotion } from 'framer-motion';
import { useEffect, useState } from 'react';

export function useReducedMotion() {
  const reducedMotion = useFramerReducedMotion();
  const [isSafe, setIsSafe] = useState(false);

  useEffect(() => {
    setIsSafe(true);
  }, []);

  return isSafe ? (reducedMotion ?? false) : false;
}

export default useReducedMotion;
'use client';

import { useEffect, useRef } from 'react';

import { lerp } from '@/utils/math';

/**
 * LERP-based scroll smoother for a fixed gallery track.
 * It keeps the track translated with an eased scroll value and
 * updates the wrapper height so the page retains native scroll.
 */
type TrackRef =
  | React.RefObject<HTMLElement | null>
  | React.MutableRefObject<HTMLElement | null>;

export const useLERPScroll = (trackRef: TrackRef, enabled = true) => {
  const startY = useRef(0);
  const endY = useRef(0);
  const rafId = useRef<number | null>(null);
  const galleryRef = useRef<HTMLElement | null>(null);

  useEffect(() => {
    if (!enabled) {
      return undefined;
    }

    // Resolve the gallery wrapper (main element with class "gallery")
    if (!galleryRef.current) {
      galleryRef.current = document.querySelector('.gallery');
    }

    const track = trackRef.current;
    const gallery = galleryRef.current;

    if (!track || !gallery) {
      return undefined;
    }

    const updateHeight = () => {
      gallery.style.height = `${track.clientHeight}px`;
    };

    const animate = () => {
      startY.current = lerp(startY.current, endY.current, 0.05);

      track.style.transform = `translateY(-${startY.current}px)`;

      if (Math.abs(startY.current - endY.current) > 0.5) {
        rafId.current = requestAnimationFrame(animate);
      } else {
        rafId.current = null;
      }
    };

    const onScroll = () => {
      endY.current = window.scrollY;
      if (!rafId.current) {
        rafId.current = requestAnimationFrame(animate);
      }
    };

    // Keep height in sync when content changes
    const resizeObserver = new ResizeObserver(updateHeight);
    resizeObserver.observe(track);

    updateHeight();
    endY.current = window.scrollY;
    rafId.current = requestAnimationFrame(animate);

    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('resize', updateHeight);
    window.addEventListener('load', updateHeight);

    return () => {
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('resize', updateHeight);
      window.removeEventListener('load', updateHeight);
      resizeObserver.disconnect();

      if (rafId.current) {
        cancelAnimationFrame(rafId.current);
        rafId.current = null;
      }

      // Reset inline styles so SSR/hydration don't keep stale transforms
      track.style.transform = '';
      gallery.style.height = 'auto';
    };
  }, [enabled, trackRef]);

  return { galleryRef } as const;
};
'use client';

import { useEffect } from 'react';

import * as THREE from 'three';

/**
 * Hook para sincronizar o efeito de revelação 2D com a posição do ghost 3D
 * @param ghostRef - Referência ao grupo do ghost no mundo 3D
 * @param revealRef - Referência ao elemento HTML do overlay de revelação
 * @param enabled - Se o efeito está ativado (desktop com WebGL)
 */
export function useGhostReveal(
  ghostRef: React.RefObject<THREE.Group | null> | undefined,
  revealRef: React.RefObject<HTMLDivElement | null>,
  enabled: boolean
) {
  useEffect(() => {
    if (!enabled || !ghostRef?.current || !revealRef.current) return;

    let rafId: number;

    const updateRevealPosition = () => {
      if (!ghostRef.current || !revealRef.current) return;

      const ghostPos = ghostRef.current.position;
      const overlay = revealRef.current;

      // Converte posição 3D world-space para coordenadas 2D viewport
      // Ghost se move aproximadamente de -10 a +10 em X e -7 a +7 em Y
      const x = ((ghostPos.x + 10) / 20) * 100; // Normaliza para 0-100%
      const y = ((ghostPos.y + 7) / 14) * 100; // Normaliza para 0-100%
      const invertedY = 100 - y;

      // Atualiza a posição do overlay usando CSS transform
      overlay.style.transform = `translate(calc(${x}vw - 50%), calc(${invertedY}vh - 50%))`;

      // Seta variáveis no documento/root para uso em classes CSS (ex: mask-image)
      document.documentElement.style.setProperty('--ghost-x', `${x}vw`);
      document.documentElement.style.setProperty('--ghost-y', `${invertedY}vh`);

      rafId = requestAnimationFrame(updateRevealPosition);
    };

    // Inicia o loop de atualização
    rafId = requestAnimationFrame(updateRevealPosition);

    return () => {
      if (rafId) cancelAnimationFrame(rafId);
    };
  }, [ghostRef, revealRef, enabled]);
}
'use client';

import { useEffect, useState } from 'react';

/**
 * Hook to sync with Ghost energy emitted from GhostCanvas
 * Energy represents the proximity of the ghost to the center (higher = closer)
 * Falls back to 0.3 if --ghost-energy CSS variable is not defined
 */
export function useGhostEnergy(): number {
  const [energy, setEnergy] = useState(1.5);

  useEffect(() => {
    const update = () => {
      const value = getComputedStyle(document.documentElement).getPropertyValue(
        '--ghost-energy'
      );

      if (value) {
        const parsed = parseFloat(value);
        if (!isNaN(parsed)) {
          setEnergy(parsed);
        }
      }
    };

    // Poll at 20fps (50ms interval) - organic feel without excessive updates
    const id = setInterval(update, 50);

    // Initial update
    update();

    return () => clearInterval(id);
  }, []);

  return energy;
}
'use client';

import { useScroll, useTransform } from 'framer-motion';
import { MutableRefObject } from 'react';

/**
 * Hook for card parallax effect.
 * Calculates progress based on viewport position.
 */
export const useParallaxCard = (ref: MutableRefObject<HTMLElement | null>) => {
  const { scrollYProgress } = useScroll({
    target: ref,
    offset: ['start end', 'end start'],
  });

  // Parallax interno da imagem (move-se um pouco mais rápido/devagar que o scroll)
  // Ajustar valores conforme gosto: [-50, 50] pixels de deslocamento, por exemplo.
  // Como é percentual de altura no CSS (top -17.5%), podemos usar porcentagem aqui ou pixels.
  // Vamos usar pixels para startar.
  const y = useTransform(scrollYProgress, [0, 1], ['-10%', '10%']);

  return { y };
};
import { type NextRequest } from 'next/server';
import { updateSession } from './lib/supabase/middleware';

export async function proxy(request: NextRequest) {
  return await updateSession(request);
}

export const config = {
  matcher: [
    /*
     * Match all request paths except for the ones starting with:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * Feel free to modify this pattern to include more paths.
     */
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
};
// Single source of truth re-exported from config/motion.
// This keeps legacy import paths working while eliminating duplicate token definitions.
export * from '@/config/motion';
export const resolveScrollState = (progress: number): string => {
  if (progress < 0.1) return 'initial';
  if (progress < 0.4) return 'expanding';
  if (progress < 0.8) return 'full';
  return 'finished';
};
import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
import { createServerClient } from '@supabase/ssr';
import { NextResponse, type NextRequest } from 'next/server';

// Fallback URLs case env vars are not available (shouldn't happen with NEXT_PUBLIC_*)
const SUPABASE_URL =
  process.env.NEXT_PUBLIC_SUPABASE_URL ||
  'https://umkmwbkwvulxtdodzmzf.supabase.co';
const SUPABASE_ANON_KEY =
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ||
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVta213Ymt3dnVseHRkb2R6bXpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNDE4MzcsImV4cCI6MjA4MzkxNzgzN30.wssvD9W-yzRyLpq8aMCw57E4wNz7OnQ58ujLzYmF6CA';

export async function updateSession(request: NextRequest) {
  let supabaseResponse = NextResponse.next({
    request,
  });

  const supabase = createServerClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
    cookieOptions: {
      // Firebase Hosting só encaminha o cookie "__session" para as Functions.
      name: '__session',
      sameSite: 'lax',
      secure: true,
    },
    cookies: {
      getAll() {
        return request.cookies.getAll();
      },
      setAll(cookiesToSet) {
        // request.cookies é imutável; apenas refletimos no response.
        supabaseResponse = NextResponse.next({ request });
        cookiesToSet.forEach(({ name, value, options }) =>
          supabaseResponse.cookies.set(name, value, options)
        );
      },
    },
  });

  // IMPORTANT: Do not use auth.getSession() - it reads from cookies without validation
  // Use auth.getUser() which always validates the session with Supabase Auth server
  const {
    data: { user },
  } = await supabase.auth.getUser();

  const pathname = request.nextUrl.pathname;
  const isLoginPage = pathname === '/admin/login';
  const isAdminRoute = pathname.startsWith('/admin');
  const isAuthCallbackRoute = pathname.startsWith('/auth/callback');

  // Skip auth callback route
  if (isAuthCallbackRoute) {
    return supabaseResponse;
  }

  // If user is logged in and trying to access login page, redirect to dashboard
  if (user && isLoginPage) {
    const url = request.nextUrl.clone();
    url.pathname = '/admin';
    const redirectResponse = NextResponse.redirect(url);
    // Copy cookies from supabaseResponse to ensure session persistence
    const cookiesToSet = supabaseResponse.cookies.getAll();
    cookiesToSet.forEach((cookie) =>
      redirectResponse.cookies.set(cookie.name, cookie.value, cookie)
    );
    return redirectResponse;
  }

  // Protect /admin routes (except login)
  if (isAdminRoute && !isLoginPage) {
    if (!user) {
      const url = request.nextUrl.clone();
      url.pathname = '/admin/login';
      const redirectResponse = NextResponse.redirect(url);
      // Copy cookies from supabaseResponse to ensure session persistence
      const cookiesToSet = supabaseResponse.cookies.getAll();
      cookiesToSet.forEach((cookie) =>
        redirectResponse.cookies.set(cookie.name, cookie.value, cookie)
      );
      return redirectResponse;
    }

    // Se precisar de papel admin, reative o check abaixo.
    // const userRole = user.app_metadata?.role || 'user';
    // if (userRole !== 'admin') {
    //   const url = request.nextUrl.clone();
    //   url.pathname = '/';
    //   return NextResponse.redirect(url);
    // }
  }

  return supabaseResponse;
}
import { createClient } from '@/lib/supabase/server';
import type { DbAsset } from '@/types/admin';
import {
  normalizeAssetList,
  type NormalizedSiteAsset,
} from '@/lib/supabase/site-asset-utils';

export type SiteAsset = NormalizedSiteAsset;

export async function getSiteAssets() {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('site_assets')
    .select('*')
    .order('page', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  if (error) throw error;

  return normalizeAssetList((data ?? []) as DbAsset[], { onlyActive: true });
}
// supabase-image-loader.js
const DEFAULT_SUPABASE_URL = 'https://aymuvxysygrwoicsjgxj.supabase.co';
const IMAGE_EXTENSIONS = ['.png', '.jpg', '.jpeg', '.webp', '.avif'];
const NON_TRANSFORM_EXTENSIONS = [
  '.svg',
  '.mp4',
  '.webm',
  '.mov',
  '.m4v',
  '.gif',
];

export default function supabaseLoader({ src, width, quality }) {
  const normalizedSrc = src.split('?')[0].toLowerCase();

  if (src.startsWith('/')) return src;

  const appendParams = (url, w, q) => {
    const separator = url.includes('?') ? '&' : '?';
    return `${url}${separator}width=${w}&quality=${q || 75}`;
  };

  if (NON_TRANSFORM_EXTENSIONS.some((ext) => normalizedSrc.endsWith(ext))) {
    return src;
  }

  if (src.includes('/storage/v1/object/public/')) {
    const base = src.startsWith('http')
      ? src
      : `${DEFAULT_SUPABASE_URL}${src.startsWith('/') ? '' : '/'}${src}`;
    const isImage = IMAGE_EXTENSIONS.some((ext) => normalizedSrc.endsWith(ext));
    if (isImage) {
      const newSrc = base.replace(
        '/storage/v1/object/public/',
        '/storage/v1/render/image/public/'
      );
      return appendParams(newSrc, width, quality || 75);
    }
    return base;
  }

  if (src.includes('/storage/v1/render/image/public/')) {
    return appendParams(src, width, quality || 75);
  }

  return src;
}
const normalizeUrl = (value: string) => value.replace(/\/+$/, '');

export function getSupabaseBaseUrl(): string | null {
  const url =
    process.env.NEXT_PUBLIC_SUPABASE_URL ?? process.env.SUPABASE_URL ?? null;

  if (!url) {
    throw new Error(
      'Supabase URL não definida. Configure NEXT_PUBLIC_SUPABASE_URL ou SUPABASE_URL.'
    );
  }
  try {
    return normalizeUrl(url);
  } catch {
    return url;
  }
}

export function normalizeStoragePath(
  filePath?: string | null,
  bucket?: string
): string | null {
  if (!filePath) return null;

  const bucketPrefix = bucket?.replace(/^\/+|\/+$/g, '');

  // Remove full Supabase URL prefix if present (object or render endpoints)
  let normalized = filePath.trim();

  // Clean common malformed prefixes/suffixes from backups (e.g. "file_path: ...," or quoted values)
  normalized = normalized.replace(/^file_path:\s*/i, '');
  normalized = normalized.replace(/^key:\s*/i, '');
  normalized = normalized.replace(/^"+|"+$/g, '');
  normalized = normalized.replace(/^'+|'+$/g, '');
  normalized = normalized.replace(/,+$/g, '');
  normalized = normalized.replace(/\s+$/g, '');

  normalized = normalized.replace(
    /^https?:\/\/[^/]+\/storage\/v1\/(?:render\/image|object)\/public\//,
    ''
  );

  // Remove local /storage/v1/object/public prefix if the path was stored like that
  normalized = normalized.replace(
    /^\/?storage\/v1\/(?:render\/image|object)\/public\//,
    ''
  );

  normalized = normalized.replace(/^\/+/, '');

  if (bucketPrefix && normalized.startsWith(`${bucketPrefix}/`)) {
    normalized = normalized.slice(bucketPrefix.length + 1);
  }

  return normalized;
}

export function buildSupabaseStorageUrl(
  bucket: string,
  filePath?: string | null
): string | null {
  if (!filePath) return null;

  const isHttp =
    filePath.startsWith('http://') || filePath.startsWith('https://');
  const isSupabaseUrl = filePath.includes('/storage/v1/');

  // Verifica se é uma URL externa não-Supabase
  if (isHttp && !isSupabaseUrl) {
    // Validação de segurança para URLs externas
    try {
      const url = new URL(filePath);
      // Permitir apenas protocolos seguros
      if (url.protocol !== 'https:') {
        console.warn(`Protocolo inseguro detectado: ${filePath}`);
        return null;
      }
      // Aqui poderíamos adicionar validação de domínio se necessário
      return filePath;
    } catch {
      console.error(`URL inválida: ${filePath}`);
      return null;
    }
  }

  const cleanBucket = bucket.replace(/^\/+|\/+$/g, '');
  const normalizedPath = normalizeStoragePath(filePath, cleanBucket);
  if (!normalizedPath) {
    return filePath.startsWith('http') ? filePath : null;
  }

  // Preserva a origem caso o caminho já seja uma URL completa de outro projeto Supabase
  if (isHttp && isSupabaseUrl) {
    try {
      const url = new URL(filePath);
      const baseOrigin = `${url.protocol}//${url.host}`;
      return `${baseOrigin}/storage/v1/object/public/${cleanBucket}/${normalizedPath}`;
    } catch {
      // se falhar, segue fluxo padrão
    }
  }

  const baseUrl = getSupabaseBaseUrl();
  if (!baseUrl) {
    return filePath.startsWith('http') ? filePath : null;
  }

  return `${baseUrl}/storage/v1/object/public/${cleanBucket}/${normalizedPath}`;
}

// Função adicional para validar e construir URLs de links externos
export function validateExternalUrl(url: string): string | null {
  if (!url) return null;
  const normalized = url.trim();
  if (!normalized) return null;

  const allowedProtocols = ['https:', 'http:'];

  try {
    const parsedUrl = new URL(normalized);
    if (allowedProtocols.includes(parsedUrl.protocol)) {
      return parsedUrl.toString();
    }

    console.warn(`Link externo inseguro bloqueado: ${url}`);
    return null;
  } catch {
    if (normalized.startsWith('/') || normalized.startsWith('#')) {
      return normalized;
    }

    if (normalized.startsWith('//')) {
      try {
        const parsedFallback = new URL(`https:${normalized}`);
        return parsedFallback.toString();
      } catch {
        console.error(`URL externa inválida: ${url}`);
        return null;
      }
    }

    console.error(`URL externa inválida: ${url}`);
    return null;
  }
}
const VALID_KEY_CHARS = /[^a-z0-9._-]/g;

export function sanitizeAssetKey(key: string) {
  return key
    .trim()
    .toLowerCase()
    .replace(/\s+/g, '_')
    .replace(VALID_KEY_CHARS, '');
}

export function normalizePage(page?: string | null) {
  return page && page.trim().length > 0 ? page.trim() : 'global';
}

export function buildAssetFilePath({
  page,
  key,
  subPath,
  extension,
}: {
  page?: string | null;
  key: string;
  subPath?: string;
  extension: string;
}) {
  const targetPage = normalizePage(page);
  const segments = [targetPage];
  if (subPath) {
    segments.push(subPath.trim().replace(/^\/+|\/+$/g, ''));
  }

  const sanitizedKey = sanitizeAssetKey(key);
  const normalizedExtension =
    extension.toLowerCase().replace(/^\.+/, '') || 'bin';
  const fileName = `${sanitizedKey}.${normalizedExtension}`;
  return `${segments.join('/')}/${fileName}`;
}

export function getFileExtension(filePath: string | null | undefined) {
  if (!filePath) return '';
  const parts = filePath.split('.');
  if (parts.length <= 1) return '';
  return parts.pop() ?? '';
}
import { SITE_ASSET_KEYS } from '@/config/site-assets';

export type SiteAssetRole = {
  key: string;
  label: string;
  description: string;
  page: string;
  asset_type: 'image' | 'video' | 'file' | 'font';
  subPath?: string;
  sort_order?: number;
};

export type SiteAssetRoleGroup = {
  label: string;
  roles: SiteAssetRole[];
};

const globalLogos: SiteAssetRole[] = [
  {
    key: SITE_ASSET_KEYS.logos.headerLight,
    label: 'Logo header (claro)',
    description: 'Versão clara do logo do header',
    page: 'global',
    asset_type: 'image',
    subPath: 'logos',
  },
  {
    key: SITE_ASSET_KEYS.logos.headerDark,
    label: 'Logo header (escuro)',
    description: 'Versão escura do logo do header',
    page: 'global',
    asset_type: 'image',
    subPath: 'logos',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconLight,
    label: 'Favicon claro',
    description: 'Favicon claro utilizado na aba',
    page: 'global',
    asset_type: 'image',
    subPath: 'logos',
  },
  {
    key: SITE_ASSET_KEYS.logos.faviconDark,
    label: 'Favicon escuro',
    description: 'Favicon escuro utilizado na aba',
    page: 'global',
    asset_type: 'image',
    subPath: 'logos',
  },
];

const globalFonts: SiteAssetRole[] = [
  {
    key: SITE_ASSET_KEYS.fonts.display,
    label: '--font-display',
    description: 'Fonte principal de destaque',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
  {
    key: SITE_ASSET_KEYS.fonts.h1,
    label: '--font-h1',
    description: 'Fonte dos títulos h1',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
  {
    key: SITE_ASSET_KEYS.fonts.h2,
    label: '--font-h2',
    description: 'Fonte dos títulos h2',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
  {
    key: SITE_ASSET_KEYS.fonts.h3,
    label: '--font-h3',
    description: 'Fonte dos títulos h3',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
  {
    key: SITE_ASSET_KEYS.fonts.body,
    label: '--font-body',
    description: 'Fonte do corpo de texto',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
  {
    key: SITE_ASSET_KEYS.fonts.light,
    label: '--font-light',
    description: 'Fonte auxiliar leve',
    page: 'global',
    asset_type: 'font',
    subPath: 'fonts',
  },
];

const clientStrips: SiteAssetRole[] = SITE_ASSET_KEYS.clients.strips.map(
  (key, index) => ({
    key,
    label: `Logo cliente ${index + 1}`,
    description: 'Logo para a faixa de clientes',
    page: 'clients',
    asset_type: 'image',
    subPath: 'clients',
    sort_order: index + 1,
  })
);

const aboutHeroVideos: SiteAssetRole[] = [
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutDesktop,
    label: 'Vídeo hero Sobre (desktop)',
    description: 'Vídeo da hero da página Sobre (desktop)',
    page: 'about',
    asset_type: 'video',
    subPath: 'hero',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.aboutMobile,
    label: 'Vídeo hero Sobre (mobile)',
    description: 'Versão mobile da hero sobre',
    page: 'about',
    asset_type: 'video',
    subPath: 'hero',
  },
];

const aboutOriginImages: SiteAssetRole[] =
  SITE_ASSET_KEYS.about.originImages.map((key, index) => ({
    key,
    label: `Origem imagem ${index + 1}`,
    description: 'Imagem da seção Origem',
    page: 'about',
    asset_type: 'image',
    subPath: 'origin',
    sort_order: index + 1,
  }));

const aboutMethodVideo: SiteAssetRole = {
  key: SITE_ASSET_KEYS.heroVideos.method,
  label: 'Vídeo método',
  description: 'Vídeo da seção Método',
  page: 'about',
  asset_type: 'video',
  subPath: 'method',
};

const aboutBeliefsAssets: SiteAssetRole[] = [
  {
    key: SITE_ASSET_KEYS.about.beliefs.ghostModel,
    label: 'Ghost Model (3D)',
    description: 'Modelo 3D GLB exubido na seção Crenças',
    page: 'about',
    asset_type: 'file',
    subPath: 'beliefs',
  },
  {
    key: SITE_ASSET_KEYS.about.beliefs.skillsVideo,
    label: 'Vídeo Skills (Desktop)',
    description: 'Vídeo de background da seção Crenças (versão pesada)',
    page: 'about',
    asset_type: 'video',
    subPath: 'beliefs',
  },
  {
    key: SITE_ASSET_KEYS.about.beliefs.skillsVideoMobile,
    label: 'Vídeo Skills (Mobile)',
    description: 'Vídeo de background da seção Crenças (versão leve)',
    page: 'about',
    asset_type: 'video',
    subPath: 'beliefs',
  },
];

const aboutCurriculum: SiteAssetRole = {
  key: 'about.curriculum_pdf',
  label: 'Currículo para download',
  description: 'PDF usado na seção AboutClosing',
  page: 'about',
  asset_type: 'file',
  subPath: 'curriculum',
};

const portfolioHeroVideos: SiteAssetRole[] = [
  {
    key: SITE_ASSET_KEYS.heroVideos.portfolioDesktop,
    label: 'Vídeo hero Portfólio (desktop)',
    description: 'Hero do portfólio desktop',
    page: 'portfolio',
    asset_type: 'video',
    subPath: 'hero',
  },
  {
    key: SITE_ASSET_KEYS.heroVideos.portfolioMobile,
    label: 'Vídeo hero Portfólio (mobile)',
    description: 'Hero do portfólio mobile',
    page: 'portfolio',
    asset_type: 'video',
    subPath: 'hero',
  },
];

const homeHeroVideo: SiteAssetRole = {
  key: SITE_ASSET_KEYS.heroVideos.homeManifesto,
  label: 'Vídeo manifesto (home)',
  description: 'Vídeo principal da hero da Home',
  page: 'home',
  asset_type: 'video',
};

const projectAssets: SiteAssetRole[] = [
  // Campaign
  {
    key: SITE_ASSET_KEYS.projects.campaign.cover,
    label: 'Campaign • Cover',
    description: 'Capa do projeto Campaign',
    page: 'projects',
    asset_type: 'image',
    subPath: 'campaign',
  },
  {
    key: SITE_ASSET_KEYS.projects.campaign.hero,
    label: 'Campaign • Hero',
    description: 'Hero do projeto Campaign',
    page: 'projects',
    asset_type: 'image',
    subPath: 'campaign',
  },
  {
    key: SITE_ASSET_KEYS.projects.campaign.thumb,
    label: 'Campaign • Thumb',
    description: 'Thumbnail do projeto Campaign',
    page: 'projects',
    asset_type: 'image',
    subPath: 'campaign',
  },
  // Key Vision
  {
    key: SITE_ASSET_KEYS.projects.keyVision.cover,
    label: 'Key Vision • Cover',
    description: 'Capa do projeto Key Vision',
    page: 'projects',
    asset_type: 'image',
    subPath: 'key-vision',
  },
  {
    key: SITE_ASSET_KEYS.projects.keyVision.hero,
    label: 'Key Vision • Hero',
    description: 'Hero do projeto Key Vision',
    page: 'projects',
    asset_type: 'image',
    subPath: 'key-vision',
  },
  {
    key: SITE_ASSET_KEYS.projects.keyVision.thumb,
    label: 'Key Vision • Thumb',
    description: 'Thumbnail do projeto Key Vision',
    page: 'projects',
    asset_type: 'image',
    subPath: 'key-vision',
  },
  // Brand Video
  {
    key: SITE_ASSET_KEYS.projects.brandVideo.hero,
    label: 'Brand Video • Hero',
    description: 'Hero do projeto Brand Video',
    page: 'projects',
    asset_type: 'image',
    subPath: 'brand-video',
  },
  {
    key: SITE_ASSET_KEYS.projects.brandVideo.thumb,
    label: 'Brand Video • Thumb',
    description: 'Thumbnail do projeto Brand Video',
    page: 'projects',
    asset_type: 'video',
    subPath: 'brand-video',
  },
  // Advertising Video
  {
    key: SITE_ASSET_KEYS.projects.advertisingVideo.hero,
    label: 'Advertising Video • Hero',
    description: 'Hero do projeto Advertising Video',
    page: 'projects',
    asset_type: 'image',
    subPath: 'advertising-video',
  },
  {
    key: SITE_ASSET_KEYS.projects.advertisingVideo.thumb,
    label: 'Advertising Video • Thumb',
    description: 'Thumbnail do projeto Advertising Video',
    page: 'projects',
    asset_type: 'image',
    subPath: 'advertising-video',
  },
  // Creative Direction
  {
    key: SITE_ASSET_KEYS.projects.creativeDirection.hero,
    label: 'Creative Direction • Hero',
    description: 'Hero do projeto Creative Direction',
    page: 'projects',
    asset_type: 'image',
    subPath: 'creative-direction',
  },
  {
    key: SITE_ASSET_KEYS.projects.creativeDirection.thumb,
    label: 'Creative Direction • Thumb',
    description: 'Thumbnail do projeto Creative Direction',
    page: 'projects',
    asset_type: 'image',
    subPath: 'creative-direction',
  },
];

export const siteAssetRoleGroups: SiteAssetRoleGroup[] = [
  { label: 'Global • Logos', roles: globalLogos },
  { label: 'Global • Fonts', roles: globalFonts },
  { label: 'Home • Hero', roles: [homeHeroVideo] },
  { label: 'Clients • Logos', roles: clientStrips },
  { label: 'Sobre • Hero vídeos', roles: aboutHeroVideos },
  { label: 'Sobre • Origem', roles: aboutOriginImages },
  {
    label: 'Sobre • Método & Curriculum',
    roles: [aboutMethodVideo, aboutCurriculum],
  },
  { label: 'Sobre • Crenças', roles: aboutBeliefsAssets },
  { label: 'Portfólio • Hero vídeos', roles: portfolioHeroVideos },
  { label: 'Portfólio • Projetos', roles: projectAssets },
];

const allSiteAssetRoles = siteAssetRoleGroups.flatMap((group) => group.roles);

export const siteAssetRoleMap = new Map(
  allSiteAssetRoles.map((role) => [role.key, role])
) as ReadonlyMap<string, SiteAssetRole>;

export function getSiteAssetRoleByKey(key: string) {
  return siteAssetRoleMap.get(key);
}
import type { DbAsset } from '@/types/admin';
import {
  buildSupabaseStorageUrl,
  normalizeStoragePath,
  validateExternalUrl,
} from '@/lib/supabase/urls';

export type NormalizedSiteAsset = DbAsset & {
  publicUrl: string;
  href?: string | null;
  resolvedPage: string;
};

export function normalizeAssetRecord(asset: DbAsset): NormalizedSiteAsset {
  const cleanBucket = ((asset.bucket || 'site-assets') as string)
    .replace(/^bucket:\s*/i, '')
    .replace(/^"+|"+$/g, '')
    .replace(/^'+|'+$/g, '')
    .replace(/^\/+|\/+$/g, '');

  const cleanKey = asset.key
    ?.replace(/^key:\s*/i, '')
    .replace(/^"+|"+$/g, '')
    .replace(/^'+|'+$/g, '')
    .replace(/,+$/g, '')
    .trim();

  const cleanPath = normalizeStoragePath(asset.file_path, cleanBucket);
  const fixClientsPath = (path?: string | null) => {
    if (!path) return path;
    // Casos importados com prefixo duplicado "clients.clients.strip.X.svg"
    if (/^clients\.clients\.strip\./.test(path)) {
      return path.replace(
        /^clients\.clients\.strip\./,
        'clients/clients.strip.'
      );
    }
    if (/^clients\.strip\./.test(path)) {
      return path.replace(/^clients\.strip\./, 'clients/clients.strip.');
    }
    return path;
  };
  const resolvedPath = fixClientsPath(cleanPath);

  // Corrige bucket para media de portfólio que foram importadas com o bucket errado
  const resolvedBucket =
    cleanBucket === 'site-assets' && resolvedPath?.startsWith('projects/')
      ? 'portfolio-media'
      : cleanBucket;

  const inferPageFromValue = (value?: string | null) => {
    if (!value) return undefined;
    const trimmed = value
      .replace(/^page:\s*/i, '')
      .replace(/^"+|"+$/g, '')
      .replace(/^'+|'+$/g, '')
      .replace(/,+$/g, '')
      .trim();
    if (!trimmed) return undefined;
    if (/^updated_at:/i.test(trimmed) || /^key:/i.test(trimmed))
      return undefined;
    const delimiter = trimmed.includes('/') ? '/' : '.';
    const base = trimmed.split(delimiter)[0];
    return base?.toLowerCase();
  };

  const resolvedPage =
    inferPageFromValue(asset.page) ||
    inferPageFromValue(resolvedPath) ||
    inferPageFromValue(cleanKey) ||
    'global';

  const publicUrl =
    buildSupabaseStorageUrl(resolvedBucket, resolvedPath) ||
    (asset.file_path?.startsWith('http') ? asset.file_path : '') ||
    '';

  // Processar href se existir
  let processedAsset: NormalizedSiteAsset = {
    ...asset,
    key: cleanKey ?? asset.key,
    bucket: resolvedBucket,
    file_path: cleanPath ?? '',
    page: resolvedPage,
    resolvedPage,
    publicUrl,
  };

  if (asset.href) {
    const validatedHref = validateExternalUrl(asset.href);
    if (validatedHref) {
      processedAsset = {
        ...processedAsset,
        href: validatedHref,
      };
    }
  }

  return processedAsset;
}

export function normalizeAssetList(
  assets: DbAsset[],
  options: { onlyActive?: boolean; dropInvalid?: boolean } = {}
) {
  const { onlyActive = false, dropInvalid = true } = options;
  const normalizedByKey = new Map<string, NormalizedSiteAsset>();
  const normalizedByPath = new Map<string, NormalizedSiteAsset>();

  const isInvalidValue = (value?: string | null) => {
    if (!value) return true;
    const normalizedValue = value.trim().toLowerCase();
    if (!normalizedValue) return true;
    return (
      normalizedValue.startsWith('updated_at:') ||
      normalizedValue.startsWith('key:') ||
      normalizedValue.startsWith('file_path:') ||
      normalizedValue === '.keep' ||
      normalizedValue === '.emptyfolderplaceholder'
    );
  };

  const dedupeDoublePrefix = (value?: string | null) => {
    if (!value) return value;
    const trimmed = value.trim();
    if (!trimmed) return value;

    const delimiter = trimmed.includes('/') ? '/' : '.';
    const parts = trimmed.split(delimiter).filter(Boolean);
    if (parts.length < 4) return value;

    const maxPrefix = Math.min(3, Math.floor(parts.length / 2));
    for (let len = 1; len <= maxPrefix; len++) {
      const first = parts.slice(0, len).join('|').toLowerCase();
      const second = parts
        .slice(len, len * 2)
        .join('|')
        .toLowerCase();
      if (first === second) {
        const deduped = [...parts.slice(0, len), ...parts.slice(len * 2)];
        return deduped.join(delimiter);
      }
    }
    return value;
  };

  const scoreRecord = (record: NormalizedSiteAsset) => {
    const activeScore = record.is_active ? 4 : 0;
    const urlScore = record.publicUrl ? 2 : 0;
    const pathScore = record.file_path?.includes('/') ? 1 : 0;
    const lengthPenalty = Math.min(record.key?.length ?? 0, 60) * 0.01;
    return activeScore + urlScore + pathScore - lengthPenalty;
  };

  for (const asset of assets) {
    const cleanedAsset: DbAsset = {
      ...asset,
      key: dedupeDoublePrefix(asset.key) ?? asset.key,
      file_path: dedupeDoublePrefix(asset.file_path) ?? asset.file_path,
    };

    const record = normalizeAssetRecord(cleanedAsset);
    const key = record.key?.trim();
    if (!key) continue;

    if (dropInvalid) {
      if (isInvalidValue(key) || isInvalidValue(record.file_path)) continue;
    }

    if (onlyActive && !record.is_active) continue;

    const hasUsableUrl = Boolean(
      record.publicUrl || record.asset_type === 'font' || record.href
    );
    if (dropInvalid && !hasUsableUrl) continue;

    const decide = (
      current: NormalizedSiteAsset | undefined,
      next: NormalizedSiteAsset
    ) => {
      if (!current) return next;
      const currentScore = scoreRecord(current);
      const nextScore = scoreRecord(next);
      if (nextScore > currentScore) return next;
      if (nextScore === currentScore) {
        return next.key.length < current.key.length ? next : current;
      }
      return current;
    };

    const bestByKey = decide(normalizedByKey.get(key), record);
    normalizedByKey.set(key, bestByKey);

    const pathKey = record.file_path || '';
    if (pathKey) {
      const bestByPath = decide(normalizedByPath.get(pathKey), record);
      normalizedByPath.set(pathKey, bestByPath);
    }
  }

  const merged = new Map<string, NormalizedSiteAsset>();
  for (const item of normalizedByKey.values()) {
    merged.set(item.id, item);
  }
  for (const item of normalizedByPath.values()) {
    merged.set(item.id, item);
  }

  return Array.from(merged.values()).sort((a, b) => {
    const pageA = a.page ?? '';
    const pageB = b.page ?? '';
    if (pageA === pageB) {
      const orderA = a.sort_order ?? Number.MAX_SAFE_INTEGER;
      const orderB = b.sort_order ?? Number.MAX_SAFE_INTEGER;
      if (orderA === orderB) return a.key.localeCompare(b.key);
      return orderA - orderB;
    }
    return pageA.localeCompare(pageB);
  });
}
interface SupabaseLoaderProps {
  src: string;
  width: number;
  quality?: number;
}

const DEFAULT_SUPABASE_URL = 'https://aymuvxysygrwoicsjgxj.supabase.co';
const IMAGE_EXTENSIONS = ['.png', '.jpg', '.jpeg', '.webp', '.avif'];
const NON_TRANSFORM_EXTENSIONS = [
  '.svg',
  '.mp4',
  '.webm',
  '.mov',
  '.m4v',
  '.gif',
];

export default function supabaseLoader({
  src,
  width,
  quality,
}: SupabaseLoaderProps): string {
  const normalizedSrc = src.split('?')[0].toLowerCase();

  const appendParams = (url: string, w: number, q: number) => {
    const separator = url.includes('?') ? '&' : '?';
    return `${url}${separator}width=${w}&quality=${q || 75}`;
  };

  // If the image is already a full URL, we need to extract the path or modify it.

  // 1. Handle local images (starting with /). Return as-is to avoid breaking them.
  // Next.js default loader would handle these if we weren't using a custom loader globally.
  // Since we are, returning src essentially serves the original asset.
  if (src.startsWith('/')) {
    return src;
  }

  // Skip transformation for non-image formats (videos, SVGs, GIFs)
  if (NON_TRANSFORM_EXTENSIONS.some((ext) => normalizedSrc.endsWith(ext))) {
    return src;
  }

  let projectId = '';
  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
  if (supabaseUrl) {
    try {
      const url = new URL(supabaseUrl);
      const parts = url.hostname.split('.');
      if (parts.length > 0) {
        projectId = parts[0];
      }
    } catch (e) {
      console.error('Invalid NEXT_PUBLIC_SUPABASE_URL', e);
    }
  }

  // Fallback if env var is missing or we want to parse from src
  if (!projectId && src.includes('supabase.co')) {
    try {
      const url = new URL(src);
      const parts = url.hostname.split('.');
      if (parts.length > 0) {
        projectId = parts[0];
      }
    } catch {
      // ignore
    }
  }

  if (src.includes('/storage/v1/object/public/')) {
    const base = src.startsWith('http')
      ? src
      : `${DEFAULT_SUPABASE_URL}${src.startsWith('/') ? '' : '/'}${src}`;

    const isImage = IMAGE_EXTENSIONS.some((ext) => normalizedSrc.endsWith(ext));

    // Only apply Supabase image renderer for supported image extensions
    if (isImage) {
      const newSrc = base.replace(
        '/storage/v1/object/public/',
        '/storage/v1/render/image/public/'
      );
      return appendParams(newSrc, width, quality || 75);
    }

    // For other file types (e.g., video), serve the object URL untouched
    return base;
  }

  // If it matches the render/image pattern already, just append params
  if (src.includes('/storage/v1/render/image/public/')) {
    return appendParams(src, width, quality || 75);
  }

  // For relative paths (if any) that are NOT local paths (already handled),
  // construct the full Supabase URL.
  // This path is hit if `src` is something like 'my-bucket/image.png' (not starting with /)
  if (!src.startsWith('http') && projectId) {
    const isImage = IMAGE_EXTENSIONS.some((ext) => normalizedSrc.endsWith(ext));
    const prefix = isImage
      ? '/storage/v1/render/image/public/'
      : '/storage/v1/object/public/';
    const full = `https://${projectId}.supabase.co${prefix}${src}`;
    return isImage ? appendParams(full, width, quality || 75) : full;
  }

  // Fallback for non-Supabase images (return original)
  return src;
}
import { createClient } from '@supabase/supabase-js';

/**
 * Creates a static Supabase client for SSG/ISR
 * bypassing Next.js cookies() access.
 */
export function createStaticClient() {
  if (process.env.PLAYWRIGHT_TEST) {
    const mockQuery = {
      eq: () => mockQuery,
      order: () => mockQuery,
      limit: () => mockQuery,
      returns: () => Promise.resolve({ data: [], error: null }),
      select: () => mockQuery,
      single: () => Promise.resolve({ data: null, error: null }),
    };
    return {
      from: () => mockQuery,
      storage: {
        from: () => ({
          getPublicUrl: () => ({ data: { publicUrl: '' } }),
        }),
      },
    } as any;
  }

  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
  const supabaseKey =
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ??
    process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY;

  if (!supabaseUrl || !supabaseKey) {
    throw new Error('Missing Supabase environment variables');
  }

  return createClient(supabaseUrl, supabaseKey, {
    auth: {
      persistSession: false,
    },
  });
}
import { createClientComponentClient } from '@/lib/supabase/client';
import { buildAssetFilePath } from '@/lib/supabase/asset-paths';
import { normalizeStoragePath } from '@/lib/supabase/urls';

type UploadBucket = 'portfolio-media' | 'site-assets';

function buildPath(base: string, slug: string) {
  const sanitizedBase = base.replace(/\/+$/g, '').replace(/^\/+/g, '');
  const basePath = sanitizedBase ? `${sanitizedBase}` : '';
  return basePath ? `${basePath}/${slug}` : slug;
}

export async function uploadToBucket(
  bucket: UploadBucket,
  basePath: string,
  identifier: string,
  file: File
) {
  const supabase = createClientComponentClient();
  const ext = file.name.split('.').pop();
  const name = ext ? `${identifier}.${ext}` : identifier;
  const path = buildPath(basePath, name);
  const { data, error } = await supabase.storage
    .from(bucket)
    .upload(path, file, { cacheControl: '3600', upsert: true });

  if (error) throw error;
  return normalizeStoragePath(data.path, bucket);
}

export async function uploadSiteAsset({
  file,
  key,
  page,
  subPath,
  bucket = 'site-assets',
}: {
  file: File;
  key: string;
  page?: string | null;
  subPath?: string;
  bucket?: UploadBucket;
}) {
  const supabase = createClientComponentClient();
  const extension = file.name.split('.').pop() ?? 'bin';
  const path = buildAssetFilePath({
    page,
    key,
    subPath,
    extension,
  });

  const { data, error } = await supabase.storage
    .from(bucket)
    .upload(path, file, { cacheControl: '3600', upsert: true });

  if (error) throw error;
  return normalizeStoragePath(data.path, bucket);
}
import { createClient } from '@/lib/supabase/server';
import type { DbProject, DbTag } from '@/types/admin';
import type { SupabaseClient } from '@supabase/supabase-js';

type ProjectFilters = {
  tagSlug?: string;
  year?: number;
  search?: string;
  includeUnpublished?: boolean;
  featuredOnHome?: boolean;
  featuredOnPortfolio?: boolean;
};

export type DbProjectWithTags = DbProject & {
  tags?: Array<{ tag: DbTag } | null> | null;
  landing_page?: { slug: string } | null;
};

export async function listProjects(
  filters: ProjectFilters = {},
  supabaseClient?: SupabaseClient
) {
  const supabase = supabaseClient ?? (await createClient());

  let query = supabase
    .from('portfolio_projects')
    .select(
      '*, tags:portfolio_project_tags(tag:portfolio_tags(id, slug, label, kind)), landing_page:landing_pages(slug)'
    )
    .order('featured_portfolio_order', { ascending: true, nullsFirst: false });

  if (!filters.includeUnpublished) {
    query = query.eq('is_published', true);
  }

  if (filters.tagSlug) {
    query = query.eq('tags.tag.slug', filters.tagSlug);
  }

  if (filters.year) {
    query = query.eq('year', filters.year);
  }

  if (filters.search) {
    query = query.or(
      `title.ilike.%${filters.search}%,client_name.ilike.%${filters.search}%`
    );
  }

  if (filters.featuredOnHome) {
    query = query.eq('featured_on_home', true);
  }

  if (filters.featuredOnPortfolio) {
    query = query.eq('featured_on_portfolio', true);
  }

  const { data, error } = await query.returns<DbProjectWithTags[]>();
  if (error) throw error;
  return data;
}

export async function getProject(id: string) {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('portfolio_projects')
    .select(
      '*, tags:portfolio_project_tags(tag:portfolio_tags(id, slug, label, kind))'
    )
    .eq('id', id)
    .single();

  if (error) throw error;
  return data as DbProject;
}

export async function upsertProject(
  payload: Partial<DbProject> & { id?: string; tagIds?: string[] }
) {
  const supabase = await createClient();

  const { tagIds, ...projectData } = payload;

  const { data, error } = await supabase
    .from('portfolio_projects')
    .upsert(projectData, { onConflict: 'id' })
    .select()
    .single();

  if (error) throw error;

  if (tagIds && data?.id) {
    await supabase
      .from('portfolio_project_tags')
      .delete()
      .eq('project_id', data.id);
    if (tagIds.length > 0) {
      const relations = tagIds.map((tagId) => ({
        project_id: data.id,
        tag_id: tagId,
      }));
      const { error: relError } = await supabase
        .from('portfolio_project_tags')
        .insert(relations);
      if (relError) throw relError;
    }
  }

  return data as DbProject;
}

export async function togglePublish(formData: FormData) {
  'use server';
  const projectId = formData.get('id') as string;
  const nextStatus = (formData.get('nextStatus') as string) === 'true';
  const supabase = await createClient();
  const { error } = await supabase
    .from('portfolio_projects')
    .update({ is_published: nextStatus })
    .eq('id', projectId);
  if (error) throw error;
}

export async function deleteProject(projectId: string) {
  const supabase = await createClient();
  const { error } = await supabase
    .from('portfolio_projects')
    .delete()
    .eq('id', projectId);
  if (error) throw error;
}
import { createClient } from '@/lib/supabase/server';
import type { DbAsset } from '@/types/admin';
import {
  normalizeAssetList,
  type NormalizedSiteAsset,
} from '@/lib/supabase/site-asset-utils';
import { normalizeStoragePath } from '@/lib/supabase/urls';

export async function listAssets(): Promise<NormalizedSiteAsset[]> {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('site_assets')
    .select('*')
    .order('page', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  if (error) throw error;
  return normalizeAssetList((data ?? []) as DbAsset[]);
}

export async function upsertAsset(payload: Partial<DbAsset>) {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('site_assets')
    .upsert(
      {
        ...payload,
        file_path: payload.file_path
          ? normalizeStoragePath(payload.file_path, payload.bucket)
          : payload.file_path,
      },
      { onConflict: 'id' }
    )
    .select()
    .single();

  if (error) throw error;
  return data as DbAsset;
}
import { createClient } from '@/lib/supabase/server';
import type { DbTag } from '@/types/admin';

export async function listTags() {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('portfolio_tags')
    .select('*')
    .order('sort_order', { ascending: true, nullsFirst: false });

  if (error) throw error;
  return data as DbTag[];
}

export async function upsertTag(payload: Partial<DbTag>) {
  const supabase = await createClient();
  const { data, error } = await supabase
    .from('portfolio_tags')
    .upsert(payload, { onConflict: 'id' })
    .select()
    .single();

  if (error) throw error;
  return data as DbTag;
}

export async function deleteTag(tagId: string) {
  const supabase = await createClient();
  const { error } = await supabase
    .from('portfolio_tags')
    .delete()
    .eq('id', tagId);
  if (error) throw error;
}
'use server';

import { redirect } from 'next/navigation';
import { createClient } from '@/lib/supabase/server';

export async function signOut() {
  const supabase = await createClient();
  await supabase.auth.signOut();
  redirect('/admin/login');
}
import { createBrowserClient } from '@supabase/ssr';

let supabaseClient: ReturnType<typeof createBrowserClient> | null = null;

export function createClientComponentClient() {
  if (process.env.PLAYWRIGHT_TEST) {
    const mockQuery = {
      eq: () => mockQuery,
      order: () => mockQuery,
      limit: () => mockQuery,
      returns: () => Promise.resolve({ data: [], error: null }),
      select: () => mockQuery,
      single: () => Promise.resolve({ data: null, error: null }),
    };
    return {
      from: () => mockQuery,
      auth: {
        getSession: () =>
          Promise.resolve({ data: { session: null }, error: null }),
        onAuthStateChange: () => ({
          data: { subscription: { unsubscribe: () => {} } },
        }),
      },
      storage: {
        from: () => ({
          getPublicUrl: () => ({ data: { publicUrl: '' } }),
        }),
      },
    } as any;
  }

  if (supabaseClient) {
    return supabaseClient;
  }

  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
  const supabaseKey =
    process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

  if (!supabaseUrl) {
    throw new Error('NEXT_PUBLIC_SUPABASE_URL não está definida.');
  }
  if (!supabaseKey) {
    throw new Error(
      'Defina NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ou NEXT_PUBLIC_SUPABASE_ANON_KEY.'
    );
  }

  supabaseClient = createBrowserClient(supabaseUrl, supabaseKey, {
    // Firebase Hosting só encaminha o cookie "__session" para as Functions.
    // Forçamos o Supabase a usar esse nome para persistir a sessão.
    cookieOptions: {
      name: '__session',
      sameSite: 'lax',
      secure: true,
    },
  });

  return supabaseClient;
}
import { createClientComponentClient } from '@/lib/supabase/client';
import type { DbAsset } from '@/types/admin';
import {
  normalizeAssetList,
  type NormalizedSiteAsset,
} from '@/lib/supabase/site-asset-utils';

export type SiteAsset = NormalizedSiteAsset;

export async function getClientSiteAssets() {
  const supabase = createClientComponentClient();
  const { data, error } = await supabase
    .from('site_assets')
    .select('*')
    .order('page', { ascending: true })
    .order('sort_order', { ascending: true, nullsFirst: false });

  if (error) throw error;

  const records = (data ?? []) as DbAsset[];
  return normalizeAssetList(records, { onlyActive: true }) as SiteAsset[];
}
import { createServerClient } from '@supabase/ssr';
import { NextResponse, type NextRequest } from 'next/server';

export async function updateSession(request: NextRequest) {
  let supabaseResponse = NextResponse.next({
    request,
  });

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll();
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          );
          supabaseResponse = NextResponse.next({
            request,
          });
          cookiesToSet.forEach(({ name, value, options }) =>
            supabaseResponse.cookies.set(name, value, options)
          );
        },
      },
    }
  );

  // refreshing the auth token
  await supabase.auth.getUser();

  return supabaseResponse;
}
import { createServerClient } from '@supabase/ssr';
import { cookies } from 'next/headers';

export async function createClient() {
  let cookieStore: Awaited<ReturnType<typeof cookies>> | undefined;
  try {
    cookieStore = await cookies();
  } catch {
    // During build/static generation, cookies() might not be available
  }

  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
  const supabaseKey =
    process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

  if (!supabaseUrl) {
    throw new Error('NEXT_PUBLIC_SUPABASE_URL não está definida no ambiente.');
  }

  if (!supabaseKey) {
    throw new Error(
      'Defina NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ou NEXT_PUBLIC_SUPABASE_ANON_KEY.'
    );
  }

  return createServerClient(supabaseUrl, supabaseKey, {
    cookieOptions: {
      // Firebase Hosting (Functions/Frameworks) só encaminha "__session"
      name: '__session',
      sameSite: 'lax',
      secure: true,
    },
    cookies: {
      getAll() {
        return cookieStore?.getAll() ?? [];
      },
      setAll(cookiesToSet) {
        try {
          cookiesToSet.forEach(({ name, value, options }) =>
            cookieStore?.set(name, value, options)
          );
        } catch {
          // The `setAll` method was called from a Server Component.
        }
      },
    },
  });
}
import { ReactNode } from 'react';

export interface ProjectCategory {
  id: string;
  label: string;
  thumb: string;
}

export interface NavLink {
  label: string;
  href: string;
}

export interface Social {
  platform: string;
  url: string;
  icon: ReactNode;
}

export interface Project {
  slug: string;
  title: string;
  client: string;
  category: string;
  displayCategory?: string;
  image: string;
  isHero?: boolean;
  year: number;
}

export interface Asset {
  videoManifesto: string;
  favicon: string;
  logoLight: string;
  logoDark: string;
}
import { initializeApp, getApps } from 'firebase/app';
import { getAnalytics, isSupported } from 'firebase/analytics';

const firebaseConfig = {
  apiKey: 'AIzaSyBe7uThxjKtP0A9QgK9KMu59bAUB4GXj4g',
  authDomain: 'portfolio-danilo-novais.firebaseapp.com',
  databaseURL: 'https://portfolio-danilo-novais-default-rtdb.firebaseio.com',
  projectId: 'portfolio-danilo-novais',
  storageBucket: 'portfolio-danilo-novais.firebasestorage.app',
  messagingSenderId: '350817205989',
  appId: '1:350817205989:web:f7ae32f12d353ef081de0c',
  measurementId: 'G-PM34VYPZZW',
};

// Initialize Firebase
const app =
  getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];

// Initialize Analytics only on client side and if supported
let analytics;
if (typeof window !== 'undefined') {
  isSupported().then((supported) => {
    if (supported) {
      analytics = getAnalytics(app);
    }
  });
}

export { app, analytics };
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  graphql_public: {
    Tables: {
      [_ in never]: never
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      graphql: {
        Args: {
          extensions?: Json
          operationName?: string
          query?: string
          variables?: Json
        }
        Returns: Json
      }
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
  public: {
    Tables: {
      landing_pages: {
        Row: {
          content: Json
          cover: string | null
          created_at: string | null
          id: string
          slug: string
          title: string
        }
        Insert: {
          content?: Json
          cover?: string | null
          created_at?: string | null
          id?: string
          slug: string
          title: string
        }
        Update: {
          content?: Json
          cover?: string | null
          created_at?: string | null
          id?: string
          slug?: string
          title?: string
        }
        Relationships: []
      }
      portfolio_project_tags: {
        Row: {
          project_id: string
          tag_id: string
        }
        Insert: {
          project_id: string
          tag_id: string
        }
        Update: {
          project_id?: string
          tag_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "portfolio_project_tags_project_id_fkey"
            columns: ["project_id"]
            isOneToOne: false
            referencedRelation: "portfolio_projects"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "portfolio_project_tags_tag_id_fkey"
            columns: ["tag_id"]
            isOneToOne: false
            referencedRelation: "portfolio_tags"
            referencedColumns: ["id"]
          },
        ]
      }
      portfolio_projects: {
        Row: {
          brand_name: string | null
          client_name: string
          created_at: string
          description: string | null
          featured_home_order: number | null
          featured_on_home: boolean
          featured_on_portfolio: boolean
          featured_portfolio_order: number | null
          gallery: Json
          hero_image_path: string | null
          id: string
          is_published: boolean
          landing_page_id: string | null
          project_type: string
          short_label: string | null
          slug: string
          thumbnail_path: string | null
          title: string
          updated_at: string
          year: number | null
        }
        Insert: {
          brand_name?: string | null
          client_name: string
          created_at?: string
          description?: string | null
          featured_home_order?: number | null
          featured_on_home?: boolean
          featured_on_portfolio?: boolean
          featured_portfolio_order?: number | null
          gallery?: Json
          hero_image_path?: string | null
          id?: string
          is_published?: boolean
          landing_page_id?: string | null
          project_type: string
          short_label?: string | null
          slug: string
          thumbnail_path?: string | null
          title: string
          updated_at?: string
          year?: number | null
        }
        Update: {
          brand_name?: string | null
          client_name?: string
          created_at?: string
          description?: string | null
          featured_home_order?: number | null
          featured_on_home?: boolean
          featured_on_portfolio?: boolean
          featured_portfolio_order?: number | null
          gallery?: Json
          hero_image_path?: string | null
          id?: string
          is_published?: boolean
          landing_page_id?: string | null
          project_type?: string
          short_label?: string | null
          slug?: string
          thumbnail_path?: string | null
          title?: string
          updated_at?: string
          year?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "portfolio_projects_landing_page_id_fkey"
            columns: ["landing_page_id"]
            isOneToOne: false
            referencedRelation: "landing_pages"
            referencedColumns: ["id"]
          },
        ]
      }
      portfolio_tags: {
        Row: {
          created_at: string
          description: string | null
          id: string
          kind: string
          label: string
          slug: string
          sort_order: number | null
        }
        Insert: {
          created_at?: string
          description?: string | null
          id?: string
          kind?: string
          label: string
          slug: string
          sort_order?: number | null
        }
        Update: {
          created_at?: string
          description?: string | null
          id?: string
          kind?: string
          label?: string
          slug?: string
          sort_order?: number | null
        }
        Relationships: []
      }
      site_assets: {
        Row: {
          asset_type: string
          bucket: string
          created_at: string
          description: string | null
          file_path: string
          id: string
          is_active: boolean
          key: string
          page: string | null
          sort_order: number | null
          updated_at: string
        }
        Insert: {
          asset_type: string
          bucket: string
          created_at?: string
          description?: string | null
          file_path: string
          id?: string
          is_active?: boolean
          key: string
          page?: string | null
          sort_order?: number | null
          updated_at?: string
        }
        Update: {
          asset_type?: string
          bucket?: string
          created_at?: string
          description?: string | null
          file_path?: string
          id?: string
          is_active?: boolean
          key?: string
          page?: string | null
          sort_order?: number | null
          updated_at?: string
        }
        Relationships: []
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DatabaseWithoutInternals = Omit<Database, "__InternalSupabase">

type DefaultSchema = DatabaseWithoutInternals[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof DatabaseWithoutInternals },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof DatabaseWithoutInternals },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  graphql_public: {
    Enums: {},
  },
  public: {
    Enums: {},
  },
} as const

export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  // Allows to automatically instantiate createClient with right options
  // instead of createClient<Database, { PostgrestVersion: 'XX' }>(URL, KEY)
  __InternalSupabase: {
    PostgrestVersion: "14.1"
  }
  public: {
    Tables: {
      landing_pages: {
        Row: {
          content: Json
          cover: string | null
          created_at: string | null
          id: string
          slug: string
          title: string
        }
        Insert: {
          content?: Json
          cover?: string | null
          created_at?: string | null
          id?: string
          slug: string
          title: string
        }
        Update: {
          content?: Json
          cover?: string | null
          created_at?: string | null
          id?: string
          slug?: string
          title?: string
        }
        Relationships: []
      }
      portfolio_project_tags: {
        Row: {
          project_id: string
          tag_id: string
        }
        Insert: {
          project_id: string
          tag_id: string
        }
        Update: {
          project_id?: string
          tag_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "portfolio_project_tags_project_id_fkey"
            columns: ["project_id"]
            isOneToOne: false
            referencedRelation: "portfolio_projects"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "portfolio_project_tags_tag_id_fkey"
            columns: ["tag_id"]
            isOneToOne: false
            referencedRelation: "portfolio_tags"
            referencedColumns: ["id"]
          },
        ]
      }
      portfolio_projects: {
        Row: {
          brand_name: string | null
          client_name: string
          created_at: string
          description: string | null
          featured_home_order: number | null
          featured_on_home: boolean
          featured_on_portfolio: boolean
          featured_portfolio_order: number | null
          gallery: Json
          hero_image_path: string | null
          id: string
          is_published: boolean
          landing_page_id: string | null
          project_type: string
          short_label: string | null
          slug: string
          thumbnail_path: string | null
          title: string
          updated_at: string
          year: number | null
        }
        Insert: {
          brand_name?: string | null
          client_name: string
          created_at?: string
          description?: string | null
          featured_home_order?: number | null
          featured_on_home?: boolean
          featured_on_portfolio?: boolean
          featured_portfolio_order?: number | null
          gallery?: Json
          hero_image_path?: string | null
          id?: string
          is_published?: boolean
          landing_page_id?: string | null
          project_type: string
          short_label?: string | null
          slug: string
          thumbnail_path?: string | null
          title: string
          updated_at?: string
          year?: number | null
        }
        Update: {
          brand_name?: string | null
          client_name?: string
          created_at?: string
          description?: string | null
          featured_home_order?: number | null
          featured_on_home?: boolean
          featured_on_portfolio?: boolean
          featured_portfolio_order?: number | null
          gallery?: Json
          hero_image_path?: string | null
          id?: string
          is_published?: boolean
          landing_page_id?: string | null
          project_type?: string
          short_label?: string | null
          slug?: string
          thumbnail_path?: string | null
          title?: string
          updated_at?: string
          year?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "portfolio_projects_landing_page_id_fkey"
            columns: ["landing_page_id"]
            isOneToOne: false
            referencedRelation: "landing_pages"
            referencedColumns: ["id"]
          },
        ]
      }
      portfolio_tags: {
        Row: {
          created_at: string
          description: string | null
          id: string
          kind: string
          label: string
          slug: string
          sort_order: number | null
        }
        Insert: {
          created_at?: string
          description?: string | null
          id?: string
          kind?: string
          label: string
          slug: string
          sort_order?: number | null
        }
        Update: {
          created_at?: string
          description?: string | null
          id?: string
          kind?: string
          label?: string
          slug?: string
          sort_order?: number | null
        }
        Relationships: []
      }
      project_config: {
        Row: {
          accessed_by: string | null
          api_keys: Json | null
          auth_providers: Json | null
          created_at: string | null
          created_by: string | null
          environment: string | null
          id: string
          is_active: boolean | null
          jwt_expiry: number | null
          last_accessed: string | null
          project_description: string | null
          project_domain: string | null
          project_name: string
          public_env_vars: Json | null
          storage_buckets: Json | null
          storage_permissions: Json | null
          updated_at: string | null
        }
        Insert: {
          accessed_by?: string | null
          api_keys?: Json | null
          auth_providers?: Json | null
          created_at?: string | null
          created_by?: string | null
          environment?: string | null
          id?: string
          is_active?: boolean | null
          jwt_expiry?: number | null
          last_accessed?: string | null
          project_description?: string | null
          project_domain?: string | null
          project_name: string
          public_env_vars?: Json | null
          storage_buckets?: Json | null
          storage_permissions?: Json | null
          updated_at?: string | null
        }
        Update: {
          accessed_by?: string | null
          api_keys?: Json | null
          auth_providers?: Json | null
          created_at?: string | null
          created_by?: string | null
          environment?: string | null
          id?: string
          is_active?: boolean | null
          jwt_expiry?: number | null
          last_accessed?: string | null
          project_description?: string | null
          project_domain?: string | null
          project_name?: string
          public_env_vars?: Json | null
          storage_buckets?: Json | null
          storage_permissions?: Json | null
          updated_at?: string | null
        }
        Relationships: []
      }
      site_assets: {
        Row: {
          asset_type: string
          bucket: string
          created_at: string
          description: string | null
          file_path: string
          id: string
          is_active: boolean
          key: string
          page: string | null
          sort_order: number | null
          updated_at: string
        }
        Insert: {
          asset_type: string
          bucket: string
          created_at?: string
          description?: string | null
          file_path: string
          id?: string
          is_active?: boolean
          key: string
          page?: string | null
          sort_order?: number | null
          updated_at?: string
        }
        Update: {
          asset_type?: string
          bucket?: string
          created_at?: string
          description?: string | null
          file_path?: string
          id?: string
          is_active?: boolean
          key?: string
          page?: string | null
          sort_order?: number | null
          updated_at?: string
        }
        Relationships: []
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DatabaseWithoutInternals = Omit<Database, "__InternalSupabase">

type DefaultSchema = DatabaseWithoutInternals[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof DatabaseWithoutInternals },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof DatabaseWithoutInternals },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  public: {
    Enums: {},
  },
} as const
import React from 'react';
import {
  Mail,
  Phone,
  MapPin,
  Linkedin,
  Instagram,
  Twitter,
  Facebook, // Adicionado conforme spec
} from 'lucide-react';
import { getGhostAssetUrl } from '@/utils/utils';

// Se não tiveres um ficheiro de tipos, podes definir aqui ou importar
// import { ProjectCategory } from './types';
export type ProjectCategory = {
  id: string;
  label: string;
  posterUrl: string;
  thumbnailUrl: string;
};

// --- 1. ASSETS GLOBAIS ---
export const ASSETS = {
  videoManifesto: getGhostAssetUrl('site-assets/home/home.manifesto_video.mp4'),
  favicon: getGhostAssetUrl('logo_site/logo.svg'),
  logoLight: getGhostAssetUrl('logo_site/faivcon-02.svg'),
  logoDark: getGhostAssetUrl('logo_site/faivcon.svg'),
};

// --- 2. CONTEÚDO DA HOME (TEXTOS) ---
export const HOME_CONTENT = {
  hero: {
    tag: '[BRAND AWARENESS]',
    // O componente HeroCopy espera um array para quebrar a linha visualmente
    title: ['Design,não é', 'só estética.'],
    subtitle: '[É intenção, é estratégia, é experiência.]',
    cta: 'get to know me better',
  },
};

// --- 3. DADOS DE NAVEGAÇÃO ---
export const NAV_LINKS = [
  { label: 'home', href: '/#hero' },
  { label: 'sobre', href: '/sobre' },
  { label: 'portfolio showcase', href: '/portfolio' },
  { label: 'contato', href: '/#contact' },
];

// --- 4. PROJETOS EM DESTAQUE ---
export const FEATURED_PROJECTS = [
  {
    slug: 'magic-radio-branding',
    title: 'Magic — devolvendo a magia ao rádio',
    client: 'Magic',
    category: 'branding & campanha',
    displayCategory: 'branding & campanha',
    imageUrl: getGhostAssetUrl('project-images/Brand-Identity%20copy.webp'),
    isHero: true,
    year: '2023',
  },
  {
    slug: 'branding-project-01',
    title: 'Uma marca ousada e consistente',
    client: 'Cliente confidencial',
    category: 'branding',
    displayCategory: 'branding',
    imageUrl: getGhostAssetUrl('project-images/Branding-Project.webp'),
    isHero: false,
    year: '2022',
  },
  {
    slug: 'key-visual-campaign',
    title: 'Key visual para campanha sazonal',
    client: 'Cliente confidencial',
    category: 'campanha',
    displayCategory: 'campanha',
    imageUrl: getGhostAssetUrl('project-images/Key-Visual.webp'),
    isHero: false,
    year: '2021',
  },
  {
    slug: 'webdesigner-motion',
    title: 'Experiência web em movimento',
    client: 'Cliente confidencial',
    category: 'web & motion',
    displayCategory: 'web & motion',
    imageUrl: getGhostAssetUrl('project-images/webdesigner-2%202.gif'),
    isHero: false,
    year: '2023',
  },
];

// --- 5. CATEGORIAS (PORTFOLIO SHOWCASE) ---
export const CATEGORIES: ProjectCategory[] = [
  {
    id: 'brand-campaigns',
    label: 'Brand & Campaigns',
    posterUrl: getGhostAssetUrl('project-images/Branding-Project.webp'),
    thumbnailUrl: '',
  },
  {
    id: 'videos-motions',
    label: 'Videos & Motions',
    posterUrl: getGhostAssetUrl('project-images/webdesigner-2%202.gif'),
    thumbnailUrl: '',
  },
  {
    id: 'websites-webcampaigns-tech',
    label: 'Web Campaigns, Websites & Tech',
    posterUrl: getGhostAssetUrl('project-images/WelcomeAd_800x500px.webp'),
    thumbnailUrl: '',
  },
];

// --- 6. CLIENTES ---
export const CLIENT_LOGOS = [
  {
    name: 'Client 1',
    src: getGhostAssetUrl('client-logos/client1.svg'),
  },
  {
    name: 'Client 2',
    src: getGhostAssetUrl('client-logos/client2.svg'),
  },
  {
    name: 'Client 3',
    src: getGhostAssetUrl('client-logos/client3.svg'),
  },
  {
    name: 'Client 4',
    src: getGhostAssetUrl('client-logos/client4.svg'),
  },
  {
    name: 'Client 5',
    src: getGhostAssetUrl('client-logos/client5.svg'),
  },
  {
    name: 'Client 6',
    src: getGhostAssetUrl('client-logos/client6.svg'),
  },
  {
    name: 'Client 7',
    src: getGhostAssetUrl('client-logos/client7.svg'),
  },
  {
    name: 'Client 8',
    src: getGhostAssetUrl('client-logos/client8.svg'),
  },
  {
    name: 'Client 9',
    src: getGhostAssetUrl('client-logos/client9.svg'),
  },
  {
    name: 'Client 10',
    src: getGhostAssetUrl('client-logos/client10.svg'),
  },
  {
    name: 'Client 11',
    src: getGhostAssetUrl('client-logos/client11.svg'),
  },
  {
    name: 'Client 12',
    src: getGhostAssetUrl('client-logos/client12.svg'),
  },
];

// --- 7. CONFIGURAÇÃO DE CONTATO ---
export const CONTACT_CONFIG = {
  title: 'contato',
  subtitle: 'Tem uma pergunta ou quer trabalhar junto?',
  formAction: 'https://formsubmit.co/danilo@portfoliodanilo.com',
  submitLabel: 'Enviar Mensagem',
  emails: {
    primary: 'dannovaisv@gmail.com',
    secondary: 'danilo@portfoliodanilo.com',
  },
};

export const CONTACT_INFO = [
  {
    label: 'danilo@portfoliodanilo.com', // Usando o secundário para display conforme spec visual ou primário? A spec lista ambos.
    href: 'mailto:danilo@portfoliodanilo.com',
    icon: <Mail className="w-5 h-5" />,
  },
  {
    label: '+55 (11) 98396-6838',
    href: 'tel:+5511983966838',
    icon: <Phone className="w-5 h-5" />,
  },
  {
    label: 'São Paulo, SP',
    href: '#',
    icon: <MapPin className="w-5 h-5" />,
  },
];

export const SOCIALS = [
  {
    platform: 'LinkedIn',
    url: 'https://linkedin.com/in/danilonovais',
    icon: <Linkedin className="w-5 h-5" />,
  },
  {
    platform: 'Instagram',
    url: 'https://instagram.com/danilo_novais',
    icon: <Instagram className="w-5 h-5" />,
  },
  {
    platform: 'Facebook', // Adicionado da Spec
    url: 'https://facebook.com/danilonovaisvilela',
    icon: <Facebook className="w-5 h-5" />,
  },
  {
    platform: 'Twitter',
    url: 'https://twitter.com/danilo_novais',
    icon: <Twitter className="w-5 h-5" />,
  },
];

// --- 8. FOOTER ---
export const FOOTER_CONTENT = {
  copyright: '© 2025 Danilo Novais Vilela — todos os direitos reservados.',
};
import type {
  PortfolioProject,
  ProjectCategory,
  ProjectGridLayout,
  ProjectType,
} from '@/types/project';
import { buildSupabaseStorageUrl } from '@/lib/supabase/urls';
import type { DbProjectWithTags } from '@/lib/supabase/queries/projects';

// Define a type for the static project from HOME_CONTENT
type StaticProject = {
  id: number;
  slug: string;
  title: string;
  category: string;
  client: string;
  year: number;
  tags: string[];
  img: string | null | undefined;
  layout: {
    h: string;
    cols: string;
    sizes: string;
  };
};

const CATEGORY_MAP: Record<string, ProjectCategory> = {
  'Branding & Identity': 'branding',
  'Campanhas & Advertising': 'campanha',
  Campanha: 'campanha',
  Branding: 'branding',
  'Web & Digital': 'web',
  'Motion & Video': 'motion',
  'Institucional & Retail': 'institucional',
  Packaging: 'packaging',
};

const ACCENT_COLOR_MAP: Record<ProjectCategory, string> = {
  branding: '#0057ff',
  campanha: '#ff3366',
  web: '#4fe6ff',
  motion: '#8705f2',
  institucional: '#00a868',
  packaging: '#ffd700',
  all: '#ffffff',
};

function getProjectCategory(projectType?: string): ProjectCategory {
  if (!projectType) return 'branding';
  const normalized = projectType.trim();
  return CATEGORY_MAP[normalized] ?? 'branding';
}

function determineProjectType(
  project: DbProjectWithTags | StaticProject
): ProjectType {
  if ('featured_on_home' in project) {
    // It's a DbProjectWithTags
    if (project.featured_on_home || project.featured_on_portfolio) {
      return 'A';
    }
  }
  // For StaticProject, or if not featured, default to 'B'
  // You might want to refine this logic based on your static data structure
  return 'B';
}

function buildLayout(
  projectType: ProjectType,
  index: number
): ProjectGridLayout {
  /**
   * Layout Pattern para Portfolio Grid:
   * - Rows devem sempre somar 12 colunas (edge-to-edge)
   * - Altura fixa no desktop para uniformidade visual
   * - Pattern: [5+7], [7+5], [4+4+4], [6+6], [8+4], [4+8]
   */
  const pairedLayouts = [
    // Row pattern: 6 + 6 = 12 (Ensures first row is full width)
    {
      cols: 'md:col-span-6 lg:col-span-6',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 50vw',
    },
    {
      cols: 'md:col-span-6 lg:col-span-6',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 50vw',
    },
    // Row pattern: 7 + 5 = 12
    {
      cols: 'md:col-span-5 lg:col-span-7',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 58vw, 58vw',
    },
    {
      cols: 'md:col-span-3 lg:col-span-5',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 42vw, 42vw',
    },
    // Row pattern: 4 + 4 + 4 = 12 (3 cards per row)
    {
      cols: 'md:col-span-4 lg:col-span-4',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 33vw, 33vw',
    },
    {
      cols: 'md:col-span-4 lg:col-span-4',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 33vw, 33vw',
    },
    {
      cols: 'md:col-span-4 lg:col-span-4',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 33vw, 33vw',
    },
    // Row pattern: 6 + 6 = 12 (2 equal cards)
    {
      cols: 'md:col-span-4 lg:col-span-6',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, 50vw',
    },
    {
      cols: 'md:col-span-4 lg:col-span-6',
      height: 'min-h-[320px]',
      aspectRatio: 'aspect-[4/5]',
      sizes: '(max-width: 768px) 100vw, 50vw',
    },
  ];

  // Para projetos do tipo A (featured), usar layouts variados
  // Para tipo B, usar grid uniforme de 4 colunas
  if (projectType === 'A') {
    const layoutIndex = index % pairedLayouts.length;
    return pairedLayouts[layoutIndex];
  }

  // Projetos tipo B: sempre 4 colunas (3 por linha no lg)
  return {
    cols: 'md:col-span-4 lg:col-span-4',
    height: 'min-h-[320px]',
    aspectRatio: 'aspect-[4/5]',
    sizes: '(max-width: 768px) 100vw, (max-width: 1200px) 33vw, 33vw',
  };
}

function toTagsList(tags?: DbProjectWithTags['tags'] | string[]): string[] {
  if (!tags) return [];
  if (typeof tags[0] === 'string') {
    return tags as string[];
  }
  return (
    (tags as DbProjectWithTags['tags'])
      ?.map((entry) => entry?.tag?.label ?? entry?.tag?.slug)
      .filter(Boolean)
      .map((value) => value as string) ?? []
  );
}

function createGallery(project: DbProjectWithTags): string[] {
  const entries = project.gallery ?? [];
  return entries
    .filter((entry): entry is { path: string; caption?: string } => !!entry)
    .map((entry) => entry.path)
    .filter((path): path is string => !!path)
    .map((path) => buildSupabaseStorageUrl('portfolio-media', path))
    .filter((url): url is string => !!url); // Additional filter to remove any null urls from buildSupabaseStorageUrl
}

function toVideoPreview(galleryUrls: string[]) {
  const videoExt = ['mp4', 'mov', 'webm', 'm4v'];
  return (
    galleryUrls.find((url) => {
      const extension = url.split('.').pop()?.toLowerCase();
      return extension ? videoExt.includes(extension) : false;
    }) ?? undefined
  );
}

export function mapDbProjectToPortfolioProject(
  project: DbProjectWithTags,
  index: number
): PortfolioProject {
  const type = determineProjectType(project);
  const layout = buildLayout(type, index);
  const category = getProjectCategory(project.project_type);
  const tags = toTagsList(project.tags);
  const gallery = createGallery(project);
  const thumbnailUrl =
    buildSupabaseStorageUrl('portfolio-media', project.thumbnail_path ?? undefined) ||
    buildSupabaseStorageUrl('portfolio-media', project.hero_image_path ?? undefined);

  const detail = {
    description: project.description ?? '',
    highlights: tags.length ? tags.slice(0, 3) : undefined,
    gallery, // Already filtered in createGallery function
  };

  return {
    id: project.id,
    slug: project.slug,
    title: project.title,
    subtitle: project.short_label ?? project.client_name,
    client: project.client_name,
    category,
    displayCategory: project.project_type ?? 'Web',
    tags,
    year: project.year ?? 0,
    image: thumbnailUrl || '',
    type,
    layout,
    detail,
    accentColor: ACCENT_COLOR_MAP[category] ?? undefined,
    isFeatured: project.featured_on_portfolio,
    featuredOnHome: project.featured_on_home,
    featuredOnPortfolio: project.featured_on_portfolio,
    videoPreview: toVideoPreview(gallery),
    landingPageSlug: project.landing_page?.slug,
  };
}

export function mapStaticProjectToPortfolioProject(
  project: StaticProject,
  index: number
): PortfolioProject {
  const type = determineProjectType(project);
  const layout = buildLayout(type, index);
  const category = getProjectCategory(project.category);
  const tags = toTagsList(project.tags);

  const detail = {
    description: project.title, // fallback
    highlights: tags.slice(0, 3),
    gallery: project.img ? [project.img] : [],
  };

  return {
    id: `static-${project.id}`,
    slug: project.slug,
    title: project.title,
    subtitle: project.client,
    client: project.client,
    category,
    displayCategory: project.category,
    tags,
    year: project.year,
    image: project.img || '',
    type,
    layout,
    detail,
    accentColor: ACCENT_COLOR_MAP[category] ?? undefined,
    isFeatured: true,
    featuredOnHome: true,
    featuredOnPortfolio: true,
    videoPreview: undefined,
    landingPageSlug: undefined,
  };
}
import { getAssetUrl } from '@/utils/utils';

export const PlaceHolderImages = [
  {
    id: 1,
    imageUrl: getAssetUrl('sobre_page/sobre-1.webp'),
    description: 'Observando os detalhes',
    imageHint: 'Abstract creative process visualization - details matter',
  },
  {
    id: 2,
    imageUrl: getAssetUrl('sobre_page/sobre-2.webp'),
    description: 'Processo criativo - do traço à intenção',
    imageHint: 'From sketches to intentional design',
  },
  {
    id: 3,
    imageUrl: getAssetUrl('sobre_page/sobre-3.webp'),
    description: 'Design invisível - transformação silenciosa',
    imageHint: 'Invisible design that transforms without noise',
  },
  {
    id: 4,
    imageUrl: getAssetUrl('sobre_page/sobre-4.webp'),
    description: 'Expansão e tecnologia com essência humana',
    imageHint: 'Expansion with purpose - technology and human essence',
  },
];
import { ExperienceFlags } from '@/store/antigravity.store';

export * from '@/store/antigravity.store';
export * from './prompts';

export const runExperienceOrchestrator = ({
  viewport,
  prefersReducedMotion,
}: {
  viewport: 'desktop' | 'tablet' | 'mobile';
  prefersReducedMotion: boolean;
}): ExperienceFlags => {
  const isMobile = viewport === 'mobile';

  // Default base state
  const flags: ExperienceFlags = {
    mountWebGL: true,
    enableManifestoScroll: true,
    enableHoverInteractions: true,
    reducedMotion: prefersReducedMotion,
    debugMode: process.env.NODE_ENV === 'development',
  };

  // 1. Mobile constraint
  if (isMobile) {
    flags.mountWebGL = false; // WebGL disabled on mobile
  }

  // 2. Reduced Motion overrides strictness
  if (prefersReducedMotion) {
    flags.mountWebGL = false;
    flags.enableManifestoScroll = false;
    flags.enableHoverInteractions = false;
  }

  return flags;
};
/**
 * Google Antigravity Manager Prompts
 * Sistema de prompts atômicos para orquestração de correções no portfólio
 * Ghost System v3.0
 */

// ==========================================
// TYPES
// ==========================================

export type PromptSeverity = 'critical' | 'high' | 'medium' | 'low';
export type PromptStatus = 'pending' | 'in_progress' | 'completed' | 'failed';
export type PromptCategory =
  | 'layout'
  | 'mobile'
  | 'motion'
  | 'accessibility'
  | 'performance';

export interface AtomicPrompt {
  id: string;
  title: string;
  severity: PromptSeverity;
  category: PromptCategory;
  objective: string;
  files: string[];
  actions: string[];
  rules: string[];
  acceptanceCriteria: string[];
  status: PromptStatus;
  dependsOn?: string[];
}

export interface PromptWave {
  id: string;
  name: string;
  description: string;
  prompts: AtomicPrompt[];
}

// ==========================================
// ATOMIC PROMPTS (10 Prompts do Relatório de Auditoria)
// ==========================================

export const ATOMIC_PROMPTS: AtomicPrompt[] = [
  {
    id: 'PROMPT_01',
    title: 'Unificar grid global e margens laterais',
    severity: 'critical',
    category: 'layout',
    objective:
      'Garantir que Home, Sobre e Portfólio usem exatamente o mesmo container (largura útil, gutters e paddings) para obter alinhamento "duas laterais" perfeito em todo o scroll.',
    files: [
      'src/app/layout.tsx',
      'src/components/layout/ClientLayout.tsx',
      'src/components/layout/Container.tsx',
      'src/app/page.tsx',
      'src/app/sobre/page.tsx',
      'src/app/portfolio/page.tsx',
    ],
    actions: [
      'Padronizar um único componente Container com Tailwind (ex.: mx-auto max-w-screen-xl px-4 md:px-6) para refletir exatamente o grid das imagens Ghost.',
      'Garantir que todas as seções principais de Home, Sobre e Portfólio sejam diretamente embrulhadas por esse Container, sem paddings laterais adicionais em cada seção.',
      'Ajustar ClientLayout (se usado) para não duplicar margens/paddings já definidos em Container.',
      'Confirmar que globals.css e Tailwind estão corretamente importados em layout.tsx.',
    ],
    rules: [
      'Mobile-first',
      'Apenas ajustes de layout (sem alterar textos)',
      'Manter o grid idêntico às imagens em docs/HOME, docs/SOBRE e docs/PORTFOLIO',
    ],
    acceptanceCriteria: [
      'Ao rolar de cima a baixo em /, /sobre e /portfolio, as bordas esquerda/direita de títulos, textos e cards mantêm alinhamento perfeito',
      'O item "grid e margens laterais correspondem exatamente à imagem?" pode ser marcado como Sim para todas as seções',
    ],
    status: 'pending',
  },
  {
    id: 'PROMPT_02',
    title: 'Corrigir Header e comportamento de clique em mobile',
    severity: 'critical',
    category: 'mobile',
    objective:
      'Garantir que o Header tenha área de clique/touch consistente, sem interferência na rolagem ou nos CTAs em mobile.',
    files: [
      'src/components/layout/Header.tsx',
      'src/components/layout/header/*',
      'src/app/layout.tsx',
    ],
    actions: [
      'Revisar estrutura de nav e botões de menu (hamburger) para garantir que nenhum elemento overlay capture cliques fora da área esperada.',
      'Em mobile, assegurar que cada item de navegação tenha área mínima de 44×44px (via Tailwind, ex.: px-3 py-2).',
      'Validar se existe algum pointer-events indevido em wrappers do Header que interfiram em cliques no Hero e nas seções abaixo.',
    ],
    rules: [
      'Não alterar o conteúdo textual nem adicionar links novos',
      'Apenas ajustar estrutura e classes Tailwind',
    ],
    acceptanceCriteria: [
      'Em dispositivos touch, todos os links do Header respondem com precisão, sem áreas "mortas" ou cliques acidentais',
      'Nenhum overflow horizontal é introduzido pelo Header',
      'O item "mobile livre de overflow e com touch targets adequados?" pode ser marcado como Sim para Home',
    ],
    status: 'pending',
  },
  {
    id: 'PROMPT_03',
    title: 'Travar Home Hero + GhostScene na referência HERO.jpg',
    severity: 'critical',
    category: 'layout',
    objective:
      'Ajustar tipografia, espaçamento e cena 3D do Hero para ficar 1:1 com docs/HOME/HERO.jpg e o blueprint Ghost.',
    files: [
      'src/components/home/hero/*',
      'src/components/canvas/home/hero/GhostScene.tsx',
    ],
    actions: [
      'Equalizar hierarquia tipográfica (h1, h2/h3, body) com o blueprint, ajustando apenas classes Tailwind (weights, tracking, line-height), sem alterar o texto.',
      'Revisar espaçamentos verticais entre título/subtítulo/CTA para que as distâncias visuais coincidam com a imagem de referência.',
      'Em GhostScene.tsx, ajustar posição, escala e intensidade de luz/materiais para obter o mesmo enquadramento e "glow" do Ghost na HERO.jpg.',
    ],
    rules: [
      'Não mexer no copy',
      'Qualquer ajuste 3D deve preservar performance (usar useFrame apenas quando necessário e memoizar materiais)',
    ],
    acceptanceCriteria: [
      'Comparando a Home Hero com docs/HOME/HERO.jpg, espaçamentos, tipografia e enquadramento do Ghost são indistinguíveis a olho nu',
      'Parallax leve do Ghost permanece suave, sem jitter',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_01'],
  },
  {
    id: 'PROMPT_04',
    title: 'Manifesto: áudio + scroll e grid alinhado',
    severity: 'high',
    category: 'motion',
    objective:
      'Fazer o Manifesto respeitar o grid global e implementar lógica de áudio que auto-mute/unmute conforme a seção entra/sai da viewport.',
    files: [
      'src/components/home/hero/*',
      'src/components/home/ManifestoSection.tsx',
    ],
    actions: [
      'Garantir que o container do Manifesto esteja dentro do mesmo Container global, sem paddings extras.',
      'Implementar observer de scroll (ex.: IntersectionObserver no client) para mutar o áudio quando a seção estiver abaixo de um certo threshold de visibilidade.',
      'Em desktop, permitir que o áudio inicie ao entrar na seção; em mobile, respeitar a necessidade de interação explícita do usuário para iniciar áudio.',
    ],
    rules: [
      'Não alterar o conteúdo do Manifesto',
      'Manter a UI atual, refinando apenas comportamento e layout',
    ],
    acceptanceCriteria: [
      'Manifesto ocupa a mesma largura da Hero/Featured Projects',
      'Áudio nunca continua tocando enquanto a seção está completamente fora de viewport',
      'O checklist de grid/alinhamento e mobile pode ser marcado como Sim para Manifesto',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_01'],
  },
  {
    id: 'PROMPT_05',
    title: 'Featured Projects: grid 100% horizontal e mobile centrado',
    severity: 'critical',
    category: 'layout',
    objective:
      'Fazer os cards de projetos em destaque preencherem 100% da largura do container, com alturas equalizadas por linha e CTAs/textos centralizados em mobile.',
    files: ['src/components/home/featured-projects/*'],
    actions: [
      'Modelar o grid com Tailwind usando combinações de grid-cols-* e auto-fit/auto-fill (ou flex com flex-[x]) para reproduzir a distribuição de larguras da referência, sem espaços vazios.',
      'Garantir que todos os cards de uma mesma linha compartilhem a mesma altura (via items-stretch + conteúdo interno com h-full).',
      'Em mobile, centralizar títulos/descrições/CTAs dos cards e revisar paddings para remover qualquer overflow horizontal.',
    ],
    rules: [
      'Mobile-first',
      'Sem alterar textos',
      'Comparação constante com docs/HOME/HOME-PORTFOLIO-BLACK---GHOST.jpg e docs/HOME/HOME-PORTFOLIO-LAYOUYT-MOBILE---GHOST.jpg',
    ],
    acceptanceCriteria: [
      'Não há gaps horizontais no fim de nenhuma linha',
      'Todos os cards têm mesma altura visual por linha',
      'Em mobile, os CTAs ficam centralizados e facilmente clicáveis',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_01'],
  },
  {
    id: 'PROMPT_06',
    title: 'Portfólio (/portfolio): Mosaic Grid + parallax estilo CodePen',
    severity: 'critical',
    category: 'layout',
    objective:
      'Ajustar o grid de /portfolio para preencher 100% da largura, equalizar alturas por linha e implementar parallax/hover inspirado no CodePen de referência.',
    files: [
      'src/app/portfolio/page.tsx',
      'src/components/portfolio/PortfolioMosaicGrid.tsx',
      'src/components/portfolio/MosaicCard.tsx',
      'src/components/portfolio/PortfolioCard.tsx',
    ],
    actions: [
      'Refatorar PortfolioMosaicGrid para calcular larguras relativas por linha (ex.: colunas flex com basis-* e grow) de forma a sempre fechar 100% da largura do container.',
      'Garantir que todos os cards de uma mesma linha tenham altura igual (via h-full + wrappers internos com flex flex-col e justify-between).',
      'Implementar animações de hover/parallax nos cards usando Framer Motion (ex.: leve translateZ em perspectiva simulada, com easing cubic-bezier(0.22, 1, 0.36, 1)) para aproximar o efeito do CodePen.',
    ],
    rules: [
      'Não alterar estrutura de conteúdo dos cards (título, descrição, tags)',
      'Apenas layout e motion',
    ],
    acceptanceCriteria: [
      'Qualquer linha de cards ocupa 100% da largura do container',
      'Nenhuma linha apresenta gaps residuais',
      'Hover/parallax são fluidos, sem overshoot ou bounce exagerado, replicando a fluidez do CodePen',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_01'],
  },
  {
    id: 'PROMPT_07',
    title: 'About Hero (tipografia) + About Closed (vídeo Supabase)',
    severity: 'critical',
    category: 'accessibility',
    objective:
      'Corrigir a visibilidade do texto em About Hero e implementar troca dinâmica de vídeo Desktop/Mobile em About Closed usando URLs do Supabase.',
    files: [
      'src/components/sobre/AboutHero.tsx',
      'src/components/sobre/AboutClosing.tsx',
    ],
    actions: [
      'Em AboutHero, aplicar classes Tailwind para que o subtítulo/h3 use cor branca e contraste adequado sobre o background, respeitando a escala tipográfica Ghost.',
      'Identificar no Supabase as chaves/URLs de vídeo para Desktop e Mobile (por ex.: colunas about_closed_desktop_url e about_closed_mobile_url).',
      'Em AboutClosing, implementar lógica client-side (hook de breakpoint ou matchMedia) para escolher a URL correta no player de vídeo sem duplicar o componente.',
    ],
    rules: [
      'Não mudar o texto dos títulos',
      'Apenas cores/tailwind para visibilidade e seleção dinâmica de mídia',
    ],
    acceptanceCriteria: [
      'Em qualquer breakpoint, o subtítulo de About Hero é claramente legível',
      'O About Closed carrega automaticamente a versão de vídeo adequada ao viewport (Desktop vs Mobile), sem que o usuário perceba troca de layout',
    ],
    status: 'pending',
  },
  {
    id: 'PROMPT_08',
    title: 'About Origin / Method / What I Do: scroll animations e glow roxo',
    severity: 'medium',
    category: 'motion',
    objective:
      'Refinar animações de scroll em Origin e Method e implementar/ajustar glow roxo + ícones redondos em What I Do, seguindo a especificação Ghost.',
    files: [
      'src/components/sobre/AboutOrigin.tsx',
      'src/components/sobre/AboutMethod.tsx',
      'src/components/sobre/AboutWhatIDo.tsx',
      'src/components/sobre/motion.ts',
    ],
    actions: [
      'Centralizar as variantes do Framer Motion em motion.ts com um set de easings premium (por exemplo, curvas suaves sem overshoot) e reutilizá-las em todas as seções.',
      'Em Origin/Method, disparar animações apenas quando o bloco estiver parcialmente visível (ex.: 25–30% em viewport) para evitar disparos prematuros.',
      'Em What I Do, ajustar o glow roxo para que o efeito seja suave, sem serrilhado, e centralizar os ícones em círculos perfeitos, respeitando o grid lateral.',
    ],
    rules: [
      'Não alterar textos',
      'Evitar qualquer animação que cause "bounce" exagerado ou fadiga visual',
    ],
    acceptanceCriteria: [
      'As animações de entrada seguem o mesmo timing e easing em todas as seções',
      'O glow roxo nos ícones é sutil mas perceptível, alinhado ao look Ghost',
      'O item "animação de parallax/hover segue a fluidez Ghost?" pode ser marcado como Sim para essas seções',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_07'],
  },
  {
    id: 'PROMPT_09',
    title: 'Centralização absoluta de mídia nos cards de portfólio',
    severity: 'medium',
    category: 'layout',
    objective:
      'Garantir que todas as imagens e vídeos dentro dos cards de portfólio estejam sempre centralizados e preencham o card de forma consistente, independentemente da proporção.',
    files: [
      'src/components/portfolio/PortfolioCard.tsx',
      'src/components/portfolio/ProjectsGallery.tsx',
    ],
    actions: [
      'Envolver a mídia (img/video) em um wrapper com relative overflow-hidden e altura fixa ou proporcional à linha (para suportar alturas equalizadas).',
      'Definir mídia com object-cover object-center w-full h-full para garantir que sempre preencha o espaço sem distorção.',
      'Validar casos extremos de proporção (super wide vs super vertical) para garantir que o recorte preserve a parte visual mais importante do conteúdo.',
    ],
    rules: [
      'Não alterar textos ou ordem de informações do card',
      'Apenas o container de mídia',
    ],
    acceptanceCriteria: [
      'Nenhum card mostra barras pretas/brancas laterais ou em cima/baixo',
      'Todas as mídias parecem perfeitamente centradas e recortadas, mantendo a altura dos cards uniforme por linha',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_06'],
  },
  {
    id: 'PROMPT_10',
    title:
      'Eliminar overflow horizontal e validar touch targets em todo o site',
    severity: 'high',
    category: 'mobile',
    objective:
      'Garantir que todas as páginas estejam livres de scroll horizontal acidental e que todos os CTAs/cards tenham zonas de toque confortáveis em mobile.',
    files: [
      'src/app/page.tsx',
      'src/app/sobre/page.tsx',
      'src/app/portfolio/page.tsx',
      'src/components/home/*',
      'src/components/sobre/*',
      'src/components/portfolio/*',
    ],
    actions: [
      'Auditar todos os wrappers horizontais (carrosséis, grids) para remover larguras fixas que ultrapassem 100vw em mobile.',
      'Garantir que todos os botões/links tenham px-3 py-2 ou superior em mobile, mantendo a identidade Ghost.',
      'Testar manualmente em breakpoints principais (sm/md/lg) para confirmar ausência total de scroll horizontal.',
    ],
    rules: [
      'Não remover seções para resolver overflow',
      'A correção deve ser via layout/responsividade',
    ],
    acceptanceCriteria: [
      'Nenhuma página apresenta scroll horizontal em qualquer breakpoint',
      'Todos os CTAs e cards são facilmente clicáveis em touchscreen',
      'O item "mobile livre de overflow e com touch targets adequados?" pode ser marcado como Sim em todas as seções',
    ],
    status: 'pending',
    dependsOn: ['PROMPT_02', 'PROMPT_05', 'PROMPT_06'],
  },
];

// ==========================================
// PROMPT WAVES (Organização por Prioridade)
// ==========================================

export const PROMPT_WAVES: PromptWave[] = [
  {
    id: 'WAVE_1',
    name: 'Foundation & Critical Layout',
    description:
      'Corrigir grid global, header mobile e garantir base sólida para todas as páginas',
    prompts: ATOMIC_PROMPTS.filter((p) =>
      ['PROMPT_01', 'PROMPT_02', 'PROMPT_05', 'PROMPT_06'].includes(p.id)
    ),
  },
  {
    id: 'WAVE_2',
    name: 'Hero & 3D Calibration',
    description: 'Ajustar Hero, GhostScene e seções visuais críticas',
    prompts: ATOMIC_PROMPTS.filter((p) =>
      ['PROMPT_03', 'PROMPT_04', 'PROMPT_07'].includes(p.id)
    ),
  },
  {
    id: 'WAVE_3',
    name: 'Motion & Polish',
    description:
      'Animações refinadas, glow effects e validação final de responsividade',
    prompts: ATOMIC_PROMPTS.filter((p) =>
      ['PROMPT_08', 'PROMPT_09', 'PROMPT_10'].includes(p.id)
    ),
  },
];

// ==========================================
// MANAGER PROMPT (Para o Agent Manager)
// ==========================================

export const GOOGLE_ANTIGRAVITY_MANAGER_PROMPT = `
# Ghost Portfolio Audit Orchestrator

Você é o orquestrador principal do sistema de auditoria Ghost Portfolio.
Execute os prompts atômicos em ondas (waves), respeitando dependências.

## Contexto
- Projeto: Portfólio Danilo Novais (Ghost Era)
- Framework: Next.js 15 (App Router) + React 18 + TypeScript + Tailwind CSS
- 3D: React Three Fiber + @react-three/drei
- Motion: Framer Motion
- Design System: Ghost System v3.0

## Paleta de Cores (Tokens Oficiais)
- bluePrimary: #0048ff (Cor da Marca, CTAs, Links)
- blueAccent: #4fe6ff (Brilhos Ghost, Atmosfera)
- background: #040013 (Fundo Principal - Deep Void)
- text: #fcffff (Texto Principal)
- textSecondary: #a1a3a3 (Metadados)
- purpleDetails: #8705f2 (Highlights sutis)

## Easing Padrão Ghost
cubic-bezier(0.22, 1, 0.36, 1) - easeOutExpo

## Ordem de Execução

### Wave 1: Foundation & Critical Layout
1. PROMPT_01 - Unificar grid global
2. PROMPT_02 - Corrigir Header mobile
3. PROMPT_05 - Featured Projects grid
4. PROMPT_06 - Portfolio Mosaic Grid

### Wave 2: Hero & 3D Calibration
5. PROMPT_03 - Home Hero + GhostScene
6. PROMPT_04 - Manifesto áudio + scroll
7. PROMPT_07 - About Hero + About Closed

### Wave 3: Motion & Polish
8. PROMPT_08 - About sections animations
9. PROMPT_09 - Media centralization
10. PROMPT_10 - Final overflow/touch validation

## Regras de Execução
1. Execute um prompt por vez, aguarde conclusão
2. Respeite dependências (dependsOn)
3. Após cada prompt, valide com build: pnpm run build
4. Documente mudanças no git com mensagens semânticas
5. Se um prompt falhar, registre e continue com próximo independente

## Critérios de Sucesso Global
- Zero overflow horizontal em mobile
- Grid consistente em todas as páginas
- Touch targets ≥ 44x44px
- Animações suaves sem jitter
- Build passa sem erros
`;

// ==========================================
// UTILITY FUNCTIONS
// ==========================================

export const getPromptById = (id: string): AtomicPrompt | undefined =>
  ATOMIC_PROMPTS.find((p) => p.id === id);

export const getPromptsByCategory = (
  category: PromptCategory
): AtomicPrompt[] => ATOMIC_PROMPTS.filter((p) => p.category === category);

export const getPromptsBySeverity = (
  severity: PromptSeverity
): AtomicPrompt[] => ATOMIC_PROMPTS.filter((p) => p.severity === severity);

export const getPromptWave = (waveId: string): PromptWave | undefined =>
  PROMPT_WAVES.find((w) => w.id === waveId);

export const getCriticalPrompts = (): AtomicPrompt[] =>
  ATOMIC_PROMPTS.filter((p) => p.severity === 'critical');

export const getPendingPrompts = (): AtomicPrompt[] =>
  ATOMIC_PROMPTS.filter((p) => p.status === 'pending');

export const getExecutionOrder = (): AtomicPrompt[] => {
  const executed = new Set<string>();
  const result: AtomicPrompt[] = [];

  const canExecute = (prompt: AtomicPrompt): boolean => {
    if (!prompt.dependsOn) return true;
    return prompt.dependsOn.every((dep) => executed.has(dep));
  };

  while (result.length < ATOMIC_PROMPTS.length) {
    const next = ATOMIC_PROMPTS.find(
      (p) => !executed.has(p.id) && canExecute(p)
    );
    if (next) {
      result.push(next);
      executed.add(next.id);
    } else {
      // Circular dependency or all done
      break;
    }
  }

  return result;
};

// Default export for convenience
export default {
  ATOMIC_PROMPTS,
  PROMPT_WAVES,
  GOOGLE_ANTIGRAVITY_MANAGER_PROMPT,
  getPromptById,
  getPromptsByCategory,
  getPromptsBySeverity,
  getPromptWave,
  getCriticalPrompts,
  getPendingPrompts,
  getExecutionOrder,
};
export * from './antigravity';
export * from './prompts';
export * from '@/store/antigravity.store';
import type { FC } from 'react';

const GhostPortfolioAuditReport: FC = () => {
  return (
    <div className="w-full max-w-5xl mx-auto px-4 py-10 space-y-12 text-sm leading-relaxed text-zinc-100">
      {/* 1️⃣ Visão Geral */}
      <section className="space-y-4">
        <h1 className="text-2xl font-semibold">1️⃣ Visão Geral</h1>
        <p>
          A estrutura do projeto está organizada em App Router, com{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/app/layout.tsx
          </code>{' '}
          como RootLayout e páginas segmentadas para Home (
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/app/page.tsx
          </code>
          ), Sobre (
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/app/sobre/page.tsx
          </code>
          ) e Portfólio (
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/app/portfolio/page.tsx
          </code>
          ). Essa arquitetura segue o padrão recomendado do App Router, com um
          layout raiz envolvendo todas as rotas.
        </p>
        <p>
          A camada de layout reutilizável está concentrada em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/components/layout
          </code>{' '}
          (incluindo <code>Header</code>, <code>Container</code> e{' '}
          <code>ClientLayout</code>), enquanto as seções de página se apoiam em
          componentes específicos: Home em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/components/home/*
          </code>
          , Sobre em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/components/sobre/*
          </code>{' '}
          e Portfólio em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/components/portfolio/*
          </code>
          . A cena 3D Ghost/ROME está centralizada em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            src/components/canvas/home/hero/GhostScene.tsx
          </code>
          .
        </p>
        <p>
          Com base nas pendências que você descreveu (ajustes de grid, margens,
          CTAs, áudio do Manifesto, vídeo dinâmico no About Closed, grid do
          portfólio e parallax), e sem acesso direto ao CSS/TSX ou às imagens de
          referência a partir deste ambiente, assumo que ainda existem desvios
          relevantes em relação às imagens canônicas em{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            docs/HOME
          </code>
          ,{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            docs/SOBRE
          </code>{' '}
          e{' '}
          <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
            docs/PORTFOLIO
          </code>
          . Abaixo, o checklist parte do princípio conservador de que qualquer
          ponto não explicitamente fechado deve ser tratado como “Não” até que
          os ajustes propostos sejam implementados e validados visualmente.
        </p>
      </section>

      {/* 2️⃣ Diagnóstico por Seção */}
      <section className="space-y-10">
        <h2 className="text-xl font-semibold">2️⃣ Diagnóstico por Seção</h2>

        {/* 2.1 Home Hero */}
        <section className="space-y-3">
          <h3 className="text-lg font-semibold">2.1 Home Hero</h3>

          <div className="space-y-1">
            <p className="font-semibold">Checklist de Fidelidade:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                O grid e as margens laterais correspondem exatamente à imagem?{' '}
                <strong>Não</strong> — é necessário travar todas as colunas em
                um único container matemático (provavelmente via{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  Container
                </code>
                ) compartilhado entre Home, Sobre e Portfólio.
              </li>
              <li>
                O alinhamento “duas laterais” está consistente em todo o scroll?{' '}
                <strong>Não</strong> — existe indício de “saltos” entre seções
                (Hero → Manifesto → Featured Projects).
              </li>
              <li>
                Os cards do portfólio ocupam toda a largura horizontal sem gaps?{' '}
                <strong>Não se aplica</strong> (seção sem cards tipo mosaico).
              </li>
              <li>
                A animação de parallax e hover segue a fluidez do CodePen
                referência? <strong>Não</strong> — o Ghost/ROME precisa seguir
                exatamente o timing/easing e amplitude definidos no blueprint,
                incluindo profundidade suave em resposta ao scroll/mouse.
              </li>
              <li>
                O mobile está livre de overflow horizontal e com touch targets
                adequados? <strong>Não</strong> — há relato de problemas de
                clique no Header e possíveis quebras de alinhamento/padding no
                Hero em telas pequenas.
              </li>
            </ul>
          </div>

          <div className="space-y-1">
            <p className="font-semibold">Inconsistências principais:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                Hero não está perfeitamente alinhado ao grid Ghost definido em{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  docs/HOME/HERO.jpg
                </code>
                , com diferença de margens laterais e possivelmente da distância
                entre título, subtítulo e CTA.
              </li>
              <li>
                Cena <code>GhostScene</code> (posição, scale, brightness) ainda
                não casada 1:1 com o enquadramento da imagem canônica.
              </li>
              <li>
                Em mobile, o Hero herdando problemas do Header (área de clique /
                nav) e potencial overflow horizontal residual.
              </li>
            </ul>
          </div>
        </section>

        {/* 2.2 Manifesto */}
        <section className="space-y-3">
          <h3 className="text-lg font-semibold">2.2 Manifesto</h3>

          <div className="space-y-1">
            <p className="font-semibold">Checklist de Fidelidade:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                O grid e as margens laterais correspondem exatamente à imagem?{' '}
                <strong>Não</strong> — Manifesto precisa seguir o mesmo
                container de Hero e Featured Projects, sem variação de paddings.
              </li>
              <li>
                O alinhamento “duas laterais” está consistente em todo o scroll?{' '}
                <strong>Não</strong> — transição Ghost → Manifesto ainda não é
                ótica e matematicamente contínua.
              </li>
              <li>
                Os cards do portfólio ocupam toda a largura horizontal sem gaps?{' '}
                <strong>Não se aplica</strong>.
              </li>
              <li>
                A animação de parallax e hover segue a fluidez do CodePen
                referência? <strong>Não</strong> — a interação aqui é
                principalmente áudio + scroll; a fluidez de entrada/saída do
                texto e controles de áudio ainda não está “Ghost level”.
              </li>
              <li>
                O mobile está livre de overflow horizontal e com touch targets
                adequados? <strong>Não</strong> — player/controle de áudio e CTA
                precisam ser garantidos como touch-friendly (min 44×44px).
              </li>
            </ul>
          </div>

          <div className="space-y-1">
            <p className="font-semibold">Inconsistências principais:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                Sincronia entre áudio do Manifesto e scroll não está descrita
                como finalizada (auto-mute/unmute em função da presença em
                viewport).
              </li>
              <li>
                Possível variação de largura do texto/legenda em relação ao
                container global.
              </li>
            </ul>
          </div>
        </section>

        {/* 2.3 Featured Projects (Home) */}
        <section className="space-y-3">
          <h3 className="text-lg font-semibold">
            2.3 Featured Projects (Home)
          </h3>

          <div className="space-y-1">
            <p className="font-semibold">Checklist de Fidelidade:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                O grid e as margens laterais correspondem exatamente à imagem?{' '}
                <strong>Não</strong> — o layout precisa espelhar{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  docs/HOME/HOME-PORTFOLIO-BLACK---GHOST.jpg
                </code>
                .
              </li>
              <li>
                O alinhamento “duas laterais” está consistente em todo o scroll?{' '}
                <strong>Não</strong> — atual “salto” visual entre o final do
                Manifesto e o início dos cards.
              </li>
              <li>
                Os cards do portfólio ocupam toda a largura horizontal sem gaps?{' '}
                <strong>Não</strong> — o mosaico ainda não preenche 100% da
                largura útil com larguras variáveis e alturas equalizadas por
                linha.
              </li>
              <li>
                A animação de parallax e hover segue a fluidez do CodePen
                referência? <strong>Não</strong> — precisa replicar precisamente
                profundidade, easing e latência do CodePen.
              </li>
              <li>
                O mobile está livre de overflow horizontal e com touch targets
                adequados? <strong>Não</strong> — existe pendência explícita
                para centralizar textos/CTAs e evitar tap targets pequenos.
              </li>
            </ul>
          </div>

          <div className="space-y-1">
            <p className="font-semibold">Inconsistências principais:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                Cards não compartilham sempre a mesma altura por linha,
                quebrando a “barra ótica” Ghost.
              </li>
              <li>
                Grid não parece derivar de um sistema matemático único (colunas
                e gutters) compartilhado com o restante da página.
              </li>
              <li>
                Em mobile, textos/CTAs desalinhados e possível overflow
                horizontal em projeções mais largas.
              </li>
            </ul>
          </div>
        </section>

        {/* 2.4 About (Origin / Method / What I Do) */}
        <section className="space-y-3">
          <h3 className="text-lg font-semibold">
            2.4 About (Origin / Method / What I Do)
          </h3>

          <div className="space-y-1">
            <p className="font-semibold">Checklist de Fidelidade:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                O grid e as margens laterais correspondem exatamente à imagem?{' '}
                <strong>Não</strong> — seções como{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  AboutOrigin.tsx
                </code>{' '}
                e{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  AboutMethod.tsx
                </code>{' '}
                ainda precisam ser rigidamente alinhadas ao mesmo container da
                Home.
              </li>
              <li>
                O alinhamento “duas laterais” está consistente em todo o scroll?{' '}
                <strong>Não</strong> — especialmente na transição entre Origin →
                Method → What I Do.
              </li>
              <li>
                Os cards do portfólio ocupam toda a largura horizontal sem gaps?{' '}
                <strong>Não se aplica</strong> (seções textuais + ícones).
              </li>
              <li>
                A animação de parallax e hover segue a fluidez do CodePen
                referência? <strong>Não</strong> — as micro-animações de scroll
                e o glow roxo dos ícones circulares em{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  AboutWhatIDo.tsx
                </code>{' '}
                ainda precisam ser calibradas.
              </li>
              <li>
                O mobile está livre de overflow horizontal e com touch targets
                adequados? <strong>Não</strong> — o texto do About Hero (H3)
                requer fonte branca para legibilidade e a hierarquia tipográfica
                Ghost.
              </li>
            </ul>
          </div>

          <div className="space-y-1">
            <p className="font-semibold">Inconsistências principais:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                <strong>About Hero</strong>: subtítulo/h3 não visível o
                suficiente sobre o background; necessidade explícita de usar
                fonte branca.
              </li>
              <li>
                <strong>About Closed</strong> (
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  AboutClosing.tsx
                </code>
                ): falta troca dinâmica de vídeo Desktop vs Mobile via URLs do
                Supabase.
              </li>
              <li>
                <strong>Origin / Method</strong>: animações de entrada on scroll
                ainda não seguem uma curva premium (sem bounce exagerado, sem
                jitter).
              </li>
              <li>
                <strong>What I Do</strong>: glow roxo e ícones circulares ainda
                não replicam exatamente o look and feel Ghost.
              </li>
            </ul>
          </div>
        </section>

        {/* 2.5 Portfolio Grid (/portfolio) */}
        <section className="space-y-3">
          <h3 className="text-lg font-semibold">
            2.5 Portfolio Grid (/portfolio)
          </h3>

          <div className="space-y-1">
            <p className="font-semibold">Checklist de Fidelidade:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                O grid e as margens laterais correspondem exatamente à imagem?{' '}
                <strong>Não</strong> — a página de Portfólio deve seguir a mesma
                largura útil e margens da Home e das imagens em{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  docs/PORTFOLIO
                </code>
                .
              </li>
              <li>
                O alinhamento “duas laterais” está consistente em todo o scroll?{' '}
                <strong>Não</strong> — há risco de variação entre o Hero da
                página e o grid/mosaico.
              </li>
              <li>
                Os cards do portfólio ocupam toda a largura horizontal sem gaps?{' '}
                <strong>Não</strong> — o mosaico em{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  PortfolioMosaicGrid.tsx
                </code>{' '}
                e <code>PortfolioCard.tsx</code> não está explicitamente
                descrito como preenchendo 100% da largura útil com alturas
                equalizadas.
              </li>
              <li>
                A animação de parallax e hover segue a fluidez do CodePen
                referência? <strong>Não</strong> — ainda não há menção de
                replicação fiel do CodePen de referência.
              </li>
              <li>
                O mobile está livre de overflow horizontal e com touch targets
                adequados? <strong>Não</strong> — cartões e filtros (
                <code>CategoryFilter.tsx</code>) precisam ser validados para
                evitar scroll lateral e tap impreciso.
              </li>
            </ul>
          </div>

          <div className="space-y-1">
            <p className="font-semibold">Inconsistências principais:</p>
            <ul className="list-disc ml-6 space-y-1">
              <li>
                Cards não garantem a mesma altura vertical por linha em todas as
                quebras de layout.
              </li>
              <li>
                Mídias (imagem/vídeo) dentro de <code>PortfolioCard.tsx</code>{' '}
                não estão explicitamente centralizadas/crocadas para preencher o
                card independentemente da proporção.
              </li>
              <li>
                Parallax e hover ainda não replicam a sensação “3D card stack”
                do CodePen.
              </li>
            </ul>
          </div>
        </section>
      </section>

      {/* 3️⃣ Lista de Problemas (Severidade) */}
      <section className="space-y-4">
        <h2 className="text-xl font-semibold">
          3️⃣ Lista de Problemas (Severidade 🔴🟡🟢)
        </h2>

        <ul className="space-y-1">
          <li>
            🔴{' '}
            <strong>P1 — Grid global e margens laterais inconsistentes</strong>:
            falta de um único sistema de colunas/gutters aplicado em Home, Sobre
            e Portfólio (RootLayout + Container).
          </li>
          <li>
            🔴{' '}
            <strong>
              P2 — Layout do grid de portfólio (Home + /portfolio)
            </strong>
            : cards não ocupam 100% da largura, alturas não equalizadas por
            linha, e alinhamento visual divergente da referência Ghost.
          </li>
          <li>
            🔴 <strong>P3 — Mobile crítico (Header + Featured Projects)</strong>
            : problemas de clique no Header, CTAs e textos não centralizados na
            seção de projetos em destaque e risco de overflow horizontal.
          </li>
          <li>
            🔴 <strong>P4 — Legibilidade no About Hero</strong>: subtítulo/h3
            precisa ser branco e seguir a escala tipográfica Ghost para
            contraste adequado.
          </li>
          <li>
            🔴 <strong>P5 — Vídeo dinâmico em About Closed</strong>: ausência
            (ou não finalização) da troca automática Desktop vs Mobile usando
            URLs do Supabase.
          </li>
          <li>
            🟡 <strong>P6 — Animações Framer Motion fora da curva Ghost</strong>
            : timings/easings com bounce/scale possivelmente exagerados em
            relação à especificação premium.
          </li>
          <li>
            🟡 <strong>P7 — Falta de parallax de profundidade nos cards</strong>
            : interações de hover/scroll do portfólio não reproduzem o CodePen
            referência.
          </li>
          <li>
            🟡{' '}
            <strong>
              P8 — Áudio do Manifesto acoplado de forma rudimentar
            </strong>
            : falta lógica clara de auto-mute/unmute com base em scroll e
            visibilidade da seção.
          </li>
          <li>
            🟡{' '}
            <strong>
              P9 — About Origin/Method/What I Do sem refinamento fino
            </strong>
            : scroll animations, glow roxo e ícones circulares ainda aquém do
            desejo Ghost.
          </li>
          <li>
            🟢{' '}
            <strong>P10 — Uso inconsistente de Container/ClientLayout</strong>:
            oportunidade de centralizar todas as páginas no mesmo componente de
            grid para reduzir divergências.
          </li>
          <li>
            🟢 <strong>P11 — Redução de movimento</strong>: adicionar fallback
            suave para usuários com{' '}
            <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
              prefers-reduced-motion
            </code>{' '}
            nas animações de hover/parallax.
          </li>
          <li>
            🟢 <strong>P12 — Otimização de mídia</strong>: garantir lazy loading
            inteligente e placeholders no grid de portfólio, sem alterar o
            layout canônico.
          </li>
        </ul>
      </section>

      {/* 4️⃣ Prompts Técnicos para Agentes Google Antigravity (Atômicos) */}
      <section className="space-y-6">
        <h2 className="text-xl font-semibold">
          4️⃣ Prompts Técnicos para Agentes Google Antigravity (Atômicos)
        </h2>

        <div className="space-y-8">
          {/* Prompt 01 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #01 — Unificar grid global e margens laterais
            </h3>
            <p>
              <strong>Objetivo:</strong> Garantir que Home, Sobre e Portfólio
              usem exatamente o mesmo container (largura útil, gutters e
              paddings) para obter alinhamento “duas laterais” perfeito em todo
              o scroll.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/layout.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/layout/ClientLayout.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/layout/Container.tsx
              </code>
              , todas as páginas de topo (
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/page.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/sobre/page.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/portfolio/page.tsx
              </code>
              ).
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Padronizar um único componente <code>Container</code> com
                Tailwind (ex.:{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  mx-auto max-w-screen-xl px-4 md:px-6
                </code>
                ) para refletir exatamente o grid das imagens Ghost.
              </li>
              <li>
                Garantir que todas as seções principais de Home, Sobre e
                Portfólio sejam diretamete embrulhadas por esse{' '}
                <code>Container</code>, sem paddings laterais adicionais em cada
                seção.
              </li>
              <li>
                Ajustar{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  ClientLayout
                </code>{' '}
                (se usado) para não duplicar margens/paddings já definidos em{' '}
                <code>Container</code>.
              </li>
              <li>
                Confirmar que{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  globals.css
                </code>{' '}
                e Tailwind estão corretamente importados em{' '}
                <code>layout.tsx</code>, conforme o padrão do App Router e
                Tailwind v3.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Mobile-first, apenas ajustes de layout
              (sem alterar textos), manter o grid idêntico às imagens em{' '}
              <code>docs/HOME</code>, <code>docs/SOBRE</code> e{' '}
              <code>docs/PORTFOLIO</code>.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Ao rolar de cima a baixo em
              /, /sobre e /portfolio, as bordas esquerda/direita de títulos,
              textos e cards mantêm alinhamento perfeito; o item “grid e margens
              laterais correspondem exatamente à imagem?” pode ser marcado como{' '}
              <strong>Sim</strong> para todas as seções.
            </p>
          </article>

          {/* Prompt 02 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #02 — Corrigir Header e comportamento de clique em
              mobile
            </h3>
            <p>
              <strong>Objetivo:</strong> Garantir que o Header tenha área de
              clique/touch consistente, sem interferência na rolagem ou nos CTAs
              em mobile.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/layout/Header.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/layout/header/*
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/layout.tsx
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Revisar estrutura de nav e botões de menu (hamburger) para
                garantir que nenhum elemento overlay capture cliques fora da
                área esperada.
              </li>
              <li>
                Em mobile, assegurar que cada item de navegação tenha área
                mínima de 44×44px (via Tailwind, ex.:{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  px-3 py-2
                </code>
                ).
              </li>
              <li>
                Validar se existe algum{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  pointer-events
                </code>{' '}
                indevido em wrappers do Header que interfiram em cliques no Hero
                e nas seções abaixo.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não alterar o conteúdo textual nem
              adicionar links novos; apenas ajustar estrutura e classes
              Tailwind.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Em dispositivos touch, todos
              os links do Header respondem com precisão, sem áreas “mortas” ou
              cliques acidentais; nenhum overflow horizontal é introduzido pelo
              Header; o item “mobile livre de overflow e com touch targets
              adequados?” pode ser marcado como <strong>Sim</strong> para Home.
            </p>
          </article>

          {/* Prompt 03 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #03 — Travar Home Hero + GhostScene na referência
              HERO.jpg
            </h3>
            <p>
              <strong>Objetivo:</strong> Ajustar tipografia, espaçamento e cena
              3D do Hero para ficar 1:1 com <code>docs/HOME/HERO.jpg</code> e o
              blueprint Ghost.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/home/hero/*
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/canvas/home/hero/GhostScene.tsx
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Equalizar hierarquia tipográfica (h1, h2/h3, body) com o
                blueprint, ajustando apenas classes Tailwind (weights, tracking,
                line-height), sem alterar o texto.
              </li>
              <li>
                Revisar espaçamentos verticais entre título/subtítulo/CTA para
                que as distâncias visuais coincidam com a imagem de referência.
              </li>
              <li>
                Em <code>GhostScene.tsx</code>, ajustar posição, escala e
                intensidade de luz/materiais para obter o mesmo enquadramento e
                “glow” do Ghost na HERO.jpg.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não mexer no copy; qualquer ajuste 3D
              deve preservar performance (usar{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                useFrame
              </code>{' '}
              apenas quando necessário e memoizar materiais).
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Comparando a Home Hero com{' '}
              <code>docs/HOME/HERO.jpg</code>, espaçamentos, tipografia e
              enquadramento do Ghost são indistinguíveis a olho nu; parallax
              leve do Ghost permanece suave, sem jitter.
            </p>
          </article>

          {/* Prompt 04 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #04 — Manifesto: áudio + scroll e grid alinhado
            </h3>
            <p>
              <strong>Objetivo:</strong> Fazer o Manifesto respeitar o grid
              global e implementar lógica de áudio que auto-mute/unmute conforme
              a seção entra/sai da viewport.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/home/hero/*
              </code>{' '}
              (se Manifesto estiver acoplado), módulo específico de Manifesto
              (onde o player é usado).
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Garantir que o container do Manifesto esteja dentro do mesmo{' '}
                <code>Container</code> global, sem paddings extras.
              </li>
              <li>
                Implementar observer de scroll (ex.:{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  IntersectionObserver
                </code>{' '}
                no client) para mutar o áudio quando a seção estiver abaixo de
                um certo threshold de visibilidade.
              </li>
              <li>
                Em desktop, permitir que o áudio inicie ao entrar na seção; em
                mobile, respeitar a necessidade de interação explícita do
                usuário para iniciar áudio.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não alterar o conteúdo do Manifesto;
              manter a UI atual, refinando apenas comportamento e layout.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Manifesto ocupa a mesma
              largura da Hero/Featured Projects; áudio nunca continua tocando
              enquanto a seção está completamente fora de viewport; o checklist
              de grid/alinhamento e mobile pode ser marcado como{' '}
              <strong>Sim</strong> para Manifesto.
            </p>
          </article>

          {/* Prompt 05 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #05 — Featured Projects: grid 100% horizontal e
              mobile centrado
            </h3>
            <p>
              <strong>Objetivo:</strong> Fazer os cards de projetos em destaque
              preencherem 100% da largura do container, com alturas equalizadas
              por linha e CTAs/textos centralizados em mobile.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/home/featured-projects/*
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Modelar o grid com Tailwind usando combinações de{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  grid-cols-*
                </code>{' '}
                e <code>auto-fit / auto-fill</code> (ou flex com{' '}
                <code>flex-[x]</code>) para reproduzir a distribuição de
                larguras da referência, sem espaços vazios.
              </li>
              <li>
                Garantir que todos os cards de uma mesma linha compartilhem a
                mesma altura (via{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  items-stretch
                </code>{' '}
                + conteúdo interno com{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  h-full
                </code>
                ).
              </li>
              <li>
                Em mobile, centralizar títulos/descrições/CTAs dos cards e
                revisar paddings para remover qualquer overflow horizontal.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Mobile-first; sem alterar textos;
              comparação constante com{' '}
              <code>docs/HOME/HOME-PORTFOLIO-BLACK---GHOST.jpg</code> e{' '}
              <code>docs/HOME/HOME-PORTFOLIO-LAYOUYT-MOBILE---GHOST.jpg</code>.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Não há gaps horizontais no
              fim de nenhuma linha; todos os cards têm mesma altura visual por
              linha; em mobile, os CTAs ficam centralizados e facilmente
              clicáveis.
            </p>
          </article>

          {/* Prompt 06 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #06 — Portfólio (/portfolio): Mosaic Grid + parallax
              estilo CodePen
            </h3>
            <p>
              <strong>Objetivo:</strong> Ajustar o grid de{' '}
              <code>/portfolio</code> para preencher 100% da largura, equalizar
              alturas por linha e implementar parallax/hover inspirado no
              CodePen de referência.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/portfolio/page.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/PortfolioMosaicGrid.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/MosaicCard.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/PortfolioCard.tsx
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Refatorar <code>PortfolioMosaicGrid</code> para calcular
                larguras relativas por linha (ex.: colunas flex com{' '}
                <code>basis-*</code> e <code>grow</code>) de forma a sempre
                fechar 100% da largura do container.
              </li>
              <li>
                Garantir que todos os cards de uma mesma linha tenham altura
                igual (via{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  h-full
                </code>{' '}
                + wrappers internos com{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  flex flex-col
                </code>{' '}
                e{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  justify-between
                </code>
                ).
              </li>
              <li>
                Implementar animações de hover/parallax nos cards usando Framer
                Motion (ex.: leve{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  translateZ
                </code>{' '}
                em perspectiva simulada, com easing{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  cubic-bezier(0.22, 1, 0.36, 1)
                </code>
                ) para aproximar o efeito do CodePen.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não alterar estrutura de conteúdo dos
              cards (título, descrição, tags); apenas layout e motion.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Qualquer linha de cards
              ocupa 100% da largura do container; nenhuma linha apresenta gaps
              residuais; hover/parallax são fluidos, sem overshoot ou bounce
              exagerado, replicando a fluidez do CodePen.
            </p>
          </article>

          {/* Prompt 07 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #07 — About Hero (tipografia) + About Closed (vídeo
              Supabase)
            </h3>
            <p>
              <strong>Objetivo:</strong> Corrigir a visibilidade do texto em
              About Hero e implementar troca dinâmica de vídeo Desktop/Mobile em
              About Closed usando URLs do Supabase.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/AboutHero.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/AboutClosing.tsx
              </code>
              , configuração Supabase (cliente utilitário).
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Em <code>AboutHero</code>, aplicar classes Tailwind para que o
                subtítulo/h3 use cor branca e contraste adequado sobre o
                background, respeitando a escala tipográfica Ghost.
              </li>
              <li>
                Identificar no Supabase as chaves/URLs de vídeo para Desktop e
                Mobile (por ex.: colunas{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  about_closed_desktop_url
                </code>{' '}
                e{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  about_closed_mobile_url
                </code>
                ).
              </li>
              <li>
                Em <code>AboutClosing</code>, implementar lógica client-side
                (hook de breakpoint ou{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  matchMedia
                </code>
                ) para escolher a URL correta no player de vídeo sem duplicar o
                componente.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não mudar o texto dos títulos; apenas
              cores/tailwind para visibilidade e seleção dinâmica de mídia.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Em qualquer breakpoint, o
              subtítulo de About Hero é claramente legível; o About Closed
              carrega automaticamente a versão de vídeo adequada ao viewport
              (Desktop vs Mobile), sem que o usuário perceba troca de layout.
            </p>
          </article>

          {/* Prompt 08 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #08 — About Origin / Method / What I Do: scroll
              animations e glow roxo
            </h3>
            <p>
              <strong>Objetivo:</strong> Refinar animações de scroll em Origin e
              Method e implementar/ajustar glow roxo + ícones redondos em What I
              Do, seguindo a especificação Ghost.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/AboutOrigin.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/AboutMethod.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/AboutWhatIDo.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/motion.ts
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Centralizar as variantes do Framer Motion em{' '}
                <code>motion.ts</code> com um set de easings premium (por
                exemplo, curvas suaves sem overshoot) e reutilizá-las em todas
                as seções.
              </li>
              <li>
                Em Origin/Method, disparar animações apenas quando o bloco
                estiver parcialmente visível (ex.: 25–30% em viewport) para
                evitar disparos prematuros.
              </li>
              <li>
                Em What I Do, ajustar o glow roxo para que o efeito seja suave,
                sem serrilhado, e centralizar os ícones em círculos perfeitos,
                respeitando o grid lateral.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não alterar textos; evitar qualquer
              animação que cause “bounce” exagerado ou fadiga visual.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> As animações de entrada
              seguem o mesmo timing e easing em todas as seções; o glow roxo nos
              ícones é sutil mas perceptível, alinhado ao look Ghost; o item
              “animação de parallax/hover segue a fluidez Ghost?” pode ser
              marcado como <strong>Sim</strong> para essas seções.
            </p>
          </article>

          {/* Prompt 09 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #09 — Centralização absoluta de mídia nos cards de
              portfólio
            </h3>
            <p>
              <strong>Objetivo:</strong> Garantir que todas as imagens e vídeos
              dentro dos cards de portfólio estejam sempre centralizados e
              preencham o card de forma consistente, independentemente da
              proporção.
            </p>
            <p>
              <strong>Arquivos:</strong>{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/PortfolioCard.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/ProjectsGallery.tsx
              </code>
              .
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Envolver a mídia (img/video) em um wrapper com{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  relative overflow-hidden
                </code>{' '}
                e altura fixa ou proporcional à linha (para suportar alturas
                equalizadas).
              </li>
              <li>
                Definir mídia com{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  object-cover object-center w-full h-full
                </code>{' '}
                para garantir que sempre preencha o espaço sem distorção.
              </li>
              <li>
                Validar casos extremos de proporção (super wide vs super
                vertical) para garantir que o recorte preserve a parte visual
                mais importante do conteúdo.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não alterar textos ou ordem de
              informações do card; apenas o container de mídia.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Nenhum card mostra barras
              pretas/brancas laterais ou em cima/baixo; todas as mídias parecem
              perfeitamente centradas e recortadas, mantendo a altura dos cards
              uniforme por linha.
            </p>
          </article>

          {/* Prompt 10 */}
          <article className="space-y-2">
            <h3 className="font-semibold">
              ### 🛠️ Prompt #10 — Eliminar overflow horizontal e validar touch
              targets em todo o site
            </h3>
            <p>
              <strong>Objetivo:</strong> Garantir que todas as páginas estejam
              livres de scroll horizontal acidental e que todos os CTAs/cards
              tenham zonas de toque confortáveis em mobile.
            </p>
            <p>
              <strong>Arquivos:</strong> Páginas principais (
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/page.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/sobre/page.tsx
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/app/portfolio/page.tsx
              </code>
              ), componentes de seções (
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/home/*
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/sobre/*
              </code>
              ,{' '}
              <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                src/components/portfolio/*
              </code>
              ).
            </p>
            <p>
              <strong>Ações:</strong>
            </p>
            <ol className="list-decimal ml-6 space-y-1">
              <li>
                Auditar todos os wrappers horizontais (carrosséis, grids) para
                remover larguras fixas que ultrapassem <code>100vw</code> em
                mobile.
              </li>
              <li>
                Garantir que todos os botões/links tenham{' '}
                <code className="text-xs bg-zinc-900 px-1 py-0.5 rounded">
                  px-3 py-2
                </code>{' '}
                ou superior em mobile, mantendo a identidade Ghost.
              </li>
              <li>
                Testar manualmente em breakpoints principais (sm/md/lg) para
                confirmar ausência total de scroll horizontal.
              </li>
            </ol>
            <p>
              <strong>Regras:</strong> Não remover seções para resolver
              overflow; a correção deve ser via layout/responsividade.
            </p>
            <p>
              <strong>Critérios de Aceite:</strong> Nenhuma página apresenta
              scroll horizontal em qualquer breakpoint; todos os CTAs e cards
              são facilmente clicáveis em touchscreen; o item “mobile livre de
              overflow e com touch targets adequados?” pode ser marcado como{' '}
              <strong>Sim</strong> em todas as seções.
            </p>
          </article>
        </div>
      </section>
    </div>
  );
};

export default GhostPortfolioAuditReport;
// Ensures Node/SSR runtime has browser-like globals some deps expect.
// Safe to import anywhere (idempotent).
if (typeof globalThis !== 'undefined') {
  // ProgressEvent is not defined in Node, but some loaders (e.g. @monogrid/gainmap-js)
  // instantiate it during SSR. Provide a minimal polyfill.
  if (typeof (globalThis as any).ProgressEvent === 'undefined') {
    class NodeProgressEvent extends Event {
      lengthComputable: boolean;
      loaded: number;
      total: number;
      constructor(type: string, eventInitDict?: ProgressEventInit) {
        super(type);
        this.lengthComputable = !!eventInitDict?.lengthComputable;
        this.loaded = eventInitDict?.loaded ?? 0;
        this.total = eventInitDict?.total ?? 0;
      }
    }

    (globalThis as any).ProgressEvent = NodeProgressEvent;
  }
}
'use client';

import { useEffect, useState } from 'react';
import { usePathname } from 'next/navigation';

export default function AntigravityDebugger() {
  const [isMounted, setIsMounted] = useState(false);
  const pathname = usePathname();

  useEffect(() => {
    setIsMounted(true);

    // Log para confirmar que o ambiente está limpo de erros de estilo globais
    console.warn(`[Antigravity] Debugger ativo em: ${pathname}`);
  }, [pathname]);

  if (!isMounted) return null;

  // Renderiza um indicador visual discreto apenas em ambiente de desenvolvimento
  if (process.env.NODE_ENV !== 'development') return null;

  return (
    <div className="fixed bottom-4 left-4 z-50 p-2 bg-black/80 text-xs text-green-400 border border-green-900 rounded font-mono pointer-events-none">
      ● Antigravity System: Ready
    </div>
  );
}
import type { PortfolioProject, ProjectCategory } from '@/types/project';

// Asset Constants (conforme regras de integridade)
const ASSETS = {
  BRANDING:
    'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/home/showcase/Branding-Project.webp',
  KEY_VISUAL:
    'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/home/showcase/Key-Visual.webp',
  MOTION:
    'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/home/showcase/webdesigner-2.gif',
  TECH: 'https://umkmwbkwvulxtdodzmzf.supabase.co/storage/v1/object/public/site-assets/projects/campaign/cover.webp',
};

export const PROJECT_CATEGORIES: Array<{
  id: ProjectCategory;
  label: string;
  labelMobile: string;
}> = [
  { id: 'all', label: 'Todos os Projetos', labelMobile: 'Todos' },
  { id: 'branding', label: 'Branding & Identity', labelMobile: 'Branding' },
  { id: 'campanha', label: 'Campanhas & Advertising', labelMobile: 'Campanha' },
  { id: 'web', label: 'Web & Digital', labelMobile: 'Web' },
  { id: 'motion', label: 'Motion & Video', labelMobile: 'Motion' },
  {
    id: 'institucional',
    label: 'Institucional & Retail',
    labelMobile: 'Institucional',
  },
  {
    id: 'packaging',
    label: 'Packaging & Product',
    labelMobile: 'Packaging',
  },
];

export const showcaseProjects: PortfolioProject[] = [
  // TYPE A - PROJETOS DESTAQUE (HERO STYLE)
  {
    id: 'proj-01',
    slug: 'neon-genesis',
    title: 'Neon Genesis',
    subtitle: 'Brand Identity & Strategy',
    client: 'CyberCore Inc.',
    category: 'branding',
    displayCategory: 'Branding',
    year: 2024,
    image: ASSETS.BRANDING,
    type: 'A',
    layout: {
      cols: 'col-span-12', // Full width showcase
      height: 'h-[80vh]',
      order: 1,
    },
    detail: {
      description:
        'Uma identidade visual disruptiva para a maior corporação de segurança cibernética da Ásia. O projeto explora a dualidade entre proteção invisível e presença marcante.',
      highlights: ['Rebranding Completo', 'Design System', '3D Motion Assets'],
    },
    isFeatured: true,
  },
  {
    id: 'proj-02',
    slug: 'void-walkers',
    title: 'Void Walkers',
    subtitle: 'Immersive Web Experience',
    client: 'Ghost Studio',
    category: 'web',
    displayCategory: 'Web Design',
    year: 2023,
    image: ASSETS.KEY_VISUAL,
    type: 'A',
    layout: {
      cols: 'col-span-6',
      height: 'h-[600px]',
      order: 3,
    },
    detail: {
      description:
        'Experiência web imersiva utilizando WebGL para narrar a jornada dos exploradores do vazio. Performance extrema com visuais etéreos.',
      highlights: ['WebGL / R3F', 'Sound Design', 'Interactive Storytelling'],
    },
  },
  {
    id: 'proj-03',
    slug: 'future-retail',
    title: 'Future Retail',
    subtitle: 'Physical & Digital Integration',
    client: 'OmniStore',
    category: 'institucional',
    displayCategory: 'Retail',
    year: 2024,
    image: ASSETS.TECH,
    type: 'A',
    layout: {
      cols: 'col-span-6',
      height: 'h-[600px]',
      order: 4,
    },
    detail: {
      description:
        'Redefinindo o varejo físico através de interfaces digitais integradas ao ambiente. Uma ponte perfeita entre o e-commerce e a loja física.',
      highlights: ['UX Research', 'Interface Design', 'Prototyping'],
    },
  },

  // TYPE B - PROJETOS GRID (EDITORIAL STYLE)
  {
    id: 'proj-04',
    slug: 'kinetic-type',
    title: 'Kinetic Type Series',
    subtitle: 'Experimental Motion',
    client: 'Personal',
    category: 'motion',
    displayCategory: 'Motion',
    year: 2023,
    image: ASSETS.MOTION,
    type: 'B',
    layout: {
      cols: 'col-span-4',
      height: 'h-[400px]',
      order: 2,
    },
    detail: {
      description:
        'Série experimental de tipografia cinética explorando os limites da legibilidade e expressão visual em movimento.',
      highlights: ['After Effects', 'Typography', 'Social Media'],
    },
  },
  {
    id: 'proj-05',
    slug: 'eco-packaging',
    title: 'Eco Essence',
    subtitle: 'Sustainable Packaging',
    client: 'Natura Life',
    category: 'packaging',
    displayCategory: 'Packaging',
    year: 2023,
    image: ASSETS.BRANDING, // Reusing branding asset for packaging demo
    type: 'B',
    layout: {
      cols: 'col-span-4',
      height: 'h-[400px]',
      order: 5,
    },
    detail: {
      description:
        'Design de embalagem focado em sustentabilidade e experiência tátil. Materiais reciclados encontram acabamento premium.',
      highlights: ['Sustainable Design', 'Print Production', '3D Mockups'],
    },
  },
  {
    id: 'proj-06',
    slug: 'tech-launch',
    title: 'Tech Launch Q4',
    subtitle: 'Global Campaign',
    client: 'SaaS Giant',
    category: 'campanha',
    displayCategory: 'Advertising',
    year: 2024,
    image: ASSETS.TECH,
    type: 'B',
    layout: {
      cols: 'col-span-4',
      height: 'h-[400px]',
      order: 6,
    },
    detail: {
      description:
        'Campanha global de lançamento de produto SaaS. Foco em conversão e awareness através de visuais de alto impacto.',
      highlights: ['Art Direction', 'Social Ads', 'Landing Pages'],
    },
  },
];

export function filterProjectsByCategory(
  projects: PortfolioProject[],
  category: ProjectCategory
) {
  if (category === 'all') return projects;
  return projects.filter((project) => project.category === category);
}
export interface FloatingCardData {
  id: number;
  title: string;
  desc: string;
  img: string;
}

export const floatingCardsData: FloatingCardData[] = [
  {
    id: 1,
    title: 'Creative Flow',
    img: 'https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=800&auto=format&fit=crop',
    desc: 'Intuição guiando pixels',
  },
  {
    id: 2,
    title: 'Design Origin',
    img: 'https://images.unsplash.com/photo-1633167606207-d840b5070fc2?q=80&w=800&auto=format&fit=crop',
    desc: 'Do traço à intenção',
  },
  {
    id: 3,
    title: 'Digital Ghost',
    img: 'https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=800&auto=format&fit=crop',
    desc: 'Presença sem peso',
  },
  {
    id: 4,
    title: 'IA Creation',
    img: 'https://images.unsplash.com/photo-1677442136019-21780ecad995?q=80&w=800&auto=format&fit=crop',
    desc: 'Inteligência aplicada',
  },
  {
    id: 5,
    title: 'Brand Strategy',
    img: 'https://images.unsplash.com/photo-1557683316-973673baf926?q=80&w=800&auto=format&fit=crop',
    desc: 'Estratégia que marca',
  },
  {
    id: 6,
    title: 'Motion Editorial',
    img: 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=800&auto=format&fit=crop',
    desc: 'Movimento com método',
  },
  {
    id: 7,
    title: 'Future Tech',
    img: 'https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=800&auto=format&fit=crop',
    desc: 'O que vem a seguir',
  },
  {
    id: 8,
    title: 'Minimal Ethics',
    img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=800&auto=format&fit=crop',
    desc: 'Menos é potência',
  },
];
const { validateAdminArgs } = require('firebase-admin/data-connect');

const connectorConfig = {
  connector: 'gemini-test',
  serviceId: 'portfolio-danilo-novais-service',
  location: 'southamerica-west1'
};
exports.connectorConfig = connectorConfig;

function createUser(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('CreateUser', inputVars, inputOpts);
}
exports.createUser = createUser;

function getProjectsByUser(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeQuery('GetProjectsByUser', inputVars, inputOpts);
}
exports.getProjectsByUser = getProjectsByUser;

function createProject(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('CreateProject', inputVars, inputOpts);
}
exports.createProject = createProject;

function deleteProject(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('DeleteProject', inputVars, inputOpts);
}
exports.deleteProject = deleteProject;

import { validateAdminArgs } from 'firebase-admin/data-connect';

export const connectorConfig = {
  connector: 'gemini-test',
  serviceId: 'portfolio-danilo-novais-service',
  location: 'southamerica-west1'
};

export function createUser(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('CreateUser', inputVars, inputOpts);
}

export function getProjectsByUser(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeQuery('GetProjectsByUser', inputVars, inputOpts);
}

export function createProject(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('CreateProject', inputVars, inputOpts);
}

export function deleteProject(dcOrVarsOrOptions, varsOrOptions, options) {
  const { dc: dcInstance, vars: inputVars, options: inputOpts} = validateAdminArgs(connectorConfig, dcOrVarsOrOptions, varsOrOptions, options, true, true);
  dcInstance.useGen(true);
  return dcInstance.executeMutation('DeleteProject', inputVars, inputOpts);
}

{"type":"module"}{
  "name": "@dataconnect/admin-generated",
  "version": "0.0.1",
  "author": "Firebase <firebase-support@google.com> (https://firebase.google.com/)",
  "description": "Generated Admin SDK For gemini-test",
  "license": "Apache-2.0",
  "engines": {
    "node": " >=18.0"
  },
  "typings": "index.d.ts",
  "module": "esm/index.esm.js",
  "main": "index.cjs.js",
  "browser": "esm/index.esm.js",
  "exports": {
    ".": {
      "types": "./index.d.ts",
      "require": "./index.cjs.js",
      "default": "./esm/index.esm.js"
    },
    "./package.json": "./package.json"
  },
  "peerDependencies": {
    "firebase-admin": "^13.4.0"
  }
}import { ConnectorConfig, DataConnect, OperationOptions, ExecuteOperationResponse } from 'firebase-admin/data-connect';

export const connectorConfig: ConnectorConfig;

export type TimestampString = string;
export type UUIDString = string;
export type Int64String = string;
export type DateString = string;


export interface CreateProjectData {
  project_insert: Project_Key;
}

export interface CreateProjectVariables {
  title: string;
  description: string;
  client?: string | null;
  link?: string | null;
  role?: string | null;
}

export interface CreateUserData {
  user_insert: User_Key;
}

export interface CreateUserVariables {
  email: string;
  name: string;
  password: string;
}

export interface DeleteProjectData {
  project_delete?: Project_Key | null;
}

export interface DeleteProjectVariables {
  id: UUIDString;
}

export interface GetProjectsByUserData {
  projects: ({
    id: UUIDString;
    title: string;
    description: string;
  } & Project_Key)[];
}

export interface GetProjectsByUserVariables {
  userId: UUIDString;
}

export interface Image_Key {
  id: UUIDString;
  __typename?: 'Image_Key';
}

export interface ProjectSkill_Key {
  projectId: UUIDString;
  skillId: UUIDString;
  __typename?: 'ProjectSkill_Key';
}

export interface Project_Key {
  id: UUIDString;
  __typename?: 'Project_Key';
}

export interface Skill_Key {
  id: UUIDString;
  __typename?: 'Skill_Key';
}

export interface User_Key {
  id: UUIDString;
  __typename?: 'User_Key';
}

/** Generated Node Admin SDK operation action function for the 'CreateUser' Mutation. Allow users to execute without passing in DataConnect. */
export function createUser(dc: DataConnect, vars: CreateUserVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<CreateUserData>>;
/** Generated Node Admin SDK operation action function for the 'CreateUser' Mutation. Allow users to pass in custom DataConnect instances. */
export function createUser(vars: CreateUserVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<CreateUserData>>;

/** Generated Node Admin SDK operation action function for the 'GetProjectsByUser' Query. Allow users to execute without passing in DataConnect. */
export function getProjectsByUser(dc: DataConnect, vars: GetProjectsByUserVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<GetProjectsByUserData>>;
/** Generated Node Admin SDK operation action function for the 'GetProjectsByUser' Query. Allow users to pass in custom DataConnect instances. */
export function getProjectsByUser(vars: GetProjectsByUserVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<GetProjectsByUserData>>;

/** Generated Node Admin SDK operation action function for the 'CreateProject' Mutation. Allow users to execute without passing in DataConnect. */
export function createProject(dc: DataConnect, vars: CreateProjectVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<CreateProjectData>>;
/** Generated Node Admin SDK operation action function for the 'CreateProject' Mutation. Allow users to pass in custom DataConnect instances. */
export function createProject(vars: CreateProjectVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<CreateProjectData>>;

/** Generated Node Admin SDK operation action function for the 'DeleteProject' Mutation. Allow users to execute without passing in DataConnect. */
export function deleteProject(dc: DataConnect, vars: DeleteProjectVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<DeleteProjectData>>;
/** Generated Node Admin SDK operation action function for the 'DeleteProject' Mutation. Allow users to pass in custom DataConnect instances. */
export function deleteProject(vars: DeleteProjectVariables, options?: OperationOptions): Promise<ExecuteOperationResponse<DeleteProjectData>>;

import { create } from 'zustand';

// Define the Experience Flags interface
export interface ExperienceFlags {
  mountWebGL: boolean;
  enableManifestoScroll: boolean;
  enableHoverInteractions: boolean;
  reducedMotion: boolean;
  debugMode: boolean; // Add debugMode flag
}

// Define Narrative States
export type NarrativeState =
  | 'IDLE'
  | 'HERO_EDITORIAL'
  | 'MANIFESTO_TRANSITION'
  | 'MANIFESTO_FULLSCREEN'
  | 'EXPLORATION';

interface AntigravityState {
  // Experience Configuration
  flags: ExperienceFlags;
  setFlag: (_key: keyof ExperienceFlags, _value: boolean) => void;
  setFlags: (_flags: Partial<ExperienceFlags>) => void;

  // Real-time Context
  viewport: { width: number; height: number };
  setViewport: (_width: number, _height: number) => void;

  // Narrative Control
  narrativeState: NarrativeState;
  setNarrativeState: (_state: NarrativeState) => void;

  // Scroll Metrics
  scrollProgress: number;
  setScrollProgress: (_progress: number) => void;
}

export const useAntigravityStore = create<AntigravityState>((set) => ({
  // Defaults based on CI/Rules
  flags: {
    mountWebGL: true, // Will be overridden by hydration/device check
    enableManifestoScroll: true,
    enableHoverInteractions: true,
    reducedMotion: false,
    debugMode: process.env.NODE_ENV === 'development',
  },

  viewport: { width: 0, height: 0 },
  narrativeState: 'IDLE',
  scrollProgress: 0,

  setFlag: (key, value) =>
    set((state) => ({ flags: { ...state.flags, [key]: value } })),
  setFlags: (newFlags) =>
    set((state) => ({ flags: { ...state.flags, ...newFlags } })),

  setViewport: (width, height) => set({ viewport: { width, height } }),

  setNarrativeState: (state) => set({ narrativeState: state }),

  setScrollProgress: (progress) => set({ scrollProgress: progress }),
}));
import { create } from 'zustand';
import { ExperienceFlags } from '@/lib/antigravity/antigravity';

interface ExperienceState {
  flags: ExperienceFlags;
  setFlags: (_flags: ExperienceFlags) => void;
}

export const useExperienceStore = create<ExperienceState>((set) => ({
  flags: {
    mountWebGL: false,
    enableManifestoScroll: false,
    enableHoverInteractions: false,
    reducedMotion: false,
    debugMode: false,
  },
  setFlags: (flags) => set({ flags }),
}));
